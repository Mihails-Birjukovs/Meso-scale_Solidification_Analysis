(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    786284,      16278]
NotebookOptionsPosition[    749184,      15703]
NotebookOutlinePosition[    749715,      15723]
CellTagsIndexPosition[    749672,      15720]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"45096047-8b69-47e7-9329-51d19bb0fc31"],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
   3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
   3.8429691342153788`*^9, 3.8429691372472734`*^9}, 
   3.868722172427369*^9},ExpressionUUID->"2a45afa4-01f0-4d8b-870f-\
5ae3f8e134f4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbd", ":=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "packageDirectory", ":=", 
   "\"\<D:\\\\Science\\\\NMI (VTPMML)\\\\MHD Project\\\\Image \
Processing\\\\Mathematica Libraries & Packages\\\\\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"packageDirectory", "<>", "\"\<MATLink\\\\MATLink.m\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], "]"}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OpenMATLAB", "[", "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MEvaluate", "[", 
   RowBox[{
   "\"\<addpath('\>\"", "<>", "packageDirectory", "<>", 
    "\"\<BM3D\\\\bm3d_matlab_package_3.0.7\>\"", "<>", "\"\<');\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MEvaluate", "[", 
    RowBox[{
    "\"\<addpath('\>\"", "<>", "packageDirectory", "<>", 
     "\"\<BM3D\\\\bm3d_matlab_package_3.0.7\\\\bm3d\>\"", "<>", 
     "\"\<');\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sendImageToMatlab", "[", "image_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"transferImage", "=", "image"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MSet", "[", 
       RowBox[{"\"\<transfer_image\>\"", ",", 
        RowBox[{"ImageData", "@", "transferImage"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "MEvaluate", "[", 
       "\"\<mat_import_image = im2double(transfer_image)\>\"", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sendImageToMathematica", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{"MGet", "@", 
     RowBox[{"ToString", "@", "image"}]}], "//", "Image"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"Histogram", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"ChartElementFunction", "\[Rule]", "\"\<GlassRectangle\>\""}], 
       ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<GrayTones\>\""}], ",", 
       RowBox[{"LabelingFunction", "\[Rule]", "None"}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "fontSize"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"MatrixPlot", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       RowBox[{"ClippingStyle", "\[Rule]", "LightGray"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
       RowBox[{"MeshStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold", ",", "matrixPlotFontSize"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"Kernels", "[", "]"}]}], "<", "useKernels"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LaunchKernels", "[", "\[IndentingNewLine]", 
       RowBox[{"useKernels", "-", 
        RowBox[{"Length", "@", 
         RowBox[{"Kernels", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",",
       "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{"2", "*", "$ProcessorCount"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mainOutputFolder", "=", 
    RowBox[{"nbd", "<>", "\"\<Output\\\\\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DirectoryQ", "@", "mainOutputFolder"}], ",", 
     "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
     RowBox[{"mainOutputFolder", "//", "CreateDirectory"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"memoizationSync", "[", "f_Symbol", "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", "=", 
       RowBox[{"memo", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "===", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"value", "=", 
           RowBox[{"valueOnMain", "[", 
            RowBox[{"f", ",", "x"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"value", "===", "Null"}], ",", "\[IndentingNewLine]", 
           RowBox[{"f", "/:", 
            RowBox[{"memo", "[", 
             RowBox[{"f", ",", "x"}], "]"}], "=", 
            RowBox[{"setValueOnMain", "[", 
             RowBox[{"f", ",", "x", ",", 
              RowBox[{"f", "[", "x", "]"}]}], "]"}]}], ",", 
           RowBox[{"f", "/:", 
            RowBox[{"memo", "[", 
             RowBox[{"f", ",", "x"}], "]"}], "=", "value"}]}], "]"}]}], "]"}],
        ",", "result"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"memo", "[", "___", "]"}], ":=", "Null"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "@", "memo"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"valueOnMain", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"memo", "[", 
    RowBox[{"f", ",", "x"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"setValueOnMain", "[", 
    RowBox[{"f_", ",", "x_", ",", "fx_"}], "]"}], ":=", 
   RowBox[{"f", "/:", 
    RowBox[{"memo", "[", 
     RowBox[{"f", ",", "x"}], "]"}], "=", "fx"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SetSharedFunction", "[", 
   RowBox[{"valueOnMain", ",", "setValueOnMain"}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clearParallelCache", "[", "f_Symbol", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UpValues", "@", "f"}], "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ParallelEvaluate", "[", 
     RowBox[{
      RowBox[{"UpValues", "@", "f"}], "=", 
      RowBox[{"{", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8169304402015343`*^9, 3.8169304572329664`*^9}, {
   3.817297782007059*^9, 3.81729778360575*^9}, {3.817308232575077*^9, 
   3.8173082329091744`*^9}, {3.8173082654542065`*^9, 
   3.8173082661323175`*^9}, {3.8173083731116056`*^9, 3.817308436969288*^9}, 
   3.8173084714569016`*^9, 3.817308641528023*^9, {3.8215187351516724`*^9, 
   3.8215187451204844`*^9}, {3.8215212453537927`*^9, 
   3.8215212812414527`*^9}, {3.8215217470822363`*^9, 3.821521772298771*^9}, {
   3.821521813453446*^9, 3.821521857595766*^9}, {3.8215222341401415`*^9, 
   3.821522259318509*^9}, {3.82152326402353*^9, 3.8215232643347263`*^9}, {
   3.821530441037798*^9, 3.821530444877508*^9}, {3.821530481189026*^9, 
   3.82153057883045*^9}, {3.821542161396227*^9, 3.821542175551358*^9}, {
   3.8215580973521657`*^9, 3.8215581067121277`*^9}, {3.821605050390068*^9, 
   3.8216050553070993`*^9}, 3.8222976400725813`*^9, {3.8223704281181946`*^9, 
   3.8223704510386715`*^9}, {3.822370484639129*^9, 3.8223706107676973`*^9}, {
   3.8223706477507224`*^9, 3.8223706492089605`*^9}, {3.828688650553396*^9, 
   3.8286886604331484`*^9}, {3.8286887169625216`*^9, 3.82868871879954*^9}, 
   3.837423323092683*^9, {3.8374471631829567`*^9, 3.837447166189891*^9}, 
   3.837482865647195*^9, {3.83748650590446*^9, 3.837486515674389*^9}, {
   3.8374865601047926`*^9, 3.8374865698484826`*^9}, {3.837573800224904*^9, 
   3.837573827721392*^9}, {3.8382948555756283`*^9, 3.8382948875230775`*^9}, {
   3.8392405080734577`*^9, 3.839240509496673*^9}, {3.845908474521624*^9, 
   3.845908486131469*^9}, {3.8460780854049487`*^9, 3.8460780863893166`*^9}, {
   3.8468449093043537`*^9, 3.846844911120497*^9}, 3.846845057328478*^9, {
   3.8468450886410856`*^9, 3.846845088896404*^9}, {3.8468451740330434`*^9, 
   3.8468451944241047`*^9}, {3.847633582605837*^9, 3.847633582957895*^9}, 
   3.8521991480171003`*^9, {3.8542845528223853`*^9, 3.854284566766261*^9}, {
   3.8546067085403414`*^9, 3.854606718740966*^9}, 3.855684893220052*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"884cb88d-eb1f-4064-847e-add6faa523fc"],

Cell[CellGroupData[{

Cell["Accelerate image transfer & BM3D for Matlab", "Subitem",
 CellChangeTimes->{{3.8215428902446327`*^9, 3.8215429092917013`*^9}, {
   3.821543019999116*^9, 3.821543055134698*^9}, {3.821543108413828*^9, 
   3.82154310858138*^9}, 3.8215435373886523`*^9, {3.821543586804587*^9, 
   3.821543595004086*^9}, {3.821552325940542*^9, 3.8215523722177296`*^9}, {
   3.8215571746165543`*^9, 3.8215571838568335`*^9}, {3.8215962804132195`*^9, 
   3.821596310588499*^9}, {3.821628482941619*^9, 3.8216285029161797`*^9}, {
   3.837605148633341*^9, 3.8376051589218345`*^9}, {3.843190145144206*^9, 
   3.8431901473592834`*^9}, {3.8474399809766827`*^9, 3.8474399809766827`*^9}},
 FontSize->18,ExpressionUUID->"cf721f86-9762-4d2d-b0b1-0300ad0a92d5"],

Cell["BM3D & NLM: integrate the GPU versions into the code", "Subitem",
 CellChangeTimes->{{3.8215428902446327`*^9, 3.8215429092917013`*^9}, {
   3.821543019999116*^9, 3.821543055134698*^9}, {3.821543108413828*^9, 
   3.82154310858138*^9}, 3.8215435373886523`*^9, {3.821543586804587*^9, 
   3.821543595004086*^9}, {3.821552325940542*^9, 3.8215523722177296`*^9}, {
   3.8215571746165543`*^9, 3.8215571838568335`*^9}, {3.8215962804132195`*^9, 
   3.821596310588499*^9}, {3.821628482941619*^9, 3.8216285029161797`*^9}, {
   3.837605148633341*^9, 3.8376051589218345`*^9}, {3.843190145144206*^9, 
   3.8431901473592834`*^9}, {3.847439982588372*^9, 3.847440006339857*^9}},
 FontSize->18,ExpressionUUID->"f6df6450-99d5-424f-8ed2-f29d0ecee839"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Images <<", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8474400491164675`*^9, 
  3.8474400514841356`*^9}},ExpressionUUID->"06a2365c-27b9-4856-8b6c-\
bf063a96d9ee"],

Cell["\<\
Pixel sizes:\[LineSeparator]  \
--------------------------------------------------
Dendrites:
\[LineSeparator]-2014-04-04      ->     1 px = 37.6 \[Micro]m
-2014-03-07     ->     1 px = 37.6 \[Micro]m
-2011-09-19-Exp2     ->     1 px = 23.7 \[Micro]m
-2014-04-15-Exp2     ->     1 px = 17.3 \[Micro]m

-2011-09-09-Exp1     ->     1 px = 17.5 \[Micro]m
-2011-09-09-Exp2     ->     1 px = 17.5 \[Micro]m
  --------------------------------------------------
Seaweeds:

2020-02-03      ->     1px = 11 \[Micro]m
2020-02-06      ->     1px = 17.5 \[Micro]m
2020-02-10      ->     1px = 17.5 \[Micro]m
  --------------------------------------------------
Exposure time in all cases: 1 s\
\>", "Abstract",
 CellChangeTimes->{{3.860734951349084*^9, 3.860735026478571*^9}, {
   3.8609146608535275`*^9, 3.8609146900929856`*^9}, 3.8609204395870028`*^9, {
   3.8609205850911922`*^9, 3.860920585251766*^9}, {3.861617003782383*^9, 
   3.861617047418807*^9}, {3.8616503848168697`*^9, 3.861650394647577*^9}, {
   3.861694332607851*^9, 3.861694365734353*^9}, {3.86169440087022*^9, 
   3.8616944709419107`*^9}, {3.861694614767084*^9, 3.861694644189275*^9}, {
   3.8616998710451202`*^9, 
   3.861699879369816*^9}},ExpressionUUID->"846099f5-e39f-491d-812f-\
5db230832caf"],

Cell[BoxData[{
 RowBox[{"imageFolder", ":=", 
  "\"\<D:\\\\[BIG DATA]\\\\ACTIVE - Data From Experiments\\\\HZDR \
Data\\\\Solidification\\\\2-metal \
Alloy\\\\2011-09-09\\\\2011-09-09-Experiment-1\\\\outliers-removed\\\\2011-09-\
09-Experiment-1\\\\\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileFolder", "=", 
    RowBox[{"SetDirectory", "@", "imageFolder"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"FileNames", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"files", "=", 
     RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToExpression", "@", 
         RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mainOutputFolder", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "imageFolder"}], "<>", "$PathnameSeparator"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DirectoryQ", "@", "output"}], ",", "\[IndentingNewLine]", 
     "Nothing", ",", "\[IndentingNewLine]", 
     RowBox[{"output", "//", "CreateDirectory"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pixelSizeMuMeters", "=", "17.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDurationSeconds", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223706440166283`*^9, 3.822370655408784*^9}, {
   3.828688415466848*^9, 3.82868842302295*^9}, {3.8374366106307073`*^9, 
   3.837436612730121*^9}, {3.8374366659407735`*^9, 3.837436692066312*^9}, {
   3.8381903902811985`*^9, 3.83819039139227*^9}, {3.8381904680399017`*^9, 
   3.8381904695363336`*^9}, 3.838216530611554*^9, {3.8382191179383373`*^9, 
   3.8382191248648205`*^9}, {3.8382729728363075`*^9, 3.838272996674044*^9}, {
   3.8382863609276934`*^9, 3.8382863610304193`*^9}, {3.838305050105472*^9, 
   3.8383050674773693`*^9}, 3.8383531801353483`*^9, 3.8383552870779576`*^9, 
   3.838355950741046*^9, {3.8383583080979815`*^9, 3.838358320838064*^9}, 
   3.838358642262561*^9, 3.83835938412653*^9, {3.8383596741132855`*^9, 
   3.838359675237794*^9}, 3.8383672241736517`*^9, 3.8383677158146973`*^9, 
   3.8383782172319813`*^9, 3.8383812717115183`*^9, 3.8383919404134965`*^9, {
   3.8383951404896803`*^9, 3.838395141945258*^9}, 3.8383957508263054`*^9, 
   3.8383962092769995`*^9, 3.838440178597614*^9, {3.8384603062397842`*^9, 
   3.83846030632755*^9}, 3.8384874747868905`*^9, 3.8384886340622716`*^9, 
   3.8384898184326525`*^9, 3.8387144349807224`*^9, 3.838718387768408*^9, 
   3.838783672135442*^9, 3.8387855431967335`*^9, 3.8388052155423717`*^9, 
   3.8388052707430196`*^9, 3.8388138451768236`*^9, 3.8388182456485386`*^9, 
   3.839148895384262*^9, 3.8391507672002506`*^9, {3.8392272156353474`*^9, 
   3.8392272162187853`*^9}, 3.8392286941850123`*^9, 3.8392361561605406`*^9, 
   3.839237054370471*^9, 3.8392376434789*^9, 3.839239551639701*^9, {
   3.8392405156909723`*^9, 3.8392405166323752`*^9}, 3.8426915720122404`*^9, 
   3.8426995743483825`*^9, 3.842701441707861*^9, {3.842955349114176*^9, 
   3.842955352410673*^9}, {3.842965903750918*^9, 3.8429659307674704`*^9}, {
   3.8429674715058975`*^9, 3.8429674715916667`*^9}, 3.8429683448606544`*^9, 
   3.843012375014877*^9, 3.8430132360946603`*^9, 3.843014548711771*^9, {
   3.84303679316053*^9, 3.8430368204441023`*^9}, 3.8430372772194633`*^9, 
   3.84303914834064*^9, 3.843041855422675*^9, 3.8430425183085155`*^9, 
   3.8430441409883466`*^9, 3.8430458153123665`*^9, 3.843046434447945*^9, 
   3.8432706623841705`*^9, 3.8458140268217945`*^9, 3.8458142420373936`*^9, {
   3.845814453698887*^9, 3.845814454283103*^9}, 3.8458147898582354`*^9, 
   3.845814918747543*^9, 3.845952924411313*^9, 3.845963521992029*^9, 
   3.8459655352923117`*^9, 3.845976038814541*^9, 3.845994196093089*^9, {
   3.8460477500394373`*^9, 3.8460477510575123`*^9}, 3.8460520665603027`*^9, 
   3.8462449041652713`*^9, {3.8471795139218264`*^9, 3.8471795148409224`*^9}, 
   3.8473576654171953`*^9, 3.8473594101762486`*^9, {3.8473615178251505`*^9, 
   3.847361518712777*^9}, 3.852223868441091*^9, {3.8522241246689367`*^9, 
   3.852224127354022*^9}, 3.854283893172999*^9, 3.854283974123249*^9, {
   3.854284028747675*^9, 3.8542840361945086`*^9}, {3.8546066921224084`*^9, 
   3.8546067913507395`*^9}, 3.860576169449164*^9, 3.860576255705443*^9, 
   3.8605763894079404`*^9, {3.86057685706324*^9, 3.8605768843226213`*^9}, 
   3.8606702712773504`*^9, {3.86073503842074*^9, 3.860735065978959*^9}, 
   3.860920334990741*^9, 3.861468008499719*^9, {3.861549367591876*^9, 
   3.861549369023287*^9}, 3.8615494706474485`*^9, 3.861551661877142*^9, 
   3.8615517295575304`*^9, {3.8615519494698534`*^9, 3.86155195636662*^9}, 
   3.8616140465087533`*^9, 3.861616996296524*^9, 3.8616170617156515`*^9, 
   3.8616172704118323`*^9, 3.861650609512191*^9, 3.8616997318111105`*^9, 
   3.8616998512851644`*^9, 3.861699942200835*^9, 3.8617822044287*^9, 
   3.8617822627454386`*^9, {3.8617920886905766`*^9, 3.8617921010953455`*^9}, {
   3.8617989203499813`*^9, 3.861798928798402*^9}, {3.861799913340885*^9, 
   3.861799927804253*^9}, {3.861800345316432*^9, 3.8618003525178585`*^9}, {
   3.86181483099113*^9, 3.8618148443292217`*^9}, 3.8618688336974387`*^9, {
   3.862045267973294*^9, 3.8620452740683985`*^9}, 3.862478514969168*^9, 
   3.8625042707295294`*^9, 3.8625043084647055`*^9, {3.8626568001531677`*^9, 
   3.8626568092538567`*^9}, {3.8692176956431427`*^9, 3.8692177152949505`*^9}, 
   3.8692365233272886`*^9, 3.8692366194637704`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"a8d5aaff-3a3a-4da0-8bf2-2806a0ee5587"],

Cell[BoxData[
 RowBox[{
  RowBox[{"images", "=", 
   RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fileFolder", "<>", "$PathnameSeparator", "<>", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"files", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"Length", "@", "files"}]}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.82237034851377*^9, 3.822370354429882*^9}, 
   3.822370406705285*^9, {3.8223707318084*^9, 3.8223707386015005`*^9}, {
   3.8223708729527082`*^9, 3.822370904441451*^9}, {3.8459085060339146`*^9, 
   3.8459085143374596`*^9}, 3.8609203411662297`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"71807184-3659-4b8e-923f-fe071caa0852"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.8468307794745717`*^9, 
  3.8468307830344753`*^9}},ExpressionUUID->"cd6a4491-20b7-468c-bded-\
69856ee6320d"],

Cell[CellGroupData[{

Cell["Image Filtering & Manipulation", "Subsection",
 CellChangeTimes->{{3.8381889592254605`*^9, 
  3.8381889906103125`*^9}},ExpressionUUID->"10397ac2-609f-4642-ae9e-\
abbcc93d760e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bm3dFilter", "[", 
     RowBox[{"inputImage_", ",", "outputImage_", ",", "noiseVariance_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inputMatlab", "=", "inputImage"}], ",", 
        RowBox[{"outputMatlab", "=", "outputImage"}], ",", 
        RowBox[{"noiseVar", "=", "noiseVariance"}], ",", 
        "\[IndentingNewLine]", "filterScript"}], "\[IndentingNewLine]", "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filterScript", "=", 
        RowBox[{"MScript", "[", "\[IndentingNewLine]", 
         RowBox[{"\"\<testFilter1\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{
          "\"\<z = mat_import_image;\nnoise_type =  'gw';\nnoise_var = \>\"", 
           "<>", 
           RowBox[{"ToString", "@", "noiseVar"}], "<>", 
           "\"\<;\nseed = 0;\n[noise, PSD, kernel] = \
getExperimentNoise(noise_type, noise_var, seed, size(z));\n\>\"", "<>", 
           RowBox[{"ToString", "@", "outputMatlab"}], "<>", 
           "\"\< = BM3D(z, PSD,'refilter');\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Overwrite\>\"", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sendImageToMatlab", "@", "inputMatlab"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MEvaluate", "@", "filterScript"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"sendImageToMathematica", "@", "outputMatlab"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyBM3D", "[", 
    RowBox[{"image_", ",", "noiseVarianceBM3D_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"bm3dFilter", "[", 
      RowBox[{"#", ",", "placeholder", ",", "noiseVarianceBM3D"}], "]"}], 
     "&"}], "@", "image"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"preprocessImage", "[", "image_", "]"}], ":=", 
   RowBox[{"BrightnessEqualize", "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"ColorToneMapping", "@", 
      RowBox[{"ImageAdjust", "@", "image"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanImage", "[", "image_", "]"}], ":=", 
   RowBox[{"BrightnessEqualize", "@", 
    RowBox[{"correction", "@", 
     RowBox[{"nonlocalCorrection", "@", 
      RowBox[{"nonlocalCorrection", "@", "image"}]}]}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"correction", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
      "&"}], "@", "image"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nonlocalCorrection", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "*", "image"}], "-", 
     RowBox[{"nonlocalCorrectionWeight", "*", 
      RowBox[{"NonlocalMeansFilter", "[", "\[IndentingNewLine]", 
       RowBox[{
       "image", ",", "nonlocalCorrectionRadius", ",", "nonlocalNoiseFactor"}],
        "\[IndentingNewLine]", "]"}]}]}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSkeleton", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteSmallComponents", "[", 
      RowBox[{"#", ",", "sizeThreshold"}], "]"}], "&"}], "@", 
    RowBox[{"Thinning", "@", "image"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPartitionSkeleton", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"getSkeleton", "@", 
      RowBox[{"ColorNegate", "@", 
       RowBox[{"MorphologicalBinarize", "@", 
        RowBox[{"cleanImage", "@", "\[IndentingNewLine]", 
         RowBox[{"applyBM3D", "[", 
          RowBox[{"#", ",", "windowNoiseVarianceBM3D"}], "]"}]}]}]}]}], "&"}],
     "@", 
    RowBox[{"preprocessImage", "@", "image"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSolidSkeletons", "[", 
    RowBox[{"skeletons_", ",", "regionMasks_"}], "]"}], ":=", 
   RowBox[{"Parallelize", "@", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageMultiply", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"First", "@", "#2"}]}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"skeletons", ",", "regionMasks"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCleanSolidSkeleton", "[", "skeleton_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Round", "@", "postMaskingSizeThreshold"}]}], "]"}], "&"}],
         "@", "\[IndentingNewLine]", 
        RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"ColorNegate", "@", 
           RowBox[{"FillingTransform", "@", 
            RowBox[{"ColorNegate", "@", "#"}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "&"}], "@", "\[IndentingNewLine]", 
      RowBox[{"Nest", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Pruning", "[", 
          RowBox[{"#", ",", "skeletonPruningScale"}], "]"}], "&"}], ",", 
        "\[IndentingNewLine]", "#", ",", "skepetonPruningIterations"}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "@", "skeleton"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getRegion", "[", 
     RowBox[{"image_", ",", "regionBoundaries_"}], "]"}], ":=", 
    RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
     RowBox[{"image", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", "regionBoundaries"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
       "regionBoundaries"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFramePartition", "[", 
    RowBox[{"image_", ",", "partitionScale_"}], "]"}], ":=", 
   RowBox[{"ImagePartition", "[", "\[IndentingNewLine]", 
    RowBox[{"image", ",", 
     RowBox[{"partitionScale", "*", 
      RowBox[{"Min", "@", 
       RowBox[{"ImageDimensions", "@", "testFrame"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getPartitionVoidFraction", "[", 
     RowBox[{"voidFractionMaps_", ",", "partitionAreas_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "0", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "@", "#"}], "/", "partitionArea"}], "//", "N"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ComponentMeasurements", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "\"\<Area\>\"", "}"}]}], "]"}], "/.", 
            RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", 
           ")"}]}], "&"}], "/@", "voidFractionMap"}], "//", "Parallelize"}], 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"textureInpaint", "[", 
     RowBox[{"image_", ",", "mask_"}], "]"}], ":=", 
    RowBox[{"Inpaint", "[", "\[IndentingNewLine]", 
     RowBox[{"image", ",", "mask", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"\"\<TextureSynthesis\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<MaxSamples\>\"", "\[Rule]", "inpaintMaxSamples"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<NeighborCount\>\"", "\[Rule]", "inpaintSampleNeigborCount"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"flatFieldCorrect", "[", 
    RowBox[{"image_", ",", "flatField_"}], "]"}], ":=", 
   RowBox[{"ImageMultiply", "[", 
    RowBox[{"image", ",", 
     RowBox[{"flatField", "^", 
      RowBox[{"-", "1"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCleanFrame", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"textureInpaint", "[", 
        RowBox[{"#", ",", "inpaintMask"}], "]"}], "&"}], "@", 
      RowBox[{"flatFieldCorrect", "[", 
       RowBox[{"#", ",", "referenceFrame"}], "]"}]}], "&"}], "@", "image"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getImageMask", "[", 
    RowBox[{"inpaintMask_", ",", "solidMask_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageMultiply", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ColorNegate", "@", "inpaintMask"}]}], "]"}], "&"}], "@", 
    "solidMask"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSolidImage", "[", 
    RowBox[{"repairedFrame_", ",", "imageMask_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ImageMultiply", "[", 
     RowBox[{"repairedFrame", ",", "imageMask"}], "]"}], "//", 
    "ImageAdjust"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDendriteGrainMasks", "[", 
    RowBox[{"dendriteSkeleton_", ",", "orientationBins_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputBins", "=", "orientationBins"}], ",", 
       RowBox[{"inputSkeleton", "=", "dendriteSkeleton"}], ",", 
       "\[IndentingNewLine]", "orientationPeakColorRanges", ",", 
       "solidColorClusters", ",", "filteredSolidColorClusters", ",", 
       "dendriteGrainMasks"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orientationPeakColorRanges", "=", 
       RowBox[{"getOrientationPeakColorRanges", "@", "inputBins"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"orientationPeakColorRanges", "//", "TableForm"}], "//", 
       "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solidColorClusters", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorDetect", "[", 
          RowBox[{"inputSkeleton", ",", "#"}], "]"}], "&"}], "/@", 
        "orientationPeakColorRanges"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"filteredSolidColorClusters", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "colorMatchThreshold"}], "]"}], "&"}], "/@", 
        "solidColorClusters"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"dendriteGrainMasks", "=", 
       RowBox[{"getGrainMasks", "/@", "filteredSolidColorClusters"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"inputSkeleton", ",", "\[IndentingNewLine]", 
            RowBox[{"solidColorClusters", "[", 
             RowBox[{"[", "previewID", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"filteredSolidColorClusters", "[", 
             RowBox[{"[", "previewID", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"ImageCollage", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"ImagePadding", "\[Rule]", "10"}]}], "]"}], "&"}], 
               "@", 
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"#", "\[Equal]", 
                  RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Binarize", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
                   "inputSkeleton"}], "}"}], ",", "\[IndentingNewLine]", 
                 "#"}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "/@", 
                  RowBox[{"ComponentMeasurements", "[", 
                   RowBox[{"#", ",", "\"\<MaskedImage\>\""}], "]"}]}], "&"}], 
                "/@", 
                RowBox[{"dendriteGrainMasks", "[", 
                 RowBox[{"[", "previewID", "]"}], "]"}]}], "//", "Flatten"}], 
              "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
         RowBox[{"Spacings", "\[Rule]", "10"}]}], "\[IndentingNewLine]", 
        "]"}], "//", "Print"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "dendriteGrainMasks"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"discolorUnorientedSegments", "[", "skeleton_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "skeleton"}], ",", "\[IndentingNewLine]", 
       "masksAspectRatios", ",", "findUnorientedMasks"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"masksAspectRatios", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"1", "/", 
             RowBox[{"Minus", "[", 
              RowBox[{
               RowBox[{"Last", "@", "#"}], "-", "1"}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"Last", "/@", 
         RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
          RowBox[{"input", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<Mask\>\"", ",", "\"\<Elongation\>\""}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"findUnorientedMasks", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{"masksAspectRatios", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "@", "#"}], "<", "criticalAspectRatio"}], "&"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"findUnorientedMasks", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "input", ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Magenta", "\[Rule]", "White"}]}], "]"}], "&"}], "@", 
           RowBox[{"ColorReplace", "[", 
            RowBox[{"#", ",", 
             RowBox[{"White", "\[Rule]", "Magenta"}]}], "]"}]}], "&"}], "@", 
         RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
          RowBox[{"input", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageAdd", "@@", 
            RowBox[{"Image", "/@", 
             RowBox[{"First", "/@", "findUnorientedMasks"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGrainMasks", "[", "dendriteClusters_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Image", "/@", 
          RowBox[{"Last", "/@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}]}]}], "&"}], "@", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectComponents", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"#Area", ">", "grainAreaThreshold"}], "&"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
      RowBox[{"Closing", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"DiskMatrix", "@", "grainClosingScale"}]}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "@", "dendriteClusters"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getInpaintMask", "[", "image_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"brightMask", ",", "darkMask", ",", "\[IndentingNewLine]", 
       RowBox[{"referenceFrame", "=", "image"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"brightMask", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Dilation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "dilationScaleBright"}]}], "]"}], "&"}],
         "@", 
        RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
         RowBox[{"referenceFrame", ",", "artefactThresholdBright"}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"darkMask", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Dilation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "dilationScaleDark"}]}], "]"}], "&"}], 
        "@", 
        RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ColorNegate", "@", "referenceFrame"}], ",", 
          "artefactThresholdDark"}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ImageAdd", "[", 
       RowBox[{"brightMask", ",", "darkMask"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSkeletonMap", "[", 
     RowBox[{
     "voidFractionMap_", ",", "emptyRegionIndices_", ",", 
      "solidSkeletonsFiltered_", ",", "scanRegionIndices_"}], "]"}], ":=", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
       RowBox[{
       "voidFractionMap", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"voidFractionMap", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", "1"}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], 
          "&"}], "/@", "emptyRegionIndices"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"solidSkeletonsFiltered", "[", 
           RowBox[{"[", "\[IndentingNewLine]", 
            RowBox[{"First", "@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Position", "[", 
               RowBox[{"scanRegionIndices", ",", "#"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", 
         ")"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"First", "/@", "scanRegionIndices"}], ")"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMILseries", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mean", "@", 
        RowBox[{"ColorNegate", "@", 
         RowBox[{"ImageAdjust", "@", 
          RowBox[{"GaussianFilter", "[", 
           RowBox[{"#", ",", "gaussianKernelScale"}], "]"}]}]}]}], "&"}], "@",
       "\[IndentingNewLine]", 
      RowBox[{"flatFieldCorrect", "[", 
       RowBox[{"#", ",", "referenceFrame"}], "]"}]}], "&"}], "@", "image"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDynamicThresholdFactor", "[", "dataset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/", 
           RowBox[{"Min", "@", "#"}]}], ")"}], "&"}], "@", 
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"Max", "@", "#"}]}], ")"}]}], "&"}], "@", 
      RowBox[{"(", 
       RowBox[{"dynamicThresholdBias", "+", "1", "-", "#"}], ")"}]}], "&"}], 
    "@", "dataset"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getResolvedUnorientedSkeleton", "[", "skeleton_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"image", "=", "skeleton"}], ",", "\[IndentingNewLine]", 
       "cornerPixelPositions", ",", "cornerPixels", ",", "pixelPositions", 
       ",", "pixelsToRemovePositions", ",", "branchPoints", ",", 
       "pixelsToRemove"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cornerPixelPositions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", "0.5"}], ")"}], "&"}], "@", 
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", "First"}], "]"}]}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageCorners", "[", "\[IndentingNewLine]", 
           RowBox[{
           "#", ",", "cornerPixelRange", ",", "cornerThreshold", ",", 
            "minimumCornerDistance", ",", "\[IndentingNewLine]", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<HarrisStephens\>\"", ",", 
               RowBox[{
               "\"\<Gaussian\>\"", "\[Rule]", "gaussianDerivatives"}]}], 
              "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"MaxFeatures", "\[Rule]", "All"}]}], 
           "\[IndentingNewLine]", "]"}]}], "&"}], "@", "image"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cornerPixels", "=", 
       RowBox[{"ReplacePixelValue", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Binarize", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "image"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"cornerPixelPositions", "\[Rule]", "1"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pixelPositions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
          RowBox[{"PixelValuePositions", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", "image"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"pixelsToRemovePositions", "=", 
       RowBox[{"IntegerPart", "@", 
        RowBox[{"Intersection", "[", 
         RowBox[{"cornerPixelPositions", ",", 
          RowBox[{"N", "@", "pixelPositions"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"branchPoints", "=", 
       RowBox[{"MorphologicalBranchPoints", "@", "image"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pixelsToRemove", "=", 
       RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SelectComponents", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#Area", "<", "killThreshold"}], "&"}], ",", 
             RowBox[{"CornerNeighbors", "\[Rule]", "cornerConnectivity"}]}], 
            "]"}], "&"}], "@", "\[IndentingNewLine]", 
          RowBox[{"ReplacePixelValue", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Binarize", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "image"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"pixelsToRemovePositions", "\[Rule]", "1"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "branchPoints"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteSmallComponents", "[", 
         RowBox[{"#", ",", "keepThreshold"}], "]"}], "&"}], "@", 
       RowBox[{"ImageSubtract", "[", 
        RowBox[{"image", ",", "pixelsToRemove"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFinalizedSkeletons", "[", 
    RowBox[{"unoriented_", ",", "filtered_", ",", "resolved_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageAdd", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Parallelize", "@", 
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ImageSubtract", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"filtered", ",", "unoriented"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        "resolved"}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
     "]"}], "//", "Parallelize"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSecondPassGrainMasks", "[", 
    RowBox[{"primary_", ",", "mainSeparated_", ",", "differences_"}], "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "dendriteGrainMasksSeparated"}], "\[NotEqual]", 
      "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageMultiply", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ColorNegate", "@", "testLiquidMask"}]}], "]"}], "&"}], "/@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "@", "#"}], ">", "0"}], "&"}]}], "]"}], "&"}], 
        "@", 
        RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Length", "@", "dendriteGrainMasksSeparated"}]}], "]"}], 
           "&"}], "/@", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "mainDendriteGrainMasksSeparated", ",", "grainDifferences"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "Nothing"}], "\[IndentingNewLine]", "]"}]}], "\n", "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getUniqueGrains", "[", "grains_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "grains"}], ",", "\[IndentingNewLine]", 
       "secondPassGrainAreas", ",", "grainPairIndices", ",", 
       "grainPairOverlapMasks", ",", "grainPairOverlapFactors", ",", 
       "redundantGrains"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"secondPassGrainAreas", "=", 
       RowBox[{"Total", "/@", "input"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grainPairIndices", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Subsets", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "input"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"grainPairOverlapMasks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ImageMultiply", "@@", "#"}], "&"}], "/@", 
          RowBox[{"Subsets", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "@", "input"}]}], ";", 
      "\n", "\[IndentingNewLine]", 
      RowBox[{"grainPairOverlapFactors", "=", 
       RowBox[{"1", "-", 
        RowBox[{
        "MapThread", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", "#1"}], "/", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"0.5", "*", 
              RowBox[{"Total", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"secondPassGrainAreas", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "#2"}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}]}],
            "&"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"grainPairOverlapMasks", ",", "grainPairIndices"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "@", "grainPairOverlapFactors"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"redundantGrains", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"grainPairIndices", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{"grainPairOverlapFactors", ",", "\[IndentingNewLine]", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "<", "criticalOverlapFactor"}], "&"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "@", "redundantGrains"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", "\[IndentingNewLine]", 
       RowBox[{"input", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"First", "/@", "redundantGrains"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decomposePrimaryGrains", ":=", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "dendriteGrainMasksSeparated"}], "\[NotEqual]", 
       "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "@", "dendriteGrainMasksSeparated"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"plotOrientationPeaks", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"grainOrientationBins", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"grainSmoothedOrientationBins", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
            "}"}]}], "//", "Print"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"previewID", "=", "1"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"mainDendriteGrainMasks", "=", 
          RowBox[{
          "getDendriteGrainMasksAlternative", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"isolatedGrains", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"grainSmoothedOrientationBins", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mainDendriteGrainMasksSeparated", "[", "k", "]"}], "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Flatten", "@", "mainDendriteGrainMasks"}]}], 
             "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ImageMultiply", "@", 
              RowBox[{"DeleteDuplicates", "@", 
               RowBox[{"Flatten", "@", "mainDendriteGrainMasks"}]}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Binarize", "[", 
                RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
              RowBox[{"isolatedGrains", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mainDendriteGrainMasksSeparated", "[", "k", "]"}], "//", 
          "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"grainDifferences", "[", "k", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteSmallComponents", "[", 
             RowBox[{"#", ",", "grainAreaThreshold"}], "]"}], "&"}], "/@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageDifference", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"dendriteGrainMasksSeparated", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], ",", "#"}], 
               "\[IndentingNewLine]", "]"}], "&"}], "/@", 
             RowBox[{"mainDendriteGrainMasksSeparated", "[", "k", "]"}]}], 
            "\[IndentingNewLine]", ")"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"grainDifferences", "[", "k", "]"}], "//", "Print"}], 
         ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "@", 
       "\"\<Grain decomposition not possible - no significant grains detected\
\>\""}]}], "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MILbasedSegmentation", "[", "frameID_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DeleteSmallComponents", "[", 
        RowBox[{"#", ",", "solidSegmentSizeThreshold"}], "]"}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"ColorNegate", "@", 
       RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"dynamicThreshold", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
          RowBox[{"selectedFrameIDs", "[", 
           RowBox[{"[", "frameID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "&"}], "@", 
    RowBox[{"allFilteredFrames", "[", 
     RowBox[{"[", "frameID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLiquidMasksWithFilledCavities", "[", 
    RowBox[{"liquidMasks_", ",", "liquidCavities_", ",", "boundaryFrame_"}], 
    "]"}], ":=", 
   RowBox[{"Parallelize", "@", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorNegate", "@", 
        RowBox[{"If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#3", "\[LessEqual]", "boundaryFrame"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteSmallComponents", "[", 
             RowBox[{"#", ",", "liquidArtefactScale"}], "]"}], "&"}], "@", 
           "\[IndentingNewLine]", 
           RowBox[{"ColorNegate", "@", 
            RowBox[{"ImageSubtract", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}]}]}], ",", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"ColorNegate", "@", 
           RowBox[{"ImageSubtract", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "&"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"liquidMasks", ",", "liquidCavities", ",", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "liquidMasks"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "getLiquidMasksWithFilledChannels", "[", "liquidMaskFilledCavities_", 
     "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ImageDifference", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"DeleteSmallComponents", "[", 
                    RowBox[{"#", ",", "channelFillScale"}], "]"}], "&"}], "@",
                   "#"}], ",", "#"}], "\[IndentingNewLine]", "]"}], "&"}], 
              "@", "#"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "]"}], "&"}], "@", 
          RowBox[{"ColorNegate", "@", 
           RowBox[{"FillingTransform", "@", 
            RowBox[{"Closing", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"DiskMatrix", "@", "channelClosingScale"}]}], 
             "\[IndentingNewLine]", "]"}]}]}]}], "&"}], "@", 
        RowBox[{"ColorNegate", "@", "#"}]}], "&"}], "/@", 
      "liquidMaskFilledCavities"}], "//", "Parallelize"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLiquidChannels", "[", 
     RowBox[{"liquidMaskFilledCavities_", ",", "liquidMaskFilledChannels_"}], 
     "]"}], ":=", 
    RowBox[{"Parallelize", "@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DeleteSmallComponents", "[", 
           RowBox[{"#", ",", "channelSizeThreshold"}], "]"}], "&"}], "@", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageDifference", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"liquidMaskFilledCavities", ",", "liquidMaskFilledChannels"}],
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTopArtefacts", "[", "inpaintMask_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Closing", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "channelClosingScale"}]}], "]"}], "&"}],
         "@", "\[IndentingNewLine]", 
        RowBox[{"ImagePad", "[", 
         RowBox[{"#", ",", "paddingDirectionsArtifacts"}], "]"}]}], "&"}], 
      "@", "\[IndentingNewLine]", 
      RowBox[{"DeleteBorderComponents", "@", 
       RowBox[{"ImagePad", "[", 
        RowBox[{"#", ",", 
         RowBox[{"-", "paddingDirectionsArtifacts"}]}], "]"}]}]}], "&"}], "@",
     "inpaintMask"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSolidifcationFront", "[", 
    RowBox[{"liquidMask_", ",", "artefacts_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Thinning", "@", 
         RowBox[{"Binarize", "@", 
          RowBox[{"ImageAdjust", "@", "\[IndentingNewLine]", 
           RowBox[{"GaussianFilter", "[", 
            RowBox[{"#", ",", "frontSmoothingFactor"}], "]"}]}]}]}], "&"}], 
       "@", "\[IndentingNewLine]", 
       RowBox[{"EdgeDetect", "@", 
        RowBox[{"ImageAdd", "[", 
         RowBox[{"#", ",", "artefacts"}], "]"}]}]}], "&"}], "/@", 
     "liquidMask"}], "//", "Parallelize"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFrontHeightMap", "[", "solidificationFront_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "solidificationFront"}], ",", 
       "\[IndentingNewLine]", "frontNonzeroHeightBands", ",", 
       "frontZeroHeightBands"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frontNonzeroHeightBands", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Last", "@", "#"}], ",", "\[IndentingNewLine]", 
               RowBox[{"height", "-", 
                RowBox[{"First", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}],
              "&"}], "@", 
            RowBox[{
            "Transpose", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Last", "/@", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"SortBy", "[", 
                  RowBox[{"#", ",", "First"}], "]"}], "&"}], "/@", 
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"GatherBy", "[", 
                    RowBox[{"#", ",", "Last"}], "]"}], "&"}], "@", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{"#", ",", "Last"}], "]"}]}], "&"}], "@", 
                  RowBox[{"Position", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ImageData", "@", "#"}], ",", "1"}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 ")"}]}], "\[IndentingNewLine]", ")"}]}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "/@", "input"}], "//", 
        "Parallelize"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"frontZeroHeightBands", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0"}], "}"}], "&"}], "/@", 
          RowBox[{"Complement", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Range", "@", "width"}], ",", "\[IndentingNewLine]", 
            RowBox[{"First", "/@", "#"}]}], "\[IndentingNewLine]", "]"}]}], 
         "&"}], "/@", "frontNonzeroHeightBands"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{"#", ",", "First"}], "]"}], "&"}], "@", 
          RowBox[{"Catenate", "@", 
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}]}]}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"frontNonzeroHeightBands", ",", "frontZeroHeightBands"}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frontBuffer", "[", 
    RowBox[{"frameID_", ",", "frontBufferScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"liquidMaskFilledChannels", "[", 
          RowBox[{"[", "frameID", "]"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "&"}], "@", 
      RowBox[{"Dilation", "[", 
       RowBox[{"#", ",", 
        RowBox[{"DiskMatrix", "@", "frontBufferScale"}]}], "]"}]}], "&"}], 
    "@", 
    RowBox[{"solidificationFront", "[", 
     RowBox[{"[", "frameID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getConcentrationSamplingMask", "[", "imageID_", "]"}], ":=", 
   RowBox[{"ImageDifference", "@@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"frontBuffer", "[", 
        RowBox[{"imageID", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"frontBufferScaleHigh", ",", "frontBufferScaleLow"}], "}"}]}], 
     "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredConcentrationField", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"GaussianFilter", "[", 
            RowBox[{"#", ",", "liquidGaussianKernelScale"}], "]"}], "&"}], 
          "@", "\[IndentingNewLine]", 
          RowBox[{"NonlocalMeansFilter", "[", 
           RowBox[{"#", ",", "liquidNeighborhoodRadius"}], "]"}]}], "&"}], 
        "@", "\[IndentingNewLine]", 
        RowBox[{"BilateralFilter", "[", 
         RowBox[{
         "#", ",", "liquidBilateralValueSpread", ",", 
          "liquidBilateralKernelScale"}], "]"}]}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"MedianFilter", "[", 
       RowBox[{"#", ",", "liquidMedianRadius"}], "]"}]}], "&"}], "@", 
    "image"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inflateMask", "[", "image_", "]"}], ":=", 
   RowBox[{"ColorNegate", "@", 
    RowBox[{"Dilation", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ColorNegate", "@", "image"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DiskMatrix", "@", "maskInflation"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clusterColorize", "[", "clusters_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"levelsets", "=", "clusters"}], ",", "clusterRules"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"clusterColors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"colorSetID", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "@", "clusterCount"}]}], "//", "Reverse"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"clusterRules", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"clusterColors", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "@", "clusterCount"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Colorize", "[", 
       RowBox[{"levelsets", ",", 
        RowBox[{"ColorRules", "\[Rule]", "clusterRules"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getClusters", "[", "image_", "]"}], ":=", 
   RowBox[{"ClusteringComponents", "[", 
    RowBox[{"image", ",", "clusterCount", ",", 
     RowBox[{"Method", "\[Rule]", "clusteringMethod"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getDendriteGrainMasksAlternative", "[", 
   RowBox[{"dendriteSkeleton_", ",", "orientationBins_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inputBins", "=", "orientationBins"}], ",", 
      RowBox[{"inputSkeleton", "=", "dendriteSkeleton"}], ",", 
      "\[IndentingNewLine]", "orientationPeakColorRanges", ",", 
      "solidColorClusters", ",", "filteredSolidColorClusters", ",", 
      "dendriteGrainMasks", ",", "spectrumPeaks", ",", 
      "spectrumEdgePeakDistance", ",", "spectrumPeakEdgeProximity"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orientationPeakColorRanges", "=", 
      RowBox[{"getOrientationPeakColorRanges", "@", "inputBins"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orientationPeakColorRanges", "//", "TableForm"}], "//", 
      "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"spectrumPeaks", "=", 
      RowBox[{"First", "/@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"inputBins", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
             RowBox[{"First", "/@", 
              RowBox[{"FindPeaks", "[", "\[IndentingNewLine]", 
               RowBox[{
               "#", ",", "Automatic", ",", "orientationPeakSharpness", ",", 
                "orientationPeakThreshold"}], "\[IndentingNewLine]", 
               "]"}]}]}], "&"}], "@", 
           RowBox[{"Last", "@", 
            RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "@", "inputBins"}], 
        "\[IndentingNewLine]", ")"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"spectrumEdgePeakDistance", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "spectrumPeaks"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Subtract", "@@", 
           RowBox[{"Abs", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", 
              RowBox[{"Last", "@", "#"}]}], "}"}]}]}], "&"}], "@", 
         "spectrumPeaks"}], ",", "\[IndentingNewLine]", 
        RowBox[{"2", "*", "criticalSpectrumEdgePeakDistance"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"spectrumPeakEdgeProximity", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "spectrumPeaks"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"90", "-", 
          RowBox[{"Abs", "@", "spectrumPeaks"}]}], "//", "Min"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"2", "*", "criticalSpectrumEdgePeakDistance"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"solidColorClusters", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "spectrumEdgePeakDistance", "\[LessEqual]", 
            "criticalSpectrumEdgePeakDistance"}], "&&", "\[IndentingNewLine]", 
           RowBox[{
           "spectrumPeakEdgeProximity", "\[LessEqual]", 
            "criticalSpectrumEdgePeakDistance"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ImageAdd", "[", 
                RowBox[{
                 RowBox[{"First", "@", "#"}], ",", 
                 RowBox[{"Last", "@", "#"}]}], "]"}], "&"}], "@", "#"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Delete", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "#"}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorDetect", "[", 
           RowBox[{"inputSkeleton", ",", "#"}], "]"}], "&"}], "/@", 
         "orientationPeakColorRanges"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Dendrite clusters: \>\"", "<>", 
       RowBox[{"ToString", "@", 
        RowBox[{"Length", "@", "solidColorClusters"}]}]}], "//", "Print"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"filteredSolidColorClusters", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Binarize", "[", 
         RowBox[{"#", ",", "colorMatchThreshold"}], "]"}], "&"}], "/@", 
       "solidColorClusters"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dendriteGrainMasks", "=", 
      RowBox[{"getGrainMasks", "/@", "filteredSolidColorClusters"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"inputSkeleton", ",", "\[IndentingNewLine]", 
           RowBox[{"solidColorClusters", "[", 
            RowBox[{"[", "previewID", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"filteredSolidColorClusters", "[", 
            RowBox[{"[", "previewID", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ImageCollage", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"ImagePadding", "\[Rule]", "10"}]}], "]"}], "&"}], 
              "@", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"#", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Binarize", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
                  "inputSkeleton"}], "}"}], ",", "\[IndentingNewLine]", "#"}],
                "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Last", "/@", 
                 RowBox[{"ComponentMeasurements", "[", 
                  RowBox[{"#", ",", "\"\<MaskedImage\>\""}], "]"}]}], "&"}], "/@", 
               RowBox[{"dendriteGrainMasks", "[", 
                RowBox[{"[", "previewID", "]"}], "]"}]}], "//", "Flatten"}], 
             "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "10"}]}], "\[IndentingNewLine]", "]"}],
       "//", "Print"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "dendriteGrainMasks"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8381890059119296`*^9, {3.8381893677521863`*^9, 3.8381893696496534`*^9}, {
   3.838189457199703*^9, 3.838189457584342*^9}, {3.8382126360472965`*^9, 
   3.8382126363285446`*^9}, {3.8382149489599414`*^9, 
   3.8382149492401924`*^9}, {3.838293176831523*^9, 3.8382931784701414`*^9}, {
   3.8391485552078114`*^9, 3.839148556895608*^9}, 3.839148672008988*^9, {
   3.839149255616995*^9, 3.839149259809787*^9}, {3.842955724667177*^9, 
   3.8429558004029775`*^9}, {3.842955841163106*^9, 3.8429558419005594`*^9}, 
   3.84295587762633*^9, {3.843304653089132*^9, 3.8433046561598926`*^9}, {
   3.8433048180942583`*^9, 3.8433048242616744`*^9}, {3.8433055032045217`*^9, 
   3.8433055042237835`*^9}, {3.8434800790645485`*^9, 
   3.8434800798615627`*^9}, {3.8434808011695547`*^9, 3.843480801723075*^9}, {
   3.8458162682218466`*^9, 3.8458162686108065`*^9}, {3.8466704748407636`*^9, 
   3.846670475504183*^9}, {3.8467523367189393`*^9, 3.8467523374546785`*^9}, {
   3.846752387230635*^9, 3.8467523881428027`*^9}, {3.846769318722342*^9, 
   3.8467693208825655`*^9}, {3.8467694299469147`*^9, 3.846769431114791*^9}, {
   3.846829503023484*^9, 3.8468295219189806`*^9}, {3.846829714132536*^9, 
   3.8468297147769403`*^9}, 3.846829770476872*^9, {3.8468367343621416`*^9, 
   3.846836740433859*^9}, {3.8468368184982905`*^9, 3.846836818986068*^9}, {
   3.8468376554587145`*^9, 3.846837660004117*^9}, {3.8468382162411404`*^9, 
   3.8468382198736067`*^9}, {3.8468382731475267`*^9, 
   3.8468383406590633`*^9}, {3.846838396428229*^9, 3.8468384008191967`*^9}, {
   3.8468472200165663`*^9, 3.846847221363595*^9}, {3.8468478649999065`*^9, 
   3.8468478670945644`*^9}, {3.8468491478061705`*^9, 
   3.8468491502317123`*^9}, {3.846849808653754*^9, 3.846849809929842*^9}, {
   3.8468499445745735`*^9, 3.84684994788789*^9}, {3.847444433002282*^9, 
   3.8474444341113186`*^9}, {3.8479565550591283`*^9, 3.8479565561243076`*^9}, 
   3.8479584002362967`*^9, 3.847958889635376*^9, 3.8479589355907516`*^9, 
   3.8479593282027287`*^9, 3.847961680799029*^9, {3.8480390910382395`*^9, 
   3.848039092217394*^9}, {3.8480394826619787`*^9, 3.8480394834092846`*^9}, {
   3.848040227238947*^9, 3.848040233605711*^9}, {3.8480432756919456`*^9, 
   3.8480432763426332`*^9}, {3.8480433387886744`*^9, 
   3.8480433395105877`*^9}, {3.854635135575929*^9, 3.854635143063056*^9}, {
   3.8546353048539505`*^9, 3.854635310385127*^9}, {3.8546361587395926`*^9, 
   3.8546361589820004`*^9}, {3.854723029087531*^9, 3.8547230380861025`*^9}, {
   3.8547230952710233`*^9, 3.8547230963273664`*^9}, {3.854811196436452*^9, 
   3.854811215124194*^9}, {3.8548228668299527`*^9, 3.854822867515088*^9}, 
   3.854823793720137*^9, 3.8606963696633587`*^9, {3.8615985970465927`*^9, 
   3.861598599006845*^9}, {3.861600132373684*^9, 3.8616001370973067`*^9}, {
   3.861724596314806*^9, 3.861724601881921*^9}, 3.8617762678673763`*^9, {
   3.8617791439652243`*^9, 3.8617791454780593`*^9}, 3.86178725989005*^9, 
   3.8617915019514894`*^9, {3.861791540787301*^9, 3.8617915553660483`*^9}, {
   3.8618777597683935`*^9, 3.8618778246299534`*^9}, 3.8623832640750103`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"26de3251-6e55-4209-95d2-c201d3f43658"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Processing ", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, 
   3.8382140851103477`*^9},ExpressionUUID->"ca0d425a-2a02-48db-a81a-\
d2184c3ee937"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getOrientations", "[", "skeleton_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", "/", "\[Pi]"}], ")"}], "*", 
      RowBox[{"ArcTan", "/@", 
       RowBox[{"Tan", "/@", 
        RowBox[{"Last", "/@", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"skeleton", ",", 
           RowBox[{"{", "\"\<Orientation\>\"", "}"}]}], "]"}]}]}]}]}], "/.", 
     RowBox[{"Rule", "\[Rule]", "List"}]}], "//", "Flatten"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorValues", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"#", ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"N", "@", 
           RowBox[{"Rescale", "@", "#"}]}]}], "\[IndentingNewLine]", 
         "}"}]}]}], "&"}], "@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "90"}], ",", "90", ",", "1"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getOrientationColors", "[", "skeleton_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "skeleton"}], ",", "\[IndentingNewLine]", 
       "partitionLines", ",", "partitionOrientations", ",", 
       "partitionOrientationColors"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partitionLines", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Image", "/@", 
          RowBox[{"Last", "/@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}]}]}], "&"}], "@", 
        "input"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"partitionLines", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Binarize", "[", 
         RowBox[{"input", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"partitionOrientations", "=", 
          RowBox[{"getOrientations", "@", "input"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"partitionOrientationColors", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Blend", "[", 
             RowBox[{"colorPalette", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"colorValues", "/@", "partitionOrientations"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ImageAdd", "@", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorReplace", "[", 
              RowBox[{"#1", ",", 
               RowBox[{"White", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"partitionLines", ",", "partitionOrientationColors"}], 
             "}"}]}], "\[IndentingNewLine]", "]"}]}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPeakColorValues", "[", "angleBins_", "]"}], ":=", 
   RowBox[{"colorValues", "/@", 
    RowBox[{"First", "/@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"angleBins", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"First", "/@", 
            RowBox[{"FindPeaks", "[", "\[IndentingNewLine]", 
             RowBox[{
             "#", ",", "Automatic", ",", "orientationPeakSharpness", ",", 
              "orientationPeakThreshold"}], "\[IndentingNewLine]", "]"}]}]}], 
          "&"}], "@", 
         RowBox[{"Last", "@", 
          RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "@", "angleBins"}], 
      "\[IndentingNewLine]", ")"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getOrientationPeakColorRanges", "[", "orientationBins_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "orientationBins"}], ",", "\[IndentingNewLine]", 
       "peakValues", ",", "peakDistanceMatrix", ",", 
       "criticalPeakProximityMap", ",", "overlappingPeaks", ",", 
       "getOverlappingPeakGroups", ",", "resolvedPeakOverlaps", ",", 
       "redundantPeaks", ",", "resolvedPeakColors"}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"peakValues", "=", 
       RowBox[{"getPeakColorValues", "@", "input"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"peakDistanceMatrix", "=", 
       RowBox[{"DistanceMatrix", "[", "\[IndentingNewLine]", 
        RowBox[{"peakValues", ",", "\[IndentingNewLine]", 
         RowBox[{"DistanceFunction", "\[Rule]", "EuclideanDistance"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"criticalPeakProximityMap", "=", 
       RowBox[{"Map", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "<", 
           RowBox[{"criticalDistanceFactor", "*", "colorSpaceWindow"}]}], 
          "&"}], ",", "\[IndentingNewLine]", "peakDistanceMatrix", ",", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\n", 
      RowBox[{"overlappingPeaks", "=", 
       RowBox[{
        RowBox[{"Sort", "/@", 
         RowBox[{"Last", "@", 
          RowBox[{
          "GatherBy", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Position", "[", "\[IndentingNewLine]", 
             RowBox[{
             "criticalPeakProximityMap", ",", "\[IndentingNewLine]", "True"}],
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{"Union", "@", "#"}]}], "&"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "//", "DeleteDuplicates"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"getOverlappingPeakGroups", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"peakValues", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "overlappingPeaks"}]}],
       ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"resolvedPeakOverlaps", "=", 
       RowBox[{"Mean", "/@", "getOverlappingPeakGroups"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"redundantPeaks", "=", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"getOverlappingPeakGroups", ",", "1"}], "]"}]}]}], ";", "\n",
       "\[IndentingNewLine]", 
      RowBox[{"resolvedPeakColors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{"colorPalette", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"resolvedPeakOverlaps", ",", "\[IndentingNewLine]", 
          RowBox[{"Complement", "[", 
           RowBox[{"peakValues", ",", "redundantPeaks"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorsNear", "[", 
         RowBox[{"#", ",", "colorSpaceWindow"}], "]"}], "&"}], "/@", 
       "resolvedPeakColors"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredOrientations", "[", 
    RowBox[{"orientations_", ",", "limiters_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", "limiters"}], "<", "#", "<", 
         RowBox[{"Last", "@", "limiters"}]}], "&"}]}], "\[IndentingNewLine]", 
      "]"}], "&"}], "@", "orientations"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredMILseries", "[", "dataset_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", "totalVariationWeight", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MaxIterations", "\[Rule]", "totalVariationIterations"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "dataset"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOrientationsLengths", "[", "dataset_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"180", "/", "Pi"}], ")"}], "*", 
         RowBox[{"ArcTan", "@", 
          RowBox[{"Tan", "@", 
           RowBox[{"First", "@", "#"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "}"}], "&"}], "/@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Last", "/@", 
        RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
         RowBox[{"dataset", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Orientation\>\"", ",", "\"\<Count\>\""}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "/.", 
       RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", 
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOrientationBinFlags", "[", 
     RowBox[{"dataset_", ",", "binCount_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "@", "#"}], "-", "1"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"First", "@", 
        RowBox[{"N", "@", 
         RowBox[{"HistogramList", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "binCount"}], "\[IndentingNewLine]", "]"}]}]}]}], 
      "&"}], "@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"First", "/@", "dataset"}], "\[IndentingNewLine]", ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOrientationBinWeights", "[", 
     RowBox[{"dataset_", ",", "binFlags_"}], "]"}], ":=", 
    RowBox[{"Parallelize", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Total", "@", 
            RowBox[{"Last", "@", 
             RowBox[{"Transpose", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
           "0"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"dataset", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Between", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "@", "#"}], ",", 
                 RowBox[{
                  RowBox[{"Last", "@", "#"}], "-", "0.001"}]}], "}"}], "&"}], 
              "@", 
              RowBox[{"binFlags", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "binFlags"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getOrientationBinsWithWeights", "[", 
    RowBox[{"skeleton_", ",", "binCount_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "orientationAndCount", ",", "orientationBinFlags", ",", 
       "orientationBinWeights", ",", "\[IndentingNewLine]", 
       RowBox[{"input", "=", "skeleton"}], ",", 
       RowBox[{"bins", "=", "binCount"}]}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orientationAndCount", "=", 
       RowBox[{"getOrientationsLengths", "@", "input"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"orientationBinFlags", "=", 
       RowBox[{"getOrientationBinFlags", "[", 
        RowBox[{"orientationAndCount", ",", "bins"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"orientationBinWeights", "=", 
       RowBox[{"getOrientationBinWeights", "[", 
        RowBox[{"orientationAndCount", ",", "orientationBinFlags"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mean", "/@", "orientationBinFlags"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"N", "@", 
          RowBox[{"Rescale", "@", "orientationBinWeights"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOrientationLimiters", "[", "meansDeviations_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "@", "#"}], "-", 
         RowBox[{"deviationScale", "*", 
          RowBox[{"Last", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", "#"}], "+", 
         RowBox[{"deviationScale", "*", 
          RowBox[{"Last", "@", "#"}]}]}]}], "\[IndentingNewLine]", "}"}], 
      "&"}], "@", "meansDeviations"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFalseDendriteIndices", "[", "dendriteStats_", "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Position", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"dendriteStats", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"Between", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"dendriteOrientationLimiters", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "dendriteOrientationLimiters"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getStatisticallyFilteredDendrites", "[", "dendriteMasks_", "]"}], 
   ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Image", "@", 
        RowBox[{"Total", "@", 
         RowBox[{"Delete", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{"falseDendriteIndices", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "&"}], "@", 
      RowBox[{"dendriteMasks", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "falseDendriteIndices"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getOrientationsWithWeights", "[", "orientationsLenghts_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "@", "#"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/", 
              RowBox[{"Total", "@", "#"}]}], ")"}], "&"}], "@", 
           RowBox[{"Last", "@", "#"}]}]}], "}"}]}], "&"}], "@", 
      RowBox[{"Transpose", "@", "#"}]}], "&"}], "@", 
    "orientationsLenghts"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getMeanSDeviationsWeighed", "[", "orientationsWeights_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "@", "#"}], ",", 
         RowBox[{"StandardDeviation", "@", "#"}]}], "}"}], "&"}], "@", 
      RowBox[{"(", 
       RowBox[{"WeightedData", "@@", "#"}], ")"}]}], "&"}], "@", 
    "orientationsWeights"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFilteredDendriteGrains", "[", "finalGrains_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "finalGrains"}], ",", "\[IndentingNewLine]", 
       "dendriteBinaryMasks", ",", "dendriteOrientationsLengths", ",", 
       "orientationsWithWeights", ",", "dendriteMeanDeviationsWeighed"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dendriteBinaryMasks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "/@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}]}], "&"}], "/@", 
        "input"}]}], ";", "\n", "\n", 
      RowBox[{"dendriteOrientationsLengths", "=", 
       RowBox[{"getOrientationsLengths", "/@", "input"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"orientationsWithWeights", "=", 
       RowBox[{
       "getOrientationsWithWeights", "/@", "dendriteOrientationsLengths"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"dendriteMeanDeviationsWeighed", "=", 
       RowBox[{
       "getMeanSDeviationsWeighed", "/@", "orientationsWithWeights"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dendriteOrientationLimiters", "=", 
       RowBox[{
       "getOrientationLimiters", "/@", "dendriteMeanDeviationsWeighed"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"falseDendriteIndices", "=", 
       RowBox[{
       "getFalseDendriteIndices", "@", "dendriteOrientationsLengths"}]}], ";",
       "\[IndentingNewLine]", "\n", 
      RowBox[{
      "getStatisticallyFilteredDendrites", "@", "dendriteBinaryMasks"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGrainStats", "[", "grains_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "grains"}], ",", "\[IndentingNewLine]", 
       "grainDendriteOrientationsLengths", ",", 
       "grainDendriteOrientationsWithWeights", ",", 
       "grainOrientationMeansDeviations", ",", "solidArea", ",", 
       "grainAreasRelative"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grainDendriteOrientationsLengths", "=", 
       RowBox[{"getOrientationsLengths", "/@", "input"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"grainDendriteOrientationsWithWeights", "=", 
       RowBox[{
       "getOrientationsWithWeights", "/@", 
        "grainDendriteOrientationsLengths"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"grainOrientationMeansDeviations", "=", 
       RowBox[{
        RowBox[{
        "getMeanSDeviationsWeighed", "/@", 
         "grainDendriteOrientationsWithWeights"}], "//", "Transpose"}]}], ";",
       "\[IndentingNewLine]", "\n", 
      RowBox[{"solidArea", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Area\>\""}], "]"}]}], "&"}], "@", 
         RowBox[{"ColorNegate", "@", "testLiquidMask"}]}], "//", "Total"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      RowBox[{"grainAreasRelative", "=", 
       RowBox[{"100", "*", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "/@", 
               RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
                RowBox[{"#", ",", "\"\<Area\>\"", ",", 
                 RowBox[{
                  RowBox[{"#Area", ">", "grainAreaThreshold"}], "&"}]}], 
                "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
             RowBox[{"FillingTransform", "/@", "finalGrainMasks"}]}], 
            "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}], "/",
          "solidArea"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"97", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "input"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "grainAreasRelative", "}"}], ",", 
          "\[IndentingNewLine]", "grainOrientationMeansDeviations"}], "}"}], 
        "\[IndentingNewLine]", "]"}], "//", "Transpose"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getSmoothOrientationBins", "[", "dataset_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", "#"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MeanFilter", "[", 
              RowBox[{"#", ",", "binAveragingRadius"}], "]"}], "&"}], "@", 
            "\[IndentingNewLine]", 
            RowBox[{"TotalVariationFilter", "[", 
             RowBox[{"#", ",", "binRegularization"}], "]"}]}], "&"}], "@", 
          RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}], "&"}],
       "@", 
      RowBox[{"Transpose", "@", "dataset"}]}], "//", "Transpose"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getFrontHeightMetrics", "[", 
     RowBox[{"frontValues_", ",", "metric_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"N", "@", 
       RowBox[{"metric", "[", "\[IndentingNewLine]", 
        RowBox[{"Last", "/@", "#"}], "\[IndentingNewLine]", "]"}]}], "&"}], "/@",
      "frontValues"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFrontHeightMeansDeviations", "[", "heightMap_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Around", "@@", "#"}], "&"}], "/@", 
     RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"getFrontHeightMetrics", "[", 
         RowBox[{"heightMap", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"Mean", ",", "StandardDeviation"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], "//", "N"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeMatrixOutliers", "[", 
    RowBox[{
    "inputMatrix_", ",", "outlierThresholdFactor_", ",", 
     "medianScanRadius_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "inputMatrix"}], ",", 
       RowBox[{"threshold", "=", "outlierThresholdFactor"}], ",", 
       RowBox[{"radius", "=", "medianScanRadius"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "getScanNeigbors", ",", 
       "getNeigborhoodMedian", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "matrixHeight", ",", "matrixWidth", ",", 
       "rescaledAbsMatrix", ",", "thresholdDisplacementValue", ",", 
       "\[IndentingNewLine]", "outlierMask", ",", "outlierPositions", ",", 
       "medianScanIndices", ",", "outlierReplacements", ",", 
       "replacementRules"}], "\[IndentingNewLine]", "}"}], ",", "\n", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getScanNeigbors", "[", "outlierPosition_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "@", "#"}], "\[LessEqual]", "matrixWidth"}], "&&", 
             RowBox[{
              RowBox[{"Last", "@", "#"}], "\[LessEqual]", "matrixHeight"}]}], 
            "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Select", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"And", "@@", 
                RowBox[{"Positive", "@", "#"}]}], "&"}], 
              "\[IndentingNewLine]", "]"}], "@", 
             RowBox[{"(", 
              RowBox[{"outlierPosition", "+", "#"}], ")"}]}], "&"}], "/@", 
           "medianScanIndices"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"getNeigborhoodMedian", "[", 
        RowBox[{"matrix_", ",", "outlierPositions_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"PixelValue", "[", 
           RowBox[{"matrix", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"getScanNeigbors", "@", "outlierPositions"}], 
          "\[IndentingNewLine]", ")"}]}], "//", "Median"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"matrixHeight", ",", "matrixWidth"}], "}"}], "=", 
       RowBox[{"Dimensions", "@", "input"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"rescaledAbsMatrix", "=", 
       RowBox[{"Rescale", "@", 
        RowBox[{"Abs", "@", "input"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"thresholdDisplacementValue", "=", 
       RowBox[{"threshold", "*", 
        RowBox[{"Median", "@", 
         RowBox[{"Flatten", "@", "rescaledAbsMatrix"}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "@", 
       RowBox[{"TableForm", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Median", "@", 
           RowBox[{"Flatten", "@", "rescaledAbsMatrix"}]}], ",", 
          "\[IndentingNewLine]", "thresholdDisplacementValue"}], 
         "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outlierMask", "=", 
       RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Image", "@", "rescaledAbsMatrix"}], ",", 
         "\[IndentingNewLine]", "thresholdDisplacementValue"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outlierPositions", "=", 
       RowBox[{"PixelValuePositions", "[", "\[IndentingNewLine]", 
        RowBox[{"outlierMask", ",", "1"}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"medianScanIndices", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"ManhattanDistance", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[LessEqual]", 
               "radius"}], "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "&"}], "@", 
        "\[IndentingNewLine]", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "#"}], ",", "#", ",", "1"}], "]"}], "&"}], "@", 
           "radius"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outlierReplacements", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getNeigborhoodMedian", "[", 
           RowBox[{
            RowBox[{"Image", "@", "input"}], ",", "#"}], "]"}], "&"}], "/@", 
         "outlierPositions"}], "//", "Parallelize"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementRules", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"outlierPositions", ",", "outlierReplacements"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ImageData", "@", 
         RowBox[{"ReplacePixelValue", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Image", "@", "#"}], ",", "replacementRules"}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], "@", "input"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"multiStageOutlierRemoval", "[", 
    RowBox[{"matrix_", ",", "parameterSet_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputMatrix", "=", "matrix"}], ",", 
       RowBox[{"filterParameters", "=", "parameterSet"}], ",", 
       "\[IndentingNewLine]", "stages", ",", "stageCounter", ",", 
       "targetMatrix"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stages", "=", 
       RowBox[{"Length", "@", "parameterSet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stageCounter", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"targetMatrix", "=", "matrix"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stageCounter", "\[LessEqual]", 
         RowBox[{"Length", "@", "parameterSet"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"targetMatrix", "=", 
          RowBox[{"removeMatrixOutliers", "@@", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "targetMatrix", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"filterParameters", "[", 
              RowBox[{"[", "stageCounter", "]"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"stageCounter", "++"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "targetMatrix"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFrontDisplacements", "[", "frontHeightMap_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Range", "@", "width"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"Reverse", "[", "\[IndentingNewLine]", 
           RowBox[{"Last", "/@", 
            RowBox[{"Transpose", "/@", "#"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
      "&"}], "/@", 
     RowBox[{"Partition", "[", 
      RowBox[{"frontHeightMap", ",", "2", ",", "1"}], "]"}]}], "//", "N"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getTrueDisplacementRange", "[", 
    RowBox[{"cleanMatrix_", ",", "formattedMatrix_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputClean", "=", "cleanMatrix"}], ",", 
       RowBox[{"inputFormatted", "=", "formattedMatrix"}], ",", 
       "\[IndentingNewLine]", "unscaledDisplacementRange", ",", 
       "rescaledToTrueDisplacementRange"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"unscaledDisplacementRange", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"BilateralFilter", "[", 
              RowBox[{
              "#", ",", "bilateralValueSpread", ",", "bilateralKernelScale"}],
               "]"}], "&"}], "@", "\[IndentingNewLine]", 
            RowBox[{"Image", "@", "inputClean"}]}], ")"}]}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"Min", ",", "Max"}], "}"}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"rescaledToTrueDisplacementRange", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Rescale", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "inputFormatted"}], "-", "1"}], ",", 
          "unscaledDisplacementRange"}], "\[IndentingNewLine]", "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sign", "@", "unscaledDisplacementRange"}], "*", 
       RowBox[{"Max", "@", 
        RowBox[{"Abs", "@", "unscaledDisplacementRange"}]}], "*", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "@", "#"}], ",", 
             RowBox[{"Max", "@", "#"}]}], "}"}], "/", 
           RowBox[{"Max", "@", "#"}]}], "&"}], "@", 
         "rescaledToTrueDisplacementRange"}], "\[IndentingNewLine]", 
        ")"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getConcentrationBins", "[", "samplingZone_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], "&"}], "@", 
       RowBox[{"ImageValue", "[", 
        RowBox[{"samplingZone", ",", 
         RowBox[{"{", 
          RowBox[{"#", ",", "All"}], "}"}]}], "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "@", "width"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGrainBinCounts", "[", 
    RowBox[{
    "baseBinCount_", ",", "minimumBinCount_", ",", "binCountFactor_", ",", 
     "grainAreaScaleFactors_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "\[Rule]", "minimumBinCount"}], ")"}], "&"}], "/@", 
        "\[IndentingNewLine]", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "<", "minimumBinCount"}], "&"}], ")"}]}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"Round", "[", 
     RowBox[{
     "binCountFactor", "*", "grainAreaScaleFactors", "*", "baseBinCount"}], 
     "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "getFilteredDendriteGrainsNearVertical", "[", "suspectGrains_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "suspectGrains"}], ",", "\[IndentingNewLine]", 
       "dendriteBinaryMasks", ",", "dendriteOrientationsLengths", ",", 
       "orientationsWithWeights", ",", "dendriteMeanDeviationsWeighed"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dendriteBinaryMasks", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "/@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}]}], "&"}], "/@", 
        "input"}]}], ";", "\n", "\n", 
      RowBox[{"dendriteOrientationsLengths", "=", 
       RowBox[{"Abs", "/@", 
        RowBox[{"getOrientationsLengths", "/@", "input"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"orientationsWithWeights", "=", 
       RowBox[{
       "getOrientationsWithWeights", "/@", "dendriteOrientationsLengths"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"dendriteMeanDeviationsWeighed", "=", 
       RowBox[{
       "getMeanSDeviationsWeighed", "/@", "orientationsWithWeights"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dendriteOrientationLimiters", "=", 
       RowBox[{
       "getOrientationLimiters", "/@", "dendriteMeanDeviationsWeighed"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"falseDendriteIndices", "=", 
       RowBox[{
       "getFalseDendriteIndices", "@", "dendriteOrientationsLengths"}]}], ";",
       "\[IndentingNewLine]", "\n", 
      RowBox[{
      "getStatisticallyFilteredDendrites", "@", "dendriteBinaryMasks"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"resolveNearVerticalDendriteGrains", "[", "grainMasks_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputMasks", "=", "grainMasks"}], ",", "\[IndentingNewLine]", 
       "newOrientationsLengths", ",", "newOrientationsWeights", ",", 
       "newOrientationMeansDeviations", ",", "correctedDendriteGrains"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newOrientationsLengths", "=", 
       RowBox[{"getOrientationsLengths", "/@", "inputMasks"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"newOrientationsWeights", "=", 
       RowBox[{
       "getOrientationsWithWeights", "/@", "newOrientationsLengths"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"newOrientationMeansDeviations", "=", 
       RowBox[{
       "getMeanSDeviationsWeighed", "/@", "newOrientationsWeights"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"suspectSplitOrientationDendrites", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Intersection", "@@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "/@", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Position", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"Transpose", "@", "#"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", ">", "deviationThreshold"}], "&"}], ")"}]}]}],
                "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Position", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Divide", "@@", "#"}], "&"}], "/@", 
                 RowBox[{"Reverse", "/@", 
                  RowBox[{"Abs", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", ">", "deviationToMeanRatioThreshold"}], "&"}],
                   ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ")"}]}], 
         "&"}], "@", "newOrientationMeansDeviations"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"correctedDendriteGrains", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"getFilteredDendriteGrainsNearVertical", "@", 
          RowBox[{"inputMasks", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "@", 
        "suspectSplitOrientationDendrites"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
       RowBox[{"inputMasks", ",", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#1", "\[Rule]", "#2"}], ")"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "suspectSplitOrientationDendrites", ",", 
            "correctedDendriteGrains"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getGrainStatsAdaptive", "[", "grainDendrites_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "grainDendrites"}], ",", "\[IndentingNewLine]", 
       "grainDendriteOrientationsLengths", ",", 
       "grainDendriteOrientationsWithWeights", ",", 
       "grainOrientationMeansDeviations", ",", "solidArea", ",", 
       "grainAreasRelative"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grainDendriteOrientationsLengths", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ContainsAny", "[", 
            RowBox[{"suspectSplitOrientationDendrites", ",", 
             RowBox[{"{", "#", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Abs", "@", 
            RowBox[{"getOrientationsLengths", "@", 
             RowBox[{"input", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"getOrientationsLengths", "@", 
            RowBox[{"input", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
          "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "input"}]}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"grainDendriteOrientationsWithWeights", "=", 
       RowBox[{
       "getOrientationsWithWeights", "/@", 
        "grainDendriteOrientationsLengths"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"grainOrientationMeansDeviations", "=", 
       RowBox[{
        RowBox[{
        "getMeanSDeviationsWeighed", "/@", 
         "grainDendriteOrientationsWithWeights"}], "//", "Transpose"}]}], ";",
       "\[IndentingNewLine]", "\n", 
      RowBox[{"solidArea", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Last", "/@", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{"#", ",", "\"\<Area\>\""}], "]"}]}], "&"}], "@", 
         RowBox[{"ColorNegate", "@", "testLiquidMask"}]}], "//", "Total"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      RowBox[{"grainAreasRelative", "=", 
       RowBox[{"100", "*", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"Total", "/@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "/@", 
               RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
                RowBox[{"#", ",", "\"\<Area\>\"", ",", 
                 RowBox[{
                  RowBox[{"#Area", ">", "grainAreaThreshold"}], "&"}]}], 
                "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
             "grainAreaMasks"}], "\[IndentingNewLine]", ")"}]}], 
          "\[IndentingNewLine]", "]"}], "/", "solidArea"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", 
              RowBox[{"97", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "input"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "grainAreasRelative", "}"}], ",", 
          "\[IndentingNewLine]", "grainOrientationMeansDeviations"}], "}"}], 
        "\[IndentingNewLine]", "]"}], "//", "Transpose"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getOrientationBinsWithWeightsAdaptive", "[", 
   RowBox[{"skeleton_", ",", "binCount_", ",", "skeletonID_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "orientationAndCount", ",", "orientationBinFlags", ",", 
      "orientationBinWeights", ",", "\[IndentingNewLine]", 
      RowBox[{"input", "=", "skeleton"}], ",", 
      RowBox[{"bins", "=", "binCount"}], ",", 
      RowBox[{"inputID", "=", "skeletonID"}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orientationAndCount", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ContainsAny", "[", 
         RowBox[{"suspectSplitOrientationDendrites", ",", 
          RowBox[{"{", "inputID", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Abs", "@", 
         RowBox[{"getOrientationsLengths", "@", "input"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"getOrientationsLengths", "@", "input"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"orientationBinFlags", "=", 
      RowBox[{"getOrientationBinFlags", "[", 
       RowBox[{"orientationAndCount", ",", "bins"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orientationBinWeights", "=", 
      RowBox[{"getOrientationBinWeights", "[", 
       RowBox[{"orientationAndCount", ",", "orientationBinFlags"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mean", "/@", "orientationBinFlags"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"N", "@", 
         RowBox[{"Rescale", "@", "orientationBinWeights"}]}]}], 
       "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816685025014761*^9, 3.816685121824583*^9}, 
   3.8166851702611666`*^9, {3.8166853319319143`*^9, 3.8166853570017614`*^9}, {
   3.8166853921288576`*^9, 3.8166854430994287`*^9}, 3.8172933692699223`*^9, 
   3.8215213526898475`*^9, {3.8215219225755024`*^9, 3.821521924970554*^9}, {
   3.8215229316665196`*^9, 3.821522945393096*^9}, {3.821522980951149*^9, 
   3.8215229979667287`*^9}, {3.8215230467223215`*^9, 
   3.8215230604803877`*^9}, {3.8216285722586937`*^9, 
   3.8216285725139947`*^9}, {3.821628929343667*^9, 3.821628965792157*^9}, {
   3.8216290306326895`*^9, 3.8216292710985947`*^9}, {3.8216293014025493`*^9, 
   3.82162930963951*^9}, {3.821629370877658*^9, 3.821629377081064*^9}, {
   3.8216300310778837`*^9, 3.821630031732127*^9}, {3.8216383543553753`*^9, 
   3.8216383590896854`*^9}, {3.8216389284082756`*^9, 
   3.8216389842724094`*^9}, {3.821639232759909*^9, 3.8216392344633527`*^9}, {
   3.821639307842224*^9, 3.821639308720874*^9}, {3.821639585663513*^9, 
   3.821639599374831*^9}, {3.8216396491287265`*^9, 3.8216396501190767`*^9}, {
   3.8216429790351295`*^9, 3.8216429909672303`*^9}, {3.8374402327092*^9, 
   3.837440248492099*^9}, {3.83744424832545*^9, 3.8374442495444384`*^9}, {
   3.838186973248103*^9, 3.8381870424399757`*^9}, {3.838187423689406*^9, 
   3.838187441344855*^9}, {3.8381889975548377`*^9, 3.838189026392866*^9}, {
   3.838189332176097*^9, 3.838189337056424*^9}, {3.83818939578568*^9, 
   3.838189397793891*^9}, {3.8381897288247213`*^9, 3.838189749417483*^9}, {
   3.8382138820253506`*^9, 3.8382138841995373`*^9}, {3.838214072640682*^9, 
   3.8382141392226744`*^9}, {3.8382153711753535`*^9, 3.838215376439974*^9}, 
   3.8387032384222097`*^9, {3.838703732473629*^9, 3.8387037369775667`*^9}, {
   3.8428548039237576`*^9, 3.842854934305986*^9}, {3.842860282742243*^9, 
   3.8428602829875865`*^9}, {3.842870228415135*^9, 3.8428702291701164`*^9}, {
   3.842870267846715*^9, 3.8428702742944756`*^9}, {3.8429556294353204`*^9, 
   3.8429556394117627`*^9}, 3.8429557446139927`*^9, {3.8429558134350357`*^9, 
   3.8429558351643076`*^9}, {3.843042091380003*^9, 3.843042092644679*^9}, {
   3.8466805217818155`*^9, 3.8466805561470957`*^9}, {3.8466817589565873`*^9, 
   3.846681760002698*^9}, {3.846830318068039*^9, 3.8468303227811403`*^9}, {
   3.846836794250393*^9, 3.846836795673586*^9}, {3.8468388032090836`*^9, 
   3.8468388042609167`*^9}, {3.846850990461435*^9, 3.846850991216034*^9}, {
   3.846851762069357*^9, 3.8468517629910154`*^9}, {3.8468570654987984`*^9, 
   3.846857066510357*^9}, {3.847176357203411*^9, 3.847176365642843*^9}, {
   3.847181268905512*^9, 3.847181280689003*^9}, 3.8479584078119354`*^9, {
   3.8480397232691083`*^9, 3.848039727605297*^9}, {3.8480399095730343`*^9, 
   3.8480399149990773`*^9}, {3.8480400878616786`*^9, 
   3.8480400888955398`*^9}, {3.848040138181182*^9, 3.8480401392481413`*^9}, {
   3.8480403111972227`*^9, 3.8480403127980833`*^9}, {3.848043112108138*^9, 
   3.848043112566221*^9}, {3.861733656133502*^9, 3.8617338662603717`*^9}, {
   3.86176934714069*^9, 3.8617693724140406`*^9}, 3.861778568938816*^9, {
   3.8622430503751097`*^9, 3.862243051090524*^9}, 3.8623736077235756`*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"f9e0f5d6-56ac-429c-ad75-9d4211a0e0a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.821639993205228*^9}, {3.8381869586707425`*^9, 
   3.8381869649591913`*^9}, 3.838187468055561*^9, 3.8381890306710825`*^9, {
   3.8382140851103477`*^9, 
   3.838214092870597*^9}},ExpressionUUID->"6934529c-6d52-4e0f-acb2-\
2d1e5f174132"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dendriteReliefPlot", "[", "image_", "]"}], ":=", 
   RowBox[{"ReliefPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ImageData", "@", 
        RowBox[{"ImageReflect", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Top", "\[Rule]", "Bottom"}]}], "]"}]}], "&"}], "@", 
      RowBox[{"ColorConvert", "[", 
       RowBox[{"image", ",", "\"\<Grayscale\>\""}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "False"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<LightTerrain\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkDFT", "[", "image_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dendriteStructure", "=", "image"}], ",", 
       "\[IndentingNewLine]", "filteredDFT", ",", "degreeCircles", ",", 
       "circleOverlayDFT", ",", "polarOverlay", ",", "polarOverlayDFT"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filteredDFT", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ImageRotate", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}], "@", 
         RowBox[{"correction", "@", 
          RowBox[{"Colorize", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ImagePeriodogram", "@", "dendriteStructure"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ColorFunction", "\[Rule]", 
             RowBox[{"ColorData", "@", "colorScheme"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "//", "ImageAdjust"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"degreeCircles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Circle", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"0.5", "*", 
            RowBox[{"ImageDimensions", "@", "filteredDFT"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"#", "*", 
            RowBox[{"Min", "@", 
             RowBox[{"ImageDimensions", "@", "filteredDFT"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"0.25", ",", "0.4"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"circleOverlayDFT", "=", 
       RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
        RowBox[{"filteredDFT", ",", "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{"degreeCircles", ",", "Dashed", ",", "overlayColor", ",", 
           RowBox[{"Thickness", "@", "0.01"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"polarOverlay", "=", 
       RowBox[{"PolarPlot", "[", "\[IndentingNewLine]", 
        RowBox[{"Nothing", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "Pi"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "*", "polarOverlayScale", "*", 
           RowBox[{"Min", "@", 
            RowBox[{"ImageDimensions", "@", "filteredDFT"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PolarAxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PolarGridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "4"}], ",", 
              RowBox[{"2", "/", "4"}], ",", 
              RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"overlayColor", ",", "Thick"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"overlayColor", ",", "Bold", ",", "polarTicksFont"}], 
             "}"}], ",", "Automatic"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"overlayColor", ",", "Thick"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PolarAxes", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
         RowBox[{"PolarTicks", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"Pi", "/", "6"}], " ", "i"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"30", " ", "i"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "5"}], ",", "6"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "None"}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"polarOverlayDFT", "=", 
       RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
        RowBox[{"filteredDFT", ",", "\[IndentingNewLine]", 
         RowBox[{"ImageMarker", "[", 
          RowBox[{
           RowBox[{"0.5", "*", 
            RowBox[{"ImageDimensions", "@", "filteredDFT"}]}], ",", 
           "polarOverlay"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"circleOverlayDFT", ",", "polarOverlayDFT"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "10"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getNormalizedDistributions", "[", 
    RowBox[{"dataset_", ",", "binning_", ",", "label_", ",", "style_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", "label"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "style"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
       RowBox[{"InterpolationOrder", "\[Rule]", "binInterpolation"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", "customFrameTicks"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"N", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
              RowBox[{"First", "@", "#"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Rescale", "@", 
              RowBox[{"Last", "@", "#"}]}]}], "\[IndentingNewLine]", 
            "}"}]}]}], "&"}], "@", 
        RowBox[{"HistogramList", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "binning"}], "\[IndentingNewLine]", "]"}]}], "&"}],
       "@", "dataset"}], "\[IndentingNewLine]", ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotOrientationPeaks", "[", "bins_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", "customFrameTicks"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", "angleLabel"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "bins"}]}], "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotReconstructedMap", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ImagePad", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
                RowBox[{"ColorReplace", "[", 
                 RowBox[{"#", ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Cyan", "\[Rule]", "Black"}], ",", 
                    RowBox[{"Magenta", "\[Rule]", "Black"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
              "\[IndentingNewLine]", 
              RowBox[{"ColorReplace", "[", 
               RowBox[{"#", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"White", "\[Rule]", "Cyan"}], ",", 
                  RowBox[{"Black", "\[Rule]", "White"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"ColorReplace", "[", 
               RowBox[{
                RowBox[{"testLiquidMask", "-", "testLiquidCavities"}], ",", 
                RowBox[{"White", "\[Rule]", 
                 RowBox[{"Lighter", "@", "Gray"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
          RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ColorReplace", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"White", "\[Rule]", "Orange"}], "}"}]}], "]"}], 
              "&"}], "@", "testLiquidCavities"}]}], "\[IndentingNewLine]", 
           "]"}]}], "&"}], "@", 
        RowBox[{"ImageAdd", "[", 
         RowBox[{"#", ",", 
          RowBox[{"EdgeDetect", "@", "realMask"}]}], "]"}]}], "&"}], "@", 
      "\[IndentingNewLine]", 
      RowBox[{"ColorReplace", "[", 
       RowBox[{"#", ",", 
        RowBox[{"White", "\[Rule]", "Magenta"}]}], "]"}]}], "&"}], "@", 
    RowBox[{"ImageMultiply", "[", 
     RowBox[{"assembledSkeleton", ",", 
      RowBox[{"ColorNegate", "@", "testLiquidMask"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"checkOrientations", "[", "skeleton_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "skeleton"}], ",", "\[IndentingNewLine]", 
       "orientationsDegrees", ",", "partitionLines", ",", 
       "partitionOrientations", ",", "colorValues", ",", 
       "partitionOrientationColors", ",", "coloredPartitionLines"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"orientationsDegrees", "=", 
       RowBox[{"getOrientations", "@", "input"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"orientationsDegrees", "//", "TableForm"}], "//", "Print"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "@", "orientationsDegrees"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"Mean", ",", "StandardDeviation"}], "}"}]}], "//", "Print"}],
       ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"partitionLines", "=", 
       RowBox[{"Image", "/@", 
        RowBox[{"Last", "/@", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"input", ",", "\"\<Mask\>\""}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partitionLines", "//", "Print"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"partitionOrientations", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"180", "/", "\[Pi]"}], ")"}], "*", 
         RowBox[{"ArcTan", "/@", 
          RowBox[{"Tan", "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"ComponentMeasurements", "[", 
             RowBox[{"input", ",", "\"\<Orientation\>\""}], "]"}]}]}]}]}], "/.", 
        RowBox[{"Rule", "\[Rule]", "List"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partitionOrientations", "//", "Print"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colorValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{"#", ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], 
          "@", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"N", "@", 
              RowBox[{"Rescale", "@", "#"}]}]}], "\[IndentingNewLine]", 
            "}"}]}]}], "&"}], "@", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "90"}], ",", "90", ",", "1"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"partitionOrientationColors", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Blend", "[", 
          RowBox[{"\"\<Rainbow\>\"", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"colorValues", "/@", "partitionOrientations"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partitionOrientationColors", "//", "Print"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
      RowBox[{"coloredPartitionLines", "=", 
       RowBox[{"ImageAdd", "@", 
        RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ColorReplace", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"White", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"partitionLines", ",", "partitionOrientationColors"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Image", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "&"}], "@", 
       "coloredPartitionLines"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viewColorizedPartitions", "[", "partitions_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"input", "=", "partitions"}], ",", "\[IndentingNewLine]", 
       "framePartitionIDs", ",", "colorizedPartitions", ",", 
       "framePartitionsIndexed"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"framePartitionIDs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"First", "@", 
             RowBox[{"Dimensions", "@", "input"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"Last", "@", 
             RowBox[{"Dimensions", "@", "input"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"colorizedPartitions", "=", 
       RowBox[{
        RowBox[{"Colorize", "/@", 
         RowBox[{"Flatten", "@", "input"}]}], "//", "Parallelize"}]}], ";", 
      "\n", "\n", 
      RowBox[{"framePartitionsIndexed", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
           RowBox[{"#1", ",", "\[IndentingNewLine]", 
            RowBox[{"Text", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"ToString", "@", "#2"}], ",", "White", ",", "Bold"}], 
               "]"}], ",", "Center"}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"colorizedPartitions", ",", "framePartitionIDs"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Last", "@", 
             RowBox[{"Dimensions", "@", "input"}]}]}], "]"}], "&"}], "@", 
         "framePartitionsIndexed"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotSampleStages", "[", "partition_", "]"}], ":=", 
   RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}], "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dendriteReliefPlot", "/@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "partition", ",", "\[IndentingNewLine]", "partitionAdjusted", ",", 
            "\[IndentingNewLine]", "partitionFiltered", ",", 
            "\[IndentingNewLine]", "partitionCleaned"}], 
           "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "partitionBinarized", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ImageAdjust", "@", "partitionCleaned"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"partitionSkeleton", ",", "Yellow"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotFrameFilteringStages", "[", "imageArray_", "]"}], ":=", 
   RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"Colorize", "/@", 
        RowBox[{"ImageAdjust", "/@", "imageArray"}]}], "\[IndentingNewLine]", 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSkeletonOrientationSpectrum", "[", 
    RowBox[{"dataset_", ",", "plotStyle_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", "angleLabel"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotStyle", "\[Rule]", "plotStyle"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
       RowBox[{"InterpolationOrder", "\[Rule]", "binInterpolation"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", "customFrameTicks"}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", "dataset"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MILseriesPlot", "[", "datasets_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", "Red"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "meanInverseLuminancePlotRange"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"\"\<Frame\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FontSize", "\[Rule]", "17"}]}], "]"}], "&"}], "@", 
           "\"\<\\\\textbf{\[LeftAngleBracket]1-I\[RightAngleBracket]}\>\""}]}\
], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], "@",
     "datasets"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interactiveMILseries", "[", "dataset_", "]"}], ":=", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"Filling", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "meanInverseLuminancePlotRange"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], "@", 
      RowBox[{"getFilteredMILseries", "@", 
       RowBox[{"dataset", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "imageID"}], "]"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"imageID", ",", "1", ",", 
       RowBox[{"Length", "@", "dataset"}], ",", "1"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getKeyPixelOverlay", "[", 
    RowBox[{"mask_", ",", "color_", ",", "skeleton_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageSubtract", "[", 
        RowBox[{"skeleton", ",", "#"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "color"}]}], "]"}], "&"}], "@", 
        "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", "mask"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitionOrientationMatrixPlot", "[", "skeleton_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"image", "=", "skeleton"}], ",", "\[IndentingNewLine]", 
       "barTickLabels", ",", "arrayPlotLegend", ",", 
       "partitionOrientationColorMap", ",", "partitionOrientationsLengths", 
       ",", "partitionOrientationsWithWeights", ",", "partitionMeansWeighed", 
       ",", "framePartitionsColorValues"}], "\[IndentingNewLine]", "}"}], ",",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"barTickLabels", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "@", "#"}], "<>", "\"\<\[Degree]\>\""}], "&"}], 
        "/@", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "75"}], ",", "75", ",", "15"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"arrayPlotLegend", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Placed", "[", 
          RowBox[{"#", ",", "Right"}], "]"}], "&"}], "@", " ", 
        RowBox[{"BarLegend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"colorPalette", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
          ",", 
          RowBox[{"Length", "@", "barTickLabels"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "matrixPlotLegendSize"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<TickLabels\>\"", "\[Rule]", "barTickLabels"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"partitionOrientationColorMap", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"getFramePartition", "[", 
         RowBox[{"image", ",", "partitionScale"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"partitionOrientationsLengths", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "}"}], "\[Rule]", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
            RowBox[{"{", 
             RowBox[{"666", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{
        "getOrientationsLengths", "/@", "partitionOrientationColorMap"}]}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"partitionOrientationsWithWeights", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "/", 
                  RowBox[{"Total", "@", "#"}]}], ")"}], "&"}], "@", 
               RowBox[{"Last", "@", "#"}]}]}], "}"}]}], "&"}], "@", 
          RowBox[{"Transpose", "@", "#"}]}], "&"}], "/@", 
        "partitionOrientationsLengths"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"partitionMeansWeighed", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Median", "@", 
          RowBox[{"(", 
           RowBox[{"WeightedData", "@@", "#"}], ")"}]}], "&"}], "/@", 
        "partitionOrientationsWithWeights"}]}], ";", "\[IndentingNewLine]", 
      "\n", 
      RowBox[{"framePartitionsColorValues", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Last", "@", 
            RowBox[{"Dimensions", "@", "imagePartitions"}]}]}], "]"}], "&"}], 
        "@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "\[Equal]", "666"}], ",", "#", ",", 
             RowBox[{"colorValues", "@", "#"}]}], "]"}], "&"}], "/@", 
          "partitionMeansWeighed"}], "\[IndentingNewLine]", ")"}]}]}], ";", 
      "\n", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"ColorFunction", "\[Rule]", "colorPalette"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "matrixPlotSize"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "90"}], ",", "90"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"Flatten", "[", 
                RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "&"}], "@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"Range", "/@", 
             RowBox[{"Dimensions", "@", "framePartitions"}]}], 
            "\[IndentingNewLine]", ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", "arrayPlotLegend"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       "framePartitionsColorValues"}]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotGrainDecomposition", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ImagePad", "[", 
                RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"ColorReplace", "[", "\[IndentingNewLine]", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Magenta", "\[Rule]", "Black"}], ",", 
                  RowBox[{"Black", "\[Rule]", "White"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorReplace", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"White", "\[Rule]", "Orange"}]}], "]"}], "&"}], "@",
                "testLiquidCavities"}]}], "\[IndentingNewLine]", "]"}]}], 
           "&"}], "@", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"White", "\[Rule]", "Magenta"}]}], "]"}]}], "&"}], "@", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{
            RowBox[{"testLiquidMask", "-", "testLiquidCavities"}], ",", 
            RowBox[{"White", "\[Rule]", 
             RowBox[{"Lighter", "@", "Gray"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "@", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"EdgeDetect", "@", "realMask"}]}], "\[IndentingNewLine]", 
       "]"}]}], "&"}], "@", 
    RowBox[{"(", 
     RowBox[{"dominantGrainOverlay", "+", "overlapZoneOverlay"}], ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"plotGrainDecompositionNoCavities", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ImagePad", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ColorReplace", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Magenta", "\[Rule]", "Black"}], ",", 
                RowBox[{"Black", "\[Rule]", "White"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"White", "\[Rule]", "Magenta"}]}], "]"}]}], "&"}], "@", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"ColorReplace", "[", 
           RowBox[{
            RowBox[{"testLiquidMask", "-", "testLiquidCavities"}], ",", 
            RowBox[{"White", "\[Rule]", 
             RowBox[{"Lighter", "@", "Gray"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "@", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"EdgeDetect", "[", 
         RowBox[{"realMask", "+", "testLiquidCavities"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
    RowBox[{"(", 
     RowBox[{"dominantGrainOverlay", "+", "overlapZoneOverlay"}], ")"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getGrainOrientationSpectra", "[", "grains_", "]"}], ":=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getSkeletonOrientationSpectrum", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getOrientationBinsWithWeights", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "angleBinCount"}], "\[IndentingNewLine]", "]"}], 
          "&"}], "/@", "grains"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", 
           RowBox[{"97", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "grains"}]}]}]}], "\[IndentingNewLine]", 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getDominanGrainOverlay", "[", "denditeGrains_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ColorReplace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"denditeGrains", "[", 
          RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"White", "\[Rule]", 
          RowBox[{"ColorData", "[", 
           RowBox[{"97", ",", "#"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       "&"}], "/@", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "denditeGrains"}]}]}], "//", "ImageAdd"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getOverlapZoneOverlay", "[", 
     RowBox[{"skeleton_", ",", "overlapMask_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"White", "\[Rule]", "Magenta"}]}], "]"}], "&"}], "@", 
         "\[IndentingNewLine]", 
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", 
           RowBox[{"10", "^", 
            RowBox[{"-", "6"}]}]}], "]"}]}], "&"}], "@", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageMultiply", "[", 
        RowBox[{"#", ",", "overlapMask"}], "]"}]}], "&"}], "@", 
     "skeleton"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSolidMaskOverlays", "[", "frameID_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Colorize", "@", 
        RowBox[{"ImageAdjust", "@", 
         RowBox[{"cleanFrames", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EdgeDetect", "@", 
        RowBox[{"useMask", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "@", "frameID"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getFrontMatrixPlot", "[", 
    RowBox[{
    "formattedMatrix_", ",", "valueRange_", ",", "frameTicks_", ",", 
     "ticksRoundFactor_", ",", "timeScalingFactor_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inputFormatted", "=", "formattedMatrix"}], ",", 
       RowBox[{"inputValueRange", "=", "valueRange"}], ",", 
       "\[IndentingNewLine]", "barTickLabels", ",", "arrayPlotLegend", ",", 
       RowBox[{"ticks", "=", "frameTicks"}], ",", "\[IndentingNewLine]", 
       RowBox[{"roundFactor", "=", "ticksRoundFactor"}], ",", 
       RowBox[{"scalingFactor", "=", "timeScalingFactor"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"barTickLabels", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "@", "#"}], "&"}], "/@", 
        RowBox[{"Round", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pixelSizeMuMeters", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"Range", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"First", "@", "valueRange"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Last", "@", "valueRange"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"Subtract", "@@", "valueRange"}], "]"}], "/", 
                "10"}]}], "\[IndentingNewLine]", "]"}], "/", "1000"}], "/", 
            "scalingFactor"}]}], ",", "roundFactor"}], "\[IndentingNewLine]", 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"arrayPlotLegend", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Placed", "[", 
          RowBox[{"#", ",", "Right"}], "]"}], "&"}], "@", " ", 
        RowBox[{"BarLegend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ColorData", "@", "colorData"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
          ",", 
          RowBox[{"Length", "@", "barTickLabels"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "matrixPlotLegendSize"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<TickLabels\>\"", "\[Rule]", "barTickLabels"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"LegendLabel", "\[Rule]", "matrixBarLegendLabel"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"DataReversed", "\[Rule]", "dataInversion"}], ",", 
          RowBox[{"Mesh", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"10", ",", "20"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"ColorData", "@", "colorData"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", "arrayPlotLegend"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "matrixPlotSize"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<t, s\>\"", ",", "\"\<X, mm\>\""}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", 
       RowBox[{"Rescale", "@", "inputFormatted"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGrainOrientationSpectraAdaptive", "[", "grains_", "]"}], ":=", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"getSkeletonOrientationSpectrum", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "getOrientationBinsWithWeightsAdaptive", "[", "\[IndentingNewLine]", 
           RowBox[{"#1", ",", "angleBinCount", ",", "#2"}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"grains", ",", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "grains"}]}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"97", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "grains"}]}]}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8382141089276686`*^9, 3.8382141470557327`*^9}, {
   3.8383810384782114`*^9, 3.838381047604392*^9}, {3.8387855585815835`*^9, 
   3.8387855587734413`*^9}, {3.8428550422523947`*^9, 3.842855063443738*^9}, {
   3.842870277711341*^9, 3.8428702783037567`*^9}, {3.8430443574775066`*^9, 
   3.8430443581598406`*^9}, {3.843306412936756*^9, 3.843306413797443*^9}, {
   3.8433074774747143`*^9, 3.8433074795321846`*^9}, {3.8434791180537205`*^9, 
   3.843479122197983*^9}, {3.8434792010384073`*^9, 3.8434792085272436`*^9}, {
   3.8434801865205216`*^9, 3.8434801872356105`*^9}, {3.8468295524204054`*^9, 
   3.846829553281579*^9}, {3.8468303011644278`*^9, 3.846830309764868*^9}, {
   3.8468366770818214`*^9, 3.8468366776273637`*^9}, {3.846837834713642*^9, 
   3.8468378625222187`*^9}, {3.8468455070247407`*^9, 3.846845510560229*^9}, {
   3.84684815828109*^9, 3.8468481614473963`*^9}, {3.8468520157107143`*^9, 
   3.846852020830513*^9}, {3.846857168227646*^9, 3.8468571689972773`*^9}, {
   3.8471814143775034`*^9, 3.8471814167940416`*^9}, {3.847517395217419*^9, 
   3.847517396149927*^9}, {3.8475193211014194`*^9, 3.8475193256496277`*^9}, {
   3.847703442796735*^9, 3.8477034453400145`*^9}, {3.847704978874587*^9, 
   3.84770498491438*^9}, {3.847958174636939*^9, 3.847958175546935*^9}, {
   3.8479584112620754`*^9, 3.847958418107979*^9}, {3.8479584533121324`*^9, 
   3.8479584698383713`*^9}, 3.847958503411874*^9, 3.8479587019715586`*^9, 
   3.8479587489015484`*^9, {3.848039611709918*^9, 3.8480396130401764`*^9}, {
   3.854284348606432*^9, 3.854284414507883*^9}, {3.8542844460535684`*^9, 
   3.854284450163246*^9}, {3.8542844897272644`*^9, 3.854284491163439*^9}, {
   3.8542846894363155`*^9, 3.8542847196534653`*^9}, {3.854284763132161*^9, 
   3.854284805203933*^9}, {3.8543017093581405`*^9, 3.8543017097800107`*^9}, 
   3.8543021687449975`*^9, {3.86135180587704*^9, 3.861351833608179*^9}, {
   3.8613521906884565`*^9, 3.861352244163921*^9}, 3.8613523774468827`*^9, 
   3.8613527808945127`*^9, {3.861352819172843*^9, 3.8613528224911113`*^9}, {
   3.861353079779817*^9, 3.8613530820279865`*^9}, {3.861353182755934*^9, 
   3.861353198595103*^9}, {3.8613532465402184`*^9, 3.86135328889894*^9}, {
   3.861353351435895*^9, 3.861353359444062*^9}, {3.861442430138591*^9, 
   3.8614424558068857`*^9}, {3.861442950672676*^9, 3.861442980099907*^9}, {
   3.861443951145012*^9, 3.861444010521378*^9}, {3.8614442545310187`*^9, 
   3.8614442566662717`*^9}, {3.8614443760482197`*^9, 
   3.8614444124822063`*^9}, {3.861444936929628*^9, 3.8614449419627314`*^9}, {
   3.8617694039719276`*^9, 3.861769404845587*^9}, {3.8618714154161644`*^9, 
   3.861871441937232*^9}, 3.8618714766948304`*^9, {3.8618715377453823`*^9, 
   3.861871539470315*^9}, {3.8618715963929563`*^9, 3.861871600951092*^9}, {
   3.8618726375592003`*^9, 3.8618726398618665`*^9}, {3.861873404718047*^9, 
   3.8618734265576353`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"ed36012d-dae3-44ee-9a0c-60eac11ed6bf"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Previews, Partitioning & Artefact Detection", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.8468307571479826`*^9, 3.846830762819174*^9}, {
  3.8468575360029893`*^9, 
  3.8468575729219303`*^9}},ExpressionUUID->"29ce30ae-a8ef-4ded-a58f-\
05ece2d801d9"],

Cell[TextData[{
 StyleBox["!ACHTUNG!", "Subtitle"],
 "\nFor previews of results with outliers/luminance artifacts, switch from\n\n\
ImageAdjust\n\nin visuals cells to\n\npreprocessImage\n\nor use\n\n\
MedianFilter[#,1]&@"
}], "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.8473587059188433`*^9, 3.847358723072055*^9}, 
   3.8473594480397825`*^9},
 FontSize->16,ExpressionUUID->"d6a4f8fb-2eba-413b-b3ed-7c3915bff00b"],

Cell[CellGroupData[{

Cell["[[ Preview Images ]]", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
  3.847440045780389*^9}},ExpressionUUID->"c2f71013-d1ab-4e3f-a187-\
ebee1a2e2579"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"previewImages", "=", "images"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"referenceFrame", "=", 
    RowBox[{"First", "@", "images"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"flatFieldCorrect", "[", 
       RowBox[{"#", ",", "referenceFrame"}], "]"}]}], "&"}], "@", 
    RowBox[{"previewImages", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "previewImages"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
  3.8473587967119102`*^9, 3.84735880759993*^9}, {3.8473590742000065`*^9, 
  3.847359106208709*^9}, {3.847359452569849*^9, 3.8473595079603925`*^9}, {
  3.8473595389841976`*^9, 3.847359539120832*^9}, {3.8474397485342627`*^9, 
  3.8474397553889327`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"0b5153a8-c262-4945-adf9-28306fdba200"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filters For PIV-optical Flow", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
   3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
   3.847358732918987*^9, 3.847358744568339*^9}, {3.8474400273636413`*^9, 
   3.847440045780389*^9}, 
   3.8522924319406624`*^9},ExpressionUUID->"b163eb5b-731a-4998-b829-\
3cbfc08644c9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b4cb70dd-eca5-4062-bdaf-e9c0a8a8b70a"],

Cell["TEST ZONE", "Abstract",
 CellChangeTimes->{{3.822418106687871*^9, 3.8224181153957405`*^9}, {
   3.8376936673110924`*^9, 3.837693692007067*^9}, 3.838705248353115*^9},
 FontSize->36,ExpressionUUID->"8ae5273f-f9eb-451f-a4f2-29b55e7c152e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"689660c6-74d1-4a0b-90e1-a64282a7951b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"images", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "images"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8522240302510138`*^9, 3.8522240964344673`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"33a2e045-a731-468d-953b-4cc9a23abf49"],

Cell[CellGroupData[{

Cell["Filter Definitions", "Subsubsection",
 CellChangeTimes->{{3.8522924450617085`*^9, 
  3.852292456991034*^9}},ExpressionUUID->"9881c276-4835-420b-a26b-\
1365c06911f8"],

Cell["\<\
Defaults:

primaryNMFradius=3;
secondaryNMFradius=3;
primaryNMFrange=20;
secondaryNMFrange=15;
curvatureFlowIterations=5;
curvatureFlowConductivity=Infinity;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.8473587059188433`*^9, 3.847358723072055*^9}, 
   3.8473594480397825`*^9, {3.852294108109967*^9, 3.8522941190022078`*^9}},
 FontSize->16,ExpressionUUID->"734a88b1-7384-4a34-abfa-64126f0f971e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"filterForVelocimetry", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NonlocalMeansFilter", "[", 
           RowBox[{
           "#", ",", "\[IndentingNewLine]", "secondaryNMFradius", ",", 
            "Automatic", ",", "secondaryNMFrange"}], "\[IndentingNewLine]", 
           "]"}], "&"}], "@", "\[IndentingNewLine]", 
         RowBox[{"CurvatureFlowFilter", "[", 
          RowBox[{
          "#", ",", "\[IndentingNewLine]", "curvatureFlowIterations", ",", 
           "curvatureFlowConductivity"}], "\[IndentingNewLine]", "]"}]}], 
        "&"}], "@", "\[IndentingNewLine]", 
       RowBox[{"NonlocalMeansFilter", "[", 
        RowBox[{
        "#", ",", "\[IndentingNewLine]", "primaryNMFradius", ",", "Automatic",
          ",", "primaryNMFrange"}], "\[IndentingNewLine]", "]"}]}], "&"}], 
     "@", "image"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"primaryNMFradius", "=", "3"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"secondaryNMFradius", "=", "3"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"primaryNMFrange", "=", "20"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"secondaryNMFrange", "=", "15"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowIterations", "=", "5"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowConductivity", "=", "Infinity"}], ";"}]}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.85222415559615*^9, 3.8522242092350097`*^9}, {
   3.852225241066019*^9, 3.8522252810178995`*^9}, {3.8522569061854753`*^9, 
   3.852256906560537*^9}, {3.8522583112470255`*^9, 3.852258381070835*^9}, 
   3.852258426167869*^9, {3.852258502872357*^9, 3.8522585156882124`*^9}, {
   3.852268853657625*^9, 3.8522689194814796`*^9}, 3.8522941203570814`*^9},
 CellLabel->
  "In[140]:=",ExpressionUUID->"edaf2fd6-053d-4a7f-ba0d-7822437056e5"],

Cell["\<\
Defaults:

nonlocalMeansRadius=1;
nonlocalMeansRange=5;
curvatureFlowIterations=5;
curvatureFlowConductivity=Infinity;
totalVariationRegularization=0.5;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.8473587059188433`*^9, 3.847358723072055*^9}, 
   3.8473594480397825`*^9, {3.852294108109967*^9, 3.852294132170749*^9}},
 FontSize->16,ExpressionUUID->"78add57e-bd1e-4aa6-9b5f-08d9677204cb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"filterForVelocimetryV2", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "totalVariationRegularization", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Poisson\>\""}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@", "\[IndentingNewLine]", 
         RowBox[{"CurvatureFlowFilter", "[", 
          RowBox[{
          "#", ",", "\[IndentingNewLine]", "curvatureFlowIterations", ",", 
           "curvatureFlowConductivity"}], "\[IndentingNewLine]", "]"}]}], 
        "&"}], "@", "\[IndentingNewLine]", 
       RowBox[{"NonlocalMeansFilter", "[", 
        RowBox[{
        "#", ",", "\[IndentingNewLine]", "nonlocalMeansRadius", ",", 
         "Automatic", ",", "nonlocalMeansRange"}], "\[IndentingNewLine]", 
        "]"}]}], "&"}], "@", "image"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nonlocalMeansRadius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nonlocalMeansRange", "=", "5"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowIterations", "=", "5"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowConductivity", "=", "Infinity"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalVariationRegularization", "=", "0.5"}], ";"}]}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.85222415559615*^9, 3.8522242092350097`*^9}, {
   3.852225241066019*^9, 3.8522252810178995`*^9}, {3.8522569061854753`*^9, 
   3.852256906560537*^9}, {3.8522583112470255`*^9, 3.852258381070835*^9}, 
   3.852258426167869*^9, {3.852258502872357*^9, 3.8522585156882124`*^9}, {
   3.852268853657625*^9, 3.852268949618478*^9}, 3.8522941223994913`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"b714146f-d7de-4ef9-ae3b-c2113f072c61"],

Cell["\<\
Defaults:

totalVariationModel=\[CloseCurlyDoubleQuote]Gaussian\[CloseCurlyDoubleQuote];
totalVariationRegularization=0.15;
totalVariationIterations=500;
curvatureFlowIterations=7;
curvatureFlowConductivity=Infinity;
peronaMalikIterations=5;
peronaMalikConductivity=Automatic;
peronaMalikRegularization=1;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.8473587059188433`*^9, 3.847358723072055*^9}, 
   3.8473594480397825`*^9, {3.852294108109967*^9, 3.8522941190022078`*^9}, 
   3.8522941492754097`*^9},
 FontSize->16,ExpressionUUID->"7e72b7d3-00c8-422e-91ce-85fd85f17952"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"filterForVelocimetryV3", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ImageAdjust", "@", 
           RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
            RowBox[{
            "#", ",", "totalVariationRegularization", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Method", "\[Rule]", "totalVariationModel"}], ",", 
             RowBox[{
             "MaxIterations", "\[Rule]", "totalVariationIterations"}]}], 
            "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
         RowBox[{"ImageAdjust", "@", 
          RowBox[{"CurvatureFlowFilter", "[", "\[IndentingNewLine]", 
           RowBox[{
           "#", ",", "curvatureFlowIterations", ",", 
            "curvatureFlowConductivity"}], "\[IndentingNewLine]", "]"}]}]}], 
        "&"}], "@", 
       RowBox[{"ImageAdjust", "@", 
        RowBox[{"PeronaMalikFilter", "[", "\[IndentingNewLine]", 
         RowBox[{
         "#", ",", "peronaMalikIterations", ",", "peronaMalikConductivity", 
          ",", "peronaMalikRegularization"}], "\[IndentingNewLine]", 
         "]"}]}]}], "&"}], "@", "image"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalVariationModel", "=", "\"\<Gaussian\>\""}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalVariationRegularization", "=", "0.15"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totalVariationIterations", "=", "500"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowIterations", "=", "7"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"curvatureFlowConductivity", "=", "Infinity"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"peronaMalikIterations", "=", "5"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"peronaMalikConductivity", "=", "Automatic"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"peronaMalikRegularization", "=", "1"}], ";"}]}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.85222415559615*^9, 3.8522242092350097`*^9}, {
   3.852225241066019*^9, 3.8522252810178995`*^9}, {3.8522569061854753`*^9, 
   3.852256906560537*^9}, {3.8522583112470255`*^9, 3.852258381070835*^9}, 
   3.852258426167869*^9, {3.852258502872357*^9, 3.8522585156882124`*^9}, {
   3.852268853657625*^9, 3.8522689239294815`*^9}, {3.852268958225297*^9, 
   3.8522689667102413`*^9}, {3.852272789262745*^9, 3.852272877615378*^9}, {
   3.852287060848834*^9, 3.8522870940231085`*^9}, {3.8522872062077646`*^9, 
   3.852287287774947*^9}, {3.8522873312636557`*^9, 3.852287339102792*^9}, {
   3.8522875766557927`*^9, 3.8522877536704*^9}, 3.8522881961591682`*^9, {
   3.8522939724523487`*^9, 3.8522939823245606`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"83bc5391-5531-411c-ad24-c808e2ed04f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["View Filter Output", "Subsubsection",
 CellChangeTimes->{{3.8522925649111185`*^9, 
  3.852292576474913*^9}},ExpressionUUID->"c88b5056-d5b2-46af-8cb6-\
3ab7ae51b65a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"filterForVelocimetryV3", "@", 
      RowBox[{"images", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], "//", "Colorize"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "images"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8522868562007704`*^9, 3.852286923966748*^9}, {
   3.8522869960963697`*^9, 3.8522869969114113`*^9}, 3.8522870701356487`*^9, {
   3.8522871448713903`*^9, 3.8522871911187105`*^9}, {3.852287839911792*^9, 
   3.852287840510727*^9}, {3.852287909463539*^9, 3.852287910886089*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"0a4cff3f-3c3b-4d4e-8bab-781d5a9181b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["View Filter Stages", "Subsubsection",
 CellChangeTimes->{{3.8522924450617085`*^9, 3.852292456991034*^9}, {
  3.8522925421227484`*^9, 
  3.852292544690625*^9}},ExpressionUUID->"17687c91-6e1a-4ee7-83f3-\
ea2d38cd6383"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"filterOne", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PeronaMalikFilter", "[", "\[IndentingNewLine]", 
        RowBox[{
        "#", ",", "peronaMalikIterations", ",", "Automatic", ",", 
         "peronaMalikRegularization"}], "\[IndentingNewLine]", "]"}], "&"}], 
      "@", "image"}], "//", 
     RowBox[{"ImageAdjust", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"filterTwo", "[", "image_", "]"}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"CurvatureFlowFilter", "[", "\[IndentingNewLine]", 
         RowBox[{
         "#", ",", "curvatureFlowIterations", ",", 
          "curvatureFlowConductivity"}], "\[IndentingNewLine]", "]"}], "&"}], 
       "@", "image"}], "//", 
      RowBox[{"ImageAdjust", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"filterThree", "[", "image_", "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
         RowBox[{
         "#", ",", "totalVariationRegularization", ",", "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "totalVariationModel"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MaxIterations", "\[Rule]", "totalVariationIterations"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", "stage2"}], "//", 
      "ImageAdjust"}]}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852294669852972*^9, 3.8522947486131487`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"57cd93a8-8004-4a87-b174-4a8091ddf8cc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"totalVariationModel", "=", "\"\<Gaussian\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalVariationRegularization", "=", "0.15"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"totalVariationIterations", "=", "500"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curvatureFlowIterations", "=", "7"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curvatureFlowConductivity", "=", "Infinity"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"peronaMalikIterations", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"peronaMalikConductivity", "=", "Automatic"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"peronaMalikRegularization", "=", "2"}], ";"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.852294186290394*^9, {3.8522942942671547`*^9, 3.852294324067912*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"334d749e-b32f-40e1-a029-90c9407b7c7b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"testID", "=", "273"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inputPlumes", "=", 
     RowBox[{"images", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"Colorize", "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"inputPlumes", ",", "\[IndentingNewLine]", 
          RowBox[{"stage1", "=", 
           RowBox[{"filterOne", "@", "inputPlumes"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"stage2", "=", 
           RowBox[{"filterTwo", "@", "stage1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"stage3", "=", 
           RowBox[{"filterThree", "@", "stage2"}]}]}], "\[IndentingNewLine]", 
         "}"}]}], "\[IndentingNewLine]", ")"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "5"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8522682857778516`*^9, 3.8522683100895724`*^9}, {
   3.8522683516589675`*^9, 3.8522683863375187`*^9}, {3.8522684413472185`*^9, 
   3.8522684784735813`*^9}, {3.85228117569905*^9, 3.8522811757627516`*^9}, {
   3.8522812086830416`*^9, 3.8522812340740848`*^9}, {3.8522812906428137`*^9, 
   3.852281301603587*^9}, {3.8522839662260494`*^9, 3.8522839680649953`*^9}, {
   3.8522840306344395`*^9, 3.8522840559047585`*^9}, {3.8522858811854973`*^9, 
   3.8522859202157736`*^9}, 3.8522923312939243`*^9, {3.852293230115868*^9, 
   3.852293243101753*^9}, {3.852294193476886*^9, 3.8522942203079777`*^9}, {
   3.8522947632461314`*^9, 3.852294821538447*^9}, {3.8522964869457817`*^9, 
   3.852296488514676*^9}, {3.852296522658761*^9, 3.85229652289929*^9}, {
   3.852296577906189*^9, 3.852296578762692*^9}, {3.852296799986271*^9, 
   3.852296800369766*^9}, {3.8522970313859034`*^9, 3.852297031792802*^9}, {
   3.852297082881839*^9, 3.85229710828278*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"49d58532-bab9-450e-8c01-f29c5ede45ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Process & Export Results", "Subsubsection",
 CellChangeTimes->{{3.8522925649111185`*^9, 
  3.8522925892108335`*^9}},ExpressionUUID->"235ff05b-f4c6-49fa-a8b8-\
7ad6a28412eb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"luminanceCompression", "=", "0.5"}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.852297348511476*^9, 3.852297352133111*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"8cf2e0a7-0048-4ac2-a364-2046a2ee6cf5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SetSharedVariable", "@", "monitorCounter"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testBatch", "=", 
      RowBox[{"Length", "@", "images"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"filteredVelocimetryFrames", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"correction", "@", 
            RowBox[{"filterForVelocimetryV3", "@", 
             RowBox[{"images", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "testBatch"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]",
          "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{"progress", "[", 
       RowBox[{"monitorCounter", ",", "testBatch"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "//", "AbsoluteTiming"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.852227462120224*^9, 3.85222749415212*^9}, {
   3.852227562209771*^9, 3.852227564792867*^9}, {3.852228110601224*^9, 
   3.852228113984477*^9}, {3.8522285580332456`*^9, 3.852228563857942*^9}, {
   3.852228693553063*^9, 3.852228697896341*^9}, {3.852228908976878*^9, 
   3.852229090769969*^9}, {3.8522295625536337`*^9, 3.8522295659912205`*^9}, 
   3.8522584397775555`*^9, {3.8522728969364767`*^9, 3.852272896975073*^9}, {
   3.8522988853852177`*^9, 3.8522988867609596`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"cec27e6b-d65d-428d-8fb8-560d0493312e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"velocimetryFolder", "=", 
      RowBox[{"output", "<>", "\"\<Filtered for Velocimetry\\\\\>\""}]}], 
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DirectoryQ", "@", "velocimetryFolder"}], ",", 
      "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
      RowBox[{"velocimetryFolder", "//", "CreateDirectory"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.852229489951912*^9, 3.8522295020709996`*^9}, {
  3.852229533409812*^9, 3.8522295530560575`*^9}, {3.85229736702978*^9, 
  3.852297369317458*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"d88e68e7-80cf-4b9d-8ed5-4e06ace93e29"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "@", "filteredVelocimetryFrames"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Export", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"velocimetryFolder", "<>", "\"\<Frame_\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<.png\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"filteredVelocimetryFrames", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "filteredVelocimetryFrames"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8522299839506187`*^9, 3.8522300085913863`*^9}, 
   3.8522303386390285`*^9},
 CellLabel->
  "In[150]:=",ExpressionUUID->"13b32005-e771-4a9d-b915-657a8f7a3a35"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"8f3b3360-c332-4f80-b677-e709e3e6578e"],

Cell["TEST ZONE END", "Abstract",
 CellChangeTimes->{{3.822418106687871*^9, 3.8224181153957405`*^9}, {
   3.8376936673110924`*^9, 3.837693692007067*^9}, 3.838705248353115*^9, {
   3.852223767922172*^9, 3.8522237681545515`*^9}, {3.8542840627210236`*^9, 
   3.8542840642650695`*^9}},
 FontSize->36,ExpressionUUID->"543817a2-bbca-462a-a3f5-f9d1df52ca4b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"6d0e9ce8-77a3-4199-8aac-513c624b10ee"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Image Sequence Binning & Averaging", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.847358732918987*^9, 
  3.847358744568339*^9}},ExpressionUUID->"d7e4caf2-faa4-4a79-8252-\
82acdcceacb3"],

Cell[TextData[{
 "Defaults:\n\naveragingBinWidth=4;\nreferenceSampleCount=5;\[LineSeparator]\n\
",
 StyleBox["!ACHTUNG!", "Subtitle"],
 "\n\nIf no averaging is desired, use\n\naveragingBinWidth=1;\n\
referenceSampleCount=1;"
}], "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.8473587059188433`*^9, 3.847358723072055*^9}, {
  3.847359247527587*^9, 3.8473592883756685`*^9}, {3.847359557944026*^9, 
  3.8473595720079994`*^9}},
 FontSize->16,ExpressionUUID->"e8c91915-5474-4d03-a225-050d5f5681f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"averagingBinWidth", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"referenceSampleCount", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.847348227665286*^9, 3.8473483047051563`*^9}, {
   3.8473483742240505`*^9, 3.8473483743028507`*^9}, {3.8473484800636716`*^9, 
   3.8473484808554626`*^9}, {3.847348530638698*^9, 3.8473485351668806`*^9}, 
   3.847348719327128*^9, 3.8473487788474083`*^9, 3.847358865919443*^9, 
   3.847359002016159*^9, {3.847359145863984*^9, 3.8473591767041454`*^9}, 
   3.84735957510446*^9, {3.847439831517355*^9, 3.847439832452853*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"3ed04c8f-016d-44e2-85eb-a94a1959e8f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"imagesAveraged", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Mean", "/@", 
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "averagingBinWidth"}], "]"}]}], "&"}], "@", 
     "images"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"referenceFrame", "=", 
   RowBox[{"Mean", "@", 
    RowBox[{"images", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "referenceSampleCount"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"images", "=", "imagesAveraged"}], ";"}]}], "Input",
 CellChangeTimes->{{3.847348227665286*^9, 3.8473483047051563`*^9}, {
   3.8473483742240505`*^9, 3.8473483743028507`*^9}, {3.8473484800636716`*^9, 
   3.8473484808554626`*^9}, {3.847348530638698*^9, 3.8473485351668806`*^9}, 
   3.847348719327128*^9, 3.8473487788474083`*^9, 3.847358865919443*^9, 
   3.847359002016159*^9, {3.847359145863984*^9, 3.8473591767041454`*^9}, {
   3.847439863013131*^9, 3.8474398856296525`*^9}, {3.8474399220771875`*^9, 
   3.847439923223123*^9}, {3.8474401205175343`*^9, 3.847440163028351*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"3be85202-cec4-4eec-b672-d2da5e686504"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"flatFieldCorrect", "[", 
       RowBox[{"#", ",", "referenceFrame"}], "]"}]}], "&"}], "@", 
    RowBox[{"imagesAveraged", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "imagesAveraged"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.847348164976734*^9, 3.8473482034795685`*^9}, {
   3.847348326249256*^9, 3.847348328375657*^9}, 3.8473484908970575`*^9, 
   3.8473591289685974`*^9, {3.847359592361045*^9, 3.847359617168429*^9}, {
   3.8473596698638515`*^9, 3.847359673248846*^9}, {3.8474397988856163`*^9, 
   3.8474398035431623`*^9}, 3.8474445256929255`*^9},
 CellLabel->
  "In[142]:=",ExpressionUUID->"1a8effe5-843c-457f-8124-3c593ba3ad00"]
}, Open  ]],

Cell[CellGroupData[{

Cell["X-ray Image Correction Preview", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.8216400818224745`*^9, 
  3.821640087422493*^9}, {3.837502178772251*^9, 3.8375021903483973`*^9}, {
  3.8475430879859257`*^9, 
  3.8475430890990114`*^9}},ExpressionUUID->"f98aa120-7a94-48ba-bc49-\
7921d28e9267"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Colorize", "@", 
      RowBox[{"ImageAdjust", "@", "#"}]}], "&"}], "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Last", "@", "images"}], ",", 
      RowBox[{"First", "@", "images"}], ",", "\[IndentingNewLine]", 
      RowBox[{"testFrame", "=", 
       RowBox[{"ImageMultiply", "[", 
        RowBox[{
         RowBox[{"Last", "@", "images"}], ",", 
         RowBox[{"referenceFrame", "^", 
          RowBox[{"-", "1"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "5"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.816683444010933*^9, 3.8166834707048817`*^9}, {
   3.816683503357418*^9, 3.816683506276226*^9}, {3.8166847516343307`*^9, 
   3.8166847526775494`*^9}, {3.816930358873807*^9, 3.8169303691383686`*^9}, 
   3.817308745466528*^9, {3.821521221658434*^9, 3.8215212441210957`*^9}, {
   3.8215216217978487`*^9, 3.8215216241484585`*^9}, {3.821521715147291*^9, 
   3.821521720747614*^9}, {3.82152187180589*^9, 3.8215219044184666`*^9}, {
   3.8215221982977924`*^9, 3.8215222034428387`*^9}, {3.8216132788146615`*^9, 
   3.8216133151456785`*^9}, {3.8216205115512238`*^9, 3.821620512119953*^9}, {
   3.821628638676518*^9, 3.8216286525513964`*^9}, {3.821629141828247*^9, 
   3.8216291434558687`*^9}, {3.8223709784478693`*^9, 3.822371053695393*^9}, 
   3.8286881978157263`*^9, {3.8286882587522583`*^9, 3.828688291223365*^9}, {
   3.8286884388401375`*^9, 3.828688470823829*^9}, {3.8286885034242673`*^9, 
   3.8286885712493734`*^9}, {3.8383564481501894`*^9, 
   3.8383564489520454`*^9}, {3.838356604573989*^9, 3.838356613062296*^9}, {
   3.8462449063444915`*^9, 3.8462449088468413`*^9}, {3.8473592293196735`*^9, 
   3.8473592303305726`*^9}, 3.8474398597658157`*^9, 3.847439939262232*^9, {
   3.8475430971006403`*^9, 3.8475430978224435`*^9}, {3.860920362238*^9, 
   3.860920364712983*^9}, {3.8609203979326115`*^9, 3.8609204019259615`*^9}, {
   3.860920552372815*^9, 3.8609205608213115`*^9}, {3.861466840677165*^9, 
   3.861466862707502*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"315b714d-5d03-46ea-be20-b2142f33aca6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partition Frame", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821642262218782*^9, 
   3.8216422960582523`*^9}, {3.821642327826264*^9, 3.8216423343547983`*^9}, {
   3.8216424095865555`*^9, 3.8216424207217426`*^9}, {3.821642483481843*^9, 
   3.8216424885702286`*^9}, {3.821643160969904*^9, 
   3.8216431700835257`*^9}},ExpressionUUID->"01a09ac3-ccce-4bed-ac61-\
11da90f560d6"],

Cell["\<\
Defaults:

partitionScale = 0.1;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8375739800401664`*^9, 3.837573980272545*^9}},
 FontSize->16,ExpressionUUID->"c1286c78-a933-4112-aafa-1d6480e41180"],

Cell[BoxData[
 RowBox[{
  RowBox[{"partitionScale", "=", "0.1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.837502257189125*^9, 3.837502292396412*^9}, {3.8381868911710796`*^9, 
  3.8381868967512684`*^9}, {3.8433074196271763`*^9, 3.843307451412755*^9}, {
  3.8467693646006575`*^9, 3.846769416188738*^9}, {3.846820139711549*^9, 
  3.846820151984194*^9}, {3.8548969926692233`*^9, 3.854897021779869*^9}, {
  3.854897205747306*^9, 3.854897205827042*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"bdfc8a21-56c2-476e-9570-ff46645990f0"],

Cell[TextData[{
 StyleBox["!ACHTUNG!", "Subtitle"],
 "\n\nPlease ensure that the reassembled partitions form an image with \
dimensions close to the original"
}], "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846770069975404*^9, 3.846770101480152*^9}},
 FontSize->16,ExpressionUUID->"20e84f6a-1872-42a0-a1d6-e3bc2cbd3d79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"framePartitions", "=", 
   RowBox[{"getFramePartition", "[", 
    RowBox[{"testFrame", ",", "partitionScale"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"framePartitions", "//", "Dimensions"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ImageDimensions", "@", "testFrame"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Dimensions", "@", "#"}], "*", 
     RowBox[{"ImageDimensions", "@", 
      RowBox[{"First", "@", 
       RowBox[{"First", "@", "#"}]}]}]}], "&"}], "@", "framePartitions"}], "//",
   "Reverse"}], "\[IndentingNewLine]", 
 RowBox[{"viewColorizedPartitions", "@", "framePartitions"}]}], "Input",
 CellChangeTimes->{{3.8215581213090754`*^9, 3.821558220375619*^9}, {
   3.8215941517219896`*^9, 3.821594176322188*^9}, 3.821594216867716*^9, {
   3.821596170006586*^9, 3.821596181010148*^9}, 3.837492398522616*^9, {
   3.837502295597477*^9, 3.8375023131656456`*^9}, {3.843307460498337*^9, 
   3.8433074608364286`*^9}, {3.8467700397362633`*^9, 3.84677004027582*^9}, {
   3.847179939378086*^9, 3.847179949169649*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"5831773f-7459-404f-b0e5-e5f19cf550d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview Partition Filter Output", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821642262218782*^9, 
   3.8216422960582523`*^9}, {3.821642327826264*^9, 3.8216423343547983`*^9}, {
   3.8216424095865555`*^9, 3.8216424207217426`*^9}, {3.821642483481843*^9, 
   3.8216424885702286`*^9}, {3.821643160969904*^9, 3.821643179648932*^9}, 
   3.8433078265744395`*^9},ExpressionUUID->"09262507-4ae4-47d6-a816-\
f790577056fc"],

Cell["\<\
Defaults:\[LineSeparator]
Unaveraged images:

luminanceCompression=0.75;
nonlocalCorrectionWeight=1.25;
nonlocalCorrectionRadius=1;
nonlocalNoiseFactor=0.05;
windowNoiseVarianceBM3D=0.035;
sizeThreshold=10;


With 4-image averages:

luminanceCompression=0.75;
nonlocalCorrectionWeight=1.25;
nonlocalCorrectionRadius=1;
nonlocalNoiseFactor=0.04;
windowNoiseVarianceBM3D=0.04;
sizeThreshold=10;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234346143654*^9}, {3.837444188588746*^9, 
   3.8374441888945384`*^9}, {3.8383962447841253`*^9, 
   3.8383962462476683`*^9}, {3.838714606091916*^9, 3.838714610436344*^9}, {
   3.8391489471847305`*^9, 3.8391489494945602`*^9}, 3.839157495374284*^9, 
   3.8430492242001038`*^9, 3.8433047241503963`*^9, {3.8473575382792454`*^9, 
   3.8473575673854866`*^9}},
 FontSize->16,ExpressionUUID->"7c43d842-82fa-41c7-905d-3ae64924a050"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.75"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalCorrectionWeight", "=", "1.25"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalCorrectionRadius", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nonlocalNoiseFactor", "=", "0.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"windowNoiseVarianceBM3D", "=", "0.035"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sizeThreshold", "=", "10"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8216390030790963`*^9, {3.8216396090389767`*^9, 3.821639609250413*^9}, {
   3.8216416989324512`*^9, 3.8216417038951783`*^9}, {3.837439727435249*^9, 
   3.8374397609084406`*^9}, {3.8374402937716317`*^9, 
   3.8374402960513163`*^9}, {3.8374406901318398`*^9, 
   3.8374406945482616`*^9}, {3.839148733198987*^9, 3.839148809319513*^9}, {
   3.8391489533432684`*^9, 3.8391490050557404`*^9}, 3.8391499088404846`*^9, {
   3.8391503013607235`*^9, 3.839150303376335*^9}, {3.8391504815290728`*^9, 
   3.8391504817365184`*^9}, {3.8391508254092236`*^9, 3.8391509028967896`*^9}, 
   3.839152955722608*^9, {3.839153061283004*^9, 3.8391530788426332`*^9}, {
   3.8391531384506054`*^9, 3.839153187745906*^9}, {3.8391532412581067`*^9, 
   3.8391532416181445`*^9}, {3.8391532741387377`*^9, 
   3.8391532936106157`*^9}, {3.8391533442273116`*^9, 3.839153367130787*^9}, {
   3.8391574555661426`*^9, 3.839157455836424*^9}, 3.8391575036531534`*^9, 
   3.839157541094448*^9, {3.839157628773676*^9, 3.8391576405976934`*^9}, {
   3.839228780906789*^9, 3.839228781098277*^9}, 3.8392288210908427`*^9, {
   3.839228952226674*^9, 3.8392289629381113`*^9}, {3.8392290351783986`*^9, 
   3.839229041866746*^9}, {3.839229098346012*^9, 3.83922909857839*^9}, 
   3.839229477314026*^9, {3.839229635467058*^9, 3.839229683738583*^9}, {
   3.839229820490481*^9, 3.839229866282689*^9}, {3.8392306870737047`*^9, 
   3.839230687129582*^9}, {3.839231157593705*^9, 3.8392312036176376`*^9}, 
   3.83923140765871*^9, 3.8392356872744017`*^9, {3.8392357254174085`*^9, 
   3.839235745520653*^9}, 3.8392362397807474`*^9, 3.839236275177821*^9, {
   3.8392381453712716`*^9, 3.839238159506689*^9}, 3.839238233394991*^9, 
   3.8392383743704824`*^9, {3.839239433762328*^9, 3.839239461480501*^9}, 
   3.8392396670898542`*^9, 3.8392404150185647`*^9, 3.839240561746397*^9, 
   3.839240984425866*^9, 3.842693859606284*^9, 3.8426939029879417`*^9, {
   3.8433046891583233`*^9, 3.843304705725852*^9}, 3.8433057676421766`*^9, 
   3.8433080508762093`*^9, {3.8434792667341356`*^9, 3.8434793225525103`*^9}, {
   3.8473489217916718`*^9, 3.847348945712177*^9}, {3.8473489785917654`*^9, 
   3.8473490128960505`*^9}, {3.8473490476715593`*^9, 
   3.8473490659832153`*^9}, {3.8473494610797625`*^9, 3.847349506322257*^9}, {
   3.847351632695762*^9, 3.84735179175188*^9}, {3.8473566582159886`*^9, 
   3.847356820210683*^9}, 3.8473568586656322`*^9, 3.847357707674511*^9, 
   3.847358122682116*^9, 3.847440076650837*^9, {3.8542841451140428`*^9, 
   3.854284151581588*^9}, 3.855342844725178*^9, 3.8606703527397346`*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"5116e97e-3591-4812-b8c7-6a94cbd44f0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testPartition", "=", 
   RowBox[{"framePartitions", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "5"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionAdjusted", "=", 
   RowBox[{"preprocessImage", "@", "testPartition"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionFiltered", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"applyBM3D", "[", 
      RowBox[{"#", ",", "windowNoiseVarianceBM3D"}], "]"}], "&"}], "@", 
    "partitionAdjusted"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionCleaned", "=", 
   RowBox[{"cleanImage", "@", "partitionFiltered"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionBinarized", "=", 
   RowBox[{"ColorNegate", "@", 
    RowBox[{"MorphologicalBinarize", "@", "partitionCleaned"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitionSkeleton", "=", 
    RowBox[{"getSkeleton", "@", "partitionBinarized"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotProcessingStages", "=", 
  RowBox[{"plotSampleStages", "@", "testPartition"}]}]}], "Input",
 CellChangeTimes->{{3.8215949058534656`*^9, 3.8215949229846354`*^9}, {
   3.821595112739027*^9, 3.821595181411327*^9}, {3.821595250377841*^9, 
   3.821595300882705*^9}, {3.8215953394924154`*^9, 3.821595442447979*^9}, {
   3.821595495817231*^9, 3.8215955568608947`*^9}, {3.8215955967362165`*^9, 
   3.8215959687096434`*^9}, {3.82159600908465*^9, 3.821596091849194*^9}, {
   3.8215961313864584`*^9, 3.821596132899401*^9}, {3.8215961946197405`*^9, 
   3.8215962480498056`*^9}, {3.821596342426355*^9, 3.8215963859379416`*^9}, {
   3.821596435183223*^9, 3.8215964454397564`*^9}, {3.8215972464987173`*^9, 
   3.821597247117051*^9}, 3.8215977142922754`*^9, 3.821597752581815*^9, {
   3.8215977992409925`*^9, 3.821597895230339*^9}, {3.821597945385166*^9, 
   3.821597998576926*^9}, {3.8215980383432665`*^9, 3.8215980657808285`*^9}, {
   3.8216068214570675`*^9, 3.8216069195965166`*^9}, {3.821606951034432*^9, 
   3.8216069511640663`*^9}, {3.821606983050764*^9, 3.821607187662876*^9}, {
   3.8216072189916067`*^9, 3.821607333697085*^9}, {3.821607365758135*^9, 
   3.821607366334588*^9}, {3.8216073987429247`*^9, 3.821607546850976*^9}, {
   3.8216255757848854`*^9, 3.821625575926016*^9}, {3.8216280170085597`*^9, 
   3.821628046388955*^9}, {3.8216427435530825`*^9, 3.8216429665864573`*^9}, {
   3.8216430177884555`*^9, 3.8216430235081997`*^9}, 3.8286883739592743`*^9, {
   3.8286888192957726`*^9, 3.8286888194393873`*^9}, {3.828688856178672*^9, 
   3.82868888309636*^9}, {3.828690930602736*^9, 3.828690939354514*^9}, {
   3.837439788371727*^9, 3.8374397884832444`*^9}, {3.837440283724214*^9, 
   3.8374402855317783`*^9}, {3.8374405999961233`*^9, 
   3.8374406977089343`*^9}, {3.837448046103488*^9, 3.8374480633114634`*^9}, 
   3.8375024971413717`*^9, {3.837515425657401*^9, 3.8375154268016787`*^9}, {
   3.837516501161915*^9, 3.8375165014970193`*^9}, {3.837516576937329*^9, 
   3.837516577753148*^9}, {3.837516610017888*^9, 3.8375166104327784`*^9}, 
   3.83751666648991*^9, {3.837516700370331*^9, 3.8375167385283146`*^9}, {
   3.8375169070420723`*^9, 3.8375169187852097`*^9}, 3.8381890492238503`*^9, {
   3.8381931136252737`*^9, 3.8381931577764316`*^9}, {3.8382146531202993`*^9, 
   3.83821465341551*^9}, {3.8382147414321976`*^9, 3.8382147415508795`*^9}, {
   3.838269687794365*^9, 3.838269688848546*^9}, {3.8382929631842127`*^9, 
   3.83829298062259*^9}, {3.8383051025223308`*^9, 3.838305102689883*^9}, {
   3.8383532266842165`*^9, 3.8383532272287607`*^9}, {3.8383560046697855`*^9, 
   3.838356006757205*^9}, {3.8383597908308544`*^9, 3.838359815870411*^9}, {
   3.8383677512570877`*^9, 3.838367751392726*^9}, {3.8383791386619864`*^9, 
   3.838379156203104*^9}, 3.8383902681758337`*^9, {3.838391978887909*^9, 
   3.8383920487452984`*^9}, {3.8383951847854633`*^9, 
   3.8383951854721656`*^9}, {3.8383957893934135`*^9, 3.838395789760209*^9}, {
   3.8383962877387595`*^9, 3.8383962888093786`*^9}, {3.8384403692474604`*^9, 
   3.838440370591675*^9}, 3.838487534711825*^9, {3.838488680169263*^9, 
   3.838488680336053*^9}, {3.838715288245554*^9, 3.838715311700451*^9}, {
   3.8387920132624044`*^9, 3.8387920321010375`*^9}, 3.838814121484707*^9, {
   3.8388185749021745`*^9, 3.838818591557468*^9}, {3.8391487839114323`*^9, 
   3.8391487880792904`*^9}, {3.8391488378961244`*^9, 3.839148840015459*^9}, {
   3.839148958143437*^9, 3.839148958559325*^9}, {3.8391508137294407`*^9, 
   3.8391508330259256`*^9}, 3.839153163650564*^9, {3.8391532335544825`*^9, 
   3.8391532336342688`*^9}, 3.8391577897336187`*^9, {3.839227462122677*^9, 
   3.8392274621865063`*^9}, {3.8392285667705*^9, 3.8392285678745475`*^9}, {
   3.839228730843098*^9, 3.839228760218549*^9}, {3.839229017235362*^9, 
   3.839229017457817*^9}, {3.839229048586656*^9, 3.8392290491777864`*^9}, {
   3.8426996077234926`*^9, 3.8426996082510815`*^9}, {3.842955392251215*^9, 
   3.8429553929381065`*^9}, {3.843191568977622*^9, 3.8431915773442535`*^9}, 
   3.843270776080494*^9, {3.8432708183764515`*^9, 3.8432708205765777`*^9}, {
   3.843270851017112*^9, 3.843270852472227*^9}, {3.843271613363303*^9, 
   3.8432716135707483`*^9}, {3.843271645579867*^9, 3.8432716456506777`*^9}, {
   3.8432716769394875`*^9, 3.8432716774591*^9}, 3.8432717193155985`*^9, {
   3.843304683166407*^9, 3.8433047134062376`*^9}, {3.843307830816041*^9, 
   3.843307833317318*^9}, 3.8434789651821556`*^9, 3.843479039398369*^9, {
   3.8434791585670404`*^9, 3.843479174005913*^9}, {3.843479239832265*^9, 
   3.8434792506541896`*^9}, {3.843479312887679*^9, 3.8434793129744473`*^9}, {
   3.84682031629605*^9, 3.8468203169826255`*^9}, {3.8468203964156265`*^9, 
   3.846820396575212*^9}, {3.8471667822633715`*^9, 3.847166804556755*^9}, {
   3.847166851102287*^9, 3.8471668612132483`*^9}, {3.8473489718722944`*^9, 
   3.847349040463086*^9}, {3.8473490710009203`*^9, 3.847349071287155*^9}, 
   3.8473517426632557`*^9, 3.8473518218810925`*^9, {3.8473566836330137`*^9, 
   3.8473566873355293`*^9}, {3.84735672151295*^9, 3.8473567215917397`*^9}, {
   3.8473568056806564`*^9, 3.8473568064393883`*^9}, {3.8473568398958664`*^9, 
   3.8473568406890755`*^9}, {3.8473568761522417`*^9, 3.847356876511282*^9}, {
   3.8473577189848614`*^9, 3.8473577191115217`*^9}, {3.847361750632633*^9, 
   3.847361750927844*^9}, {3.854284192663498*^9, 3.8542842086971836`*^9}, {
   3.854897062240385*^9, 3.854897085467317*^9}, {3.8548972132632217`*^9, 
   3.8548972138827257`*^9}, 3.861551775790931*^9, {3.861617493677485*^9, 
   3.861617506194579*^9}, {3.861650673212015*^9, 3.8616506738423233`*^9}, {
   3.861782554369342*^9, 3.8617825548948593`*^9}, {3.861800436547182*^9, 
   3.861800437041912*^9}, {3.8618712907151127`*^9, 3.8618713232988997`*^9}, {
   3.862228462653305*^9, 3.8622284647965746`*^9}, {3.8624787904671907`*^9, 
   3.8624788143817883`*^9}, {3.8625043687669706`*^9, 
   3.8625043776016345`*^9}, {3.8625044092816343`*^9, 3.8625044100457506`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"2be48baf-9801-46d9-945e-0b0a469f2304"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Sample Partition Filtering Stages >>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821642262218782*^9, 
   3.8216422960582523`*^9}, {3.821642327826264*^9, 3.8216423343547983`*^9}, {
   3.8216424095865555`*^9, 3.8216424207217426`*^9}, {3.821642483481843*^9, 
   3.8216424885702286`*^9}, {3.821643160969904*^9, 3.821643179648932*^9}, 
   3.8433078265744395`*^9, {3.843479058108117*^9, 3.843479059443899*^9}, {
   3.847440270012574*^9, 
   3.847440306980719*^9}},ExpressionUUID->"eb21a759-9d82-4274-a7ff-\
4a5cbca9e503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<1_sample_stages.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotProcessingStages", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294908679724*^9, 3.8382949100730066`*^9}, {3.8382951363354254`*^9, 
   3.8382951525346394`*^9}, {3.838390596127884*^9, 3.838390596407138*^9}, 
   3.8471668657431355`*^9, {3.854284214986397*^9, 3.854284218804144*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"eea0e5c5-8ad1-4693-901f-cfb45a3dc91f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview Partition Orientations", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821642262218782*^9, 
   3.8216422960582523`*^9}, {3.821642327826264*^9, 3.8216423343547983`*^9}, {
   3.8216424095865555`*^9, 3.8216424207217426`*^9}, {3.821642483481843*^9, 
   3.8216424885702286`*^9}, {3.821643160969904*^9, 3.821643179648932*^9}, 
   3.8433078265744395`*^9, {3.843479058108117*^9, 
   3.843479059443899*^9}},ExpressionUUID->"dc5b14df-323a-4ab1-9283-\
e1024dbbb8b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"polarOverlayScale", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarTicksFont", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"overlayColor", "=", "Black"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorScheme", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<BrownCyanTones\>\"", ",", "\"\<Reversed\>\""}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.837483051921468*^9, 3.837483084006678*^9}, {
   3.8374835909356728`*^9, 3.8374836133914547`*^9}, {3.8375025923644133`*^9, 
   3.8375025993566794`*^9}, {3.8375026307168665`*^9, 
   3.8375026446888204`*^9}, {3.837502743076623*^9, 3.8375028440377607`*^9}, {
   3.8375028756384635`*^9, 3.8375029135343404`*^9}, {3.8375029535889497`*^9, 
   3.837502996044857*^9}, {3.837503127037527*^9, 3.837503136013109*^9}, {
   3.837517459249627*^9, 3.837517493785136*^9}, {3.8375186990850224`*^9, 
   3.8375187052335835`*^9}, 3.838186926304016*^9, {3.838214753209711*^9, 
   3.838214759503749*^9}, {3.83829300388041*^9, 3.838293015934184*^9}, {
   3.838294601631748*^9, 3.8382946198711348`*^9}, {3.8382946735600567`*^9, 
   3.838294690367772*^9}, {3.838440426399268*^9, 3.838440447631405*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"cf67a536-0f0b-4283-82d8-b76664082487"],

Cell[BoxData[{
 RowBox[{"checkOrientations", "@", "partitionSkeleton"}], "\n", 
 RowBox[{"plotSampleDFT", "=", 
  RowBox[{"checkDFT", "@", "partitionBinarized"}]}]}], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"616ecf20-6102-4110-a22b-b5beac904bb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Sample Partition DFT >>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821642262218782*^9, 
   3.8216422960582523`*^9}, {3.821642327826264*^9, 3.8216423343547983`*^9}, {
   3.8216424095865555`*^9, 3.8216424207217426`*^9}, {3.821642483481843*^9, 
   3.8216424885702286`*^9}, {3.821643160969904*^9, 3.821643179648932*^9}, 
   3.8433078265744395`*^9, {3.843479058108117*^9, 3.843479059443899*^9}, {
   3.847440270012574*^9, 
   3.8474402876603837`*^9}},ExpressionUUID->"fa9ffdb1-04da-4d84-8f12-\
ca73a67cb476"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<2_sample_DFT.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotSampleDFT", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
  3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
  3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
  3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
  3.83844043753448*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"5d94345f-c956-4bda-9471-a1742ebac066"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Detect Artefact Regions", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216432942734737`*^9}, {
   3.8216434569839206`*^9, 3.821643467888749*^9}, {3.837503085860713*^9, 
   3.8375030909005356`*^9}, {3.83750337814086*^9, 3.837503378880463*^9}, {
   3.846857551426365*^9, 
   3.846857553386944*^9}},ExpressionUUID->"9a8675f0-4ffa-4940-93e4-\
94c1eaee17c8"],

Cell["\<\
Defaults:

artefactThresholdBright=0.975;
artefactThresholdDark=0.975;
dilationScaleBright=5;
dilationScaleDark=5;

referenceFrame=First@images;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, 3.838189200472759*^9, {3.843305379821919*^9, 
   3.8433053802637324`*^9}},
 FontSize->16,ExpressionUUID->"f5a24f1d-117a-4387-925c-966b370a2ad3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"artefactThresholdBright", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"artefactThresholdDark", "=", "0.975"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dilationScaleBright", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dilationScaleDark", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"referenceFrame", "=", 
   RowBox[{"First", "@", "images"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.821628189984812*^9, 3.8216282222085886`*^9}, {
   3.822371593629223*^9, 3.8223715939622803`*^9}, {3.8375032025816736`*^9, 
   3.8375032263091125`*^9}, {3.8375712843279285`*^9, 3.837571288135748*^9}, {
   3.8381866770718036`*^9, 3.8381866910148926`*^9}, 3.8381868666475286`*^9, 
   3.8381871955596085`*^9, 3.838219192617954*^9, {3.8387826705230618`*^9, 
   3.838782672170657*^9}, {3.8387837354194527`*^9, 3.8387837609471974`*^9}, {
   3.8387842749890966`*^9, 3.838784301131605*^9}, {3.8387843334355555`*^9, 
   3.8387843679150634`*^9}, 3.8387844121556487`*^9, {3.8388141438204556`*^9, 
   3.8388141706280317`*^9}, 3.8388186160061316`*^9, {3.839149078591963*^9, 
   3.8391490796311846`*^9}, 3.8392377115770006`*^9, {3.842955422531934*^9, 
   3.842955423442499*^9}, 3.8429659519275393`*^9, {3.84304296320427*^9, 
   3.8430430012592683`*^9}, {3.843270876193392*^9, 3.8432708771129355`*^9}, 
   3.8433053850897703`*^9, 3.8458142753549433`*^9, 3.8458149412995663`*^9, 
   3.8459656586154385`*^9, {3.8459890193438387`*^9, 3.8459890642790766`*^9}, 
   3.8460548245848346`*^9, 3.8473617775297184`*^9, {3.854284241586609*^9, 
   3.854284242561121*^9}, 3.861617556036578*^9, {3.861782569888441*^9, 
   3.8617825708797383`*^9}, 3.8617921694822445`*^9, {3.861798947559284*^9, 
   3.8617989493146024`*^9}, 3.86180046546951*^9, {3.8620453015516825`*^9, 
   3.8620453044034767`*^9}, {3.8625044318511686`*^9, 3.862504439567009*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"e70df21a-49a3-49c0-b26f-0c71340d6fa6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"inpaintMask", "=", 
    RowBox[{"getInpaintMask", "@", "referenceFrame"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImageAdjust", "@", "referenceFrame"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageAdjust", "@", "referenceFrame"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"inpaintMask", ",", "Red"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8216077149590483`*^9, 3.8216078345262747`*^9}, {
   3.8216080696540833`*^9, 3.821608072361178*^9}, {3.8216082250844064`*^9, 
   3.8216082714278097`*^9}, {3.8216094790023255`*^9, 
   3.8216095781553793`*^9}, {3.8216096133288984`*^9, 3.821609616070583*^9}, {
   3.8216096564845266`*^9, 3.8216097007366395`*^9}, {3.8216097368985415`*^9, 
   3.8216097389177465`*^9}, 3.82161027894273*^9, {3.8216103123164454`*^9, 
   3.821610320819722*^9}, {3.821613494527102*^9, 3.8216137286104536`*^9}, {
   3.8216139050686436`*^9, 3.821614046130248*^9}, {3.8216141059051614`*^9, 
   3.821614190502817*^9}, {3.8216142378957686`*^9, 3.82161426019181*^9}, {
   3.8216152969690847`*^9, 3.821615330778343*^9}, {3.8216164559241695`*^9, 
   3.821616456730443*^9}, {3.8216164956007013`*^9, 3.821616503123932*^9}, {
   3.8216280799811068`*^9, 3.821628085661889*^9}, {3.821628269082196*^9, 
   3.821628271986419*^9}, {3.821643479153615*^9, 3.821643517513986*^9}, 
   3.8223365235656137`*^9, {3.8223715231040764`*^9, 3.822371567457675*^9}, {
   3.822418389639776*^9, 3.8224184038112392`*^9}, {3.828688903186983*^9, 
   3.8286889167210484`*^9}, {3.8374408091487274`*^9, 
   3.8374408211555095`*^9}, {3.837440856045409*^9, 3.837440873372682*^9}, {
   3.837501966653979*^9, 3.837501969636093*^9}, {3.837502005676979*^9, 
   3.837502069637205*^9}, {3.8375031049096823`*^9, 3.837503105638733*^9}, {
   3.8375031560046988`*^9, 3.837503357700379*^9}, {3.837503389229045*^9, 
   3.8375033949248347`*^9}, 3.83757129156857*^9, {3.838186625527388*^9, 
   3.838186741615205*^9}, {3.838784319077381*^9, 3.838784321451148*^9}, {
   3.838784406307345*^9, 3.838784426692401*^9}, {3.8387851060920863`*^9, 
   3.838785134508823*^9}, {3.8387851788666983`*^9, 3.8387851841967597`*^9}, {
   3.8430392188100147`*^9, 3.8430392252599783`*^9}, 3.843305346759722*^9, {
   3.843305378199277*^9, 3.843305391679072*^9}, {3.843305462980561*^9, 
   3.843305479141155*^9}, {3.843307548524067*^9, 3.8433075594975767`*^9}, {
   3.849120650524376*^9, 3.84912065621786*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"2f31778c-e2a9-417b-90d5-8b25e26aaadd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solid Region Detection", "Section",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.847804737786278*^9, 3.8478047394029536`*^9}, 
   3.8552159543428135`*^9, 
   3.8553426421045337`*^9},ExpressionUUID->"caadb55f-dcff-404c-98a9-\
34fa549a0251"],

Cell[TextData[{
 StyleBox["!ACHTUNG!", "Subtitle"],
 "\n\nCells for en-masse processing of images ahead\n\nIf individual frame \
filtering is desired, please skip to the respective section"
}], "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}},
 FontSize->16,ExpressionUUID->"5f01a689-899f-4f2d-b6c4-754c3a2b8431"],

Cell[CellGroupData[{

Cell["Compute the Mean Inverse Luminance (MIL)", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}},
 FontSize->24,ExpressionUUID->"f9e4fef7-8387-439a-a4eb-b62465154806"],

Cell["\<\
Defaults:

gaussianKernelScale=0;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, 3.838189200472759*^9, {3.843305379821919*^9, 
   3.8433053802637324`*^9}, 3.8458998789732313`*^9, 3.8459633836313944`*^9, 
   3.8459634399438086`*^9, 3.8459637243599377`*^9, 3.8474407562763147`*^9},
 FontSize->16,ExpressionUUID->"a29337f9-08d7-46d8-9f62-a1037aea11e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gaussianKernelScale", "=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845811305134037*^9, 3.8458114692910705`*^9}, {
   3.8458119269552507`*^9, 3.845812023445235*^9}, {3.845812078436823*^9, 
   3.845812266259036*^9}, {3.8458123166279087`*^9, 3.8458123673239307`*^9}, 
   3.845812563659105*^9, {3.845812696595659*^9, 3.845812833995626*^9}, 
   3.845812959019072*^9, 3.8458132673304358`*^9, {3.845813338354759*^9, 
   3.8458133470829573`*^9}, {3.845813520410965*^9, 3.8458135402359095`*^9}, {
   3.8458145847002416`*^9, 3.8458145851462927`*^9}, 3.845827274470806*^9, 
   3.8459079489462185`*^9, 3.845908112922145*^9, {3.845908146273973*^9, 
   3.845908193225349*^9}, {3.8459082288338394`*^9, 3.845908246552803*^9}, 
   3.8459082809857464`*^9, {3.8473439025355253`*^9, 3.8473439034870157`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"04adbd70-d8eb-4c79-b40b-1e0aeecf4bb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"meanInverseLuminance", "=", 
    RowBox[{
     RowBox[{"getMILseries", "/@", "images"}], "//", "Parallelize"}]}], ";"}],
   "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.845811305134037*^9, 3.8458114692910705`*^9}, {
   3.8458119269552507`*^9, 3.845812023445235*^9}, {3.845812078436823*^9, 
   3.845812266259036*^9}, {3.8458123166279087`*^9, 3.8458123673239307`*^9}, 
   3.845812563659105*^9, {3.845812696595659*^9, 3.845812833995626*^9}, 
   3.845812959019072*^9, 3.8458132673304358`*^9, {3.845813338354759*^9, 
   3.8458133470829573`*^9}, {3.845813520410965*^9, 3.8458135402359095`*^9}, {
   3.8458145847002416`*^9, 3.8458145851462927`*^9}, {3.845827274470806*^9, 
   3.84582727973473*^9}, {3.8459077352418776`*^9, 3.8459077386526117`*^9}, {
   3.845907800753378*^9, 3.8459078022514887`*^9}, {3.845908049410869*^9, 
   3.845908051221029*^9}, 3.846829674109688*^9, {3.8468297579404516`*^9, 
   3.84682975943583*^9}, {3.8546341411987114`*^9, 3.8546341442578487`*^9}, {
   3.8546342443018045`*^9, 3.8546342453430157`*^9}, {3.854634354355623*^9, 
   3.854634355575985*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"06959fb2-f402-49af-9b8c-9e4ea254d256"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot MIL for the Image Sequence", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}},
 FontSize->24,ExpressionUUID->"cce0578b-3f2b-44b7-88b6-7ece180f5c3e"],

Cell["\<\
Defaults:

rangeOffset=0.025;
fontSize=15;

totalVariationWeight=0.01;
totalVariationIterations=500;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, 3.838189200472759*^9, {3.843305379821919*^9, 
   3.8433053802637324`*^9}, 3.8458998789732313`*^9, 3.8459633836313944`*^9, 
   3.8459634399438086`*^9, {3.8459715880976*^9, 3.8459716003938923`*^9}, {
   3.845976133703529*^9, 3.8459761385951414`*^9}, {3.845976180636242*^9, 
   3.845976181940792*^9}, 3.84683849913651*^9, 3.847440216655612*^9, 
   3.8475175493404913`*^9, 3.8475212670965548`*^9},
 FontSize->16,ExpressionUUID->"a96c7ca9-cfa8-43fa-a047-2da8d1e25b93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rangeOffset", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanInverseLuminancePlotRange", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Automatic", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "rangeOffset"}], "+", 
          RowBox[{"Min", "@", "#"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rangeOffset", "+", 
          RowBox[{"Max", "@", "#"}]}]}], "\[IndentingNewLine]", "}"}], "&"}], 
      "@", "meanInverseLuminance"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845813019418721*^9, 3.8458130351945543`*^9}, {
   3.8458130673883853`*^9, 3.8458132450594716`*^9}, {3.8458133204511585`*^9, 
   3.845813353524245*^9}, {3.845813687867587*^9, 3.845813690210601*^9}, {
   3.8458137907310696`*^9, 3.8458138234664373`*^9}, {3.8458145955953217`*^9, 
   3.845814727066367*^9}, {3.8458270699905977`*^9, 3.845827085574891*^9}, {
   3.8459509288611994`*^9, 3.8459509403075523`*^9}, {3.8459761110924025`*^9, 
   3.845976115725278*^9}, {3.8459761482054167`*^9, 3.845976174469206*^9}, {
   3.8460501023552947`*^9, 3.846050109434465*^9}, 3.8460501627237163`*^9, {
   3.847345229664214*^9, 3.847345235783455*^9}, 3.8473453009834146`*^9, 
   3.847345345119734*^9, {3.8473461229910774`*^9, 3.847346123110758*^9}, {
   3.8473461609443197`*^9, 3.8473461857271495`*^9}, {3.8473462654080896`*^9, 
   3.8473462676706104`*^9}, {3.8473577738407955`*^9, 
   3.8473577739993715`*^9}, {3.847440224588903*^9, 3.8474402289243097`*^9}, 
   3.84751661548982*^9, {3.847517581075672*^9, 3.847517593923334*^9}, {
   3.854634034009385*^9, 3.854634035126173*^9}, {3.8546341067262073`*^9, 
   3.8546341067651043`*^9}, {3.8616837300099564`*^9, 3.861683730078822*^9}, 
   3.861700069499112*^9, {3.8617161452634096`*^9, 3.861716147989729*^9}, 
   3.8617826043761415`*^9, {3.861792208275926*^9, 3.8617922086479177`*^9}, {
   3.861799009850638*^9, 3.8617990099782457`*^9}, {3.861800595724184*^9, 
   3.8618006057942505`*^9}, {3.861800830377632*^9, 3.861800834316052*^9}, 
   3.86204536268861*^9, {3.862045425184575*^9, 3.862045428959368*^9}, {
   3.8620528073136063`*^9, 3.8620528091845474`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"2f1df84f-1196-4191-88be-f63569f2aa71"],

Cell[BoxData[
 RowBox[{"ListLinePlot", "@", "meanInverseLuminance"}]], "Input",
 CellChangeTimes->{{3.845813019418721*^9, 3.8458130351945543`*^9}, {
   3.8458130673883853`*^9, 3.8458132450594716`*^9}, {3.8458133204511585`*^9, 
   3.845813353524245*^9}, {3.845813687867587*^9, 3.845813690210601*^9}, {
   3.8458137907310696`*^9, 3.8458138618749948`*^9}, {3.8458145897723465`*^9, 
   3.8458146857867165`*^9}, {3.8458265197342987`*^9, 3.845826520073391*^9}, {
   3.845908301610368*^9, 3.845908305665806*^9}, 3.8468298239336557`*^9, 
   3.8468298585013947`*^9, {3.8468300088095355`*^9, 3.84683002324407*^9}, {
   3.846830266716416*^9, 3.8468302740594916`*^9}, {3.8475175952438045`*^9, 
   3.847517595955904*^9}, {3.848057392898085*^9, 3.848057408055522*^9}, {
   3.862052836826392*^9, 3.862052838722838*^9}, {3.862228497731529*^9, 
   3.8622285030443697`*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"c54990dd-ff35-4932-9a59-0cd5b04dae7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview Images ]]", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.846072312771467*^9, 3.8460723145559773`*^9}},
 FontSize->24,ExpressionUUID->"978af63b-2690-4320-882c-cf88e14169c1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"images", "[", 
     RowBox[{"[", "imageID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"imageID", ",", "1", ",", 
     RowBox[{"Length", "@", "images"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8458129106536946`*^9, 3.8458129289308157`*^9}, {
   3.8459085588027086`*^9, 3.84590856053741*^9}, {3.8473466947186804`*^9, 
   3.8473468185434237`*^9}, {3.8473468510237017`*^9, 3.8473468549750304`*^9}, 
   3.847440831756173*^9, {3.8474496409624577`*^9, 3.8474496502017508`*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"d8746e27-acf4-4ab6-a3db-c334caf6c94e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Background Correction & Artefact Removal", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}},
 FontSize->24,ExpressionUUID->"a654ea2e-e7cc-430a-851c-b6140cb16881"],

Cell["\<\
Defaults:

inpaintMaxSamples=300;
inpaintSampleNeigborCount=150;

upperLimit=Length@images;
imageStepSize=5;

selectedFrameIDs=Range[lowerLimit,upperLimit,imageStepSize];\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8375739800401664`*^9, 3.837573980272545*^9}, 
   3.8390603100973406`*^9, 3.839157486646391*^9, {3.839157809829609*^9, 
   3.8391578123568535`*^9}, {3.8468384498804026`*^9, 3.846838464442418*^9}, {
   3.846838506201025*^9, 3.8468385065520906`*^9}, {3.847180393856143*^9, 
   3.847180394202446*^9}, 3.84718098528971*^9, {3.8474405438601456`*^9, 
   3.8474405482125072`*^9}, {3.8474410616595297`*^9, 
   3.8474410619976215`*^9}, {3.847450137235363*^9, 3.8474501474271092`*^9}},
 FontSize->16,ExpressionUUID->"8d538b2c-f02e-48a9-852c-d7a84f188efd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inpaintMaxSamples", "=", "300"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inpaintSampleNeigborCount", "=", "150"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerLimit", "=", "600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upperLimit", "=", 
   RowBox[{"Length", "@", "images"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imageStepSize", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStepSizeSeconds", "=", 
   RowBox[{
   "frameDurationSeconds", "*", "averagingBinWidth", "*", "imageStepSize"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"images", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"upperLimit", "-", "lowerLimit", "+", "1"}], ")"}], "/", 
    "imageStepSize"}], "//", "Round"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedFrameIDs", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"lowerLimit", ",", "upperLimit", ",", "imageStepSize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedFrames", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"images", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "selectedFrameIDs"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8458154049878173`*^9, 3.8458154390670786`*^9}, {
   3.8458161972506323`*^9, 3.845816197587731*^9}, {3.845816275106436*^9, 
   3.8458162757547026`*^9}, {3.8458164013219447`*^9, 3.845816437049405*^9}, {
   3.8458167476820903`*^9, 3.8458167480261707`*^9}, {3.845816859940038*^9, 
   3.8458169199695106`*^9}, {3.845817141121002*^9, 3.845817154450358*^9}, {
   3.8458259087666144`*^9, 3.84582593716667*^9}, {3.84582598906384*^9, 
   3.845825998111134*^9}, {3.8458260421503134`*^9, 3.845826068478256*^9}, {
   3.8458265566635475`*^9, 3.8458265582702513`*^9}, {3.845826745689175*^9, 
   3.845826746783873*^9}, {3.8459086871776557`*^9, 3.845908691185211*^9}, {
   3.8459530502350497`*^9, 3.84595305057967*^9}, {3.8459638348474627`*^9, 
   3.845963835535261*^9}, {3.8459657955753164`*^9, 3.8459657960462604`*^9}, {
   3.845976253261324*^9, 3.8459762535251303`*^9}, {3.845995802845189*^9, 
   3.8459958032929983`*^9}, {3.8460484086153936`*^9, 
   3.8460484091273794`*^9}, {3.846054955113385*^9, 3.8460549946569204`*^9}, {
   3.8468383660094213`*^9, 3.8468383787224693`*^9}, {3.847180529081337*^9, 
   3.847180529625061*^9}, {3.847180738425765*^9, 3.8471807632164917`*^9}, {
   3.8471808038808947`*^9, 3.8471808042269707`*^9}, {3.847180979001525*^9, 
   3.847180982097247*^9}, {3.847440531284775*^9, 3.8474405646954308`*^9}, {
   3.8474406829172897`*^9, 3.847440682980122*^9}, {3.847441056588087*^9, 
   3.847441056847393*^9}, {3.860758616586135*^9, 3.860758617363897*^9}, {
   3.8615520476067595`*^9, 3.861552047797303*^9}, {3.8616146000933695`*^9, 
   3.8616146001502275`*^9}, {3.8616148156697206`*^9, 
   3.8616148157415285`*^9}, {3.8616176114517117`*^9, 
   3.8616176116352215`*^9}, {3.8616508611629324`*^9, 3.861650861376425*^9}, {
   3.861700214211878*^9, 3.861700214682616*^9}, {3.8617826228343487`*^9, 
   3.8617826230667243`*^9}, {3.861792233017336*^9, 3.8617922330801764`*^9}, {
   3.861799018363815*^9, 3.861799018610157*^9}, 3.8618007631796455`*^9, {
   3.8618740800017853`*^9, 3.8618740804237747`*^9}, {3.8620454855920377`*^9, 
   3.8620454858061876`*^9}, {3.8624789170349193`*^9, 
   3.8624789172343903`*^9}, {3.8625045246162424`*^9, 3.8625045248547606`*^9}, 
   3.862658388047613*^9, {3.86921784985404*^9, 3.869217850252305*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"1562329f-a763-44a9-a80e-8368a7d7bbb7"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"selectedFrames", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "selectedFrames"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.847441207136097*^9, 3.847441223148835*^9}, {
   3.847449687818159*^9, 3.847449698994273*^9}, {3.847449885122223*^9, 
   3.847449886513503*^9}, 3.847611169763078*^9},
 CellLabel->
  "In[199]:=",ExpressionUUID->"5196880a-26aa-4f76-9a02-42c321364a65"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cleanFrames", "=", 
    RowBox[{
     RowBox[{"getCleanFrame", "/@", "selectedFrames"}], "//", 
     "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.845815473074624*^9, 3.8458155718747673`*^9}, {
   3.8458156341075706`*^9, 3.8458156427396073`*^9}, {3.8458161712581396`*^9, 
   3.845816196610345*^9}, 3.845816244745625*^9, {3.845816385322728*^9, 
   3.845816387972642*^9}, {3.845817151538145*^9, 3.8458171817054744`*^9}, {
   3.845826937357755*^9, 3.8458269541750083`*^9}, {3.845908592993859*^9, 
   3.8459086709297304`*^9}, {3.846846008879717*^9, 3.846846028840887*^9}, 
   3.8474406487885537`*^9, {3.8474410420928497`*^9, 3.847441044500411*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"7d6d67f2-27cb-4bb2-99a3-ccf908522a51"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"cleanFrames", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "cleanFrames"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.847441207136097*^9, 3.847441223148835*^9}, {
   3.847449687818159*^9, 3.847449716097251*^9}, {3.84744987663492*^9, 
   3.8474498793696065`*^9}, 3.847611170875105*^9, {3.8617810093129063`*^9, 
   3.8617810128727684`*^9}, {3.8617810809696255`*^9, 
   3.8617810811931334`*^9}, {3.862750155467537*^9, 3.8627501565956783`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"c266a4a0-9fde-4ecc-a13a-821835931160"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Filtering", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.845826860574724*^9}},
 FontSize->24,ExpressionUUID->"5449dda7-ee6a-4f01-9df5-65dd4d4b5bf4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "getBM3DFilteredFrame"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "@", "getNMFilteredFrame"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBM3DFilteredFrame", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{"getBM3DFilteredFrame", "[", "image", "]"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"applyBM3D", "[", 
       RowBox[{"#", ",", "globalNoiseVarianceBM3D"}], "]"}], "&"}], "@", 
     "image"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getNMFilteredFrame", "[", "image_", "]"}], ":=", 
  RowBox[{
   RowBox[{"getNMFilteredFrame", "[", "image", "]"}], "=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonlocalMeansFilter", "[", 
      RowBox[{"#", ",", "globalNonlocalMeansRadius"}], "]"}], "&"}], "@", 
    "image"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8459638490509043`*^9, 3.8459638813275394`*^9}, {
  3.846068793627977*^9, 3.846068795466852*^9}, {3.846830847859561*^9, 
  3.8468308484853163`*^9}, {3.84683472805122*^9, 3.8468347433621492`*^9}, {
  3.8474411447090573`*^9, 3.847441144909521*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"51c0e3e4-8f56-4595-8335-6c096171a99f"],

Cell["\<\
Defaults:

globalNoiseVarianceBM3D=0.02;
globalNonlocalMeansRadius=3;


A good potential alternative (computationally cheaper) to keep in mind:
Binarize[#,0.55*dynamicThreshold[[imageID]]]&@ImageAdjust@BilateralFilter[#,5,\
23]&@cleanFrames[[imageID}]\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8375739800401664`*^9, 3.837573980272545*^9}, 
   3.8390603100973406`*^9, 3.839157486646391*^9, {3.839157809829609*^9, 
   3.8391578123568535`*^9}, {3.846838515059511*^9, 3.8468385224266553`*^9}, {
   3.847970351107999*^9, 3.8479703895162907`*^9}},
 FontSize->16,ExpressionUUID->"e9728bda-4375-4268-84d8-2c13b094040b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"globalNoiseVarianceBM3D", "=", "0.02"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"globalNonlocalMeansRadius", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"cleanFrames", "//", "Length"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.845826760830787*^9, {3.8458269558866143`*^9, 3.8458269561755657`*^9}, {
   3.8459509844537296`*^9, 3.8459510584596086`*^9}, {3.846068694591869*^9, 
   3.8460687091634293`*^9}, {3.846830839424073*^9, 3.846830840779592*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"eba34a3f-1a32-4306-9f20-e769e3c11291"],

Cell[CellGroupData[{

Cell["[[ Preview Frame Cleanup & Filtering Steps ]]", "Subsubsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.845826860574724*^9}, {
  3.84780410185818*^9, 3.847804116522992*^9}},
 FontSize->24,ExpressionUUID->"ad6d2d07-f4ef-473a-b829-10c8b0f5e593"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkFrame", "=", 
    RowBox[{"Last", "@", "imagesAveraged"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"flatCorrectedFrame", "=", 
   RowBox[{"flatFieldCorrect", "[", 
    RowBox[{"checkFrame", ",", "referenceFrame"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repairedFrame", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"textureInpaint", "[", 
      RowBox[{"#", ",", "inpaintMask"}], "]"}], "&"}], "@", 
    "flatCorrectedFrame"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredFrame", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NonlocalMeansFilter", "[", 
         RowBox[{"#", ",", "globalNonlocalMeansRadius"}], "]"}], "&"}], "@", 
       "\[IndentingNewLine]", 
       RowBox[{"applyBM3D", "[", 
        RowBox[{"#", ",", "globalNoiseVarianceBM3D"}], "]"}]}], "&"}], "@", 
     "repairedFrame"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"plotFrameCleanup", "=", 
  RowBox[{"plotFrameFilteringStages", "@", 
   RowBox[{"{", 
    RowBox[{
    "checkFrame", ",", "flatCorrectedFrame", ",", "repairedFrame", ",", 
     "filteredFrame"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.837502257189125*^9, 3.837502292396412*^9}, {3.8381868911710796`*^9, 
   3.8381868967512684`*^9}, 3.839060307784522*^9, {3.83914911016756*^9, 
   3.8391491406794715`*^9}, 3.8391578155114207`*^9, {3.8430480281766005`*^9, 
   3.8430480304399724`*^9}, {3.8433047461822596`*^9, 3.843304772788841*^9}, {
   3.843480096800641*^9, 3.8434801089041023`*^9}, 3.8434801935520334`*^9, {
   3.845816870090892*^9, 3.8458168764169755`*^9}, 3.84607059479617*^9, {
   3.847804043339384*^9, 3.847804085363318*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"8b1e7705-a4d3-4839-824e-17e3220475a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Process the Image Sequence", "Subsubsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.845826860574724*^9}, {
  3.847947576915681*^9, 3.8479475804681034`*^9}},
 FontSize->24,ExpressionUUID->"f9f3c547-d814-4334-bf29-bf12017e20ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"allBM3DfilteredFrames", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
          RowBox[{"getBM3DFilteredFrame", "@", 
           RowBox[{"cleanFrames", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "cleanFrames"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "cleanFrames"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allFilteredFrames", "=", 
    RowBox[{
     RowBox[{"getNMFilteredFrame", "/@", "allBM3DfilteredFrames"}], "//", 
     "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8458172418338385`*^9, 3.845817247330141*^9}, {
   3.845817331458172*^9, 3.8458173325961294`*^9}, 3.8458173682178717`*^9, {
   3.8458174028033857`*^9, 3.845817445913105*^9}, {3.8458177214981966`*^9, 
   3.8458177362437363`*^9}, {3.845817883794158*^9, 3.8458178843777103`*^9}, 
   3.8458183078348184`*^9, {3.845818677401764*^9, 3.845818682819216*^9}, {
   3.845818917161913*^9, 3.845818962112709*^9}, {3.845819017753421*^9, 
   3.845819026987774*^9}, 3.845826007846673*^9, {3.845826078822265*^9, 
   3.8458260928149137`*^9}, {3.845826960231741*^9, 3.845826960742386*^9}, {
   3.8458269908477573`*^9, 3.8458270236868715`*^9}, {3.8458271772145853`*^9, 
   3.845827178566021*^9}, {3.845827299711063*^9, 3.8458273181502824`*^9}, {
   3.8458999018603325`*^9, 3.845899903564773*^9}, {3.845899934469131*^9, 
   3.845899972164335*^9}, {3.8459001948919334`*^9, 3.8459002322201214`*^9}, {
   3.845909085194365*^9, 3.8459092211843624`*^9}, {3.8459092913055515`*^9, 
   3.8459093877542973`*^9}, {3.8459510691661153`*^9, 3.845951078014222*^9}, 
   3.845951143541052*^9, {3.8459524883231864`*^9, 3.8459524903894367`*^9}, {
   3.845982795155014*^9, 3.8459827980897903`*^9}, {3.8460687220572677`*^9, 
   3.846068726777299*^9}, {3.8468346459318256`*^9, 3.846834687322323*^9}, {
   3.847449925282922*^9, 3.8474499263859715`*^9}, 3.8474499911854973`*^9},
 CellLabel->
  "In[257]:=",ExpressionUUID->"6f151834-556c-421c-b9c5-09eee7746a71"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"allFilteredFrames", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "allFilteredFrames"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8476112168990707`*^9, 3.8476112176749954`*^9}, {
  3.8476113126676054`*^9, 3.847611340898676*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"1a22ec43-6718-48ce-b82c-d8f6d127b201"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Filtered Frames & IDs >>", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.845826860574724*^9}, {
  3.847441336707851*^9, 3.847441354059901*^9}},
 FontSize->24,ExpressionUUID->"4b501789-d90a-4123-b403-0402328a81cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compressedFilteredImages", "=", 
     RowBox[{
      RowBox[{"Compress", "/@", "allFilteredFrames"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredFramesFolder", "=", "\"\<Filtered Frames\\\\\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DirectoryQ", "[", 
      RowBox[{"output", "<>", "filteredFramesFolder"}], "]"}], ",", 
     "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "<>", "filteredFramesFolder"}], "//", 
      "CreateDirectory"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"k", "=", "1"}], ",", 
      RowBox[{"k", "\[LessEqual]", 
       RowBox[{"Length", "@", "compressedFilteredImages"}]}], ",", 
      RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Export", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "output", "<>", "filteredFramesFolder", "<>", "\"\<Frame_\>\"", "<>", 
          RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<.txt\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"compressedFilteredImages", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "compressedFilteredImages"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Filtered Frame IDs.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "selectedFrameIDs"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.854606529087934*^9, 3.8546065458660727`*^9}, {
  3.8546072033462467`*^9, 3.854607228360889*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"4952f92c-44af-42f8-b753-df0abec33af7"]
}, Closed]],

Cell[CellGroupData[{

Cell[">> Import Filtered Frames & IDs <<", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.845826860574724*^9}, {
  3.847441336707851*^9, 3.847441354059901*^9}, {3.8474415517797813`*^9, 
  3.8474415524765015`*^9}, {3.8474421777792006`*^9, 3.8474421850199537`*^9}},
 FontSize->24,ExpressionUUID->"dbe506f2-abf7-4f2d-87b7-5814948e0dce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inputFolder", "=", "output"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filteredFramesFolder", "=", 
   RowBox[{"inputFolder", "<>", "\"\<Filtered Frames\\\\\>\""}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.847441398164261*^9, 3.8474415226840076`*^9}, {
  3.84744157221341*^9, 3.8474416725637407`*^9}, {3.8474421506920605`*^9, 
  3.8474421691646795`*^9}, {3.8475160274979963`*^9, 3.8475160451857452`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"8de68d07-98be-4bae-a43b-553af0ba7429"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "filteredFramesFolder"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allFilteredFrames", "=", 
    RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Uncompress", "@", 
        RowBox[{"Import", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"filteredFramesFolder", "<>", "#"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "files"}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedFrameIDs", "=", 
   RowBox[{"Uncompress", "@", 
    RowBox[{"Import", "[", "\[IndentingNewLine]", 
     RowBox[{"inputFolder", "<>", "\"\<Filtered Frame IDs.txt\>\""}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.847441398164261*^9, 3.8474415226840076`*^9}, {
  3.84744157221341*^9, 3.8474416725637407`*^9}, {3.8474421506920605`*^9, 
  3.8474421691646795`*^9}, {3.8475160274979963`*^9, 3.847516049033471*^9}, {
  3.854627960365204*^9, 3.8546279617628393`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"6794502d-6119-4e76-a333-bec7b9744506"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MIL-based Solid Region Detection", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
  3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
  3.8458267315822296`*^9}, {3.845826855710351*^9, 3.8458268783665533`*^9}, {
  3.845827040038642*^9, 3.8458270422060313`*^9}, {3.8460723947875605`*^9, 
  3.8460723980516243`*^9}},
 FontSize->24,ExpressionUUID->"d910264e-c0ca-4c3b-8405-e86661d94767"],

Cell["\<\
Defaults:

totalVariationWeight=0.01;
totalVariationIterations=500;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, 3.838189200472759*^9, {3.843305379821919*^9, 
   3.8433053802637324`*^9}, 3.8458998789732313`*^9, 3.8459633836313944`*^9, 
   3.8459634399438086`*^9, {3.8459715880976*^9, 3.8459716003938923`*^9}, {
   3.845976133703529*^9, 3.8459761385951414`*^9}, {3.845976180636242*^9, 
   3.845976181940792*^9}, 3.84683849913651*^9, 3.847440216655612*^9, 
   3.8475175493404913`*^9, 3.8475212670965548`*^9, 3.862050810306426*^9},
 FontSize->16,ExpressionUUID->"58aedc44-b644-413a-9fcf-2ba375c3fc45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totalVariationWeight", "=", "0.01"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"totalVariationIterations", "=", "500"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8625045496552544`*^9, 3.8625045699658523`*^9}, 
   3.8626583747164035`*^9, {3.868721986562663*^9, 3.868722015754487*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"7653c26c-6347-4e21-8b6f-d827e047aaab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filteredMeanInverseLuminance", "=", 
   RowBox[{"getFilteredMILseries", "@", "meanInverseLuminance"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotMILseries", "=", 
  RowBox[{"MILseriesPlot", "@", 
   RowBox[{"{", 
    RowBox[{"meanInverseLuminance", ",", "filteredMeanInverseLuminance"}], 
    "}"}]}]}]}], "Input",
 CellLabel->
  "In[222]:=",ExpressionUUID->"80af1f50-7de9-4d40-bf50-7cdd4ad5e9bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<3_MIL_curve.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotMILseries", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9},
 CellLabel->
  "In[220]:=",ExpressionUUID->"2ad24b1e-3dd5-4d02-808e-122bce227845"],

Cell["\<\
Defaults:

thresholdFactor=0.85;
dynamicThresholdBias=3;
dynamicThresholdPower=15;
solidSegmentSizeThreshold=25;

Visualization:
medianFilterRadius=0;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, 3.838189200472759*^9, {3.843305379821919*^9, 
   3.8433053802637324`*^9}, 3.8458998789732313`*^9, 3.8459633836313944`*^9, 
   3.8459634399438086`*^9, {3.8459715880976*^9, 3.8459716003938923`*^9}, {
   3.8459892018869114`*^9, 3.8459892088712816`*^9}, {3.846045357950354*^9, 
   3.846045384254941*^9}, {3.846072405147425*^9, 3.8460724073395643`*^9}, 
   3.854627900610273*^9, 3.8546281710583873`*^9, 3.8616148395897455`*^9, {
   3.8617003023101845`*^9, 3.8617003053381844`*^9}},
 FontSize->16,ExpressionUUID->"ee5f9626-8676-4d63-ab9c-6f1bb62e1c4e"],

Cell[BoxData[
 GraphicsBox[
  {Thickness[0.002240645305848084], 
   FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIVIGYC4pr7P24Zn5Z2mDETCCqtHGD8MyCwx8rhQPe+
JpPHUnD+9mCriP/sCP73fR+3pl/jhPMPgtQvZofz08CABc5fcmv5Y0NmBod6
lqP9hupWDiz6v7gu8fy2L9kq+vv0OUuHnKkJhRafv9jbVkasMNVF8FWfNM87
K4Xg8/mvn5LKYemwQXqb7qk3X+3Fp17hzGCydGAFm/cdzofY/wPOD3jiecl0
8g97h6ZHx2dwWzp4bfU/ntz20z5CfPtFBjlLh+1eGyzm7GR0SIi948YsYeXQ
F9Htz7iBDc73B+kX5oTz1wrp8KXXCcD5hctLNvzjZ3fo8XrFYsJo5vAFFD7T
2ByW3N/HN+eyKZz/Ikv72/SzCP6BWlmL9CMI/qG25eGnFplCwsuZ3SEFZH6F
qQO3I5/XDE1OOF9mo9h8JgUeOB8cjzN5HLaY/ziUcsoUGn88Djyg8Pph6tAP
9o8g3L1g5TMl4Xz3NUeXM1hIwfmw9IDOh6UXAIFAAaY=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4jfFW0V/d6s5+F+cGPNvs5EDjG9fGbHCdC+C
bwwCh40cDLRWCl9QUXNoZDnab/jdyKHbxnNX2iFlB4emR8dnaJs4nD4DBDlK
DofaloefUjKD8/9+K30wZ6IFnP8HxH9o5VB9/8ct425lhyeJC6+Z3LdxeAqi
/dUc6kHmu9vB7T8CMi8Jwa/9bVVwLgPBX/rCQ+9/IYK/v1bWIr3FzmGD6pPm
eblqDlvMfxxK6bJz8DrBbjs7FMFPTQMCNgQf7E5BFYcSoDGn19k6pIPknyk5
LLm/j29Os41DOKdYu/F6RYh7/a0h4aKs6FAPcg+HFZwP8y+MvwLkvkZzB/c1
R5czVCg63BD65HhezMxhb37N25lblRwYQOCCicOLLO1v02VVIOoTjR0CbknX
JAqpQcJ3thHc/TA+zH8wPsz/4PBdiODD4hcAK7nkRw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYCYpnlLzz07PUdIsS3X2TwM3eA8QvWdN/OSDB3
cN9fK2uhru8wEwQyzR3Ep17hzGBC8EWh/BlQ/oss7W/T7+rB5f98K30w56Ke
g21lxArTWATfBspv4fVfP+WonkMjy9F+w3Bzh5pPGwKyZ+k5pIGAGpQvpQcx
t9fMwdRmb9A0Rl2HlNg7bsw7TB3+g8B8bTi//rdVwbkXWnD+Br28xYx3tBwO
AL2RzmIG54OtcTdzWA/lf4TyUdS3mDmwcHbJJ7/TctB4y7vPYKWZwxbzH4dS
Tuk4gIIlPcXKYQtI/R89OP/4rh29bAX6cP561SfN89Zi8qdP4K8ym43gnwGB
PVYOtSD3dyD4YPv5EHyfE+y2s7/qwPn1oHC7rgtxV5UNxP4Pug43pGsSjZYi
+FNB9q1G8PNB8XsAwQfHy0cbaHjqQsznsXWQmReneToAwQfLyyP4oj1er1im
6Dgsub+Pbw6zrcOft68PWCbrOCwFJqP/C20cMvI/tJ4s0Ya7twHkXnNNOP85
KF73asD5qaB4b8PkH2lbHn6qCcGHhac0yH0bEHwDrZXCF1Q04Xz/ixNj/jlr
w/lgf27UdCjZKvr7tJ25wyNQwm/QdPADqbts5sAECu88TUg4b0XwYekPxj91
2Glt5j9TSDqz0HKYBgrfalNIfPZqw/mQ+NKF82H5CxzPFoj8Bst/AKlsmP8=

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4v7gEpXp/cYOf7+VPpgz0cIBxld/y7vPoNLS
ocfrFYtJobHDkvv7+OZ8tnJITwOCY0YOPifYbWeH2jiIT73CmSFk5OB7cWLM
v8O2Dsmxd9yYJQwdtpj/OJTSZQdR/80AzgfTrxD86RP4q8xuGzjsr5W1SG9B
8Je+8ND7X4jg1/62KjiXgeAfaVsefirJzqF4q+jv03yGDiUgWs/O4T8I2BtB
zP9l46D6pHne2VdGDibGQMBsDeeD7ZtiAecfAPFdzBwcmh4dnxFt5HBD6JPj
eTcTh5kg8NMAYs89I7j9IOOMDyP49pURK0z3Ivj+oPDYjOD/AYXvQiO4/8H2
zDaChw+MHyG+/SKDnCGcz+u/fkqqhJFDI8vRfsNyY4j8OiMHCVC4L4K6z9MY
Qt80hccf2L/K5g7o8QsAF/zddA==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgAmJ+KG3f9Oj4DGcHB5vKiBWmay0dYPx6lqP9hs8tHWaC
gCaCr/qked5ZIQT/PwjIW8L5t6RrEo2+WsD5pw47rc3ch8nPX9N9O2MDgp8G
AmWWDuJTr3BmfELwYebD+DD7UeTVEXyY+9H56P7zOcFuO7vUHM6fEFyiMn29
Ody/MD7MPhgf5h4YH+ZfGB/mH3R+7W+rgnMVCH7JVtHfp+3M4f6F8WHmw/gw
+1Hk1RF8mPvR+TD/AQDmNuCV
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4pkgsNHFAUzPNHWA8Ve88ND7/9HU4cE+vjnG
TQj+Rr28xYx/nOH8nbe6/qZ+d3a4IfTJ8byYGZx/oFbWIr0FwX+apf1tuq0t
nO97cWLMv2YE/ypIf5utQ0iJyvT/NxD89uXhp4y2ODvsB5lnYuvAAAIZzg5L
7gMddtjGQf1J87yzp5ww+FMn8FeZZds4RIhvv8jwDsEH+8fKGc7Xn7Dgh2Gf
s8MW8x+HUnYh+DD3w/gw/4HDpxPh/2zOnwvSmZ1Rw+eKEwYfFr43pWsSjf46
OfQFAz0639Shx+sVi8lEZzjfoenR8RmHEXyw+78h+Lz+66ekdrjA+ejxBwDj
V9n5
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}}, {{{53.27340000000001, 24.5797}, {53.27340000000001, 
    24.8188}, {53.04689999999999, 24.8188}, {52.87970000000001, 24.8188}, {
    46.3828, 24.8188}, {46.215599999999995`, 24.8188}, {45.98909999999999, 
    24.8188}, {45.98909999999999, 24.5797}, {45.98909999999999, 
    24.342200000000002`}, {46.215599999999995`, 24.342200000000002`}, {
    46.3828, 24.342200000000002`}, {52.87970000000001, 24.342200000000002`}, {
    53.04689999999999, 24.342200000000002`}, {53.27340000000001, 
    24.342200000000002`}, {53.27340000000001, 24.5797}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIzIGYC4tjco/82KQc4fNl5q+tvqYUDjP/3W+mDORMt
HGaCgCyC7y8nluUrjeDvr5W1SBdB8MH6hQMcniQuvGZSb+Fw+LJ2qqRQgMOh
tuXhp4osHMLFt19kuOfvcEPok+P5aWYO5teO5poI+DuseOGh93+jqcOHDQHZ
s8r94HwFx4/JZ676wvkJIAM9fR3+gOxrNIPzweYbWcD5YHdNsXBwUS1lmhXh
6/AFZO5yKweWxZOsGFn9HBpYjvYbmts4hJSoTP8f4eewxfzHoZRfNg48/uun
pL7wc/A5wW47e6ktxLxKfzjfHWSeQACcHwHyj1mAQ38w0KB+GzgfbE6ENZyv
8ZZ3nwGnNSR8jKHhfdQKzudwAxq8C8E/cdhpbeY8K0h4WyP44PiwRfDB5rsh
+KpPmuedBfJ7vF6xmCy0cpAHhZ8n1D03rBysda7MelYZ4CAx9QpnxiNbOB8c
L/9sHVZ3385gKCbMD4Xy09OAIA8hDwpe34wAh15QeNy3hfsHnB7u2ziAhP9L
BDh8Bfl/qi08PcD02zc9Oj4jG8FfCop3RT84vxUUzWd8IPGfaA3nw+Ibxoel
r5Ktor9P1/lCwi3SFBJvsX5wPji9XUfwweHi5A8Jv4OmDn9igB6YBU2vYWYO
FRErTM/yQ+Pf1ByeX55naX+bHovIP7D8BAB/QoXm
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4uZAz7kNZoEOZ8DA2AHGZwABAROHDQ9fTt2k
guDvr5W1SP8SAOf3L/hh+OxTgAOv//opqRoI/pL7+/jmFCP4YOPvWMD5i0Hy
wpYONjpXZj37GODgfYLddraopUP78vBTRk8QfH85sSzf8wEQe49YOCyeZMXo
uwWqf7KFw38QaMbkF6zpvp0RYOGg4Pgx+cxEBL/b6xWLyVoEn/PngvTNpwIc
GlmO9hu2I/gw98P4MP+B9Z9E+P/F9vXMz2cg+OIeAX8k2jH5sPB9LCJ78uns
AIeDbUCPXjJ2iM09+m/TcQT/Le8+g5n3EHzhT47n074i+Ftbai5sVgyE89Hj
DwDRpdDW
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {{{
    74.9891, 24.5797}, {74.9891, 24.926599999999997`}, {74.70309999999999, 
    25.2125}, {74.35629999999999, 25.2125}, {74.01089999999999, 25.2125}, {
    73.72500000000001, 24.926599999999997`}, {73.72500000000001, 24.5797}, {
    73.72500000000001, 24.234399999999997`}, {74.01089999999999, 23.9484}, {
    74.35629999999999, 23.9484}, {74.70309999999999, 23.9484}, {74.9891, 
    24.234399999999997`}, {74.9891, 24.5797}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYC4h9s8TN8fEMdvmwIyJ5lbuuAwt8O5euGOoSL
b7/I8M/WISb36L9N3Aj+hAU/DJ+9CkHlnwpxiFFw/Jg8x9bhE8ic3SEON6Rr
Eo1UbR1sdK7MerY2xGGL+Y9DKbtsHLyqm/V9loU4nAEBHxuHDQ9fTt00Bcrf
Y+UwEwQSEXwJj4A/EsEI/rWjuSYN3pj8Lztvdf1tRfD318papKdYOci8fmQm
FYDgB8iJZfnGo8lPQPDB9geGOBSs6b6dEWDq4KZayjTLBegfoU+O591MHHq8
XrGYWIY4pMTecWPOMHYAKWMQRvDB/hFA8N/w7jOY+SsYzn+xfT3z8zfBDite
eOj9X2jsUBmxwvQsUP/Jw05rM9ch+OBwNDfByTfQWil8ocTEYckkK0ZfjhAH
jbcgi0wg4f0zGM4H2/8KwY8FxeflYIdboPhJRfD/fit9MOejMZwPdk+escN3
UHr4GuwwfQJ/lZk2wr8wPjgeEhB8sP8aQiDhGGnq8A2kvzME4t+Ppg5ty8NP
GR1AhHdBPPs5ScZQOH8RyD8CCH4aCIhh8k+A3DcPwYelB5h+GB/sfyYEH0wf
QaQfcPw/CXH4A/K/oa2DKyi+X4Q4qDxpnne2yhYSnz9CHCTmxWmePmDroGk1
6XQ9TygqXwaNrxPq4HOC3Xb2UluIf01CHThACanLFu7ep1na36bXQvMbbyg8
v8D4YPd8tIHzwf7fAs0vEqEO/cElKtP7bRxMjIFAHcFvCvSc22CG4MPy95L7
+/jmHLZxQM//ALBuziw=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4gA5sSxf5jCHM2Bg7ADjM4CAgIlD7bptSfUf
Q+H8Hq9XLCYHEfyY3KP/Nu0PdeD1Xz8lVQPBX3J/H9+cYgQfbPwdCzh/MUhe
2NKB8+eC9M37Qh28T7Dbzha1dAgpUZn+fwOCL/P6kZnUnFCH/bWyFulHLBwK
4tnPSTZC9U+2gJgbgMkvWNN9OyPAwuEt7z6DmXEIfoT49osMVQj+taO5Jg3T
Qx0aWY72G7Yj+DD3w/gw/4H1T0P4f2tLzYXNqQj+ExHZk0+DMfmw8N3w8OXU
TRmhDgfbloefumTsoGU16XT9FAR/162uv6mrEfwHQGcYH0LwmwI95za8Q/DR
4w8AymfKoQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4g0PX07d5BLu4H9xYsy/zUYOML59ZcQK070I
vjEIHDZyAAmfNQ93aGQ52m/43cjh2tFck4bXYQ4OTY+Oz9A2cTgDAgfCHA61
LQ8/pWQG5//9VvpgzkQLOP8PiP/QysFNtZRp1pMwhyeJC6+Z3LdxKIhnPydp
G+5QDzLf3Q5u/xGQeUkIfu1vq4JzGQj+0hceev8LEfz9tbIW6S12Di+2r2d+
7hDusMX8x6GULjsHG50rs57ZIvgMIGCC4At9cjyf9jXMoWSr6O/T62wh8hfC
HJbc38c3pxnqvpVQ9/pbO3zZEJA9a3qYQz3IPRxWcD7MvzD+CpD7Gs0dHgCN
MV4U5nADZJGYGcQ9J8Og9pg4TFjww/DZN6j6RGOHmnXbkupNwyHhO9sI7n4Y
H+Y/GB/mf3D4LkTwYfELAF4x89g=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYCYnGPgD8S0REOEeLbLzL4mTvA+AVrum9nJJg7
SL9+ZCYVEeEwEwQyzR2uHs01aQhG8K9A+TOg/P4FPwyf+SHkhT85nk/zjXCw
rYxYYRpr7iAE5dtA+Y9FZE8+9Y5waGQ52m8Ybu7QFOg5t8EtwiENBNSgfLMI
hxdZ2t+m95o57LzV9TdVOMIhJfaOG/MOUwcTYyB4Hg7nL5pkxeh7AcHn/Lkg
ffO5cIcDtbIW6SxmcP6nDQHZs9zNHDig/I9QPor6FjOHkBKV6f+B5mm85d1n
sNLMQdNq0ul6ngiH/SD5FCuI/iAEv8frFYtJIoL/Yvt65ucZmPzpE/irzGYj
+GdAYI+Vw2KQ+1MQ/GCQ/SEIvo3OlVnPBBH8w5e1UyX1Ihy2mP84lFJlA7Hf
MMLhhnRNotFSBH8qyL7VCH4+KH4PIPh/vpU+mPPRxgEUnMbqUPN5bB2+s8XP
8JFF8MHy4gj+1paaC5tZIxyW3N/HN4fZFhKu/8Mdlr7w0Pu/0MZBwfFj8pmH
4XD3HgG5dxaCPwGUXroQfAYQaMHkH2lbHn6qCcGHhec3kPs6EXxQsjo7HcGP
yT36b9NtBB+c/laGO5RsFf192s7cIUBOLMt3cbiD38WJMf8uQ+N7QbiDzwl2
29lbEXxY+oPxTx12Wpv5z9ThAdDbxrvCHaaBwrfaFBKfTxB8cHwBwxfGh+Wv
2t9WBecsEPkNlv8AdkKPWA==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4hNl++ZLhUc6/P1W+mDORAsHGF/9Le8+g0pL
h6KMiW9r/CMdltzfxzfns5XDGRBQiXTwOcFuOzvUxqEyYoXp2e8RDr4XJ8b8
O2zr0O31isVkZ4TDFvMfh1K67CDqNyD48o4fk8+sRfAjxLdfZFgV4bC/VtYi
vQXBX/rCQ+9/IYJf+9uq4FwGgn+kbXn4qSQ7hwkLfhg+2xbhULJV9PdpPTsH
YxBgjoSY/8vG4ea578GPdSMdTMDi1nA+2L4pFnD+ARDfxcxB3ZBjjQxXpMMN
oU+O591MHGaCwMYIh2KQ+feM4PaD7TmM4NuDAmIvgu8PCo/NCP4fUPguNIL7
36Hp0fEZs43g4QPjc/5ckL55F4L/jS1+hs/PCIdGlqP9huXGDnKtrwN3yEU6
SEy9wpmxyMRBqPnAqYWukRB33jSFxx/Yv8rmDujxCwDvseXf
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {{{
    107.48899999999998`, 24.5797}, {107.48899999999998`, 
    24.926599999999997`}, {107.20299999999997`, 25.2125}, {
    106.85599999999998`, 25.2125}, {106.51099999999997`, 25.2125}, {
    106.22500000000001`, 24.926599999999997`}, {106.22500000000001`, 
    24.5797}, {106.22500000000001`, 24.234399999999997`}, {
    106.51099999999997`, 23.9484}, {106.85599999999998`, 23.9484}, {
    107.20299999999997`, 23.9484}, {107.48899999999998`, 
    24.234399999999997`}, {107.48899999999998`, 24.5797}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYC4ogU6/v+ubEOXzYEZM8yt3VA4W+H8n1jHcLF
t19k+GfrsP/UQtdt2gh+jcg694dcaPxXMQ4xCo4fk+fYOtxRYWucejvG4YZ0
TaKRqq3D9XPfgx+fjXHYYv7jUMouG4eWA0ADj8U4nAEBHxuHF2qGHGu2QPl7
rBxmzASCRgTfv3d6nlAxgv8mcIdcazYm/8vOW11/WxH8/bWyFukpVg5Pls4+
olCA4M95v/yYdz2a/AYEH2x/YYxDwZru2xkBpg5A1y+dnQL0j9Anx/NuJg4g
7eaRMQ4psXfcmDOMHWJ3efIwGSP4CQIRllsMEPwtJ8r2zZdC8NcXZUx8yxPj
sOKFh97/hcYOG+YCTQTqP3nYaW3mOgT/Ezh+THDyDbRWCl8oMXHYLtf6OlAj
xkHjLe8+g5kmDgFA77+WRPDB9nMh+OD4/BztcAsUP6kI/t9vpQ/mfDSG88Hu
yTOGpAfRGIfpE/irzLQR/oXxXbZ9/nulAcE37XRMeLogxgEUjDMjTR0eVAET
yEqofz+aOlypeKlm+AAR3jxM2u1iirFwPtg/Bgh+ahoQmGHyT4DcNw/Bh6UH
mH4YH+x/JQQfTD9BpJ+MPSWTJVhiHf6A/G9o61CbBRTgiHVQedI872yVLSQ+
JWIdJObFaZ4+YOsASu5VOmh8GzS+T6yDzwl229lLbR18koAGhMQ6cLipljJ1
2cLd+zRL+9v0Wmh+042F5xcYH+yejzZwPtj/W2wg7rGIdegPLlGZ3m/jsEYm
KsXaHcH3AAVoGIIPy99L7u/jm3PYxgE9/wMAFfjRXQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {CompressedData["
1:eJxTTMoPSmViYGBwBGIQHZFifd9/apxD/pru2xkNtg4w/oyZQOBp5/BCzZBj
TUmcQ4T49osM5+wcyl8CBXwQfN27KmyNugh+y+vAHXKicQ5bzH8cSqmyc0hN
AwK2OIenWdrfptvaOew/tdB12+9YuHqwPTcRfJF17g+rriD44ixhfLqHYlHt
2xrr8CRx4TWT+XYOPuadjglrYx3+g0C8nUONvWncroWxDvtrZS3SWewcMvaU
TJaYE+twBgTm2ML5V4U+OZ6fhuCD1bfYOoTy6W6aOz/WIUbB8WNyjS3EvYsR
/D8rP17yXYXgtzsmPL2wCqEf7N91sQ7qb3n3Gey0dVjguu3z3y2xDj1er1hM
FO0c1gK9J7Iv1uGGdE2i0VQ7h9hdnjxMlxF8kPS6+wi+6M1z34Mfx0LMTUPw
wfKmCD7M/LfLj3mbP4yFxOcHW4crFcAIewANn/u2DmtkolKsl8c6XAf5P8zK
wcQYCID+8znBbjtb1AoS3oug5rNaOTz9DfRwL4Iv2wqM4DYEvzYLGIANmPyS
raK/T9+zhPPB4XXG0qF033wp/dZYh+UvPPT+H7SE+LcdwQfHUw+Czx9hueVE
X6wDj//6KaknLCHpYwuCz8Ok3S52E8HfMPf98mOPEfrnALnezxH8IwobijJe
IvgS+sAE9RGTX//bquDcCwQf5r+AHXKtr18i+DD7YHx2UACfxuT/+Vb6YI4g
gr/k/j6+OcoIPth+Qyt4+hefeoUz4xDCfHB8brB2uOvfOz3vFdS8RmtIfP2C
+t/C2kGg+cCphcD8B+P7JAlEWIYg+LD8DU6fkTYO6PkfAGn1zE8=
     "], CompressedData["
1:eJxTTMoPSmViYGAQB2IQLdB84NTC3DgHnxPstrOv2jrA+FvMfxxK6bJ1uOvf
Oz0vKc5BYl6c5ukNNg4mxkAQHOdQ+9uq4JyFjcONc9+DH7vGOag8aZ539pS1
g+5dFbZG3TiHP99KH8wptIaYJ4rgx+7y5GH6HAvn14isc3/4KtbhPwjw28D5
Jw47rc2UQ/CPQ/lTnLtznr+OhduvcvtnXdabWIeSraK/T9vZOJwBAZY4h97g
EpXp+20d6qcCNbDHOSx94aH3/yGC/2Xnra6/T20dnlxQuv2TD+p+LjuHPys/
XvJVinNITQMBO4crFS/VDC3iHG5I1yQaTbVzOA9UXueF4IPdk4zgw8Kvx+sV
i4khgg8LXwD/nK6X
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYCYt8kgQhLnTiHJ4kLr5nImzio3P5ZlyWD4NeI
rHN/KBXncEPok+P5b8YO/BGWW06IxTnIzIvTPD3B2CEBqH2LQJzDFvMfh1Ky
jB1Ywvh0N/HGOXC7qZYyRRk7PLmgdPvns1g4/8vfKxUv7yH4CiD7WhB8Gf27
KmwnYx0kpl7hzAgycXi7/Ji3+cVYiH0FJg4ePEza7UDz/C5OjPm32cRBtvV1
4I53sQ4Fa7pvZ1wwcZjwtsbelC/O4UCtrEW6i6kDzH9g/hYE37YyYoVprhmc
3xdcojI93tzhQRXQwz9jHTbq5S1m/GPukCvUfODUTgT/hZohx5oaBP978OOl
s0NiHQ62LQ8/5YTgR4hvv8jQZwbng8NHy8xhxcdLvkkZUP0yZg4lGRPf1uQj
+OKgAKxC8F26c57/7oTqt0LwP20IyJ7VjuD//Vb6YM5HM4ee6XlCzQUI/l3/
3ul5WQj+e1B4VsY6fNl5q+tvq7mD6M1z34NnxzrU/rYqOLfD3MEHFB5bEPw3
gTvkWh8j+FOcQRbGOvD6r5+SKoHgw8ITxp8JBqaQ9HItFpKe/ps4LJl9RGHD
rFiHOpB5HFB+FDT+GIzh4QVOD6+M4PyvIPc+RfCNQWCzkYMuMLk0ysbB+ejp
GQB7pUIS
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYpmoFOv72+Md/C9OjPm32cgBxrevjFhhuhfB
NwaBw0YOsbs8eZhWxzs0shztN/xu5CDb+jpwR1y8g0PTo+MztE0cyl+qGXKY
xDscalsefkrJDM7/+630wZyJFnD+HxD/oZWDTrvYzXPh8Q5PEhdeM7lv47Bd
DmjghniHepD57nZw+4+AzEtC8Gt/WxWcy0Dwl77w0PtfiODvr5W1SG+xc8jY
UzJZYku8wxbzH4dSuuwceJi028U2IvhrQBqWI/i1WUANGfEOJVtFf59eZ+tg
AvK3c7zDkvv7+OY02zjYm8bt8pSButff2qHdMeHpBS6ge0Hu4bCC82H+hfFX
gNzXaO7gY97pmCAa73BD6JPjeTEzhxZg8MnZxjswgMAFEwdVQ441MllQ9YnG
DgkCEZZbVkDDd7YR3P0wPsx/MD7M/+DwXYjgw+IXABiS12k=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYCYn7dTXPfJyc4RIhvv8jgZ+4A4xes6b6dkWDu
EG655URZUoLDTBDINHeI7j/0VSMBkz8Dyo9/ekHpdixCnptJu10MyLetjFhh
Govg20D5BhxrZKJiEhwaWY72G4abO3TnPP+9MjLBIQ0E1KD8wASHF1na36b3
mjlk7ymZLOGQ4JASe8eNeYepw24gl0ULwT/8VSOmXw7BB3EPySY4HKiVtUhn
MYPzP20IyJ7lbubwBcr/COWjqG8xc/j890rFS6B5Gm959xmsNHMosOW6vtgm
wWE/SD7FygEUPPviEfzYXZ48TOkIPiPQuzezMPnTJ/BXmc1G8M+AwB4rB9bG
qc7dGQi+eadjwtMEBB8U3DH2CD7IOQW+CQ5bzH8cSqmygdjvn+BwQ7om0Wgp
gj8VZN9qBD8fFL8HEPw/30ofzPloAwlPL6j5PLYOQF4YnyuCD5Z3QvDTJ76t
sbdMcFhyfx/fHGZbBxDX1CzBYekLD73/C20c5r5ffsxbHeHen3VZe0qYEXz3
h1Ui677Hw/ku24Ah/gGTf6RtefipJgQfFp5rQQZ8Q/B/r/x4yZcJEd7HvYEh
qILgA2NrvhR3gkPJVtHfp+3MHYCqkwQ4Ehz8Lk6M+XcZGt9sCQ4+J9htZ29F
8GHpD8Y/ddhpbeY/U4fiDKCPhRMcpoHCt9rUYf98Kf27Ggg+OL78EXxY/qr9
bVVwzgKR32D5DwDKYZc2
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4r9XKl6qPU1w+Put9MGciRYOML76W959BpWW
Dpd9kwQiHiY4LLm/j2/OZyuH/yBwOsHB5wS77exQGwf9uypsjVsTHHwvToz5
d9jWYeLbGnvTaQkOW8x/HErpsnPYXTJZgmUSgt8zPU+oeQKCb33fv3d6X4LD
/lpZi/QWBH/pCw+9/4UIfu1vq4JzGQj+kbbl4aeS7ByApofxTU1wKNkq+vu0
np2DMQjshpr/y8aBtXGqc/eFBAcTkDizNZwPtm+KBZx/AMR3MXPQ2TT3/fJ9
CQ43hD45nnczcUhPAwKg+4tB5t8zgtsPtucwgm9fGbHCdC+C7w8Kj80I/h9Q
+C40gvvfoenR8RmzjeDhA+NnP/+98uM0BJ/7+uIC220JDo0sR/sNy40dNGL6
D309keAgMfUKZ8YiEwfl2z/rsu4kOMwEgZum8PgD+1fZ3AE9fgFFP+jx
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}}}, {{{138.494, 26.165599999999998`}, {138.494, 
     26.487499999999997`}, {138.21899999999997`, 26.737499999999997`}, {
     137.922, 26.737499999999997`}, {137.57500000000002`, 
     26.737499999999997`}, {137.33799999999997`, 26.4641}, {
     137.33799999999997`, 26.165599999999998`}, {137.33799999999997`, 
     25.8078}, {137.634, 25.581299999999995`}, {137.90899999999996`, 
     25.581299999999995`}, {138.23099999999997`, 25.581299999999995`}, {
     138.494, 25.831299999999995`}, {138.494, 
     26.165599999999998`}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQrRHTf+hrQKLDkvv7+OZMNnWA8Q/Uylqks5g5aLeL
3Tznn+jw51vpgzkHzRy4mYAitgi+SdwuTx4jBL/DMeHpBa1Eh1OHndZm1iH4
TxIXXjPRR/DPgMAdU7j+mWBg6qB/V4Wt0RbBv/2zLmuPC4LPvkYmKsU90WGD
Xt5ixjWmDtEp1vf9PRMdUmLvuDHvQPBtKyNWmPoi+AZaK4UvlJjA7esPLlGZ
3m/sYLnlRNk+/USHRpaj/YblCP6MCfxVZtm4+RtB9scYO3TnPP+90hDqHx9j
h2Sgdb3GCD739cUFtmYIPix8T4LCR8/EAT38AZ1UslE=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYCYp1Nc98v35bi8GVDQPYsc1sHFP52KH9ZikO4
+PaLDP9sHRKeXlC6PRXBt+W6vrigFY1fmuIQo+D4MXmOrUOeUPOBU7kpDjek
axKNVG0dcp7/XvkxLcVhi/mPQym7bBwcQQYmpzicAQEfG4eSyRIsYVFQ/h4r
CO2A4K845m3eaYngf9WI6T9kisn/svNW199WBH9/raxFeoqVw8dLvkkCFgj+
ue/Bj5fao8lHIPhgc4HqC9Z0384IMHX4sxKowgjoH6FPjufdTBx+ALXP1klx
SIm948acYexgcFeFrVESic+xRiZKAsGPTLG+78+L4EdYbjlRxpbisOKFh97/
hcYON0AOAuo/edhpbeY6BP8TOH5McPINtFYKXygxcQD69quGSIqDxlvefQYz
TRxA3v/Kg+CD7WdF8MHx+TPZ4RYoflIR/L/fSh/M+WgM54Pdk2cMSQ9cKQ7T
J/BXmWkj/AvjAxXXZTkg+HOOKGwoCkhxmAkCkaYOBaAEEgL170dTh6w9wBgv
QIQ3a+NU5+4JCD7YPzMQfBNjIJiNyT8Bct88BB+WHmD6YfwokP8nIvhpIFCE
4JvE7fLkaUpx+APyv6Gtg4MpUKAlxUHlSfO8s1W2kPjsSXGQmBenefqArQMo
udtOQ+PPQ+MD84/PCXbb2UttHdQMgQasSnHgcFMtZeqyhbv3aZb2t+m10Pw2
DZFfYHywez7awPlg/2+xgbhnTopDf3CJyvR+G4dQPt1Ncxcj+MDYmeq8GsGH
5e8l9/fxzTls44Ce/wFiBdbf
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4gjLLSfK+FIdzoCBsQOMzwACAiYOK455m3ey
IvhHFDYUZbxNgfMLbLmuL36T4sDrv35KqgaCv+T+Pr45xQg+2Pg7FnD+YpC8
sKVDTP+hrxpAvvcJdtvZopYOkSnW9/2fIviM2u1iN2+lOOyvlbVIP2LhcMk3
SSDiLFT/ZAuHD8uBDtyKyS9Y0307I8DCIWtPyWSJPQh+nlDzgVMnEXzWxqnO
3TdSHBpZjvYbtiP4MPfD+DD/6QCdc+46wv/nvgc/XrofwZ8BsmAbJh8Wvn+v
VLxUO5jicLBtefipS8YONxaDQgTBv6B0+2fdIyR5kAVvEfyPoABgSYXz0eMP
AGy6zMU=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4pLJEixhm1Id/C9OjPm32cgBxrevjFhhuhfB
NwaBw0YOU527c56vTnVoZDnab/jdyOGrRkz/odZUB4emR8dnaJs4KN3+WZdV
kOpwqG15+CklMzj/77fSB3MmWsD5f0D8h1YOf1Z+vOTblOrwJHHhNZP7Ng6H
QAauS3WoB5nvbge3/wjIvCQEv/a3VcG5DAR/6QsPvf+FCP7+WlmL9BY7hzlH
FDYUbUh12GL+41BKl51DzvPfKz+uQ/D3gDSsQvCXzgZq6Ep1KNkq+vv0OlsH
BhCoSHVYcn8f35xmGwe2RmAIpEDd62/toNUudvNcNNC9IPdwWMH5MP/C+CtA
7ms0d+Bh0m4XS0x1uCH0yfG8mJkDKPi+lqRC7Llg4gAMnT0l3VD1icYOM/KE
mg+sgobvbCO4+2F8mP9gfJj/weG7EMGHxS8A3TrkBg==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4pLJEixhVmkOEeLbLzL4mTvA+AVrum9nJJg7
7JsvpX/XIs1hJghkmjsc+qoR02+G4B+E8mdA+ce8zTsdTRDyRRkT39YYpznY
VkasMI01dyiE8m2g/Bl5Qs0HjNIcGlmO9huGmzt8vOSbJGCQ5pAGAmpQvkaa
w4ss7W/Te80cLijd/lknluaQEnvHjXmHqQOIm8WA4ANdc+jrl1Q4H8TVAPIP
1MpapLOYwfmfNgRkz3JH8D+i8cHqW8wcIlOs7/t/TXXQeMu7z2ClmcONxQW2
XMJpDvtB8ilWDguAwaNihuAfUdhQlGGL4IO8a++IyZ8+gb/KbDaCfwYE9lg5
5Dz/vfKjHYI/9/1yYJAi+KDgPiSK4C8BOue6cprDFvMfh1KqbCD2q6Y53JCu
STRaiuBPBdm3GsHPB8XvAQT/z7fSB3M+2kDCUwFqPo+tA5C3p0QawQfLSyD4
574HP17Kn+aw5P4+vjnMtg4/gNzZPGkOS1946P1faOPAEsanu+lvKty9CU+B
MXgTwee6DgzQSwh+hyNQxTlM/pG25eGnmhB8WHjaggy4iOAnCURYbrmB4Ots
AobgLwTf4K4KW+PDVIeSraK/T9uZOwBVnyi7l+rgd3FizL/L0Pi+m+rgc4Ld
dvZWBB+W/mD8U4ed1mb+M3W4AQqAl6kO00DhW23qADR9qvN/BB8cX8DwhfFh
+av2t1XBOQtEfoPlPwCtqqFU
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYgOONTJRO9Ic/n4rfTBnooUDjK/+lnefQaWl
A1vjVOfuLWkOS+7v45vz2crBxBgI5qc5+Jxgt50dauOQJBBhuaUjzcH34sSY
f4dtHY4obCjKyExz2GL+41BKl53Dh+XHvM1TEfwDpxa6bktG8POEmg+cSkxz
2F8ra5HeguAvfeGh978Qwa/9bVVwLgPBP9K2PPxUkp0D0PROx4w0h5Ktor9P
69k5pIFAH9T8XzYOFltOlO1bnAZxN7M1nA+2b4oFnH8AxHcxc0h4ekHp9sQ0
hxtCnxzPu5k4zAQBoPuLQebfM4LbDzLO+DCCb18ZscJ0L4LvDwqPzQj+H1D4
LjSC+9+h6dHxGbON4OED4y+Q0r+rkoXg23JdX1zQmebQyHK037Dc2CGm/9BX
jTlpDhJTr3BmLDJxCOXT3TR3fRrEnTdN4fEH9q+yuQN6/AIA2kHfRg==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgAmJ+KD33/fJj3uEZDjaVEStM11o6wPj1LEf7DZ9bOpwB
gQAE/0TZvvlS3gh+GghkpcP5UyRYwvhSEfyJb2vsTeMw+flrum9nbEDwweaU
WTokCURYbklB8GHmw/gw+2F8pds/67ICEHyY+9H56P7zOcFuO7vUHM6fEFyi
Mn29Ody/MD7MPhgf5h4YH+ZfGB/mH3R+7W+rgnMVCH7JVtHfp+3M4f6F8WHm
w/gw+2F8mH9hfJj70fkw/wEA2xLSMQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI3IGYC4uNl++ZLHc904PNfPyW1w8IBxld90jzv7CwL
h/fLj3mbH810uC70yfH8MguH+SCBw5j8a1D+Etdtn/8eQMgf9zbvdDyAMO9P
Xdaekv2ZDp83BGTPmo7g//1W+mDORAsHlds/gSJQ+XALhysVL9UMN2Q6qIH0
e5k7XF9cYMs1P9NhxQsPvf8fTR2s7/v3To9D8E8tBDrAEsH/Hvx46WwTBB+k
/boxgg/yXqdhpsMt6ZpEo6+mDpd8kwQidDMdeEDh8cPUAWTcX51Mh1OHndZm
/kPwb4D8J2YG52/Qy1vMqGPm8FUjpv+QLlS9nZnDBSWgh/QyHbjcVEuZoswc
0kAgKdPhQNvy8FOXbBzinwJVpGY6XAWZ52brkP3898qPaUDzQe5JtXVgbZzq
3N2B4DNqt4vdnITg699VYWucisl/krjwmsl8BD9cfPtFhn22DlEpwBCbiOCD
jDvXj+BH9x/6qtGB4LOvkYlKqc90+AKKj+22DpZbTpTtK0fwQcG52AXBP6yw
oSjDFsEHh48JwjxY+MD4S2cfUdigheCDw0sNk+97cWLMv2YEH+ZfcHxrIvjn
QBGuj+CDw9MNk38GBHwQ/KkT+KvMtG0dsqD8KVA+TB4cX0JQ/7lCzXtq43AD
ZKFgpoNj06PjM6rNHMJBAcSX6SAzL07ztICZA3MYn+4mXkR6i9vlycP0OQPO
twCF52sEH6h67vvnmPxpIPfsRvBngoGpAxcoQ7xC8MHp6SOCfweUneZkwvn/
QRlqKYIPTv9LoeExxxSS31ZkOiy5v49vzmWoPDD/P8/S/jY91sKhZLIES9gx
qPocRHkBTm/1CD6sPAEAeU4XbA==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGItIGYC4hTr+/69/VkOpw47rc2MM3cIt9xyoqwry2GD
Xt5iRh1Lh/9XKl6qPc2E8z9c8k0SeJAJV8+vu2nu++cIfknGxLc1rzMdvuy8
1fV3q4XDFaDyiI+ZDnW/rQrOvbBwOO5t3ukokQXn8zBpt4vJIvgLXLd9/quC
4Mfv8uRhUs9yMNBaKXzhiYXDkgJbruvaWQ5nQOCOhUPGnpLJEjpZDnz+66ek
nkDwvU+w286eiuAvub+Pb06xCZwfo+D4MVkHwWcAAQETh56c579XCiL4/0GA
HZMPtv+MscMRhQ1FGUD1B9uWh5+6ZOywf76U/l0dBF+nXezmOXMEf3qeUPMB
JwR/wtsae9M4BD+cDxig6QjzYXyY/WcWAgMoFsEHh7czJh/mPxgf5n8YHxY+
MP7+WlmL9CMIPix8wf7xQIS/Q8LTC0reiPg5r3T7Z10Qgt9/6KtGTDhS/F5f
XGBbh+CDw7slC54+zn8Pfry0HZH+0NMjAGk2LWQ=
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
    0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYC4glva+xN47IdGlmO9ht+t3CA8beY/ziUYmXp
0OGY8PRCWLbD/lpZi3QTS4f4pxeUbnsi+Atct33+64Lgx/Qf+qrhgODPOaKw
ocgEwZ8iwRLGp4kwH8aH2X+94qWaoQmC/2flx0u+VlD1pxD8xff38c2ZjOAb
g0CzhYNJ3C5PHiDfrjJihWmthcMZELDIdrgu9MnxfJqFQ7jllhNlbNkOEeLb
LzL0mTjEpFjf97+Y5fB5Q0D2rOkWDkDP7/K8kOWwQS9vMeMaCwcLoPJ957Mc
/C5OjPm3GcHfCJLfg+DD3Js+ERiAdxH8cD7dTXMfY/Jh/v8PAvuz4OGj0y52
89zmLNTwXIPgm4D8OR+hH8aHmw/y3zoE/8Ml3ySBLQh+zp6SyRI7shy43FRL
mVZZOBw4tdB12/csh5Ktor9PnzN2+K4BtPFnlkNK7B035hXGEP/9znJY8cJD
7/9CY4cjX4EK/iH4DsDkocScDedPce7OeQ7kS0y9wpmxCageGP0ZrNlw88Hp
ywnKz7OAxD8wPd2Srkk0+mrhwMOk3S4WiZkeYXwAYMQw7g==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4ikSLGF8X7MdHJoeHZ9x28gBxrdH40eIb7/I
8M7IwSHh6QWlz9kOB9uWh58SMnb4DwLrsx3218papE+xgMunpgGBmB1cv8qT
5nlnrRB8m8qIFaa+uPklW0V/n86zc5gxEwg+ZjtsMf9xKKXLzuGIwoaijLcI
/hyQwAsEP+f575UfnyH0g9U/RZjPcX1xge0iqH9PWzgYcKyRiVqQ7XBd6JPj
+WUIPsw/6Hx9KH8fmvzyFx56/xst4OY/z9L+Nj3WwmGB67bPf59A5R8awd1n
D3LPXiOHD5d8kwSA7i8GuXeeEdx/MD7M/zA+LHy43VRLmXYh+LD4AwB1sdKo

    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4j0lkyVYluU4zAQDUwcYf8ULD73/H00d5kvp
31WZheB/D368dHYFgv+nLmtPSXmOww2hT47nxczg/AO1shbpLQj+0yztb9Nt
beF834sTY/41I/hXQfrbbB2WFNhyXc9H8HU2zX2/PC3HYT/IPBNbh1A+3U1z
g3McltzfxzfnsI2DvWncLk8dTP7UCfxVZtk2DjxM2u1ipgh+TP+hrxoeCP7f
KxUv1WJzHLaY/ziUsgvBh7kfxof57z8IRCP8H2655USZFYJvc9+/d7oeJh8W
vqadjglPLXIc+oJLVKbPN3W4cQ4YorEI/nml2z/rshD842X75kuVI/j7Ty10
3TYbwUePPwDILtm5
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}}, {{{241.07299999999998`, 24.5797}, {241.07299999999998`, 
    24.8188}, {240.84699999999998`, 24.8188}, {240.67999999999998`, 
    24.8188}, {234.183, 24.8188}, {234.01599999999996`, 24.8188}, {233.789, 
    24.8188}, {233.789, 24.5797}, {233.789, 24.342200000000002`}, {
    234.01599999999996`, 24.342200000000002`}, {234.183, 
    24.342200000000002`}, {240.67999999999998`, 24.342200000000002`}, {
    240.84699999999998`, 24.342200000000002`}, {241.07299999999998`, 
    24.342200000000002`}, {241.07299999999998`, 24.5797}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJrIGYC4rnvlx/zFs53KFjTfTvjgqkDjL/ihYfe/4+m
Dktct33+K4Dgfw9+vHQ2B4KvEdN/6OuHPAz+FvMfh1K4zOD8J4kLr5nomzmo
o/Fh8gdqZS3SXcwczivd/ln3Kc/hlnRNolGpmcOekskSLGr5Dhv08hYz3rFx
OKKwoShDM9/hqtAnx/Nutg7zpfTvqmjlO9wAqU+1hah3Q/BT04DAD8G35bq+
uCAQkw92z3wEP1x8+0WGfbYO6RPf1tj7IvgZIAt80ORdEfy9IAfZ5Dt82RCQ
PWs71D1mCP7xsn3zpdgR/D91WXtK/ufB+TqbgDHwLQ9u3tXFBbZc7xH8/yDw
GsHXaRe7ee45Jt/34sSYf80IPsy/LNpAgVcIPiy8YXxweHLlY/DPgIAPgj91
An+VmTaC/3Xnra6/orYOV3yTBCI48x2W3N/HN4fZFp5eePzXT0l9YePAwwR0
wNU8B8emR8dnVJs59OQ8/73yYp6DzLw4zdMCZg6mnY4JTy8g0tMUCZYwvq0I
fgEogtYg+Bmg8F+JyU+JvePGvAPBnwkGUPPWIvgg6z+uQ/CBlivd3orgTwBq
N92X59AXXKIyfb4pxP1HEXxwfHxG8M+CPPwbwf9wCRggLPlw88Dy3Aj+0tnA
FM2H4MPyHzoflj8BTdK28Q==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4js/67L23Mh38L84MebfZiMHGN++MmKF6V4E
3xgEDhs5/Fn58ZLvpXyHRpaj/YbfjRxi+g991ViT7+DQ9Oj4DG0Thw7HhKcX
puU7HGpbHn5KyQzO//ut9MGciRZw/h8Q/6GVQ4JAhOWWFfkOTxIXXjO5b+Og
ATLwSr5DPch8dzu4/UdA5iUh+LW/rQrOZSD4S1946P0vRPD318papLfYOTBo
t4vdvJbvsMX8x6GULjuHK75JAhFXEXyV20ANFxB8Hiagho35DiVbRX+fXmfr
kJoGBPPyHZbc38c3p9nGIef575Ufu6Du9bd2mPC2xt60CehekHs4rOB8mH9h
/BUg9zWaO5RkTHxb057vcEPok+N5MTMHUPDFzM53YACBCyYO8U8vKN3eCFWf
aOzw90rFS7WL0PCdbQR3P4wP8x+MD/M/OHwXIviw+AUAl0v62w==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4rc19qZxBgUOEeLbLzL4mTvA+AVrum9nJJg7
CDcfOLVQv8BhJghkmjuIrHN/WKWH4AtD+TOgfPGb574H6yLkc57/XvlRp8DB
tjJihWmsuUM2lG8D5ddn7SmZDOQ3shztNww3d1gtE5VirV3gkAYCalC+eoHD
iyztb9N7zRxmH1HYUCRX4JASe8eNeYepA4ibIYzgA10jso4XwQdx3YH8A7Wy
FuksZnD+pw0B2bPczRweQPkfoXwU9S1mDvFPLyjdBvI13vLuM1hp5iDf+jpw
h0yBw36QfIqVAyh4XPUQ/KnO3TnPDRF8kHcvGWPyp0/grzKbjeCfAYE9Vg4v
1Qw51hgh+Iza7WI39RD89SAPyiH4LUDnyKkWOGwx/3EopcoGYj+Qf0O6JtFo
KYI/FWTfagQ/HxS/BxD8P99KH8z5aAMJT2Wo+Ty2DuuLMia+VUDwwfLyCL60
/l0VNukChyX39/HNYbZ1AHEbJQsclr7w0Pu/0MbBJG6XJ48Qwr2PlwJjkAHB
z7flur74Rz6c/375MW/zr5j8I23Lw081Ifiw8FxSADTgO4J/vGzffKn/CL43
D5N2uwAi/E8vdN32mbnAoWSr6O/TduYO9/17p+cxFTj4XZwY8+8yNL4ZCxx8
TrDbzt6K4MPSH4x/6rDT2sx/pg7zpYA+5ihwmAYK32pTB6Dpf68IIfjg+FJD
8GH5q/a3VcE5C0R+g+U/AEpym1w=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4qcXlG7/LChw+Put9MGciRYOML76W959BpWW
Dv690/OE8gscltzfxzfns5VDehoQpBQ4+Jxgt50dauPw90rFS7XIAgffixNj
/h22ddC/q8LW6FngsMX8x6GULjuHIwobijLcEXydTXPfL3dD8JnD+HQ3uRY4
7K+VtUhvQfCXvvDQ+1+I4Nf+tio4l4HgH2lbHn4qyc5hfVHGxLceBQ4lW0V/
n9azc/gPAtFQ83/ZOLxUM+RYk1bgYGIMBMzWcD7YvikWcP4BEN/FzKHG3jRu
V2yBww2hT47n3UwcZoIA0P3FIPPvGcHtBxlnfBjBt6+MWGG6F8H3B4XHZgT/
Dyh8FxrB/e/Q9Oj4jNlG8PCB8WWiUqzveyL4rwN3yLUCw7eR5Wi/YbmxQ7XI
OveHSQUOElOvcGYsMnH4Hvx46eycAog7b5rC4w/sX2VzB/T4BQAoNdyk
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYCYt8kgQjLHQUO+2tlLdKnWDj4QPn7oHyY/HWh
T47nl1k4PKwSWee+vcDBoenR8RmnLRymOnfnPJ9a4FDPcrTf0N3OIef575Uf
pxQ4bNDLW8yYY+fwtsbeNA7I32L+41BKl50Dcxif7qaJCP5MEOhH8GWiUqzv
9xY4lGwV/X06D8G3qYxYYepr5yCNxofJqzxpnnfWys7Bddvnv1f6ChxS04BA
zM4hHURvQPgPJn+wbXn4KSFjuP4I8e0XGd4Zwflg/93Gzed2Uy1l2mUEd38x
yL3zjOD+g/ElWIACUxB8WPjA9IPVT0WYDwvf51na36bHIsJ/+QsPvf+NCP5+
tPiB8QEQNslc
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIJIGYC4oSnF5RuT01xSIm948Y8Q88Bxve5ODHmn7I+
nC8+9QpnhpO+A2vjVOfuCQh+xsS3NfaVKQ71v60KznnoOxSBBIJTHGbMBIJK
fYe/VypeqhmmOBiDgLOBA5/uprnv2VMckkH2vTBwMOBYIxP1IxnCX2Ho0OEI
tPFdssPjxIXXTOSNHHpynv9e+TbZ4eRhp7WZekYOEw591Yh5jeCnpwHBMwQf
rP4ugg92H5A/fQJ/lZk2gg82/74hnA9Wv87QgYdJu11MMMWhhdd//ZRWXQeQ
cR/TUhxSQfak6UDCoxeNPxWTfwYEchD8P99KH8wR1HVAD28Ayjixhg==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
    164.53199999999998`, 14.212899999999998`}, {208.6218, 
    14.212899999999998`}, {208.6218, 15.648059999999996`}, {
    164.53199999999998`, 15.648059999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIJIGYC4v8gcDzL4QwI+Gg4xPQf+qoxJcvB5+LEmH/K
eg5/Vn685GuX5SA+9QpnhpO+A8camagUcTQ+PyZ/Sntr1GUbBD8l9o4b8ww9
OP/Pt9IHcwR14Xx9rZXCF1p04PzUNBDQcbjzsy5rjwiCD3avdhaEjtdx+K4B
dHFglsPTxIXXTPR1HDL2lEyWKAGa//b1AUtlbYeIFOv7/nOzHGbMBIKbmg4g
5V/XZDlsd2h6dDxCwyHccsuJsm1A+Qn8VWbZ6g7hfLqb5m7PcnhTvFX0t7e6
w41z34Mf70TwGbTbxW7uQ/DPA6WXHkfwYeEZcEu6JjEIwQeb/xrBh4U3AFvu
t08=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJRIGYC4j91WXtK8rMdUmLvuDHP0HOA8ae0t0ZdttGH
88WnXuHMcILy0xF89sapzt0OCP7y2UcUNrzKcniepf1tuqyeA4N2u9jNbVkO
Z0DARwPOnzGBv8rstTqcH3BLuiYxSN1BhQ1o4PYshzfFW0V/e6s7/AeB/Qg+
WP44gn/+e/DjpccR+pcf8zbvPJkFcX+NOsTeF1D+HC0HG67riwtksx3Wqj5p
nuer4/Dl75WKl1nZDqlpIKAD9y86X2ZenObpCQj+n2+lD+YI6jqghx8AiV6c
bw==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
    219.38200000000003`, 14.212899999999998`}, {263.4718, 
    14.212899999999998`}, {263.4718, 15.648059999999996`}, {
    219.38200000000003`, 15.648059999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJRIGYC4vQ0ILhU4PA4ceE1k/uGDjD+9An8VWbaRg7+
SQIRlkD+ycNOazP1jBye/1758dJZBH/i2xp701MIfsVLNUOOUwj9kyVYwvhO
Fjh83Xmr66+okUPjVOfunJ0FEHvaDBxOlO2bLzW/wOH81bA3+tH6DiDj4ioK
HMSnXuHMcNJ3yN5TMlmiDJOfEnvHjVkCjT9DD87/8630wRxBXTj/DAjk6MD5
qSD706D8KgQ/xfq+f28vgi+yzv1h1Y4Chykg/3TrwsMH7N91iPCChR8AyauT
KA==
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxllHtI01EUx5e9Y1tz6pY6dfuVOWpBa0r0kM4YS1SixwpWaZa63SwxE7OU
WaCikYSrCB+VPWVEa5WUmdkylyZNJSqKJLSyB/4RaRQYFHbv77ff75IduH98
OPfec873nHs1mfs22aaKRKIpeKXgFYTXFumS5nMvEKjbLnhtnlDg+Z05w9iw
XwnioMVVii4EyI5tbQQYd356xlxDEPd9wUjD7EgYe74uU3YUQQw5L1WBrkrx
pv8ggruWldaJKhUsIrwXQSvhuGiB57/6YBGJ1QL3ElNpoPOnNq2mhGcGMmXW
Fbedk7idMru/E0G8AVtIDHefD4FbrpOiwSiAhB1tyY8RhBafLOyriIJxy3DT
GcyOofEBQ2oUnDZV5355QpmU/83/P/Pneb5O7o+OFthP8tExArPx8yjPTd8w
tKyWgfzEOa8v91BePbT+eG03Za1+lluF2eQsl9uPMUL+B3wt5vp0BrB3W/b9
gL9EA7gY9U0PgnpiWxnA6vQUNdL7zmJ3gZOy86tjTUIBZVav7QhGL91Q92k1
Av+jJ+ZY0u+rKqjLk5d32AN+SyRkr8IF4P4lubtcotYIePvr8J72QgTEbTgV
zs1PKYL3ZJ42hnP61yEg42SvnMfl6wno+1EJWJ38xGYExUR/vxJ0WD5XGz+f
Chh1dacuf4CgUj0ztnezgouP+y0iBmECs/N7K0TgCWJHgjl9WxAkFhpL/WlS
OEH0aKTM6lNGmY1nC/R7UAYdTy+aW7IQaIkeyWHAlpvF50uZrWeaAq6QhmdQ
5vWczI+qvWXxvjCBufdCWWyUptSNSARm3+NnscBNA65hvUkMPUXe8xEZlP+8
PDSycBdlMg67MT8k8bLEXB9xvhXK0uk5MyRAtuuzA/FyJEL91lirqv+3BJaS
AcwN9Nci49iB4Id37A5SSLj/oYbG4+eRZ1ZvL2X+v7lH6k0Khsn/0V/5JPXu

    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
    0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIdIGYC4v8g0J7hYGIMArIO34MfL53dkOGwN7/m7UxT
JYc0EHiXjsEP5xRrN16v6MAAAl8Q/GTr+/697Blw/sdLvkkCHBkO3Taeu9Ka
EHzla4+CGd4owPlgd8QLwvlg5xgLwM0Du28zP9w+GB/mHnT+jJkgwOuw/Ji3
eadohoP6J5WXs07yOujfVWFrVETwwfaZIPhFGRPf1thnwPXD+DDz+w991Ygx
R/B/1mXtKZHH5Fff/3HL2FsAzt8RbBXxP10QzgcbLynpcKJs33wpcwQf7J4A
NPngDIdo1QiZczIScH7Q28sfZySKOsTt8uRhisbkrxHS4Uu/JwtXj84H+1dT
Gm5fCijc1KTg7oHxYe5F57uvObqcgUMRzu8Exe8kRUg8yiPif/+pha7btBF8
cPj7IvjZz3+v/FiG4Gu1i908V53hsBbk3nUKDkDTJ0s0INInenoFAI+THi0=

    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 
    1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
    0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIdIGYC4v8gYJ7pYGIMArIO34MfL51tkOmwN7/m7UxT
JYc0EJiXgcEP5xRrN16v6ADWvxjBT7a+79+7HcH/eMk3SWBHhkO3jeeutCYE
X/nao2CGNwpwPticeEE4H+wcYwG4eWD3beaH2wfjw9yDzp8xEwR4HZYf8zbv
PJrhoP5J5eWsk7wO+ndV2BovIvhg+54g+EUZE9/WvEfoh/Fh5vcf+qoR8xzB
/1mXtafkPCa/+v6PW8beAnD+jmCriP/pgnA+2HhJSYcTZfvmSz1H8MHuYchE
lWfOdIhWjZA5JyMB5we9vfxxRqKoQ9wuTx4mbkz+GiEdvvR7snD16HywfzWl
4falgMJNTQruHhgf5l50vvuao8sZOBTh/E5Q/E6CpofziPjff2qh67bbCD44
/P8i+NnPf6/8qJYJ52u1i908p53psBbk3nUKDkDTJ0sYINInenoFACRTMnU=

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC0TH9h77yZDlEq0bInJsj5ADjrxHS4Uv/J+TQ
k/P890pOBN+80zHhKQeCf7xs33wpdgQ/4ekFpdusWQ5f9n3cmv5NyGGKBEsY
H5AvXDmp5OwSIYf575cf82bOcnjdlttt9FvQAWSdxp9Mh96Ibn/GD3wO0/OE
mg88QvBB1n+8hOAbcKyRidqTCbVPAM43MQaCzaJwfnoaELhJOYAddD7TYT1Y
vbQD0DW6mx4i+P9B4DGCr39Xha3xI4IPNudXpkPN/R+3jLOlHYCyU50/ZzoE
vL38cYaitAPH9cUFtp+g9qVJwfkiIP+yIPjqn1ReztKUhITX90wHsPI2CYcJ
b2vsTf8h+GdAgCULzp8vBXQRV5bDTBCQlITzwep4pOD8VJB6NhmH/SCBH5kO
c0Dqf8pA4vMBgj8DRO9F8MHhsTTTARR8xsWScH4VyL+rReH8YJB/F0Lj60Cm
ww3e22Kp33gcrlS8VDN8gOB/uOSbJAB0P4wPS09vQPFtjUhfsPQGAKlSEkI=

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}}}, {{{212.67299999999997`, 5.392189999999999}, {
     212.67299999999997`, 6.385939999999999}, {211.855, 7.243750000000002}, {
     210.806, 7.243750000000002}, {209.75599999999997`, 7.243750000000002}, {
     208.93900000000005`, 6.385939999999999}, {208.93900000000005`, 
     5.392189999999999}, {208.93900000000005`, 4.3999999999999995`}, {209.789,
      3.62031}, {210.806, 3.62031}, {211.83100000000002`, 3.62031}, {
     212.67299999999997`, 4.3999999999999995`}, {212.67299999999997`, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/eXvlYqXdVkOb9pyu41uizrA+CKVk0rOpog4pKcB
AZAvDOIvEXKY8375Me/yLIf+iG5/xgBBB5XbP+uyCrIc1D+pvJzFKeCwwHXb
578pWQ69IPkPfA75Qs0HTkUi+B8u+SYJ+CD4RxQ2FGU4ZjlU3/9xy9hbwEGn
XezmOesshx3BVhH/0wUh8qZZDl/2fdyavk3IocCW6/piE6j7XETgfJj7Yfw+
kPkC4nD+TBD4KeHA3jjVudsGal6YlINDwtMLSs5ZDgbGQFAsDebe9oXKi8nA
3Q/jx+/y5GFKR/DPLAR6uDDLoQbsfmmI+4HhI79rwb5UPSkHnU1z3y8Hhp/7
mqPLGW5IwMM35O3ljzMUxR3Qwx8AMaG4UA==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYC4nDLLSfK/mU5PHCNd5x1UcoBxpfftWBf6jtp
hz8rP17y/QaTl3FwSHh6Qek1gm9z3793+i0En2ONTFTK+SyH/d37mkycpR1M
4nZ58pzKcnjTltttVC3pkC/UfODUSUw+TD9LGJ/upqVZDq5rji5nqEDwa+7/
uGWcLe0QDzSOaTuCP0UCqGJnloOJMQgg+AdA9i+WhPN3BltF/HcXRFW/md9h
T8lkCZZtCD7MPnT+jJkgwOsQDuTOXZ/loP5J5eWsk7wQ8b0I/v5TC123HUbw
l88+orDhEoIPNvcygm8BDO59jxHmw/gw+3U2zX2//B6CnwFy8BkEH+ye01kO
YO8bC8D57qDwixCE88+eAQIeMTgfHL95Eg4lGRPf1gDdE6EaIXPuDjD8nLtz
nr9GxD8oeMJeZTmcAQNpB512sZvnnkP5PQg+LP3A+C0K7Kpnrkg63Dj3Pfjx
2yyHg6D4SJaExN9nBJ+HSbtd7CeCD0t/IpWTSs4+QfBh5gMAflwshA==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYC4g+XfJMEMrIdHrjGO866KOUA48vvWrAv9Z20
w3Tn7pzn8TB5GYc7P+uy9oQg+NcrXqoZuiD4S1y3ff5rke2wv3tfk4mztMP5
78GPlxpnO7xpy+02qpZ0YF8jE5WChQ/TP+f98mPe/NkOrmuOLmeoQPBr7v+4
ZZwt7QAybrYCgq+/ae775UrZDibGIIDgHwDZv1gSzt8ZbBXx310QVf1mfodw
Pt1Nc+URfJh96PwZM0GA1wHENZfMdlD/pPJy1kleiDp1BD8ixfq+vy6Cb28a
t8vTBsE/AwJI/CvA4I7wRZgP48PsP+5t3unogeCzhAEdbIrgg90D5IO9bywA
57uDwi9CEM4/C7KXRwzOB8dvnoQDD5N2u5httkOEaoTMuTvA8LurwtYYioh/
fmDwvA/Ohrj7jLTDEYUNRRmBUH4Pgg9LPzB+iwK76pkrkg4lGRPf1oRnOxwE
xUeyJCT+YhD85bOBOpIQfFj6E6mcVHL2CYIPMx8AgukoVw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQHdN/6KvGg2yHaNUImXNzhBxg/DVCOnzp+4QcONbI
RKXcz3boj+j2ZxQQdsjYUzJZ4g6CH5Nifd//JoJ/52dd1p4b2Q5f9n3cmn5N
yOG4t3mnI5AvXDmp5OwSIL9s33yp89kOMhvF5jMp8DtkTHxbY78z26EXpP8D
n0OBLdf1xVsQ/PfLj3mbr0Tw9e+qsDXOzXY40L2vyURZwOHGue/Bj6dmO8wE
A0EHnuuLC2z7EO6B8T3WHF3OICEK5589AwQ8Yg5TJFjC+G4i+Db3/Xun30Pw
YeGBzt8RbBXx/ziC/6Ytt9totqTD/lMLXbddznaYA3LOTxmHJSAPrUfw7U3j
dnlOQPDPA52/tDzboV2BXfXMFkk4/yDIf4dF4Xz1TyovZ60UdDgBCr/J2Q43
eG+LpX7jcXBIeHpBaTOC/wMY/CWXEXyY+4LfXv4446GgA3p8AwAnSO7T
     "], {{222.46399999999994`, 5.71875}, {220.45299999999997`, 5.71875}, {
     220.52499999999998`, 6.831250000000001}, {221.20000000000002`, 
     7.0218799999999995`}, {221.495, 7.0218799999999995`}, {
     222.42499999999995`, 7.0218799999999995`}, {222.45600000000002`, 
     5.90156}, {222.46399999999994`, 5.71875}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4q8aMf2HInMcolUjZM7NEXKA8dcI6fCl/xNy
CLfccqIsDMFnCePT3RSK4E9x7s55Hozg626a+355UI7Dl30ft6Z/E3KIf3pB
6XZgjoNw5aSSs0uEHHL2lEyWCMhxeN2W2230W9ABZN1XjxyH3ohuf8YPfA4p
1vf9e/URfAug9fvkEfy/VypeqnHC7BOA802MgWCzKJyfngYEblIOvCAHSec4
rAerl3YAuuZnnR6CfwYEDBD8Pys/XvK1Q/DB5rrnONTc/3HLOFva4cMl3yQB
hxyHgLeXP85QlHa4urjAlsseal+aFJwvAvIvC4Kv/knl5SxNSUh4Oec4gJW3
STjE7vLkYfJG8GfMBIJABD/n+e+VH4HhDxKeKSkJ54PdzSMF56eC1LPJOPSA
BFxzHOaA1P+UgcSnLoIPVseF4J8HhcenbAeQN42LJeH8KpB/V4vC+cEg/y6E
xhdPjsMN3ttiqd94HBa4bvv8VwfB3ztfSv9uAIIPS09vQPFtjUhfsPQGABa2
Go0=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIZIGYCYo2Y/kNf9+Q4pKcBwTEhBxhfYdeCfal9Ig48
TNrtYlsx+V/2fdyafk0IzheunFRydomAw/vlx7zN1+Y49EZ0+zN+4HNIsb7v
37sYwT+vdPtn3SRMvjEYCMH5YPO3IfgGIOliaQcVIDdrByb/PwjUy8DVo/NP
nwECHUUHG6Bzpnch+CWTJVjCgPxWBXbVMyXyDry6m+a+r4e6r0DGwd40bpdn
Ro6D65qjyxkiEHyY/Q4JTy8o1WPyYeEJ49uWONaeluFzAGnnmZbjcIP3tljq
Nx6Hr6AAX4jgdzgCNWxC8GHxcbB7X5NJsoADenwBAHqxxu0=
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/eXvlYqXfLkOM2aCAK8DjG9iDASb+R1S04DgXw6c
f8U3SSDib45D8NvLH2cwCsD5DCDgIAjnP3CNd5x1UcbhqLd5p+ONHAfXNUeX
M1Qg+DX3f9wyzpZ26JmeJ9T8AsHvcEx4euFVjsObttxuI2sEvwIkv1oSzt8Z
bBXx310Qzoe5z2LLibJ9zxH8koyJb2uuY/Jh/j2isKEo42GOg/onlZezTvI6
nP8e/HjpewT/R13WnpLPCD7IuQe+Ifh7SiZLsLDlwvno4QkA1Y+kSw==
     "], {{232.01300000000003`, 8.48438}, {232.01300000000003`, 
     8.746879999999999}, {231.80599999999995`, 8.929689999999999}, {
     231.57699999999997`, 8.929689999999999}, {231.345, 8.929689999999999}, {
     231.139, 8.746879999999999}, {231.139, 8.48438}, {231.139, 
     8.253129999999999}, {231.322, 8.04688}, {231.57699999999997`, 8.04688}, {
     231.822, 8.04688}, {232.01300000000003`, 8.253129999999999}, {
     232.01300000000003`, 8.48438}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {{{236.67299999999997`, 5.392189999999999}, {236.67299999999997`, 
     6.385939999999999}, {235.855, 7.243750000000002}, {234.80599999999995`, 
     7.243750000000002}, {233.75599999999997`, 7.243750000000002}, {232.939, 
     6.385939999999999}, {232.939, 5.392189999999999}, {232.939, 
     4.3999999999999995`}, {233.789, 3.62031}, {234.80599999999995`, 
     3.62031}, {235.83100000000002`, 3.62031}, {236.67299999999997`, 
     4.3999999999999995`}, {236.67299999999997`, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/eXvlYqXdbkOb9pyu41uizrA+CKVk0rOpog4pKYB
AZAvDOIvEXKY8375Me/yXIf+iG5/xgBBB5XbP+uyCnId1D+pvJzFKeCwwHXb
578puQ69IPkPfA65Qs0HTkUi+B8u+SYJ+CD4RxQ2FGU45jpU3/9xy9hbwEGn
XezmOetchx3BVhH/0wUh8qa5Dl/2fdyavk3IocCW6/piE6j7XETgfJj7Yfw+
kPkC4nD+TBD4KeHA2jjVudsGal6YlINDwtMLSs65DgbGQFAsDebe9oXKi8nA
3Q/jx+7y5GFKR/DPLAR6uDDXoQbsfmmI+4HhI79rwb5UPSkHnU1z3y8Hhp/7
mqPLGW5IwMM35O3ljzMUxR3Qwx8AZK+4kQ==
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGITIGYC4v2nFrpu085zmDETBHgdYHwTYyDYzO/woy5r
T4k0gq9y+2ddlgQmf2ewVcR/d0E4X37Xgn2peRJwPth8SWmH6XlCzQf48hwe
uMY7zroo4/Dhkm+SwJdcOJ9Fu13s5i0En2ONTFTK+VyH7SDz26UcDEACZ3Id
RConlZw9IumQsadksgQWPky/ClvjVOfluQ6ua44uZ6hA8Gvu/7hlnC3t0ANy
0A4E/8hXjZj+XbkQ/xkj+Ae69zWZLJaE82H+RVEPDI+SjIlva7Yj+DD70Pmw
8J4vpX9XZVOug/onlZezTvI6XAEGR8ReBP9qxUs1wyMIfiif7qa5pxF8nuuL
C2yvIfjvlx/zNn+IMB/Gh9kPdO2hrxcQ/Bvnvgc/PovJh/kPhc8uDuevF9Lh
S4+Tcpjwtsbe9FEuJL7fSTuAguPQRwQfFBz2jHlw/hQJljA+1jyH/ohuf8YJ
UnA+WL5PAs6H2Q/jw9wHil4WJgQfZh86H+b/Aluu64v/IMJnCUiAPQ/Oh6VH
GF/dEJjAxBD8MyCggOCj5xcAVyFknQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}}}, {{{271.094, 26.165599999999998`}, {271.094, 
     26.487499999999997`}, {270.81899999999996`, 26.737499999999997`}, {
     270.52199999999993`, 26.737499999999997`}, {270.17499999999995`, 
     26.737499999999997`}, {269.93800000000005`, 26.4641}, {
     269.93800000000005`, 26.165599999999998`}, {269.93800000000005`, 
     25.8078}, {270.234, 25.581299999999995`}, {270.50899999999996`, 
     25.581299999999995`}, {270.8310000000001, 25.581299999999995`}, {271.094,
      25.831299999999995`}, {271.094, 26.165599999999998`}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQvd79YZXIpwKHJff38c2ZbOoA4x+olbVIZzFz0L+r
wtb4scDhz7fSB3MOmjnMlwKKvEDwN58o2zf/EYIfv8uTh+l+gcOpw05rM+sQ
/CeJC6+Z6CP4Z0Dgjilc/0wwMHUw4FgjE/UCwW8Xu3nu+2sEf/775ce83xY4
bNDLW8y4xtThuLd5p+O7AoeU2DtuzDsQfNvKiBWmvgi+gdZK4QslJnD7+oNL
VKb3Gzts//z3SsXDAodGlqP9huUI/owJ/FVm2bj5G0H2xxg73PfvnZ73COof
H2MHkHUJjxF8+dbXgTueIPiw8D0JCh89Ewf08AcAkqDIDg==
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYCYk8eJu12tiKHLxsCsmeZ2zqg8LdD+f8KHcLF
t19k+Gfr8Hjp7CMK3xD8wB1yra/fovGfFjrEKDh+TJ5j65C9p2SyxKNChxvS
NYlGqrYOL9UMOdbcK3TYYv7jUMouG4dgkIF3Ch3OgICPjcPbGnvTuBtQ/h4r
h5kgcBrBbxe7ee77cQR/vfvDKpFjmPwvO291/W1F8PfXylqkp1g5rJaJSrE+
juBL699VYTuNJn8dwQfbD1RfsKb7dkaAqYMBxxqZqCNA/wh9cjzvZuIA0t54
sNAhJfaOG3OGscPpha7bPm9H8L3NOx0TkPjxTy8o3d6I4N/3752et67QYcUL
D73/C40d5ksBTdxR6HDysNPazHUI/idw/Jjg5BtorRS+UGLiAPTtOvethQ4a
b3n3Gcw0cQB5f91GBB9s/1oEHxyfKwodboHiJxXB//ut9MGcj8ZwPtg9eUD/
gNLDhkKH6RP4q8y0Ef6F8Y8obCjKOI3gN0x17s65XAgJx0hTh9egBHIV6t+P
pg4ZE4Ex/hgR3ts//71S8RnBB/vnO4IPjucfmPwTIPfNQ/Bh6QGmH8ZPAPn/
M4KfngYETxB83ySBCMs3hQ5/QP43tHW4DBIApm+VJ83zzlbZQuLzY6GDxLw4
zdMHbB1AyT3wGxr/FxofmH98TrDbzl5q63AcZABDkQOHm2opU5ct3L1Ps7S/
Ta+F5rdviPwC44Pd89EGzgf7f4sNxD0/Cx36g0tUpvfbOMTvAqr4i+ADY+fv
FaB9MD4sfy+5v49vzmEbB/T8DwAdfON2
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
    0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYC4uPe5p2OZkUOtb+tCs5ZmDr8Xvnxkq8Rgh+4
Q671tWGRQ8Ga7tsZAqYOQNUJTw2KHLaY/ziUssrEAaQ9Qb/Iwe/ixJh/zSYO
m0+U7ZuvV+Sw5P4+vjnFJg45z4EmqiD4G4oyJr5VQvDB9vEg8euy9pTIFjls
0MtbzJhj6qB/V4WtUR5qX5epg+u2z3+vAM17kaX9bfpZU4dqkXXuD9WKHLjc
VEuZXpk6TM8Taj4AtD9CfPtFhjgzB5j/wPxzCP4NoU+O59vM4Xz1t7z7DCot
HF6DPKxZ5OB9gt12tqilw/nvwY+XSiL4b2vsTeO4EHwDjjUyUQxFDtEKjh+T
Yyzg/E8bArJnLTeH88Hh42zuMP/98mPerEUOPiD9puYO/r1AF7Mj+JZbgAHI
ieAzh/HpbuKF6g9G8Hu8XrGYLETwp0/grzLjtnAQv3nuezA7gq/dLnbzHCuC
Dw5PoPl9wSUq0+dbOFS8VDPkECpyEJ96hTPjkgUkPCQQ/PXuD6tEVBB8CRag
hVpFDstfeOj9N0TwYeEJ45sYA8FmM0h6UShyqAOlJwkzB5moFOv7gkUOEiDz
lEwhfEZo/EmZwMMLnB6YEfwJIPf+N4bzz4CBsUM9MLlMNkLw0dMzAHpgIx0=

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4rc19qZxLUUO/hcnxvzbbOQA49tXRqww3Yvg
G4PAYSOHv1cqXqo1Fjk0shztN/xu5LDe/WGVSF6Rg0PTo+MztE0cjihsKMpI
LnI41LY8/JSSGZz/91vpgzkTLeD8PyD+QysHA441MlE5RQ5PEhdeM7lv4yCy
DmhgU5FDPch8dzu4/UdA5iUh+LW/rQrOZSD4S1946P0vRPD318papLfYOTRM
de7OaS5y2GL+41BKl53DSzVDjjVNCP5EkIYGBJ+9EaihoMihZKvo79PrbCH+
Ti9yWHJ/H9+cZhuH7Z+BIRALda+/tcOJsn3zpSKB7gW5h8MKzof5F8ZfAXJf
o7mD5RagSHSRww2hT47nxcwcQMG3LrXIgQEELpg4rC/KmPi2AKo+0dihPmtP
yeQGaPjONoK7H8aH+Q/Gh/kfHL4LEXxY/AIA5xrlyg==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYC4rc19qZxJ4ocIsS3X2TwM3eA8QvWdN/OSDB3
EG4+cGrh8SKHmSCQae4gss79YdUxBF8Yyp8B5YvfPPc9+ChCPuf575UfjxQ5
2FZGrDCNNXfIhvJtoPz6rD0lk4H8Rpaj/Ybh5g6rZaJSrA8XOaSBgBqUv7/I
4UWW9rfpvWYOs48obCjaVuSQEnvHjXmHqQOIm7EawQe6RmTdUgQfxHUH8g/U
ylqks5jB+Z82BGTPcjdzeADlf4TyUdS3mDnEP72gdBvI13jLu89gpZmDfOvr
wB1bihz2g+RTrBxAweN6DMGf6tyd8/wkgg/y7qXTmPzpE/irzGYj+GdAYI+V
w0s1Q441pxB8Ru12sZvHEPz1IA9uQ/BbgM6R21vksMX8x6GUKhuI/UD+Dema
RKOlCP5UkH2rEfx8UPweQPD/fCt9MOejDSQ8d0PN57F1WF+UMfHtDgQfLL8d
wZfWv6vCtrnIYcn9fXxzmG0dQNzGjUUOS1946P1faONgErfLk2cVwr2PlwJj
cAaCv10OGKBTEPzvwUAVkzD5R9qWh59qQvBh4Rm8A2jAZAQ/2fq+f+90BN+b
h0m7fQWCf3qh67bPs4scSraK/j5tZ+4AUp03q8jB7+LEmH+XofE9s8jB5wS7
7eytCD4s/cH4pw47rc38Z+owXwro4wVFDtNA4Vtt6gA0/e+VVQg+OL72Ifiw
/FX726rgnAUiv8HyHwCUeLni
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYm/zTscE9mKHv99KH8yZaOEA46u/5d1nUGnp
sP3z3ysVrMUOS+7v45vz2crhDAj8KnLwOcFuOzvUxiHZ+r5/7/siB9+LE2P+
HbZ1mOrcnfP8fpHDFvMfh1K67By028VunruL4E+WYAnjQ+Jn7ymZLHGnyGF/
raxFeguCv/SFh97/QgS/9rdVwbkMBP9I2/LwU0l2DuI3z30PBtpXslX092k9
O4f0NCD4BDX/l42Df+/0PKG/RQ4mxkDAbA3ng+2bYgHnHwDxXcwcHi+dfUTh
S5HDDaFPjufdTBz+gwDQvcUg8+8Zwe0HGWd8GMG3r4xYYboXwfcHhcdmBP8P
KHwXGsH979D06PiM2Ubw8IHxmw+cWuj6AMEP3iHX+hoYvo0sR/sNy40dHlaJ
rHP/WeQgMfUKZ8YiE4f4XZ48TMzFDjNB4KYpPP7A/lU2d0CPXwC22ugy
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgAmJ+KM2o3S5281qxg01lxArTtZYOMH49y9F+w+eWDjNB
4DKCPyNPqPnABQQ/PQ0IEhD8GnvTuF2xCP6flR8v+UZh8vPXdN/O2IDgg4xJ
K7N0SLG+798bi+DDzIfxYfbD+EcUNhRlXEbwYe5H56P7z+cEu+3sUnM4f0Jw
icr09eZw/8L4MPtgfJh7YHyYf2F8mH/Q+bW/rQrOVSD4JVtFf5+2M4f7F8aH
mQ/jw+yH8WH+hfFh7kfnw/wHANvC1Mk=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4rc19qZxISUO/hcnxvzbbOQA49tXRqww3Yvg
G4PAYSOHv1cqXqoFljg0shztN/xu5LDO/WGViF2Jg0PTo+MztE0cjihsKMow
LnE41LY8/JSSGZz/91vpgzkTLeD8PyD+QysHA441MlE2JQ5PEhdeM7lv4yAC
MjCoxKEeZL67Hdz+IyDzkhD82t9WBecyEPylLzz0/hci+PtrZS3SW+wcGqY6
d+cElzhsMf9xKKXLzuGlmiHHmiAEfyJIQwCCz9YI1OBQ4lCyVfT36XW2DiYg
f5uXOCy5v49vTrONw7bPwBDQhbrX39rhRNm++VKaQPeC3MNhBefD/AvjrwC5
r9HcwXILUES7xOGG0CfH82JmDh7A4FtnWuLAAAIXTByAoTPxrQNUfaKxQ0PW
npLJAdDwnW0Edz+MD/MfjA/zPzh8FyL4sPgFAG8L4Dk=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQBWIQLbLO/WHVghIH28qIFaay5g4sYXy6m+aXOMQoOH5M
fmPmIHbz3PdgIJ8BBB6YOTBpt4vdnFPiIDH1CmfGJjMHKf27KmxTSxxk5sVp
nhYwc4jb5cnD1FvicEPok+P5a6YOJ8r2zZdqR/DPgEADgm/R6ZjwtKrE4evO
W11/Vc3gfB7/9VNSfyD4W8x/HEqZZe6wBWQgUP9/EHhvATGvpcRB/S3vPoNK
SwdDjjUyUV0lDvtrZS3SVawcNhRlTHw7qcThxGGntZnzoPxZCP6bwB1yrcsR
fLA/V5U4+FycGPNvsSWc//db6YM5Ey0dGqc6d+esLHFoZDnab5hu6YAefgCs
1pdl
     "], CompressedData["
1:eJxTTMoPSmViYGAwAmIQLXbz3PfgxSUOtpURK0zPmjhcVLr9s25HicP+WlmL
dBUrh4De6XlCO0sc6n9bFZzzQPBvSNckGoXi5v8HgXorh6cXgAZuK3Ho8XrF
YrLQyiFrT8lkiS0I/pvAHXKt6xH8GpF17g/XQO1PsXL4s/LjJV8gf/kLD73/
glYOOu1AF68scdhi/uNQSpaVA0h51ZISh+kT+KvMbls5bCjKmPh2FoK/QEr/
rkobgg9yTl1eiYP6W959BpaWcP6htuXhp4rM4fxbIP+YmkH4VSUOM8HA1EGu
9XXgjjYE33Xb579XJiD4YPfNhPIlzRzWyESlWM8Fho/QJ8fzYWYOHaAAnwl1
f5cpnH8A5N8WUweQc9mAfL+LE2P+OZs6GHIATZhW4hCj4PgxeY4JxLypJQ4M
IBBgApHvK3G4DXLvU2MHTx4m7Xag+1Ji77gxZxg7PKwChlA9gg+On2oE/4pv
kkBEKYL/I/jx0tkFJQ4nDzutzcwzdnjxGxgB2VD3txk7gKLrdWGJwwpQfCw0
dvhZB4zR4hKHzxsCsmd9R/A1QOEraQLn87ipljJ5mTjsAjkQqF/1SfO8s1Um
kPSRg+CngUAGgt8w1bk7J7nE4UWW9rfptgg+2PybxnD+Rr28xYwxxg7A2K+x
z4bGt7axAyh6KqoRfFByEZmC4ANDS+zmghIHXv/1U1I1TBzQ8wMA4GZkkg==

     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4gf+vdPzPpU4nAEDYwcYnwEEBEwcOsRunvv+
FsGf6tyd8/whgv8mcIdcK5DP679+SqoGgr/k/j6+OcUIPtj4OxZw/mKQvLCl
w8MqkXXuQL73CXbb2aKWDglPLyjdvovgbzlRtm/+jRKH/bWyFulHLBxkolKs
71+E6p9s4aDTDnTgUUx+wZru2xkBFg4ZE9/W2J9E8LP2lEyWuIDgb/v890rF
9RKHRpaj/YbtCD7M/TA+zH8g50hdR/hfRv+uCttpBL8BZMExTD4sfDfNfb/8
GFD9wbbl4acuGTvItb4O3HENwZ9zRGFD0R0Ef4EU0IJHCP4aUAC8RfDR4w8A
6IPaEA==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgAmJeKH1R6fbPupZSh/21shbpUywcYPzpE/irzG5bOrCE
8eluKobKP7Fy8HhYJbIuHsG36HRMeOqF4L9UM+RYY1XqoK+1UvjCFUs4H2Y+
jB8hvv0ig5+5w7bPf69UeJc6HADJu5g5GNxVYWuMR/BbDpxa6FqC4MPc53dx
Ysy/YHMHdPfXiKxzf1iDye/xesViMtEc4p/8UodTh53WZu4zg/sHxj9Rtm++
lD+C/2flx0u+TqUOjSxH+w2nm8P5MPNh/L/fSh/MmWgJ17/F/MehlCxEeMH4
MPthfJj7kmPvuDHPsMRwPwDznbg/
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQBWIQvc79YZXIr1IH28qIFaay5g7z3i8/5v2z1CFGwfFj
8hszhw1FGRPf/ih1YACBB2YOc44obCj6VuogMfUKZ8YmM4ctJ8r2zX9X6iAz
L07ztICZw4/gx0tnPyt1uCH0yfH8NVOHJIEIyy0PEPw0ELiF4F9Uuv2z7kqp
w9edt7r+qprB+Tz+66ek/kDwt5j/OJQyy9zBD2QgUP9/EHhvATHvXqmD+lve
fQaVlg5nFrpu+/y41GF/raxFuoqVgxcPk3b7m1KHE4ed1mbOg/K/IPgtrwN3
yDGWwfkzQYC5zMHn4sSYf4st4fy/30ofzJlo6SCjf1eFDchvZDnab5hu6YAe
fgBSoKDV
     "], CompressedData["
1:eJxTTMoPSmViYGAwAmIQvaEoY+LbP6UOtpURK0zPmjjk7CmZLCFU5rC/VtYi
XcXK4aWaIccaIL/+t1XBOQ8E/4Z0TaJRKG7+fxCot3JoyAIaKFDm0OP1isVk
oZUDSxif7iZeBL/ldeAOOU4EX2Sd+8MqNqj9KVYOU527c56zljksf+Gh91/Q
yuGIAtDFzGUOW8x/HErJsnIAKRf5V+owfQJ/ldltKwcvHibt9i8IvuWWE2X7
7iP4IOdInCh1UH/Lu8/A0hLOP9S2PPxUkTmcfwvkH1MzCP9KqcNMMDB12CHX
+jrwAYL/wL93et4rBB/svs9QvqSZg+u2z3+vfCt1uCH0yfF8mJkDSHoiUB7s
/i5TOP8AyL8tpg4g587/VOrgd3FizD9nU4czC4EmvC91iFFw/Jg8xwRi3rtS
BwYQCDCByD8vdbgNcu9TY4cnS2cfUQC6LyX2jhtzhrFDDShAbyD44Pi5guDn
PP+98uM5BH/i2xp701OlDicPO63NzDN2aARFwFGo+9uMHd4Ao6v1dKnDClB8
LDR2mCIBjNGzpQ6fNwRkz/qO4GuAwlfSBM7ncVMtZfIycQh5DHQg0HzVJ83z
zlaZQNLHMQQf7K9DCL6U/l0Vtr2lDi+ytL9Nt0XwwebfNIbzN+rlLWaMMXYA
xr7YzSPQ+NY2dggARo/QVQTfA5hc1r1F8OeAIuxXqQOv//opqRomDuj5AQDd
r15j
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYC4oSnF5Ru+5c51P62KjhnYeow1bk757k3gv8m
cIdcK5BfsKb7doaAqQNQ9c86rzKHLeY/DqWsMnEAaf/pUebgd3FizL9mEwff
JIEISyB/yf19fHOKTRzYGoEm2iH4XjxM2u02CD7YPlUEf4oESxifeZnDBr28
xYw5pg4nyvbNl7KE2tdl6vDAv3d6HtC8F1na36afNXUQWef+sMqhzIHLTbWU
6ZWpgwHHGpkooP0R4tsvMsSZOcD8B+afQ/BvCH1yPN9mDuerv+XdZ1Bp4dD6
Guhh5zIH7xPstrNFLR0yJr6tsTdG8DvEbp77rozgn1rouu2zZJlDtILjx+QY
Czj/04aA7FnLzeF8cPg4mztYdDomPJUrc/AB6Tc1d3ipZsixRgHBvwIKQGUE
f+775ce81aH6gxH8Hq9XLCYLEfzpE/irzLgtHDYUAV2sgOAfUQCKyCP44PAE
mt8XXKIyfb6Fg1DzgVMLtcscxKde4cy4ZAEJD0ME3+Nhlcg6WwR/E8hCYPgs
f+Gh998QwYeFJ4xvYgwEm80g6cWqzKEOlJ4kzBy2ff57pQJonwTIPCVTCF8a
Gn9SJvDwAqcHZgR/Asi9/43h/DNgYOwASi66Pgg+enoGACLKRFY=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4k1z3y8/NrXM4e+30gdzJlo4wPjqb3n3GVRa
OshEpVjfn1zmsOT+Pr45n60cTIyBoLPMwecEu+3sUBuHUwtdt32uLXPwvTgx
5t9hW4c/Kz9e8s0rc9hi/uNQSpedw8S3NfamOQj+z7qsPSXZCP4FpdtAoTKH
/bWyFuktCP7SFx56/wsR/NrfVgXnMhD8I23Lw08l2TkATY/blVvmULJV9Pdp
PTuHMyDQADX/l43Dts9/r1R0l0HczWwN54Ptm2IB5x8A8V3MHDx5mLTbm8oc
bgh9cjzvZuKQBgJA9xeDzL9nBLcfZJzxYQTfvjJiheleBN8fFB6bEfw/oPBd
aAT3v0PTo+MzZhvBwwfGf6lmyLEmD8HfIdf6OrCuzKGR5Wi/Ybmxg8fDKpF1
7WUOElOvcGYsMnE4orChKGNimcNMELhpCo8/sH+VzR3Q4xcAadLzxw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4g6xm+e+Py1z8L84MebfZiMHGN++MmKF6V4E
3xgEDhs5zMgTaj7wqMyhkeVov+F3IwePh1Ui686XOTg0PTo+Q9vEIW6XJw/T
0TKHQ23Lw08pmcH5f7+VPpgz0QLO/wPiP7RyOLXQddvns2UOTxIXXjO5b+Ow
zh1o4JMyh3qQ+e52cPuPgMxLQvBrf1sVnMtA8Je+8ND7X4jg76+VtUhvsXOQ
0r+rwgbkbzH/cSily86h5QDQxicIvk47UMNDBH8BSMOlMoeSraK/T6+zdTgD
AifKHJbc38c3p9nGIaB3ep7Qfqh7/a0dkgQiLLfsAroX5B4OKzgf5l8YfwXI
fY3mDld8gSJ7yxxuCH1yPC9m5gAKPvfjZQ4MIHDBxAEYOtrtl6DqE40dJFjC
+HQfQcN3thHc/TA+zH8wPsz/4PBdiODD4hcAPJfyLQ==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIzIGYCYk8eJu32rHKHLztvdf0ttXCA8f9+K30wZ6KF
Q9wuoEgmgv/Av3d6XgaCnyQQYbklDcEH6wfynyQuvGZSb+HwZOnsIwpA/qG2
5eGniiwcrvgCdcSWO9wQ+uR4fpqZg1DzgVMLncsdVrzw0Pu/0dSBrXGqc7cB
gr9DrvV1oAyCH/IYaCBXucMfkH2NZnA+2HwjCzh/f62sRfoUC4eXaoYca3iA
/tsQkD1ruZWDH8jBSuUODSxH+w3NbRwUgMbv0Cl32GL+41DKLxsHnU1z3y+3
K3fwOcFuO3upLcS8AATfcsuJsn2pCD6QN18qv9yhP7hEZXq/DZzP479+SmqE
NZyv8ZZ3nwGnNSR88qDhfdQKzudwUy1l2oXgnzjstDZznhUkvAsQfHB8FCL4
YPOLEXyg6495A/k9Xq9YTBZaOZiCNJRA3XPDymGd+8MqkYZyB4mpVzgzHtnC
+eHi2y8y/LN1AIaWTFQdbr4BlB8K5ZsYA0EtQt4DaNy66nKHXlB43LeF+wec
Hu7bOCQ8vaB0O73c4SvI/1Nt4ekBpn+KBEsYnz+CD1aviuCDokvudxkk/hOt
4XxYfMP4sPT1qy5rT4lgucNMEIg0dZgHCh9dBB+c3mwQfCAv57knNPwOmjqA
rP8ZAk2vYWYOKdb3/Xth8W9qDs8vz7O0v02PReQfWH4CABkhf8I=
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
    0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGI9IGYC4ikSLGF8m8sdan9bFZyzMHU4UbZvvtR6BF+u
9XXgjnXlDgVrum9nCJg6AFXrblpb7rDF/MehlFUmDiDtumvKHfwuToz512zi
0DDVuTtndbnDkvv7+OYUmzhYbgGauBDBr7U3jds1H8EH29eJxPc273ScVe6w
QS9vMWOOqcOflR8v+c6B2tdl6iDUfODUQqB5L7K0v00/a+rg8bBKZN3icgcu
N9VSplemDinW9/17gfZHiG+/yBBn5gDzH5h/DsG/IfTJ8XybOZyv/pZ3n0Gl
hcMOkIeXlTt4n2C3nS1q6TDniMKGomkI/i5PHibtdgT/75WKl2q15Q7RCo4f
k2Ms4PxPGwKyZy03h/PB4eNs7pCzp2SyRFO5gw9Iv6m5g0wU0MXNCD5bIzAA
2xD8C0q3f9Z1QfUHI/g9Xq9YTBYi+NMn8FeZcVs4PFk6+4hCC4L/I/jx0tlN
CD44PIHm9wWXqEyfb+Hguu3z3yt95Q7iU69wZlyygITHVAS/RmSd+8MFCP5T
kIXA8Fn+wkPvvyGCDwtPGN/EGAg2m0HSy9xyhzpQepIwc3ipZsixBmifBMg8
JVMIvw4af1Im8PACpwdmBH8CyL3/jeH8M2Bg7OADTC4J6xF89PQMADPVR2w=

    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJFIGYC4nPfgx8vLa5w+Put9MGciRYOML5D06PjM05b
OKSBQAGCn2J93783F8E373RMeGqByfc5wW47W9QGzs9f0307wwHBb2A52m9Y
buOw7fPfKxWmCH780wtKtw0x+Uvu7+Ob44zgw8yH8WH2mxgDwd9yON+Th0m7
/ReCf6Js33yp75j8/bWyFulTEPwt5j8OpURZOBhyrJGJ+oXgw8yH8WH2o/ML
QP4VMEV171MTOL9kq+jv0+tMHB5WiaxzN0XwYeGDzpeYeoUz4xGCDzMfxofZ
D4sfGH/i2xp70wIEHxa/6HxY/AMAPMT50w==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYCYu12sZvnvlc4zAQDUwcYf8ULD73/H00dZKJS
rO9/RPBPlO2bL/UQwffiYdJuf1DhcEPok+N5MTM4/0CtrEV6C4L/NEv723Rb
Wzjf9+LEmH/NCP5VkP42Wwf51teBO+4g+I+Xzj6icKPCYT/IPBNbh+/BQJFz
FQ5L7u/jm3PYxiHn+e+VH3dh8qdO4K8yy7ZxuOybJBCxH8GvFlnn/vAEgu9t
3umYcLnCYYv5j0MpuxB8mPthfJj/zoDAJYT/K16qGXIcQvCz9pRMltiDyYeF
b/rEtzX2Bysc+oJLVKbPN3Ww3AIM0csIvkncLk+eWwi+AccamagHCL7Oprnv
l39C8NHjDwAVkNqc
    "]], FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}}}, {{{411.373, 24.5797}, {411.373, 24.8188}, {
    411.1469999999999, 24.8188}, {410.97999999999996`, 24.8188}, {404.483, 
    24.8188}, {404.316, 24.8188}, {404.089, 24.8188}, {404.089, 24.5797}, {
    404.089, 24.342200000000002`}, {404.316, 24.342200000000002`}, {404.483, 
    24.342200000000002`}, {410.97999999999996`, 24.342200000000002`}, {
    411.1469999999999, 24.342200000000002`}, {411.373, 24.342200000000002`}, {
    411.373, 24.5797}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
     3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJHIGYC4hp707hdkVUOXzYEZM8yt3VA4W+H8gOrHMLF
t19k+GfrIH7z3PdgTwS/5XXgDjlHNL5llUOMguPH5Dm2DvPfLz/mbVrlcEO6
JtFI1dZBJirF+r5hlcMW8x+HUnbZOLSLAQ3Ur3I4AwI+Ng7yG4oyJmpD+Xus
ILQcgr/Dk4dJWxrBf1Alss5dEpP/Zeetrr+tCP7+WlmL9BQrh/v+vdPzpBB8
/ySBCEs5NHktBB9sLlB9wZru2xkBpg5A1/v3igP9I/TJ8bybiUMCUPsWkSqH
lNg7bswZxg5/rlS8VONG8Ouz9pRM5kLwp0iwhPGxIvgizQdOLWSscljxwkPv
/0Jjhyu+QAcB9Z887LQ2cx2C/wkcPyY4+QZaK4UvlJg4AH37sIqjykHjLe8+
g5kmDjUgARYEH2w/I4IPjs/flQ63QPGTiuD//Vb6YM5HYzgf7J48Y0h6YK5y
mD6Bv8pMG+FfGP978OOls+UQ/C0nyvbNV6tymAkCkaYO8q3ABKIB9e9HU4c5
RxQ2FJkhwvuFmiHHGjcEH+wfLwT/Pwh4Y/JPgNw3D8GHpQeYfhgf7H93BH8G
yF3mCH7DVOfuHPsqhz8g/xvaOrA3AgUcqhxUnjTPO1tlC4lPlyoHiXlxmqcP
2Dq8ASb3Vk80vi8aH5h/fE6w285eauvwpw5oQHCVA4ebailTly3cvU+ztL9N
r4XmN09EfoHxwe75aAPng/2/xQbiHp8qh/7gEpXp/TYOE94CVQQg+MDYMeQI
QfBh+XvJ/X18cw7bOKDnfwAIStLJ
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYCYpHmA6cWtlY5nAEDYwcYnwEEBEwcdnjyMGk3
IvgnyvbNlypF8OVbXwfuKKly4PVfPyVVA8Ffcn8f35xiBB9s/B0LOH8xSF7Y
0kFknfvDKiDf+wS77WxRS4cpEixhfIUI/vPfKz9eyq5y2F8ra5F+xMLBv3d6
nlAqVP9kC4f4XUAHRmLyC9Z0384IsHCYc0RhQ1EMgj///fJj3skI/gs1Q441
WVUOjSxH+w3bEXyY+2F8mP/+AJ3jm4Xwv3+SQIRlHIK/ZS7QgkhMPix8n19Q
uv0TqP5g2/LwU5eMHQJ2yLW+zkTwz38Pfrw0H8G/4gu0oBTBvw8KgAYEHz3+
ANR0yXA=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC0RuKMiZer3Lwvzgx5t9mIwcY374yYoXpXgTf
GAQOGzkYcKyRibpS5dDIcrTf8LuRw4MqkXXuB6scHJoeHZ+hbeLwPfjx0tnb
qhwOtS0PP6VkBuf//Vb6YM5ECzj/D4j/0Mohxfq+f+/+KocniQuvmdy3cXB/
CDTwapVDPch8dzu4/UdA5iUh+LW/rQrOZSD4S1946P0vRPD318papLfYOWw5
UbZv/rUqhy3mPw6ldNk5yEQBbbyK4B9RAGq4jOBbgDQcrnIo2Sr6+/Q6W4f0
NCDYVeWw5P4+vjnNNg4v1Aw51myAutff2uHPyo+XfNcA3QtyD4cVnA/zL4y/
AuS+RnOHnOe/V35cV+VwQ+iT43kxM4caYPA93FHlwAACF0wcniydfUThCFR9
orHDlrnvlx+7DA3f2UZw98P4MP/B+DD/g8N3IYIPi18AO7r5xA==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {
    1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJLIGYCYvkNRRkTpasdIsS3X2TwM3eA8QvWdN/OSDB3
cNn2+e8VqWqHmSCQae7g/rBKZJ0kJn8GlO/Bw6TdLoGQny+lf1cFyLetjFhh
Govg20D5W+a+X35MvNqhkeVov2G4ucN9/97peWLVDmkgoAblC1U7vMjS/ja9
18zh/Pfgx0s5qx1SYu+4Me8wdQBxZ/+rgvNrRNa5P/yB4IO4VUD+gVpZi3QW
Mzj/04aA7FnuCP5HND5YfYuZwxQJljC+n1UOGm959xmsNHMI2CHX+pq92mE/
SD7FymE7MHgqJBH8E2X75kvJIvgyQO+yyWPyp0/grzKbjeCfAYE9QH5UivV9
WQTfJG6XJ48Ugv8AGNzunAj+dqBzAgWqHbaY/ziUUmUDsV+w2uGGdE2i0VIE
fyrIvtUIfj4ofg8g+H++lT6Y89EGEp58UPN5bB2eLJ19RIEHwQfLcyH4/kkC
EZZs1Q5L7u/jm8Ns65AA5G5hqXZY+sJD7/9CG4f0iW9r7P9Wwd0rfvPc9+DX
CP6bQGCAPkfwddrFbp57isk/0rY8/FQTgg8Lz5bXQAOeI/jAxNJ84BWCX2Nv
GrfrN4L/50rFS7X3VQ4lW0V/n7YzdxBpPnBq4dsqB7+LE2P+XYbGN5Dvc4Ld
dvZWBB+W/mD8U4ed1mb+M3W44gsMgM9VDtNA4Vtt6lD+Us2Q4x+CD44vYPjC
+LD8VfvbquCcBSK/wfIfAN51m2s=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYC4vqsPSWTo6od/n4rfTBnooUDjK/+lnefQaWl
wws1Q441EdUOS+7v45vz2crhPwj4Vjv4nGC3nR1q4zA9T6j5gFO1g+/FiTH/
Dts6HC/bN1/KuNphi/mPQylddg7xuzx5mAwR/OPe5p2OBgj+/PfLj3nrVzvs
r5W1SG9B8Je+8ND7X4jg1/62KjiXgeAfaVsefirJzsGDh0m73ajaoWSr6O/T
enYOM2YCgSvU/F82Di0HTi10Dah2MDEGAmZrOB9s3xQLOP8AiO9i5iB+89z3
YPdqhxtCnxzPu5lA9AHdXwwy/54R3H6QsPFhBN++MmKF6V4E3x8UHpsR/D+g
8F1oBPe/Q9Oj4zNmG8HDB8bf/vnvlQpjBL/ldeAOOedqh0aWo/2G5cYOIuvc
H1b5VDtITL3CmbHIxGHC2xp707BqB5C3Z940hccf2N3K5g7o8QsAP3PlVQ==

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJ5IGYCYgmWMD7dJdUOf7+VPpgz0cIBxld/y7vPoNLS
oeXAqYWui6odltzfxzfns5XDjJlAML3awecEu+3sUBsHA441MlE91Q6+FyfG
/Dts65AgEGG5pabaYYv5j0MpXXYO34MfL51dheAnPL2gdLsSwTfvdEx4WlHt
sL9W1iK9BcFf+sJD738hgl/726rgXAaCf6RtefipJDuHJ0tnH1EA2leyVfT3
aT07BxNjIOiHmv/LxkEmKsX6/sxqiDizNZwPtm+KBZx/AMR3MXNYX5Qx8e2E
aocbQp8cz7uZOJwBAaD7i0Hm3zOC2w8yzvgwgm9fGbHCdC+C7w8Kj80I/h9Q
+C40gvvfoenR8RmzjeDhA+P7907PE6pF8OVbXwfuAIZvI8vRfsNyY4f17g+r
RKZVO0hMvcKZscjEQadd7Oa5+dUOoGiZedMUHn9g/yqbO6DHLwDJi987
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIJIGYC4sdLZx9R+FbokBJ7x415hp4DjO9zcWLMP2V9
OF986hXODCd9h+2f/16p+IzgP/+98uOl54UO9b+tCs556DvkgASuFDrMmAkE
lfoOm+e+X37scKGDMQg4Gzjs9uRh0l5f6JAMsu+FgYO3eadjwnIof4Whw/dg
oI2LCh0eJy68ZiJv5FDxUs2QA8g/edhpbaaekUO1yDr3hwsQ/PQ0IJiH4IPV
z0Lwwe6bWegwfQJ/lZk2gg82/74hnA9Wv87QwXLLibJ9mwsdWnj9109p1XUA
GbfmXqFDKsieNB1IeHxC43/D5J8BgRwE/8+30gdzBHUd0MMbANoAvJU=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{287.238, 
    14.212899999999998`}, {357.2681, 14.212899999999998`}, {357.2681, 
    15.648059999999996`}, {287.238, 15.648059999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIJIGYCYhNjIFhf5nAGBHw0HB5Wiaxzn1rm4HNxYsw/
ZT0HQ441MlFZZQ7iU69wZjjpO1h0OiY8DUPjB2Hyp7S3Rl22QfBTYu+4Mc/Q
g/P/fCt9MEdQF87X11opfKFFB85PTQMBHQeFDUUZE0MRfLB7E8sc/oNAvI7D
Onegi0vKHJ4mLrxmoq/jkDHxbY19K9D8t68PWCprOyQ8vaB0e2aZw4yZQHBT
08ED5MGFZQ7bHZoeHY/QcHjg3zs9bxlQfgJ/lVm2ukPcLk8epuVlDm+Kt4r+
9lZ3WCClf1dlBYK/5UTZvvmrEHwZoDTbegQfFp4Bt6RrEoMQfLD5rxF8WHgD
AGOHpTc=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJRIGYCYomb574HM5Y7pMTecWOeoecA409pb426bKMP
54tPvcKZ4QTl/y2D82WiUqzvv0Twc57/XvlxX5nD8yztb9Nl9Ryk9O+qsC0t
czgDAj4acP6MCfxVZq/V4fyAW9I1iUHqDmtABgL5b4q3iv72VneYCQIrEXyw
/FoEv3Gqc3fOWoT+tzX2pnHryiDur1F3YACBfVD+HC2HHXKtrwNvlDmsVX3S
PM9Xx2GKBEsY3/8yh9Q0ENCB+xedLzMvTvP0BAT/z7fSB3MEdR3Qww8AGRaS
DQ==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{368.028, 
    14.212899999999998`}, {438.05809999999997`, 14.212899999999998`}, {
    438.05809999999997`, 15.648059999999996`}, {368.028, 
    15.648059999999996`}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1,
     3, 3}, {1, 3, 3}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJRIGYC4v8gsLva4XHiwmsm9w0dYPzpE/irzLSNHJ7/
XvnxEpB/8rDT2kw9I4eGqc7dOdsRfJ12sZvnNiP4As0HTi3cjNCvv2nu++Wb
qh2+7rzV9VfUyEFG/64K2+Jqh/Q0IGgzcEgQiLDc0lHtcP5q2Bv9aH0HkHHf
E6sdxKde4cxw0ndgCePT3RSPyU+JvePGLIHGn6EH5//5VvpgjqAunH8GBHJ0
4PxUkP1pUH4ygv/nSsVLtXIEf737wyqRRdUOU0D+6daFhw/Yv+sQ4QULPwAx
a5sl
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
    0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIFIGYC4mSBCMst5wod+iK6/RkFxB2CHy+dfeQUgp8+
8W2N/clCh+C3lz/OOCjsIH7z3Pfg44UOJsZAsJnfYb37wyqRDQj+cW/zTscl
CH56GhDMQ/BBxisA+Q9c4x1nCQrA+WB1aoJw/h1N2TX/PyvA+d02nrvSmhTh
/Mr7P24Z71aE2L8KwZ8vpX9XZR0mH2yfo5LDff/e6XkrCh325te8nWmq5PD/
SsVLtfkI/m5PHibtmQj+TBBoReiH8WHmg93dgeBLsITx6U5C8MH2AflrhXT4
0vsQfPc1R5cz/FCA8/+DQLwgnG8MBgJw81DCswPBh7kHnT8DzOB1kAZ6n+00
go8e3wD/huAF
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4tlHFDYUKRQ5zASBSHEHbx4m7XYZBF//rgpb
o3SRg/yuBftS3wk5JAtEWG6RKHLY372vyeQxv8NLNUOONQwI/nwpoI5Xhajy
ckUOnTaeu9IWKTqwhPHpbpIvcjAGgcsI/h1N2TX/HyP47muOLmf4geA/cI13
nOWo5HDfv3d6nhyC/3gp0AcyCH6tvWncrvuFcP7EtzX2pvcKHWru/7hl7C0L
cd8jBH+3J9DDjwsd/oOBgsPpha7bPr8udKgEye9WdJBvfR244w+CD5YXLILz
xW+e+x58t9DhTVtut5G0gMPvlR8v+d4pdOiP6PZnLOCH82U2is1nUkDwC5aX
bPh3ng/OnwEOcF6H33VZe0ruIvgJTy8o3b6P4EuAAgTofxgfPf4Ao0zS8A==

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxtlGtIVFEQx1clLXBXc693V7vkBmpFUPSAiAJHwiyipITw7bK566NtNw9L
+MhXpiGmZRKWGuqHEkk2wwoxMT/Yg1z9UkQiYdJDpCRM6YEf7MzZe+9ZrIHz
4ce5c2fmPzNnk8V50hqg0Wj86DlOjz89O95HB1bVEMi1UfsSBgqPe6jZBdh2
WZycqCKQh/d3RZiL3bm2lxC4hZZqgMSZEsFdSGDLj+i51nwDBFXdOFhfQOBb
7dn6XU8MUIQOPnxmyNVstBGoMQXFeJYM8PFO26jJTECD1mlUWSi+7hr/FKFy
C8abjIQ+ktc0byEQNdg5bN0uQfbgkWB/J+d7UlrO/jLOiNOUd6M1y/8rJ9CY
Up/k12eEF0f31sWXy987jLDyhmZcQWBxeOFR7imjN/9Kzvex4Iv/MvNv5LwZ
9dgaoXIO6hcrqRyD9z2c27G+PxJMJzW0OCo599/+3v28gvOoiSrgw6+PWUJT
aH0Jvc+6NUUSvDw/3BFJuQHrOycBtu9XKY+P7k0+HLWKmU4+zPIpIWBFPiR5
56SIwApaB/Wv+XpiwMXzUfqhMPtfJufcpvkLcakErmJ+1yJVZnqti1D5Q0J2
fGuhAca6Eh4vUn8Ma6sVYWAjDZhFwMT6JUIlHTf7aXkei8OBTqeUZlPmMxxK
BXfijIPAYdTntwABONAu2d8tQD8KRvufEZMiTRzgzPLWh6m8hP1+GwoGKmdy
qVz/Ux3oq0dedTk5J+OAWTizfmQTaGPzux6WywuGXJnyvtTpwT673LOQQWAP
xlvUA66dJ0Pelw0C4HolpnNW9PkvT+lVZvsEnONc8WVj7TqVbzKBtCq/006J
1p/BQLfB/DmNM9vvdM7sPaB8yVC2Jj9Q653fLEU/nXceKLM6rujU/ZUeiB3+
5hBocYRVj5jlevtDANtTYpP1FbXQhgNu5/H2PaQKOjlju2crOCvvFYvnCYXV
79lfyiIpBQ==
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQnfP898qPp4oc1D+pvJy1UtABxt8RbBXxP13YQVr/
rgrbcUw+TD2M/7ott9soWsDhRNm++VJHixxMjIFgM7/Dff/e6XmHEPwae9O4
XXsx+f0R3f6MAYJwPsx8GD8NBNwk4PwD3fuaTJKlHc5/D368dGORw5yZQPBT
xmG9+8MqkWUI/uvAHXKtsxH8x0tnH1GYVOTwZd/HrenfpOH8CNUImXN3JOH8
nSD/PpdwOAMCU4ocPoPUh0k4ZO8pmSwxA8EH2z8bwQfbP6/IYSbYPgS/RYFd
9cwVSTjffc3R5QwzpBwkWML4dOcUOQS8vfxxhqK0g7d5p2PCzCKHmvs/bhl7
S8PVg90rJgOJnyUIPoh7aSma/BoEH6x/S5HDdJB7bkrB+WuFdPjS7STg/CCQ
/Y7iDskCEZZbgPo1QOGvKQ5xH9C+PlD8CIg7AFWvcwf6V6RyUslZFTGI/glF
Dr0g+Q8iDqDgft0L9Z+EMJxfDfIPtxCcb1/iWHt6Dp8DKPSOzCpyuMF7Wyz1
G49DsjUwxSxG8F23ff57ZQ2Cz9441bl7U5GD/xPPS6aT+R0u+yYJRGwtcpDf
tWBfKp+gQ7vYzXPftyLSF9i9O6HpyZPXoRrIfbgPwZ8vBUzABxB8lPzQicYH
pkcAGJp8LQ==
     "], {{299.25500000000005`, 4.82031}, {299.25500000000005`, 4.05}, {
     298.603, 3.8437499999999996`}, {298.28400000000005`, 
     3.8437499999999996`}, {297.872, 3.8437499999999996`}, {
     297.52199999999993`, 4.12188}, {297.52199999999993`, 4.50313}, {
     297.52199999999993`, 5.02656}, {298.01399999999995`, 5.56719}, {
     299.25500000000005`, 5.607810000000001}, {299.25500000000005`, 
     4.82031}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIZIGYCYveHVSLrfhY5pKcBwTEhBxhfYdeCfal9Ig6W
W06U7fuKyf+y7+PW9GtCcL5w5aSSs0sEHLTbxW6e+1jk0BvR7c/4gc/h6QWl
2z/fIPizjyhsKHqCyTcGAyE4H2z+NgTfACRdLO0A4mZ8x+T/B4F6Gbh6dP7p
M0Cgo+hwEeicugcI/tsae9M4IL9VgV31TIm8w25PHibt21D3Fcg4XPZNEog4
X+TguubocoYIBB9mf/DjpbOP3MLkw8ITxrctcaw9LcPn4A/UbvmsyOEG722x
1G88DutBAf4Gwf8O0vAFwYfFx8HufU0myQIO6PEFAPXW02I=
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
    0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4ikSLGF8nsUOM2aCAK8DjG9iDASb+R0e+PdO
z3NA8I8obCjKsC92eOAa7zhLUADOD357+eOMhYKo8hdlHNa7P6wS0Sl2cF1z
dDlDBYJfc//HLeNsaQeF1teBO0wQ/Bp707hdplD7jBH8A937mkwWS8L5b9py
u42kReD8/yAQL+gAMk5OH8rfz+cAcs5EVQRfZ9Pc98ulEPz5Uvp3VYD8aNUI
mXN7BOD8dgV21TMhQnA+zD+u2z7/vcKG8A+MD3O/yDqgBwUw+WD/BCP4a4V0
+NLrJOB8cPDvFIbz+yO6/RkLBOH8G7y3xVK/8UDsU0Hwgx8vnX3EAMG/4psk
EAEMD+HKSSVnjwg4dIjdPPcdyJfftWBfKp+gwxOgcgUzTD5MP3p6AAASiumv

    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYCYuHmA6cW1hY7PHCNd5x1UcoBxpfftWBf6jtp
hxTr+/69lTB5GYcOsZvnvhcj+CxhfLqbshH8nD0lkyXSih32d+9rMnGWdmiY
6tydk1zs8KYtt9uoWtJh7vvlx7yx8GH6Mya+rbEPLHZwXXN0OUMFgl9z/8ct
42xpB5BxzyMR/A1FQBVRxQ4mxiCA4B8A2b9YEs7fGWwV8d9dEFX9Zn6HIwpA
kUgEH2YfOn/GTBDgdQBxTcOKHdQ/qbycdZIXoi4WwT/ubd7pmIDgW245UbYv
HcFnAIEMBL8FGNyuBQjzYXyY/UDb4nblIvhzQA5OQfDB7gHywd43FoDz3UHh
FyEI5589AwQ8YnA+OH7zJBwWSOnfVQG6J0I1QubcHWkHA441MlEliPgHBc9E
YHyfAQNphz8rP17yLYLyexB8WPqB8VsU2FXPXJF0uOKbJBBRWuxwEBQfyZKQ
+CtH8HOe/175sQrBh6U/kcpJJWefIPgw8wEiXy/x
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQnfP898qPh4od1D+pvJy1UtABxt8RbBXxP13YQUb/
rgrbfkw+TD2M/7ott9soWsDhRNm++VJ7ix1MjIFgM7/DA//e6Xm7EPwae9O4
XVsx+f0R3f6MAYJwPsx8GD8NBNwk4PwD3fuaTJKlHS58D368dGWxw5yZQPBT
xmG9+8MqkXkI/pvAHXKtkxH8J0tnH1HoKnb4su/j1vRv0nB+hGqEzLk7knD+
TpB/n0s4nAGBnmKHzyD1YRIO2XtKJktMQPDPg+yfjOCD7Z9W7DATbB+C36LA
rnrmiiSc777m6HKGGVIOEixhfLpTih0C3l7+OENR2sHHvNMxYWKxQ839H7eM
vaXh6sHuFZOBxM8cBP8FkHtpLpr8EgQfrH9NscN0kHtuSsH5a4V0+NLtJOD8
IJD9juIOyQIRlluA+jVA4a8pDnEf0L4+UPwIiDsAVa9zB/pXpHJSyVkVMYj+
jmKHXpD8BxEHUHC/boX6T0IYzq8G+YdbCM63L3GsPT2HzyHkMTDAJxU73OC9
LZb6jcchxfq+f+9sBN912+e/V5Yg+OyNU527VxU7+D/xvGQ6md/him+SQMTa
Ygf5XQv2pfIJOnSI3Tz3fS0ifYHduxGanjx5HWqA3IfbEPwFUsAEvAPBR8kP
nWh8YHoEAPfTetk=
     "], {{314.75500000000005`, 4.82031}, {314.75500000000005`, 4.05}, {
     314.10300000000007`, 3.8437499999999996`}, {313.78400000000005`, 
     3.8437499999999996`}, {313.372, 3.8437499999999996`}, {
     313.02199999999993`, 4.12188}, {313.02199999999993`, 4.50313}, {
     313.02199999999993`, 5.02656}, {313.51399999999995`, 5.56719}, {
     314.75500000000005`, 5.607810000000001}, {314.75500000000005`, 
     4.82031}}}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIZIGYC4odVIuvcPxc7pKcBwTEhBxhfYdeCfal9Ig5X
fJMEIt5j8r/s+7g1/ZoQnC9cOank7BIBhyMKG4oyXhc79EZ0+zN+4HNoyNpT
MvkZgm8St8uT5x4m3xgMhOB8sPnbEHwDkHSxtEM8kMv0EZP/HwTqZeDq0fmn
zwCBjqJDDtA5ErcQ/A6xm+e+3yx2aFVgVz1TIu8Q8njp7CNXoO4rkHHIef57
5ccTxQ6ua44uZ4hA8GH2v62xN427gsmHhSeMb1viWHtahs/hBVD7pfvFDjd4
b4ulfuNx8AAF+FMEfyJIwzsEHxYfB7v3NZkkCzigxxcA7cnL2Q==
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQfczbvNNRpsRhxkwQ4HWA8U2MgWAzvwMDCIgg+Ns+
/71SIVziEPz28scZjAJwPlidgyCc/8A13nHWRRmHDUUZE98ylDi4rjm6nKEC
wa+5/+OWcba0wxQJljA+TgR/4tsae1OuEoc3bbndRtYIfgVIfrUknL8z2Cri
v7sgnA9z30s1Q441HAg+W+NU524GTD7MvwZ3VdgaWUsc1D+pvJx1ktdhy4my
ffN5EHxPHibtdj4EH+RcXQEEX6dd7OY5cQQfPTwBPYGLZQ==
     "], {{321.313, 8.48438}, {321.313, 8.746879999999999}, {321.106, 
     8.929689999999999}, {320.87699999999995`, 8.929689999999999}, {320.645, 
     8.929689999999999}, {320.4390000000001, 8.746879999999999}, {
     320.4390000000001, 8.48438}, {320.4390000000001, 8.253129999999999}, {
     320.62199999999996`, 8.04688}, {320.87699999999995`, 8.04688}, {
     321.12199999999996`, 8.04688}, {321.313, 8.253129999999999}, {321.313, 
     8.48438}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {{{325.97299999999996`, 5.392189999999999}, {325.97299999999996`, 
     6.385939999999999}, {325.155, 7.243750000000002}, {324.106, 
     7.243750000000002}, {323.05600000000004`, 7.243750000000002}, {
     322.23900000000003`, 6.385939999999999}, {322.23900000000003`, 
     5.392189999999999}, {322.23900000000003`, 4.3999999999999995`}, {323.089,
      3.62031}, {324.106, 3.62031}, {325.1310000000001, 3.62031}, {
     325.97299999999996`, 4.3999999999999995`}, {325.97299999999996`, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQfczbvNMxpMThTVtut9FtUQcYX6RyUsnZFBEHBhAA
8oVB/CVCDnOOKGwoCihx6I/o9mcMEHSI2+XJw+Rb4qD+SeXlLE4Bh7nvlx/z
di9x6AXJf+BzYAnj093kiOC7bvv894oVgm9wV4Wt0bTEofr+j1vG3gIOSQIR
lluMShx2BFtF/E8XhMjrlzh82fdxa/o2IYfW14E75PSh7nMRgfNh7ofx+0Dm
C4jD+TNB4KeEQ0Dv9DwhY6h5YVIOb2vsTePMShwMjIGgWNqhFsjdZQ2VF5OB
ux/G/7Py4yVfDwR/E8jDQP/XgN0vDXE/MHzkdy3Yl6on5fBk6ewjCsDwc19z
dDnDDQl4+Ia8vfxxhqK4A3r4AwAQSqj2
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGITIGYC4mPe5p2Oa0ocZswEAV4HGN/EGAg28zs8WTr7
iMISBP9H8OOlsxdh8ncGW0X8dxeE8+V3LdiXmicB54PNl5R22DT3/fJjc0sc
HrjGO866KOPwwL93et4EBP/F75UfLzUj+Dl7SiZL1JU4bAeZ3y7l0JAFFKgp
cRCpnFRy9oikw5wjChuKsPBh+iteqhlyZJU4uK45upyhAsGvuf/jlnG2tIMO
yEFFCL7HwyqRdcVQ/xkj+Ae69zWZLJaE82H+RVEPDI8FUvp3VYoQfJh96HxY
eG/7/PdKRX6Jg/onlZezTvI6BACDQ6gUwb+odPtnXQWCP/Ftjb1pDYL/JnCH
XGsjgh+3y5OHqR1hPowPs79GZJ37wzoE/4pvkkBELSYf5j8UPrs4nL9eSIcv
PU7KweCuCltjOzS+30k7gILDvR/BlwEGB9t0BH9DUcbEtzNKHPojuv0ZJ0jB
+WD5Pgk4H2Y/jA9zHyh6M6Yj+DD70Pkw/yu0vg7cMQURPsDQeh04C8GHpUcY
/1cdMIEtRPDPgMAyBB89vwAAmz5tgg==
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3,
      3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGCwA2IQnfP898qPdqUOBsZAUCztAOP/B4F6GQcZ/bsqbNal
DjuCrSL+p8s4NE517s4xRfAZQMAIwW85cGqhqw6Cf0Hp9s86LQRfrvV14A4l
hPkwPsz+pyANGgg+SFpOG6r/uBScv15Ihy9dDsGPUY2QObdH0mGNTFSKtWap
g/onlZezOCUdzix03fZZvdRhLUh9nQTcPghfzOGIwoaiDNlSB5HKSSVnU0Qc
dDbNfb9crNQhGmTeHCGHGXlCzQdEoParC0P4bKUOQW8vf5zhKO4Q8njp7CMM
pQ4hIP5DKYdfdVl7SgRLHd605XYbScvD+R8WrVc466EA5ztPaBZKW4Xglx/e
5jozVxFiHl+pw21N2TX/Dys5XPFNEohgRfAVQO7/UwLnv1Qz5FjzqcRB+dqj
YIY7inC++5qjyxk0FOD83ohuf8YCOYc5IA9/KYH4Xw4Yv8Dguv+9BBJ+fyQh
/n9V4vBl38et6dvEHE6Bwu9picMD13jHWRNFHdJA4BFMXgSV/00Izof4X8AB
FLwT35Y4LL21/LGhM48DmPsLwYf5D8YHpyc+aPrYzweRF4bGR40AJH2JQdUf
5nfY5cnDpC2P0A9LDyj2mSD4YP/Yljoc6N7XZLKY32Hi2xp7U2B6FwbF/xIh
hxPe5p2OVgg+2D1W0Pi0FnCYCQKGpQ62JY61p2P4HICp4dRCbQTfJA7oIjUE
H2y+Aiw9CjhI3Dz3PViy1GE2yJybgpD4AMofBLnnsbDDE2D0K6iUOniA4s9C
1EEKlP90SyHxuUPCQWSd+8Mqg1JIeItJOYCy43PjUoea+z9uGWcj8i8s/wAA
p5uv1A==
     "], {{336.84400000000005`, 8.340629999999999}, {336.84400000000005`, 
     7.9281299999999995`}, {336.542, 7.601559999999999}, {335.961, 
     6.9578099999999985`}, {335.778, 7.467189999999999}, {335.72299999999996`,
      7.935939999999999}, {335.72299999999996`, 8.253129999999999}, {
     335.72299999999996`, 8.97656}, {336.12799999999993`, 
     9.159379999999999}, {336.34400000000005`, 9.159379999999999}, {336.756, 
     9.159379999999999}, {336.84400000000005`, 8.56406}, {336.84400000000005`,
      8.340629999999999}}, {{337.019, 4.279690000000001}, {
     336.56600000000003`, 3.9390599999999996`}, {336.12799999999993`, 
     3.7953099999999993`}, {335.731, 3.7953099999999993`}, {335.08, 
     3.7953099999999993`}, {334.856, 4.50313}, {334.856, 4.956250000000001}, {
     334.856, 5.3374999999999995`}, {334.984, 5.6}, {335.07199999999995`, 
     5.734379999999999}, {335.12699999999995`, 5.81406}, {335.134, 5.82188}, {
     335.58799999999997`, 6.267189999999999}, {335.953, 5.528130000000001}, {
     336.303, 5.018750000000001}, {337.019, 4.279690000000001}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {
     0, 1, 0}, {1, 3, 3}}}, {CompressedData["
1:eJxVk21IU2EUx+eKtVDG3OZY27Ws7AWUymZQQXmGmPUhyuYHIbAQbBLLXthT
alNSszGWlWVopkyxOcq5lq43ieEHgyjthSJQCQsJEZVaBhWB6zn37t6HDlwu
P557z3P+5/zP6pKTh0rlMpnMQh98z6zPUgbCBEYwLptA5J+R6EObngNu86d0
xQAB5+TvcXNGKtTezPXY+xh/qdIF83sZD+5Lkmf4CFQgJ6aCfuz1L6uXgCtt
2bqRsAk6jTRhO4HSYzT2cML3LQQ+5x2xtL3jINtMo4lx+MXZiPci4w/7S9RF
5wnEMLxGibWV1x2j6QaJyzB/jx4y+zu++WsIbPyRPtPmTgED1lNL4Kl1Z1Fs
Wgd4vYuez1064dlq0sEWKre2mkB+4LlfZtBKzNdfqJHYhvkVybCtmCq4QGAD
5l+uhoQMl36sLl5fTAVYzg4ngV0OS/UrTiX08xwB7oHeK+9MlBhlmweU/5+n
LYXjzxw3DFT/ab8jtHhVBtvdlqNfmxnzc7vDuHDKd3u4n8Ap5DdLJObn+VEp
sW/cP5WVmwRYXjhIoLHIcyDhuwrerpn4U3OPgHX+fbQ1QQ0oT95NIKDJVNkW
1cL/7YyfrGyYLbjGmJ+fm3FZ07wzp0H0UzIE86lj6uJ6FxiL/RaZn8eEVurn
kCdSl71WB9U5tOP1BEZRt10HBxtbyjX0vkKst0sLFWjgKwRuYVRqhfMmxnvR
sB2M7dN/70Z7CFShX3tTJBb9JPIs1nN4hdTv+6iv2AhOrKeLCLrNJpgroB3p
jvul2STU64/3YzcHL7vyHi30Mf+L+7RqsDNSuokT8gfi5wrGvP56k8STuA9R
I7QPp4XO0Pk9Rj+7jNBarqkfCjHm/d3PWNxvYZ8Yi/v/DztXypg=
     "], CompressedData["
1:eJxTTMoPSmViYGAQBmIQbdHpmPB0TqmDcOWkkrMqEg4wvseao8sZfog5tBw4
tdAVyBcBy4s5vK2xN42bVeoQ8vbyxxmNog4KG4oyJk4vdVgrpMOXPk/EweCu
ClvjZKj6FBEHE2MgmIjg+5gDLWjF5D9wjXecVSgO58PcA+M/BMkHSjpUvFQz
5GgrdUhJAwI1KYegHXKtr9tLHXYEW0X8Py7lsM79YZVIV6nDge59TSbN0g4X
vgc/XtoLte+JtENA7/Q8oYkIPsy/6Hx3kP9vIMID5h4AmYaAGg==
     "], {{346.705, 3.0953099999999996`}, {346.705, 2.66719}, {346.092, 
     2.30156}, {345.30600000000004`, 2.30156}, {344.51099999999997`, 
     2.30156}, {343.90799999999996`, 2.66719}, {343.90799999999996`, 
     3.0953099999999996`}, {343.90799999999996`, 3.262500000000001}, {344.034,
      3.7312499999999993`}, {344.686, 3.7312499999999993`}, {345.448, 
     3.7312499999999993`}, {345.664, 3.7312499999999993`}, {346.705, 
     3.7312499999999993`}, {346.705, 3.0953099999999996`}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIxIGYCYgOONTJRN0odZswEAV4HGN/EGAg28ztMfFtj
b3oBwX+pZsix5hwmf2ewVcR/d0E4f42QDl96npKD5ZYTZft2lzo8cI13nOWI
4Ffe/3HLeLeiA8j4uCMI/hGFDUUZR0sd1oL0z0Pw+WMD7htdV4DzYfbB+DD3
yESlWN8/jODD7EPnw/ybJBBhueVAqYP6J5WXs07yOrz4vfLjpeMIfofYzXPf
TyL4XjxM2u1nEHyw/ZcRfPTwBACM9Jn5
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}}}, {{{353.77299999999997`, 5.392189999999999}, {
     353.77299999999997`, 6.385939999999999}, {352.955, 7.243750000000002}, {
     351.90599999999995`, 7.243750000000002}, {350.856, 7.243750000000002}, {
     350.039, 6.385939999999999}, {350.039, 5.392189999999999}, {350.039, 
     4.3999999999999995`}, {350.889, 3.62031}, {351.90599999999995`, 
     3.62031}, {352.93100000000004`, 3.62031}, {353.77299999999997`, 
     4.3999999999999995`}, {353.77299999999997`, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQPUWCJYxPsMzhTVtut9FtUQcYX6RyUsnZFBGHMyAg
UOYgDOIvEXLImPi2xp63zKE/otufMUDQQadd7OY5zjIH9U8qL2dxCjhk7SmZ
LMFS5tALkv/A53BB6fbPun+lcL5Q84FTC78j+H9Wfrzk+6nUofr+j1vG3gIO
BndV2BrflzrsCLaK+J8uCJF/U+rwZd/HrenbhByCdsi1vn5dCnGfiwicD3M/
jN8HMl9AHM6fCQI/JRxkolKs77+Hmhcm5bDLk4dJ+3Opg4ExEBRLO3gBue0/
oPJiMnD3w/gnyvbNl2Itg/MbQB7mKnOoAbtfGuJ+YPjI71qwL1VPymFDETDE
gOHnvubocoYbEvDwDXl7+eMMRXEH9PAHACWysow=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
      3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 
     3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQPeeIwoaitDKHqvs/bhmvFnWA8SvAfEmHK75JAhGR
ZQ4PXOMdZ12UcXjxe+XHS54Ivk672M1z9gh+ivV9/17LMgcDYyAolnYAGZdh
XuYQ8vbyxxkPpeD8NUI6fOl5ShD7VKD6HRH8SpD9uxUdTpTtmy+li+A/WTr7
iIJemcNakP55CD5/bMB9o+sKcP6MmSDA62ASt8uTxwjB3wIy0KzMQbhyUsnZ
IwIOHg+rRNYB3SuzUWw+UwK/w7nvwY+XAv1zg/e2WOo3Hoc/QO/6eiD4YPdF
oPGB4QU2fqagA3p4AgCfgaF8
     "], CompressedData["
1:eJxTTMoPSmViYGCQAmIQ3fo6cIdcdJmDiTEQbBZ1gPE91hxdzvBDBM7/su/j
1vRtQg5sjVOdu8PKHNxB8haCDh1iN899Dyxz8H/iecl0Mr8DAwj4lDn8B4H9
fA467UAF7gg+Sxif7iZHBP9H8OOls23KHKrv/7hlrC3gMO/98mPelmUOO4Kt
Iv6nCzpsmgsUMC9zONi9r8mEWQjOB6vnRvCFKyeVnF2C4IPdd0MCzgd5z7hY
EtW8ZkkHj4dVIussof4Tk3LwMe90TLAtc9gPkneWdrjimyQQ4VzmIL9rwb7U
d9IOAb3T84Q8EXywfn8EXxdkQUiZw33XeMdZH6UcdnnyMGmHlznEqEbInPsj
CTEvsswh+O3ljzMUJeHhC3Y/i4QDenwAADSkvqw=
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
      1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQzdY41bl7TZmD+ieVl7NWCjrA+DuCrSL+pws7bDlR
tm/+Ckw+TD2M/7ott9soWsAhSSDCcsuyMgcTYyDYzO9Q8VLNkGMJgi9289z3
4PmY/P6Ibn/GAEE4H2Y+jJ8GAm4ScP6B7n1NJsnSDhkT39bYTy5zmDMTCH7K
OHg8rBJZ147gt7wO3CFXi+DX2pvG7Souc/iy7+PW9G/ScH6EaoTMuTuScP5O
kH+fS0DsLStz+AxSHybhwBLGp7upEsEH21+L4IPtry9zmAm2D8FvUWBXPXNF
Es53X3N0OcMMKYdNc98vPwbUH/D28scZitIOTy8o3f5ZVeZQc//HLWNvabh6
sHvFZCDx04bgNwC5Oe1o8n0IPlj/1DKH6SD33JSC89cK6fCl20nA+UEg+x3F
Hf6s/HjJF6hfAxT+muIQ97WWOfSB4kdA3KFGZJ37w5oyB5HKSSVnVcQg+gvL
HHpB8h9EHN4Ag7s1H+o/CWE4vxrkH24hON++xLH29Bw+B2DomcYBzbvBe1ss
9RuPw98rwBTTiuA/8O+dnteH4C+Q0r+rMqXMwf+J5yXTyfwOOc9/r/w4rcxB
fteCfal8gg4KG4oyJk5HpC+we2dB05MnrwOIW7UAwbcEJeCFCD5KfuhE4wPT
IwAu9XTw
     "], {{361.355, 4.82031}, {361.355, 4.05}, {360.703, 
     3.8437499999999996`}, {360.384, 3.8437499999999996`}, {359.972, 
     3.8437499999999996`}, {359.62199999999996`, 4.12188}, {
     359.62199999999996`, 4.50313}, {359.62199999999996`, 5.02656}, {
     360.11400000000003`, 5.56719}, {361.355, 5.607810000000001}, {361.355, 
     4.82031}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1,
     3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIxIGYC4lMLXbd9vljmMGMmCPA6wPgmxkCwmd9Bp13s
5rmTCH7LAaCKE5j8ncFWEf/dBeH8NUI6fOl5Sg5XfJMEIraWOTxwjXec5Yjg
V97/cct4t6JDB9D473sR/LhdnjxM+8sc1oL0z0Pw+WMD7htdV4DzYfbB+DD3
bPv890rFXgQfZh86H+bfPys/XvLdVeag/knl5ayTvA6NU527cw4i+AobijIm
HkbwnyydfUThGIIPtv8sgo8engCIuZ2N
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIxIGYC4hTr+/69yuUOM2aCAK8DjG9iDASb+R2OKGwo
ypBG8GWigCokMfk7g60i/rsLwvlrhHT40vOUHHKe/175ka3c4YFrvOMsRwS/
8v6PW8a7FR1Axk/kR/B/BD9eOlug3GEtSP88BJ8/NuC+0XUFOB9mH4wPc09A
7/Q8IX4EH2YfOh/m36nO3TnPucsd1D+pvJx1ktdBRv+uCpswgr/Lk4dJWxTB
r7U3jdsljuCD7ZdD8NHDEwBzvpOX
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 
    1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {
    0, 1, 0}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIlIGYC4p91WXtK8ssdZswEAV4HGN/EGAg28zu4bvv8
90oagq/TLnbzXGq5wwPXeMdZggJwfvDbyx9nLBRElb8o4yCyzv1hVVC5g+ua
o8sZKhD8mvs/bhlnSzu0vg7cIReN4D9ZOvuIQgzUPmME/0D3viaTxZJw/pu2
3G4jaRE4/z8IxAs6vAEa1xoK5e/nc+gAOue7N4I/RYIljM8RwWdrnOrc7VDu
EK0aIXNujwCc367ArnomRAjOh/lnjUxUirUuwj8wPsz9NSAPmmHywf4JRvDX
CunwpddJwPng4N8pDOf3R3T7MxYIwvk3eG+LpX7jgdjnjeDv8uRh0g5H8C23
nCjbBwxP4cpJJWePCDi8rbE3jQOGj/yuBftS+QQdvIDK27HwYfrR0wMAmyTt
Yg==
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 
    3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {
    1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 
    0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBOIAIGYCYgmWMD7dB+UOM2aCAK8DjG9iDASb+R0qXqoZ
ctxA8C8o3f5Zdw2TvzPYKuK/uyCcL79rwb7UPAk4P+Tt5Y8zGKUdTOJ2efJc
Knd44BrvOOuijMPEtzX2pkcQ/Isg9TsQfJ1Nc98v3wTjSzlsOVG2b/6GcgeR
ykklZ59IOuyQa30duA5qn56MQ0Dv9Dyh5Qj9rts+/70yD8EXWef+sGoSgg82
r6fc4T8IzJdyeApycBfU/COSDoza7WI3sfBh+h/4Ay2sKHdwXXN0OUMFgl9z
/8ct42xphymgAG1E8EHWizRBw88YwT/Qva/JZLEknA8LTxT1wPBma5zq3N2A
4MPsQ+fD4lMmKsX6fm25g/onlZezTvI6gIKjohnBt+h0THjahuD/CH68dHYX
gh8ECuB+BP+IwoaijKkI82F8mP1A165z70XwLUEB3I3Jh/kPhc8uDuevF9Lh
S4+TcgBF/7Gp0Ph9J+2gAwz+c3MRfHB6Wobg/6zL2lOyHMr3k0Ll90nA+TD7
YXyY+wJB/l2K4MPsQ+fD/A/272JE+DCB0scKBP/Pyo+XfNcg+B1A7d/XI/gS
QG7wVgQ/BBj8R3YhzIfx4fZD8wOM3/Ia6OKNmHyY/1D4wPCF8WHhCww9Ju3d
iPAD8w+jhedpBB/svzOI8EXhA8MXxofZD+PD3AfyfvBpBB9mHzof5n9dkH9P
IMLnhLd5p+M5BN8DFAEXEfwrvkkCEVcRfCDPcsstpPBGK+8ATnw59g==
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQfczbvNORpcJhxkwQ4HWA8U2MgWAzvwMDCPwph/O3
ff57peJ3uUPw28sfZzAKwPlgdQ6CcP4D13jHWRdlHDYUZUx8+6LcwXXN0eUM
FQh+zf0ft4yzpR2mSLCE8X1E8Ce+rbE3/VTu8KYtt9vIGsGvAMmvloTzdwZb
Rfx3F4TzYe57qWbIseYDgs/WONW5+wUmH+Zfg7sqbI1vyx3UP6m8nHWS12HL
ibJ9878g+J48TNrt3xB8kHN1fyD4Ou1iN8/9R/DRwxMAroicmg==
     "], {{383.813, 8.48438}, {383.813, 8.746879999999999}, {383.606, 
     8.929689999999999}, {383.37699999999995`, 8.929689999999999}, {383.145, 
     8.929689999999999}, {382.9390000000001, 8.746879999999999}, {
     382.9390000000001, 8.48438}, {382.9390000000001, 8.253129999999999}, {
     383.12199999999996`, 8.04688}, {383.37699999999995`, 8.04688}, {
     383.62199999999996`, 8.04688}, {383.813, 8.253129999999999}, {383.813, 
     8.48438}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGITIGYC4skSLGF8gRUOM2aCAK8DjG9iDASb+R3WF2VM
fOuB4B9R2FCU4Y7J3xlsFfHfXRDOl9+1YF9qngScDzZfUtqhPmtPyWSnCocH
rvGOsy7KOKyWiUqxNkXwt5wo2zdfA8E373RMeKpU4bAdZH67lIM3SECxwkGk
clLJ2SOSDukT39bYY+HD9Ltu+/z3Cl+Fg+uao8sZKhD8mvs/bhlnSzv8rAM6
SBzBF1nn/rBKAuo/YwT/QPe+JpPFknA+zL8o6oHhkfP898qPYgg+zD50Piy8
mw+cWugqUuGg/knl5ayTvA6g4LgvieDPe7/8mLcsgh+3y5OHSRHB3yHX+jpQ
DcHXbhe7eU4bYT6MD7Mf6FqRdcoI/nwp/bsqSph8mP9Q+OzicP56IR2+9Dgp
B6BvL/nqQOP7nbQDKDhETBB8UHBcskbwa+xN43bZVjj0R3T7M06QgvPB8n0S
cD7Mfhgf5j5Q9JraIPgw+9D5MP+/DgSGkCUifFpBAvYIPiw9wvjHQQnMDcEH
G+ON4KPnFwBxk1it
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
      3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
     0}}}, {CompressedData["
1:eJxTTMoPSmViYGAwBmIQPV9K/67KtAoH9U8qL2etFHSA8XcEW0X8Txd28EsS
iLCchMmHqYfxX7fldhtFCzj8Xvnxku+ECgcTYyDYzO8g1Hzg1MJeBH99UcbE
tx2Y/P6Ibn/GAEE4H2Y+jJ8GAm4ScP6B7n1NJsnSDkza7WI3ayoc5swEgp8y
Dg+rRNa5FyL4cq2vA3ekIfjiN899D46tcPiy7+PW9G/ScH6EaoTMuTuScP5O
kH+fSzj8B4H4CofPIPVhEg5z3y8/5p2M4DOC7E9D8MH2Z1Y4zATbh+C3KLCr
nrkiCee7rzm6nGGGlIO3eadjQnqFQ8Dbyx9nKEo71GftKZmcUuFQc//HLWNv
abh6sHvFZCDxU4Dgg7hshWjyFQg+WH99hcN0kHtuSsH5a4V0+NLtJOD8IJD9
juIOU527c56XVzhogMJfUxzivvwKhz5Q/AiIOwBVP6wC+lekclLJWRUxiP7o
CodekPwHEYcWYHDLRUL9JyEM51eD/MMtBOfblzjWnp7D5wAMvXPfUyscbvDe
Fkv9xuMwPQ+YYvIQ/IqXaoYcFQi+5ZYTZftqKxz8n3heMp3M78DWCHRxQ4WD
/K4F+1L5BB12efIwaTci0hfYvS3Q9OTJ6wDiinQh+Jd9gQm4G8FHyQ+daHxg
egQAfx9o1A==
     "], {{391.955, 4.82031}, {391.955, 4.05}, {391.303, 
     3.8437499999999996`}, {390.984, 3.8437499999999996`}, {
     390.57199999999995`, 3.8437499999999996`}, {390.2219999999999, 
     4.12188}, {390.2219999999999, 4.50313}, {390.2219999999999, 5.02656}, {
     390.71399999999994`, 5.56719}, {391.955, 5.607810000000001}, {391.955, 
     4.82031}}}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGITIGYC4p91WXtK7lc4zJgJArwOML6JMRBs5ncQu3nu
e/B1BF+7HShyFZO/M9gq4r+7IJwvv2vBvtQ8CTgfbL6ktMPTC0q3f16ocHjg
Gu8466KMg1DzgVMLDyP40vp3Vdi2I/jz3i8/5r2xwmE7yPx2KYdNc4EC6ysc
RConlZw9IukAdN3jpVj4MP2rZaJSrOdWOLiuObqcoQLBr7n/45ZxtrRDPMhB
SxH8apF17g+XQf1njOAf6N7XZLJYEs6H+RdFPTA8LvsmCUQsRfBh9qHzYeH9
Us2QY82iCgf1TyovZ53kdQAFh+sKBJ8ljE9302oE/4jChqKM9Qi+fOvrwB1b
EPyJb2vsTXchzIfxYfYDXVslsgnBZ2uc6ty9AZMP8x8Kn10czl8vpMOXHifl
APSt5ZZd0Ph+J+0ACo6qQwi+H0jBKQT/8dLZRxTOVDj0R3T7M06QgvPB8n0S
cD7Mfhgf5j5Q9M4+heDD7EPnw/wftEOu9fVxRPgAQ0uu9SyCD0uPML4uKIFd
QfD/g8BNBB89vwAA0tB5nw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4odVIuvcpSsdolUjZM7NEXKA8dcI6fCl/xNy
EGo+cGqhJIKfPvFtjT0S34BjjUyUBIJfa28at0u80uHLvo9b078JOYjdPPc9
GMgXrpxUcnaJkMPsIwobisQqHV635XYb/RZ0qAZa91Co0qE3otuf8QOfgwRL
GJ8uG4IPst71XwWc//SC0u2fnyqg9gnA+SbGQLBZFM5PTwMCNykHoGtN4/5U
OKwHq5d2OP89+PFS1ko4/wwIsCH4Kdb3/Xt5Efz/ICBY6VBz/8ct42xpB6Ds
9Dy+SoeAt5c/zlCUdgjcIdf6GqgebF+aFJwvAvIvC4Kv/knl5SxNSUh4CVQ6
gJW3SThMde7OeS6M4IO8YSyO4MtEAV0EDO+ZICApCeeD3c0jBeengtSzyTis
BgkA3TsHpP6nDCQ+WRF8sDmfK+D8c6DweF4BsbdYEs6vAvl3tSicHwzy70Jo
fH2pcLjBe1ss9RuPg3mnY8JTlko433Xb579XxBB8WHp6A4pva0T6gqU3AGbe
FQw=
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQvc79YZVIRKVDtGqEzLk5Qg4w/hohHb70fUIOLGF8
upvCKx36I7r9GQWEHUzidnnyhCH4upvmvl8eguC/rbE3jQPyv+z7uDX9mpDD
46WzjygA+cKVk0rOLhFySLa+79/rX+kgs1FsPpMCv8OWE2X75rtUOvSC9H/g
c9gh1/o60AnB/x4MNMEGwZ+eJ9R8wKzS4UD3viYTZQGHnOe/V340qnSYCQaC
DkDdO+T0Ee6B8T3WHF3OICEK5589AwQ8Yg5ePEza7SEIPtA3x7zDEXxYeKDz
dwRbRfw/juC/acvtNpot6RD/9ILS7cBKhzkg5/yUcQgCecgewZ8vpX9XxQDB
Bzn/knKlQ7sCu+qZLZJw/kGQ/w6Lwvnqn1Rezlop6JACCj/DSocbvLfFUr/x
OChsKMqY6Ijgg4J/VyCCD3Nf8NvLH2c8FHRAj28Ay/DjZw==
     "], {{404.96399999999994`, 5.71875}, {402.953, 5.71875}, {403.025, 
     6.831250000000001}, {403.7, 7.0218799999999995`}, {403.995, 
     7.0218799999999995`}, {404.92499999999995`, 7.0218799999999995`}, {
     404.95599999999996`, 5.90156}, {404.96399999999994`, 5.71875}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYCYveHVSLrDlY6RKtGyJybI+QA468R0uFL/yfk
UPFSzZDjAIJ//nvw46X7EfzpeULNB/Yh+E+Wzj6iAOR/2fdxa/o3IYcae9O4
XXsrHYQrJ5WcXSLkwKDdLnZzT6XD67bcbqPfgg4PgNa576x06I3o9mf8wOdQ
n7WnZPIaBP8F0Po1SxB8b/NOx4SZMPsE4HwTYyDYLArnp6cBgZuUQ8hjoIMW
VTqsB6uXdjCJ2+XJswaJD9K3FsE/sdB12+fNCD7YnB2VDjX3f9wyzpZ2cN/2
+e+VLZUOAW8vf5yhKO2wXa71deAWqH1pUnC+CMi/LAi++ieVl7M0JSHhta3S
Aay8TcLhz8qPl3x3IfgzZgLBXgS/5cCpha7A8AcJz5SUhPPPgACPFJyfClLP
JuMg0AwU2F7pMAek/qcMJD5XI/j/QWAmgg8Oj75KB1AwGBdLwvlVIP+uFoXz
g0H+XQiNr9mVDjd4b4ulfuNxmP9++THv1Qj+GpmoFOu9CD4sPb0Bxbc1In3B
0hsAYTYeGw==
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4,
      3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
     1, 3, 3}}}, {{{416.373, 5.392189999999999}, {416.373, 
     6.385939999999999}, {415.55500000000006`, 7.243750000000002}, {
     414.5060000000001, 7.243750000000002}, {413.4560000000001, 
     7.243750000000002}, {412.63900000000007`, 6.385939999999999}, {
     412.63900000000007`, 5.392189999999999}, {412.63900000000007`, 
     4.3999999999999995`}, {413.489, 3.62031}, {414.5060000000001, 3.62031}, {
     415.53099999999995`, 3.62031}, {416.373, 4.3999999999999995`}, {416.373, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQrb9p7vvlvyod3rTldhvdFnWA8UUqJ5WcTRFxSE8D
AiBfGMRfIuTAoN0udvNbpUN/RLc/Y4CgwxGFDUUZnysd1D+pvJzFKeDAEsan
u+ltpUMvSP4Dn0POnpLJEi8Q/DUyUSnWDxH8Kc7dOc9vVzpU3/9xy9hbwOFE
2b75UjcrHXYEW0X8Txd0mA6Sv1rp8GXfx63p24Qc3gTukGu9CnWfiwicD3M/
jN8HMl9AHM6fCQI/JRy2f/57peIm1LwwKYeQx0tnH7lT6WBgDATF0g5PgFyF
R1B5MRm4+2H8FIEIyy3vEHwJkIe/VDrUgN0v7XAc5P7vlQ7yuxbsS9WTcvDg
YdJuB4af+5qjyxluSMDDN+Tt5Y8zFMUd0MMfALchvro=
     "]}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
     1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 
    3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYC4vv+vdPzrKocHrjGO866KOUA48vvWrAv9Z20
gz7HGpkoM5i8jEPI46Wzjxgg+BeUbv+s00DwzTsdE54qVTns797XZOIs7eCf
JBBhqVDl8KYtt9uoWtIhZ0/JZAksfJh+k7hdnjx8VQ6ua44uZ6hA8Gvu/7hl
nC3tkAI0bosYgl9jbxq3S7zKwcQYBBD8AyD7F0vC+TuDrSL+uwuiqt/M7zDh
LVBEDMGH2YfOnzETBHgd4oFcJuEqB/VPKi9nneR1+A8Ckgj+FAmWMD5ZBJ+9
capztwqCfwYEkPig4BbSRZgP48Ps9+Bh0m7XQvDTJwIdrIjgg90D5IO9bywA
57uDwi9CEM4/C7KXRwzOB8dvnoRDzvPfKz8C3ROhGiFz7o60w/8rFS/VDBHx
/wYUYMD4Brv7jLTD8bJ986X0ofweBB+WfmD8FgV21TNXJB2AnLsqRlUOB0Hx
kSzpkACKPxME32LLibJ95gg+LP2JVE4qOfsEwYeZDwAUvhfR
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
    0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {
    1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJtIGYC4jUyUSnW+VUOD1zjHWddlHKA8eV3LdiX+k7a
4c+Vipdq2TB5GQf5DUUZE1MR/Pnvlx/zjkXwWcL4dDeFVzns797XZOIs7SCj
f1eFLbTK4U1bbrdRtaSDeadjwtMQTD5MP4N2u9hNpyoH1zVHlzNUIPg193/c
Ms6WdgAZ1+iN4HvwMGm3+1Q5mBiDAIJ/AGT/Ykk4f2ewVcR/d0FU9Zv5HeJ3
efIweSP4MPvQ+TNmggCvgw6Qe869ykH9k8rLWSd5Hc6AgB+Cn/D0gtLtQAT/
im+SQEQkgg82B4kPCu77iQjzYXyY/eI3z30PjkfwTeKADg5D8MHuAYYv2PvG
AnC+Oyj8IgTh/LMgd/KIwfng+M2TcLDYcqJsH9A9EaoRMufuSDucWei67XMq
Iv53AINHG8gH+/OMtMMU5+6c58lQfg+CD0s/MH6LArvqmSuSDjnPf6/8mFbl
cBAUH8mSkPjLRPDZG6cCdSD4sPQnUjmp5OwTBB9mPgDsChyy
    "]], FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{
     0, 2, 0}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGBQAGIQ/aBKZJ376iqHaNUImXNzhBxg/DVCOnzp+4QczDsd
E56uqnLoj+j2ZxQQdkif+LbGfiWCH//0gtLt5Qi+/IaijIlA/pd9H7emXxNy
EL957nswkC9cOank7BIhh+l5Qs0HFlU5yGwUm8+kwO/w/PfKj5emVzn0gvR/
4HN4E7hDrnUqgq/TLnbzXD+Cf2ah67bPnVUOB7r3NZkoCzjMl9K/q9JW5TAT
DAQdtsu1vg5sQrgHxvdYc3Q5g4QonH/2DBDwiDnU2JvG7VqO4AN987NuFYIP
Cw90/o5gq4j/xxH8N2253UazJR2mSLCE8S2tcpgDcs5PGYeW10APTUbwr/gm
CUQ0I/gyQOezlVc5tCuwq57ZIgnnHwT577AonK/+SeXlrJWCkPBrqXK4wXtb
LPUbj0PI46Wzj0xB8NcDg//tEgQf5r7gt5c/zngo6IAe3wA4VOby
     "], {{426.164, 5.71875}, {424.153, 5.71875}, {424.2249999999999, 
     6.831250000000001}, {424.90000000000003`, 7.0218799999999995`}, {
     425.19499999999994`, 7.0218799999999995`}, {426.12499999999994`, 
     7.0218799999999995`}, {426.15599999999995`, 5.90156}, {426.164, 
     5.71875}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1,
     3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
    3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGINIGYC4vXuD6tEXlQ5RKtGyJybI+QA468R0uFL/yfk
cN+/d3reMwTfJG6XJw8S//+VipdqTxF8Dx4m7fYnVQ5f9n3cmv5NyOHJ0tlH
FIB84cpJJWeXCDmkT3xbY/+4yuF1W2630W9BB5B16+5XOfRGdPszfuBzeH5B
6fbPSwg+yHqh0wj+lrnvlx/bD7NPAM43MQaCzaJwfnoaELhJOezwBDroZJXD
erB6aYc5RxQ2FF1C8GfMBILLCL4+xxqZqFsI/hkQuFflUHP/xy3jbGkHoGyK
9e0qh4C3lz/OUJR2kG99HbjjFtS+NCk4XwTkXxYEX/2TystZmpKQ8Lpb5QBW
3ibhkCAQYbnlAYL/HwQeI/gv1Aw51gDDG+TMmZKScD7YXTxScH4qSD2bjEP5
S6AA0L1zQOp/ykDi8xKCD3bnAQQfHB5bqhxAwWdcLAnnV4H8u1oUzg8G+Xch
NL4OVjnc4L0tlvqNx4EljE9300UEX6D5wKmFjxF8WHp6A4pva0T6gqU3ACiW
JlA=
    "]], FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 
    3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGIZIGYC4vXuD6tEJKod0tOA4JiQA4yvsGvBvtQ+EYf5
Uvp3VUQw+V/2fdyafk0IzheunFRydomAw4S3NfamAtUOvRHd/owf+Bx8zDsd
E7gRfAbtdrGbTJh8YzAQgvPB5m9D8A1A0sXSDjpA7jlRTP5/EKiXgatH558+
AwQ6ig4g5zz9VwXnhzxeOvsIkN+qwK56pkTeQX5DUcbEn1UQ9xXIOFhsOVG2
722Vg+uao8sZIhB8mP07PHmYtH9i8mHhCePbljjWnpbhcwBpn89S7XCD97ZY
6jceB5F1wADnQvDjdwE1CCP4sPg42L2vySRZwAE9vgDsbbWs
    "]], FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
     0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
     1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQA2IQPUWCJYzPsdphxkwQ4HWA8U2MgWAzv8MZELBA8FsO
nFroCuQHv738cQajAJzPAAIOgnD+A9d4x1kXZRxq7E3jdqlWO7iuObqcoQLB
r7n/45ZxtrRDwtMLSrd1Efz4XZ48TPrVDm/acruNrBH8CpD8akk4f2ewVcR/
d0E4H+a+7Z//XqnQRfCv+CYJRKhi8mH+/bPy4yVfrWoH9U8qL2ed5HVomOrc
nWOI4IvfPPc92BjBfw507k8TBP978OOls20QfPTwBAB5d5Iy
     "], {{435.61300000000006`, 8.48438}, {435.61300000000006`, 
     8.746879999999999}, {435.40599999999995`, 8.929689999999999}, {
     435.1769999999999, 8.929689999999999}, {434.94499999999994`, 
     8.929689999999999}, {434.739, 8.746879999999999}, {434.739, 8.48438}, {
     434.739, 8.253129999999999}, {434.92199999999997`, 8.04688}, {
     435.1769999999999, 8.04688}, {435.42199999999997`, 8.04688}, {
     435.61300000000006`, 8.253129999999999}, {435.61300000000006`, 
     8.48438}}}], 
   FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{1, 4, 3}, {
     1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
     3}}}, {{{440.373, 5.392189999999999}, {440.373, 6.385939999999999}, {
     439.55500000000006`, 7.243750000000002}, {438.5060000000001, 
     7.243750000000002}, {437.4560000000001, 7.243750000000002}, {
     436.63900000000007`, 6.385939999999999}, {436.63900000000007`, 
     5.392189999999999}, {436.63900000000007`, 4.3999999999999995`}, {437.489,
      3.62031}, {438.5060000000001, 3.62031}, {439.53099999999995`, 
     3.62031}, {440.373, 4.3999999999999995`}, {440.373, 
     5.392189999999999}}, CompressedData["
1:eJxTTMoPSmViYGCQBGIQrb9p7vvlVdUOb9pyu41uizrA+CKVk0rOpog4pKcB
AZAvDOIvEXJg0G4Xu1lW7dAf0e3PGCDocERhQ1FGcbWD+ieVl7M4BRxYwvh0
N+VWO/SC5D/wOeTsKZkskYHgr5GJSrFORPCnOHfnPI+udqi+/+OWsbeAw4my
ffOlIqsddgRbRfxPF3SYDpIPrXb4su/j1vRtQg5vAnfItYZC3eciAufD3A/j
94HMFxCH82eCwE8Jh+2f/16piISaFyblEPJ46ewjMdUOBsZAUCzt8ATIVUiC
yovJwN0P46cIRFhuyUPwJUAeLql2qAG7X9rhOMj95dUO8rsW7EvVk3Lw4GHS
bgeGn/uao8sZbkjAwzfk7eWPMxTFHdDDHwD0f7Js
     "]}], 
   FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0,
     1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
    3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 
    3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 
    3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGITIGYC4ikSLGF8F6sdZswEAV4HGN/EGAg28zusL8qY
+PYEgn9EYUNRxnFM/s5gq4j/7oJwvvyuBftS8yTgfLD5ktIO9Vl7SiYfqnZ4
4BrvOOuijMMamagU660I/pYTZfvmr0DwzTsdE54uqnbYDjK/XcrBBySwsNpB
pHJSydkjkg7pE9/W2GPhw/S7bPv890pftYPrmqPLGSoQ/Jr7P24ZZ0s7/KkD
Omg6gi+yzv1h1Qyo/4wR/APd+5pMFkvC+TD/oqgHhkfO898rP05D8GH2ofNh
4d1y4NRC1ynVDuqfVF7OOsnrAAqO+zMR/Pnvlx/znovgx+/y5GFaiOBvl2t9
HbgMwddpF7t5bjXCfBgfZj/QtSLrFiP486X076oswuTD/IfCZxeH89cL6fCl
x0k5/Fn58ZLvGmh8v5N2WA+yYAuCDwqOS7sR/Bp707hde6sd+iO6/RknSMH5
YPk+CTgfZj+MD3PfBGD0mu5BSp9Q+9D5MP+/Cdwh17oTET4tr4EC+xF8WHqE
8Y97AxPYMQQfbM5pBB89vwAAE49zUw==
    "]]},
  AspectRatio->Automatic,
  BaselinePosition->Scaled[0.6620575499588702],
  ImageSize->{693.6352710668262, 53.33333333333333},
  PlotRange->{{0., 446.3}, {0., 32.660000000000004`}}]], "Output",
 CellChangeTimes->{3.8546472364482703`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"869df0db-8989-485a-b802-c3eec7f62d5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thresholdFactor", "=", "9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dynamicThresholdBias", "=", "15"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dynamicThresholdPower", "=", 
   RowBox[{"-", "0.5"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solidSegmentSizeThreshold", "=", "25"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamicThresholdFactor", "=", 
   RowBox[{
   "getDynamicThresholdFactor", "@", "filteredMeanInverseLuminance"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotDynamicThresholdFactor", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"dynamicThresholdFactor", "[", 
      RowBox[{"[", 
       RowBox[{"lowerLimit", ";;", "All"}], "]"}], "]"}], "^", 
     "dynamicThresholdPower"}], "//", "ListLinePlot"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dynamicThreshold", "=", 
   RowBox[{"1", "-", 
    RowBox[{"thresholdFactor", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "2"}]}], "*", "filteredMeanInverseLuminance", "*", 
     RowBox[{"dynamicThresholdFactor", "^", "dynamicThresholdPower"}]}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845909543370329*^9, 3.8459096724252596`*^9}, {
   3.8459097233291535`*^9, 3.84590977676945*^9}, {3.845909937074065*^9, 
   3.8459100130973835`*^9}, {3.8459502519495106`*^9, 3.845950269919157*^9}, 
   3.845950504060326*^9, {3.8459506113561225`*^9, 3.845950612307982*^9}, {
   3.8459506927812414`*^9, 3.8459508305080595`*^9}, {3.845952507485235*^9, 
   3.8459525679950294`*^9}, {3.8459543516347995`*^9, 
   3.8459544330509796`*^9}, {3.84595544562661*^9, 3.845955552706379*^9}, {
   3.8459555874144983`*^9, 3.845955652322735*^9}, {3.845955767555001*^9, 
   3.8459558866664104`*^9}, {3.845955924443347*^9, 3.8459559245141354`*^9}, {
   3.845956019355082*^9, 3.845956053770317*^9}, {3.8459566207888765`*^9, 
   3.8459566238903265`*^9}, 3.845956704410083*^9, 3.8459567608839855`*^9, 
   3.8459567930996714`*^9, {3.845956884051465*^9, 3.845956903009014*^9}, {
   3.845957046370531*^9, 3.8459570897059774`*^9}, 3.845957157042984*^9, {
   3.845958391954118*^9, 3.845958417242098*^9}, {3.8459584514335356`*^9, 
   3.8459585725541267`*^9}, {3.845958621818138*^9, 3.8459586407608213`*^9}, {
   3.8459587312095995`*^9, 3.845958802097872*^9}, {3.845961626568315*^9, 
   3.845961629496485*^9}, {3.84596195528192*^9, 3.845961984895729*^9}, {
   3.8459623202650523`*^9, 3.845962320568241*^9}, {3.8459634321686*^9, 
   3.8459634353760233`*^9}, {3.8459649728155494`*^9, 3.845964973591539*^9}, {
   3.845965041551626*^9, 3.845965123167545*^9}, {3.8459653180409107`*^9, 
   3.8459653181037426`*^9}, {3.8459653532403493`*^9, 3.845965353775422*^9}, {
   3.845965386671687*^9, 3.84596540153469*^9}, {3.84596611210289*^9, 
   3.845966114110417*^9}, {3.8459662730078297`*^9, 3.845966292624093*^9}, {
   3.8459663275356593`*^9, 3.8459664033827305`*^9}, {3.845966437022998*^9, 
   3.8459664794396076`*^9}, {3.845966537607587*^9, 3.845966595920025*^9}, {
   3.8459707298047504`*^9, 3.8459707479089136`*^9}, {3.8459707888541756`*^9, 
   3.8459707889658794`*^9}, {3.8459708258150196`*^9, 3.845970825885832*^9}, {
   3.8459708599911385`*^9, 3.8459708601666694`*^9}, {3.8459709100805845`*^9, 
   3.8459709721431336`*^9}, {3.845971002696641*^9, 3.845971122968959*^9}, {
   3.84597115655338*^9, 3.8459711972806015`*^9}, 3.845971233560704*^9, {
   3.8459714495067167`*^9, 3.8459715554495955`*^9}, {3.845971610482169*^9, 
   3.8459716630282326`*^9}, {3.8459716952051973`*^9, 3.845971700260801*^9}, {
   3.8459717382933044`*^9, 3.8459718408944044`*^9}, {3.8459718823670626`*^9, 
   3.8459719406325703`*^9}, {3.845972114545843*^9, 3.8459721320741143`*^9}, {
   3.845972184866376*^9, 3.845972203081747*^9}, {3.8459722581945615`*^9, 
   3.845972260037639*^9}, {3.8459724243074856`*^9, 3.8459724252749023`*^9}, 
   3.845974270603961*^9, {3.8459743010194397`*^9, 3.845974326764326*^9}, {
   3.8459743621723213`*^9, 3.8459743786433973`*^9}, 3.8459744752542467`*^9, {
   3.845974509237257*^9, 3.8459745145897217`*^9}, {3.8459745452377863`*^9, 
   3.84597457614846*^9}, {3.845974842849431*^9, 3.845974848400692*^9}, {
   3.845975943459895*^9, 3.845975969546257*^9}, 3.845977834194948*^9, {
   3.8459888951760855`*^9, 3.845988896065402*^9}, {3.8459890736411476`*^9, 
   3.8459890876391287`*^9}, {3.8459891277838593`*^9, 3.845989133134655*^9}, {
   3.845989191454615*^9, 3.8459892642635365`*^9}, {3.845989314656313*^9, 
   3.8459893148158865`*^9}, 3.8459894388242435`*^9, {3.845989486632025*^9, 
   3.84598950865619*^9}, 3.845989544384748*^9, {3.845989712265401*^9, 
   3.845989766192374*^9}, {3.845989797176587*^9, 3.8459897982407436`*^9}, {
   3.8459898632656183`*^9, 3.8459899049941235`*^9}, {3.8459899452894526`*^9, 
   3.8459899488100452`*^9}, {3.8459900209781866`*^9, 
   3.8459900211926413`*^9}, {3.8459900804172373`*^9, 3.84599008910502*^9}, {
   3.8459931712184796`*^9, 3.845993173917273*^9}, {3.845993244226079*^9, 
   3.845993244705798*^9}, {3.845993621828209*^9, 3.84599365247476*^9}, {
   3.845996335168557*^9, 3.8459963464533916`*^9}, {3.8460446959183097`*^9, 
   3.8460448302788467`*^9}, 3.846044861316736*^9, {3.846044941687927*^9, 
   3.846044996361896*^9}, {3.846045086549474*^9, 3.8460450899006357`*^9}, {
   3.846045236907614*^9, 3.846045237803253*^9}, {3.8460453092782583`*^9, 
   3.8460453095495377`*^9}, 3.846045430730301*^9, {3.8460454682274446`*^9, 
   3.84604550108392*^9}, {3.8460456179687963`*^9, 3.8460456189601803`*^9}, 
   3.846046058759465*^9, {3.846046102208618*^9, 3.84604610271129*^9}, 
   3.846048796375161*^9, {3.8460495322592297`*^9, 3.8460495598269377`*^9}, {
   3.8460496213241706`*^9, 3.8460496511319094`*^9}, {3.8460496825009236`*^9, 
   3.846049685636585*^9}, {3.8460498047987227`*^9, 3.8460498073509364`*^9}, {
   3.846049869390954*^9, 3.846049869559506*^9}, {3.846049912624956*^9, 
   3.8460499407212267`*^9}, {3.8460500352019167`*^9, 
   3.8460500387454896`*^9}, {3.8460550405249033`*^9, 3.846055047853356*^9}, {
   3.846068998823269*^9, 3.8460690400248613`*^9}, 3.846820907722457*^9, 
   3.8468360339552836`*^9, 3.846836103121752*^9, {3.846836209529932*^9, 
   3.846836219825457*^9}, {3.8471810604497223`*^9, 3.847181089153965*^9}, {
   3.847342531096121*^9, 3.847342534842058*^9}, {3.847345047912667*^9, 
   3.8473450482873583`*^9}, {3.847345082071897*^9, 3.8473450831747093`*^9}, {
   3.8473451413921566`*^9, 3.8473451440815525`*^9}, {3.8473454053357906`*^9, 
   3.847345407207382*^9}, {3.847516278085207*^9, 3.84751630227416*^9}, {
   3.847516672962224*^9, 3.847516673137755*^9}, {3.847516733850499*^9, 
   3.84751673413078*^9}, 3.847516785027726*^9, {3.84751684217101*^9, 
   3.8475168424183493`*^9}, {3.8475170495472198`*^9, 
   3.8475170761710997`*^9}, {3.847517126531477*^9, 3.847517210163018*^9}, {
   3.8475172988918715`*^9, 3.8475172993546343`*^9}, {3.847517430636756*^9, 
   3.847517431171325*^9}, {3.8475176292120175`*^9, 3.8475178946046987`*^9}, {
   3.847517933628397*^9, 3.847517934731449*^9}, {3.8475181608850827`*^9, 
   3.84751816097983*^9}, {3.847518198348867*^9, 3.8475182442366395`*^9}, {
   3.8475182773722515`*^9, 3.8475183904523616`*^9}, {3.8475184445890627`*^9, 
   3.8475184457156286`*^9}, {3.847518488181303*^9, 3.8475184920117693`*^9}, {
   3.8475185275328684`*^9, 3.8475185368362894`*^9}, {3.847518566869012*^9, 
   3.8475185973995156`*^9}, {3.8475186317414455`*^9, 
   3.8475186479898567`*^9}, {3.8475186796376457`*^9, 3.847518733252194*^9}, {
   3.8475187668767977`*^9, 3.847518785612258*^9}, 3.8475188215175037`*^9, {
   3.8475190199895997`*^9, 3.847519046860896*^9}, {3.847519116725906*^9, 
   3.847519151317233*^9}, {3.847520330350915*^9, 3.8475203304217567`*^9}, {
   3.8479565413408136`*^9, 3.8479565460412436`*^9}, {3.847956580001461*^9, 
   3.8479565917530055`*^9}, {3.8479705653978806`*^9, 3.847970575717288*^9}, {
   3.847970606406227*^9, 3.8479706082851973`*^9}, 3.847970692758359*^9, {
   3.848057709264056*^9, 3.848057718135334*^9}, 3.854296066378257*^9, {
   3.8542962798008366`*^9, 3.8542962798796268`*^9}, 3.8542963111839304`*^9, {
   3.8542963922835865`*^9, 3.85429639277417*^9}, {3.854296430510888*^9, 
   3.8542964328311887`*^9}, 3.8542965598486385`*^9, {3.854296614118681*^9, 
   3.854296618486255*^9}, 3.8542968651452074`*^9, 3.8546278992035666`*^9, 
   3.8546280814124513`*^9, 3.85462814108496*^9, {3.8546281780148287`*^9, 
   3.854628209937656*^9}, {3.8546286126671305`*^9, 3.854628614776907*^9}, {
   3.854628655429254*^9, 3.8546286555238237`*^9}, {3.8546332852615557`*^9, 
   3.854633304783023*^9}, {3.854633359972878*^9, 3.854633379479499*^9}, {
   3.8546335592480764`*^9, 3.8546335756675444`*^9}, {3.8546338638313465`*^9, 
   3.854633878844411*^9}, 3.854634443402361*^9, 3.8546345091389785`*^9, {
   3.8546345575411916`*^9, 3.8546345690084534`*^9}, {3.8546346036222444`*^9, 
   3.854634609324297*^9}, 3.8546346866608925`*^9, {3.8546353495479093`*^9, 
   3.8546354990760036`*^9}, {3.854635533989171*^9, 3.8546356011101522`*^9}, {
   3.854635676127884*^9, 3.8546357464032516`*^9}, {3.854635833668666*^9, 
   3.8546360169650793`*^9}, {3.854636070304155*^9, 3.8546360817399015`*^9}, 
   3.8546361753645225`*^9, {3.854636243243501*^9, 3.854636245017314*^9}, {
   3.8546363183381295`*^9, 3.8546363497726307`*^9}, {3.854638059519458*^9, 
   3.854638130039364*^9}, {3.8546472114056377`*^9, 3.8546472193630342`*^9}, {
   3.854647326019671*^9, 3.8546473503060875`*^9}, {3.8546473892818775`*^9, 
   3.854647423354142*^9}, 3.8546474770104733`*^9, {3.8546475660643997`*^9, 
   3.85464758544209*^9}, 3.854723048419245*^9, 3.854723103443926*^9, {
   3.8615976770053644`*^9, 3.861597712907813*^9}, {3.861614617622486*^9, 
   3.8616146178847847`*^9}, {3.8616146683274827`*^9, 
   3.8616146925169053`*^9}, {3.8616147238142*^9, 3.8616147253002234`*^9}, {
   3.8616147804051256`*^9, 3.8616147825882006`*^9}, {3.8616345910952063`*^9, 
   3.861634739436963*^9}, {3.861634793230516*^9, 3.8616348103745804`*^9}, {
   3.861634842290642*^9, 3.86163496030235*^9}, {3.8616350227809544`*^9, 
   3.861635249413602*^9}, {3.8616353907351394`*^9, 3.8616354877016697`*^9}, {
   3.8616355294369707`*^9, 3.8616356617320232`*^9}, {3.861639445161951*^9, 
   3.861639446196186*^9}, {3.8616394881377726`*^9, 3.8616395104982967`*^9}, {
   3.861639833339301*^9, 3.861639879856825*^9}, {3.8616403174038725`*^9, 
   3.8616405707449207`*^9}, {3.861640615937212*^9, 3.8616406479058123`*^9}, {
   3.8616407062587657`*^9, 3.861640812058736*^9}, {3.8616408664818444`*^9, 
   3.8616408780732756`*^9}, {3.8616409637691383`*^9, 3.861640993873033*^9}, {
   3.8616415223853493`*^9, 3.86164161625955*^9}, {3.8616416910247126`*^9, 
   3.8616417381529446`*^9}, {3.861641799671957*^9, 3.8616418252476535`*^9}, {
   3.861641951305371*^9, 3.861642007991495*^9}, {3.86164205454659*^9, 
   3.8616421335464725`*^9}, {3.8616421693462334`*^9, 
   3.8616422246076145`*^9}, {3.861642293047959*^9, 3.8616423587518663`*^9}, {
   3.861642408095636*^9, 3.8616424458229647`*^9}, {3.8616424826681395`*^9, 
   3.861642626348984*^9}, {3.861642667471582*^9, 3.8616426675663805`*^9}, 
   3.8616427441350026`*^9, {3.8616431830230417`*^9, 3.861643208213668*^9}, {
   3.8616438260552816`*^9, 3.8616438466702423`*^9}, 3.8616449827824163`*^9, {
   3.8616450256788573`*^9, 3.8616450937029533`*^9}, {3.861645357768792*^9, 
   3.8616454160628157`*^9}, 3.8616455270289817`*^9, {3.8616456028944645`*^9, 
   3.8616456736280065`*^9}, {3.861645732430402*^9, 3.861645754308886*^9}, {
   3.8616457893378973`*^9, 3.8616458385254908`*^9}, {3.8616458871496*^9, 
   3.861645901995411*^9}, {3.861645985461068*^9, 3.861646027222429*^9}, {
   3.861646068140587*^9, 3.8616460682283998`*^9}, {3.861646218181641*^9, 
   3.8616462195091867`*^9}, {3.8616463299512887`*^9, 3.8616463314512773`*^9}, 
   3.8616511156349077`*^9, {3.8616836495451145`*^9, 3.8616836887425566`*^9}, 
   3.861683764336149*^9, {3.8616838884483924`*^9, 3.8616838946688814`*^9}, {
   3.8616839792341757`*^9, 3.86168398044793*^9}, 3.8616840867583766`*^9, {
   3.8616841272141857`*^9, 3.861684127272977*^9}, 3.861700280688215*^9, 
   3.8617003236512856`*^9, 3.861714463007943*^9, {3.8617150229301133`*^9, 
   3.861715023766443*^9}, {3.8617157431605406`*^9, 3.861715743693116*^9}, 
   3.861715868435046*^9, 3.86171591298993*^9, {3.861716025718136*^9, 
   3.861716031388693*^9}, {3.8617162267264395`*^9, 3.861716226885015*^9}, {
   3.8617826623551145`*^9, 3.8617826660412755`*^9}, {3.8617922735098605`*^9, 
   3.861792275753862*^9}, 3.8617990327324386`*^9, {3.8618121356621866`*^9, 
   3.8618121843203106`*^9}, 3.861812232074211*^9, {3.8618122626972837`*^9, 
   3.8618122658897533`*^9}, 3.8618123974894085`*^9, {3.86181514725753*^9, 
   3.861815152758788*^9}, {3.861856539918874*^9, 3.8618566249660296`*^9}, {
   3.8618566992143965`*^9, 3.8618567249186563`*^9}, {3.861896810711458*^9, 
   3.861896810773327*^9}, {3.861896852695419*^9, 3.8618968527662826`*^9}, 
   3.86204552029869*^9, {3.8622385069582124`*^9, 3.86223851341966*^9}, {
   3.8624789569392977`*^9, 3.8624789570260653`*^9}, {3.862478992216057*^9, 
   3.862479006074064*^9}, {3.8625045921611843`*^9, 3.862504597813978*^9}, {
   3.8626584464611187`*^9, 3.8626584574987893`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"c3d06f19-3fbc-44bb-8a35-65d2b366c98b"],

Cell[BoxData[
 RowBox[{"thresholdSeries", "=", 
  RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
   RowBox[{"dynamicThreshold", ",", 
    RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Frame\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MaTeX", "[", 
          RowBox[{"#", ",", 
           RowBox[{"FontSize", "\[Rule]", "17"}]}], "]"}], "&"}], "@", 
        "\"\<\\\\boldsymbol{\\\\tau}\>\""}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.868722116738446*^9, 3.868722164497959*^9}, {
  3.8687249323110127`*^9, 3.868724955253047*^9}, {3.8687249874779234`*^9, 
  3.868725031225258*^9}, {3.868725078326995*^9, 3.8687250862851496`*^9}, {
  3.8687251280067463`*^9, 3.8687251338522873`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"f74edd0c-bdc1-4b20-a942-5e328134e566"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<3A_MIL_curve.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "thresholdSeries", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8687251210041804`*^9, 3.8687251385507145`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"294f32d2-f8d3-463a-a2fc-d30aec3d6ad1"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"testSegment", "=", 
     RowBox[{"MILbasedSegmentation", "@", "cleanFrameID"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Colorize", "@", 
       RowBox[{"ImageAdjust", "@", 
        RowBox[{"cleanFrames", "[", 
         RowBox[{"[", "cleanFrameID", "]"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeDetect", "@", "testSegment"}]}], "\[IndentingNewLine]", 
     "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"cleanFrameID", ",", "1", ",", 
     RowBox[{"Length", "@", "allFilteredFrames"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8546475294176025`*^9, 3.8546475516332026`*^9}, {
   3.8616409226579137`*^9, 3.8616409239520164`*^9}, {3.8616410218179936`*^9, 
   3.861641023756963*^9}, 3.8616412562746897`*^9, {3.861641329233631*^9, 
   3.861641351480997*^9}, {3.86164148495464*^9, 3.8616414863418903`*^9}, 
   3.8616433640734277`*^9, {3.8616433958349867`*^9, 3.8616434075636187`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"c99f8b5e-46e3-4f91-ab26-24537ac59914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<4_correction_curve.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "plotDynamicThresholdFactor", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frameSolidMasks", "=", 
    RowBox[{"MILbasedSegmentation", "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "selectedFrameIDs"}]}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.854636267627247*^9, 3.8546362697712927`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"ac8cbc06-5b97-42bc-981c-ded36ae8bb9d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solidification Region & Front Analysis", "Section",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 
   3.8478844747937126`*^9}},ExpressionUUID->"252b1651-74c6-4b87-9a34-\
5e1424428717"],

Cell[CellGroupData[{

Cell["\<\
Solid/Liquid Mask Cleanup + Solidification Front, Liquid Cavity & Channel \
Detection\
\>", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
   3.845826386614379*^9, 3.845826389807841*^9}, 3.8478846445532837`*^9},
 FontSize->24,ExpressionUUID->"d44bae79-2155-4f08-993f-ae6f12d19a4b"],

Cell["\<\
Defaults:

liquidArtefactScale=300;

channelClosingScale=25;
channelSizeThreshold=500;
channelFillScale=10000;

artefactBoundaryFrame=150;
frontSmoothingFactor=3;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.854648137990076*^9, 3.8546481382638226`*^9}},
 FontSize->16,ExpressionUUID->"af2f951b-0167-4564-ad71-69c29669fe04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"liquidArtefactScale", "=", "100"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"channelClosingScale", "=", "50"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"channelSizeThreshold", "=", "500"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"channelFillScale", "=", "10000"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"artefactBoundaryFrame", "=", 
   RowBox[{"Length", "@", "cleanFrames"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"frontSmoothingFactor", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, 3.8478844891777267`*^9, {
   3.847884519873647*^9, 3.847884531768838*^9}, 3.8542967605197096`*^9, {
   3.8542974715514812`*^9, 3.8542974879480343`*^9}, {3.8543009867253885`*^9, 
   3.8543010266118803`*^9}, {3.8615985669702263`*^9, 3.8615985671534195`*^9}, 
   3.8616149711274633`*^9, {3.8616150227887974`*^9, 3.861615023060021*^9}, {
   3.86161509854912*^9, 3.861615098629904*^9}, {3.8616151989416237`*^9, 
   3.8616151997235208`*^9}, 3.861646126180892*^9, {3.861646288364665*^9, 
   3.8616462902436395`*^9}, 3.861646323293974*^9, {3.861646385533365*^9, 
   3.861646386038905*^9}, 3.861646516028651*^9, 3.8616465759878845`*^9, {
   3.861646619005612*^9, 3.861646625884215*^9}, {3.861646686508174*^9, 
   3.861646701387416*^9}, {3.8616467784761796`*^9, 3.8616467785549173`*^9}, {
   3.8616469097482243`*^9, 3.8616469118835135`*^9}, {3.8616469841240654`*^9, 
   3.861646984388358*^9}, {3.8616486157724094`*^9, 3.86164861657719*^9}, {
   3.8616486629392724`*^9, 3.861648663962602*^9}, {3.861648750196353*^9, 
   3.861648750383904*^9}, {3.861648863116704*^9, 3.8616488640831203`*^9}, {
   3.8616489578831463`*^9, 3.86164895793805*^9}, {3.8616838201862717`*^9, 
   3.861683827262398*^9}, {3.8616840178553953`*^9, 3.8616840408139877`*^9}, {
   3.8616974117323895`*^9, 3.8616974399251084`*^9}, {3.861697531982383*^9, 
   3.8616975321817465`*^9}, {3.8616976897332745`*^9, 
   3.8616976901007986`*^9}, {3.8616977306285725`*^9, 3.86169773171072*^9}, {
   3.8616978100682344`*^9, 3.8616978122666903`*^9}, {3.8616980364125943`*^9, 
   3.8616980368109016`*^9}, {3.861698175365344*^9, 3.8616981754431334`*^9}, {
   3.86171497234448*^9, 3.8617149726228333`*^9}, {3.861715146558343*^9, 
   3.8617151473659983`*^9}, {3.8617154467837024`*^9, 
   3.8617154474290237`*^9}, {3.8617155908478317`*^9, 
   3.8617156160780168`*^9}, {3.861715655351269*^9, 3.861715662036565*^9}, {
   3.8617156936385937`*^9, 3.861715694766344*^9}, {3.861715819336651*^9, 
   3.8617158246143527`*^9}, {3.8617163315591917`*^9, 
   3.8617163316769342`*^9}, {3.8617165315901365`*^9, 3.861716531796584*^9}, {
   3.8617827070674033`*^9, 3.861782714558877*^9}, {3.8617923355127344`*^9, 
   3.861792339932969*^9}, {3.8617990709551687`*^9, 3.861799082498283*^9}, {
   3.8618123367778473`*^9, 3.8618123378080034`*^9}, {3.861812373923566*^9, 
   3.861812374111989*^9}, {3.861812474945033*^9, 3.8618124957201385`*^9}, 
   3.861856989366511*^9, {3.8618570279733076`*^9, 3.8618570304536753`*^9}, {
   3.8618571098881283`*^9, 3.861857135086344*^9}, {3.8618571827361155`*^9, 
   3.8618571827580566`*^9}, {3.862238558921383*^9, 3.8622385651082134`*^9}, {
   3.8625046432544403`*^9, 3.8625046657417183`*^9}, {3.8626584936871243`*^9, 
   3.8626584987858753`*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"ffe693f4-2c4a-4eeb-8fee-0aba6aa81b88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"paddingDirections", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"paddingDirectionsArtifacts", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"imageMask", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getImageMask", "[", 
      RowBox[{"inpaintMask", ",", "#"}], "]"}], "&"}], "/@", 
    "frameSolidMasks"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"liquidMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"getImageMask", "[", 
         RowBox[{"inpaintMask", ",", "#"}], "]"}], "&"}], "@", 
       RowBox[{"ColorNegate", "@", "#"}]}], "&"}], "/@", "imageMask"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"liquidCavities", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ImagePad", "[", 
           RowBox[{"#", ",", "paddingDirections"}], "]"}], "&"}], "@", 
         RowBox[{"DeleteBorderComponents", "@", "\[IndentingNewLine]", 
          RowBox[{"ImagePad", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "paddingDirections"}]}], "]"}]}]}], "&"}], "/@", 
       "liquidMask"}], "//", "Parallelize"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"liquidMaskFilledCavities", "=", 
     RowBox[{"getLiquidMasksWithFilledCavities", "[", "\[IndentingNewLine]", 
      RowBox[{
      "liquidMask", ",", "liquidCavities", ",", "artefactBoundaryFrame"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"useMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getImageMask", "[", 
       RowBox[{"inpaintMask", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorNegate", "@", 
         RowBox[{"ImageAdd", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"liquidMaskFilledCavities", ",", "liquidCavities"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"liquidMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"getImageMask", "[", 
       RowBox[{"inpaintMask", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"ColorNegate", "@", "useMask"}], "\[IndentingNewLine]", 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"liquidMaskFilledChannels", "=", 
    RowBox[{
    "getLiquidMasksWithFilledChannels", "@", "liquidMaskFilledCavities"}]}], 
   ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"liquidChannels", "=", 
     RowBox[{"getLiquidChannels", "[", 
      RowBox[{"liquidMaskFilledCavities", ",", "liquidMaskFilledChannels"}], 
      "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"topArtefacts", "=", 
    RowBox[{"getTopArtefacts", "@", "inpaintMask"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solidificationFront", "=", 
    RowBox[{"getSolidifcationFront", "[", 
     RowBox[{"liquidMaskFilledChannels", ",", "topArtefacts"}], "]"}]}], 
   ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884497305993*^9, 
   3.847884546666002*^9}, {3.8480384495573034`*^9, 3.8480384643334284`*^9}, 
   3.848038575396985*^9, {3.8480387186709766`*^9, 3.8480387248373613`*^9}, {
   3.8480387683817663`*^9, 3.8480387767897015`*^9}, {3.848038930325247*^9, 
   3.848038930662402*^9}, {3.8480390467482057`*^9, 3.848039069756689*^9}, {
   3.8480391284930563`*^9, 3.8480391310051317`*^9}, {3.8480427067163343`*^9, 
   3.8480427094201546`*^9}, {3.848042744652419*^9, 3.848042760878853*^9}, 
   3.8542972458145714`*^9, {3.8542973170141277`*^9, 3.8542973593102493`*^9}, 
   3.854297734117786*^9, 3.8542977736560926`*^9, {3.854297837333005*^9, 
   3.8542978493760414`*^9}, {3.854297885821664*^9, 3.8542978873762827`*^9}, {
   3.8542980120918474`*^9, 3.8542980148112044`*^9}, {3.8542985569482813`*^9, 
   3.8542985979795027`*^9}, {3.8542986409492674`*^9, 
   3.8542986531800604`*^9}, {3.8542987851733975`*^9, 3.854298807690396*^9}, {
   3.8542991028038464`*^9, 3.8542991075627604`*^9}, {3.8542994533484793`*^9, 
   3.854299461337246*^9}, {3.8542995358013477`*^9, 3.8542995417141547`*^9}, {
   3.8542997245618486`*^9, 3.854299724687617*^9}, 3.8542998713609037`*^9, 
   3.8543000326002836`*^9, 3.85430076688875*^9, {3.854300946742116*^9, 
   3.854300948733843*^9}, 3.854301117666501*^9, 3.8547962411897154`*^9, {
   3.854796388978172*^9, 3.854796423707259*^9}, 3.8547980718952847`*^9, {
   3.854810411502265*^9, 3.8548104606976337`*^9}, {3.85481113321301*^9, 
   3.8548111423157487`*^9}, {3.8617156591220345`*^9, 3.8617156635414104`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"d247dba2-ba72-462c-9168-6106caf6e8fd"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"useMask", "[", 
    RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "useMask"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884497305993*^9, 
   3.847884552157322*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"3415ebed-5e84-4589-8931-881bd5fa17e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Preview Resulting Masks ]]", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}, {3.8478846445532837`*^9, 
  3.8478846562489805`*^9}},
 FontSize->24,ExpressionUUID->"444e95a4-9f71-42f1-8c30-2a8e29c8079c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkID", "=", "120"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "checkID", "]"}], "]"}]}], "&"}], "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "frameSolidMasks", ",", "imageMask", ",", "liquidCavities", ",", 
        "liquidMaskFilledCavities", ",", "\[IndentingNewLine]", "useMask", 
        ",", "liquidMask", ",", "liquidMaskFilledChannels", ",", 
        "liquidChannels"}], "\[IndentingNewLine]", "}"}]}], 
     "\[IndentingNewLine]", ")"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "20"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884595919291*^9, 
   3.8478846019342346`*^9}, {3.8478846658638425`*^9, 3.8478846723774242`*^9}, 
   3.8480395237174644`*^9, 3.854296725583873*^9, {3.8542975167577972`*^9, 
   3.854297518220046*^9}, 3.854298048573303*^9, {3.854301220908999*^9, 
   3.854301221988044*^9}, {3.8547996278370347`*^9, 3.8547996357206345`*^9}, {
   3.861598007998562*^9, 3.8615980092670984`*^9}, {3.861598060930688*^9, 
   3.8615980610972366`*^9}, {3.861598655010882*^9, 3.8615986552971272`*^9}, {
   3.8615987146379128`*^9, 3.861598726986605*^9}, {3.861615238974611*^9, 
   3.8616152394922285`*^9}, {3.8616153279479885`*^9, 
   3.8616153280995836`*^9}, {3.861646414452985*^9, 3.861646414732237*^9}, {
   3.861646657141641*^9, 3.861646657499694*^9}, {3.861648646139206*^9, 
   3.8616486566022215`*^9}, {3.8616486937399464`*^9, 3.861648704297217*^9}, {
   3.8616489771076865`*^9, 3.8616489772353425`*^9}, {3.8617151623069196`*^9, 
   3.861715170852517*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"601b3238-e7cf-441b-a62e-60a6bfd4ef9d"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"useMask", "[", 
      RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ColorReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
        RowBox[{"Binarize", "@", 
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "5"}], "]"}]}]}], "&"}], "@", 
      RowBox[{"solidificationFront", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "solidificationFront"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884595919291*^9, 
   3.8478845972038956`*^9}, {3.8478849205245123`*^9, 
   3.8478849564888678`*^9}, {3.861649106404149*^9, 3.86164921894671*^9}, {
   3.8616492947969007`*^9, 3.861649295536922*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"885077d5-c44c-4824-8af0-54b1afb4be89"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Solid Mask Overlays >>", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261190913615`*^9}, {
   3.845826396326409*^9, 3.8458264029985676`*^9}, {3.8458267177897425`*^9, 
   3.8458267315822296`*^9}, {3.845826855710351*^9, 3.8458268783665533`*^9}, {
   3.845827040038642*^9, 3.8458270422060313`*^9}, {3.8459620182315845`*^9, 
   3.845962029472042*^9}, {3.846072335563671*^9, 3.8460723375959187`*^9}, 
   3.84607441134029*^9},
 FontSize->24,ExpressionUUID->"741d095f-9fcf-4cd6-bb33-f13ec53abb92"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"frameSolidMaskOverlays", "=", 
    RowBox[{"getSolidMaskOverlays", "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "selectedFrameIDs"}]}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.846069156600618*^9, 3.846069210671185*^9}, {
   3.8460692527437825`*^9, 3.8460692559849443`*^9}, {3.8460693034578123`*^9, 
   3.8460693109527326`*^9}, {3.8460693699644036`*^9, 
   3.8460693833104067`*^9}, {3.8460694207021275`*^9, 3.8460694209494734`*^9}, 
   3.846836228747409*^9, 3.8468365144662743`*^9, 3.8468366199540796`*^9, {
   3.8468481087184763`*^9, 3.8468481250702744`*^9}, {3.8473408179271197`*^9, 
   3.8473408251659904`*^9}, {3.847340970519724*^9, 3.8473409773187046`*^9}, 
   3.8473427413187838`*^9, {3.847342825086248*^9, 3.8473428258465695`*^9}, 
   3.847517385556241*^9, {3.854301855915164*^9, 3.854301858772463*^9}, 
   3.8543020039896812`*^9, {3.8543020440675693`*^9, 3.854302046037298*^9}, 
   3.854302115324274*^9, 3.854302152780776*^9, {3.8543025919951105`*^9, 
   3.854302594296518*^9}, {3.854302647838771*^9, 3.8543026479055924`*^9}, {
   3.854302769649428*^9, 3.854302769818977*^9}},
 CellLabel->
  "In[7360]:=",ExpressionUUID->"63fca51f-f993-4561-bde0-803306599b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solidMaskOverlayFolder", "=", "\"\<Solid Mask Overlays\\\\\>\""}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DirectoryQ", "[", 
      RowBox[{"output", "<>", "solidMaskOverlayFolder"}], "]"}], ",", 
     "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "<>", "solidMaskOverlayFolder"}], "//", 
      "CreateDirectory"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "output", "<>", "solidMaskOverlayFolder", "<>", "\"\<Sample_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<.jpg\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Rasterize", "[", 
       RowBox[{
        RowBox[{"frameSolidMaskOverlays", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"RasterSize", "\[Rule]", "1500"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
     "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "frameSolidMaskOverlays"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8543028356177626`*^9, 3.8543028958421106`*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"9401841b-2015-4c78-92ed-e531e8bf0c30"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solidification Front  Height Map", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
   3.845826386614379*^9, 3.845826389807841*^9}, 3.8478846445532837`*^9, 
   3.8478847622095747`*^9},
 FontSize->24,ExpressionUUID->"15f22d84-5a4e-4e2e-9bc7-31b42762f73d"],

Cell["\<\
Defaults:

frontStateLowerLimit=1;
frontStateUpperLimit=Length@cleanFrames;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.854648137990076*^9, 3.8546481382638226`*^9}, {
  3.861684778839484*^9, 3.8616847871971087`*^9}},
 FontSize->16,ExpressionUUID->"c541626f-92f6-4d0f-b681-ee7cb634fe0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frontStateLowerLimit", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"frontStateUpperLimit", "=", "260"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8616843452981796`*^9, 3.861684370101491*^9}, {
   3.861684444166666*^9, 3.86168444443795*^9}, 3.8616845190157504`*^9, {
   3.8616845543288803`*^9, 3.86168455719726*^9}, {3.8616845916705823`*^9, 
   3.8616845918291583`*^9}, 3.8616846727282023`*^9, {3.861684711870509*^9, 
   3.861684712108828*^9}, {3.861715313038434*^9, 3.8617153346646795`*^9}, {
   3.8617163707181005`*^9, 3.8617163709156466`*^9}, {3.8617179914683037`*^9, 
   3.8617179927730036`*^9}, 3.8617827489058504`*^9, {3.861792362960327*^9, 
   3.861792373855137*^9}, {3.8617990988028955`*^9, 3.861799109484873*^9}, {
   3.861812578296898*^9, 3.8618125787835965`*^9}, {3.8618570910305653`*^9, 
   3.8618570912459884`*^9}, {3.861857248775494*^9, 3.8618572489649873`*^9}, {
   3.861897110704848*^9, 3.861897112269803*^9}, 3.8622386692717953`*^9, 
   3.8625046897690754`*^9, {3.8626585114765844`*^9, 3.86265851303316*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"849c864d-3981-4594-9263-b342bcaecab9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"width", ",", "height"}], "}"}], "=", 
   RowBox[{"ImageDimensions", "@", 
    RowBox[{"First", "@", "solidificationFront"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frontHeightMap", "=", 
     RowBox[{"getFrontHeightMap", "@", 
      RowBox[{"solidificationFront", "[", 
       RowBox[{"[", "\[IndentingNewLine]", 
        RowBox[{"frontStateLowerLimit", ";;", "frontStateUpperLimit"}], 
        "\[IndentingNewLine]", "]"}], "]"}]}]}], ";"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pixelRanges", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "#1", ",", "#2"}], "]"}], "&"}], "@@", "#"}], "&"}],
     "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"width", ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"height", ",", "50"}], "}"}]}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"widthMilimeters", ",", "heightMilimeters"}], "}"}], "=", 
    RowBox[{"pixelSizeMuMeters", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"width", ",", "height"}], "}"}], "/", "1000"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"physicalRanges", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"#1", "*", 
           RowBox[{"Rescale", "@", "#2"}]}], ",", "0.1"}], "]"}], "&"}], "@@",
        "#"}], "&"}], "/@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"widthMilimeters", ",", "heightMilimeters"}], "}"}], ",", 
        "pixelRanges"}], "\[IndentingNewLine]", "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"physicalTicks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"#", "/@", 
        RowBox[{"{", 
         RowBox[{"pixelRanges", ",", "physicalRanges"}], "}"}]}], "]"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"First", ",", "Last"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPhysicalTicks", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Last", "@", "physicalTicks"}], ",", "None"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "@", "physicalTicks"}], ",", "None"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"physicalTicksHeightMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Reverse", "@", 
             RowBox[{"Last", "@", "#"}]}]}], "}"}], "&"}], "@", 
         RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"width", "-", 
                 RowBox[{"Last", "@", 
                  RowBox[{"First", "@", "pixelRanges"}]}]}], ",", "0"}], 
               "}"}]}], ")"}], "&"}], "/@", 
           RowBox[{"First", "@", "#"}]}], "\[IndentingNewLine]", "]"}]}], "//",
         "Transpose"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "}"}], "&"}], "@",
     "physicalTicks"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884595919291*^9, 
   3.8478845972038956`*^9}, {3.8478849205245123`*^9, 3.8478849616811185`*^9}, 
   3.8480392872884808`*^9, 3.848039323749285*^9, {3.8480394327251773`*^9, 
   3.848039435324542*^9}, {3.8547316203761272`*^9, 3.8547316233838105`*^9}, {
   3.861350953708116*^9, 3.8613509681216855`*^9}, {3.861351379338807*^9, 
   3.8613513799242945`*^9}, {3.8613514409860935`*^9, 
   3.8613514417151356`*^9}, {3.8613515427541256`*^9, 
   3.8613515503464384`*^9}, {3.8616844574582505`*^9, 
   3.8616844725678387`*^9}, {3.8616845599519587`*^9, 
   3.8616845617122507`*^9}, {3.8616847403839226`*^9, 3.861684742149866*^9}, 
   3.8622946413331165`*^9, {3.8622991079642*^9, 3.8622991082544675`*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"cf5db055-6feb-47a0-8ce7-86efc0fd40ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aspectRatio", "=", 
    RowBox[{
     RowBox[{"Divide", "@@", 
      RowBox[{"Reverse", "@", 
       RowBox[{"ImageDimensions", "@", 
        RowBox[{"First", "@", "solidificationFront"}]}]}]}], "//", "N"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", 
       RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", "plotPhysicalTicks"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<X, mm\>\"", ",", "\"\<Y, mm\>\""}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"frontHeightMap", "[", 
     RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "frontHeightMap"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8613509162060375`*^9, 3.86135092626699*^9}, {
   3.8613509770181313`*^9, 3.861351333732097*^9}, {3.8613513647676086`*^9, 
   3.861351392188016*^9}, {3.8613514467587223`*^9, 3.8613514840021*^9}, 
   3.862294643765829*^9, {3.86229911159013*^9, 3.8622991121805487`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"24af1147-b0bd-4c29-b390-acbd50afb418"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Height Map States", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}, {3.847885301976758*^9, 
  3.8478853047761393`*^9}},
 FontSize->24,ExpressionUUID->"dc918b8c-dd63-4df2-aa40-73565799173b"],

Cell["\<\
Defaults:

stateFirst=1;
stateLast=Length@frontHeightMap;
stateStep=25;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.854648137990076*^9, 3.8546481382638226`*^9}, {
  3.861684778839484*^9, 3.8616847974077806`*^9}},
 FontSize->16,ExpressionUUID->"e48d3d99-21de-4ff7-a9b0-8efa38d6eb1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stateFirst", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateLast", "=", 
   RowBox[{"Length", "@", "frontHeightMap"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateStep", "=", "15"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.847884900773056*^9}, {3.8478849985512877`*^9, 
   3.8478849985522842`*^9}, 3.8478924319659033`*^9, {3.8480584624549475`*^9, 
   3.8480585073109975`*^9}, {3.848058544046761*^9, 3.8480585798550053`*^9}, {
   3.861684802727556*^9, 3.861684808517069*^9}, {3.861716423421812*^9, 
   3.86171642355165*^9}, {3.8617180237807775`*^9, 3.8617180240281997`*^9}, {
   3.8617827608091125`*^9, 3.8617827610393963`*^9}, {3.8617923815056763`*^9, 
   3.861792384280254*^9}, {3.86179911372359*^9, 3.8617991148743777`*^9}, {
   3.861813773808024*^9, 3.861813799448431*^9}, {3.861857293358308*^9, 
   3.8618572936125736`*^9}, {3.8625046947044277`*^9, 3.862504696830057*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"dfef6382-cb4f-4f0f-b84c-f361aeb1e14c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"selectedFrontStates", "=", 
   RowBox[{"frontHeightMap", "[", 
    RowBox[{"[", 
     RowBox[{"stateFirst", ";;", "stateLast", ";;", "stateStep"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStampsSeconds", "=", 
    RowBox[{"timeStepSizeSeconds", "*", 
     RowBox[{"Range", "[", 
      RowBox[{"stateFirst", ",", "stateLast", ",", "stateStep"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fillingRules", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#", "+", "1"}], "}"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "@", "#"}], "-", "1"}], "\[IndentingNewLine]", 
        "]"}]}], "&"}], "@", "selectedFrontStates"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotSelectedFrontStates", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Filling", "\[Rule]", "fillingRules"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", "plotPhysicalTicks"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<X, mm\>\"", ",", "\"\<Y, mm\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{"#", ",", "Right"}], "]"}]}], "&"}], "@", 
       RowBox[{"SwatchLegend", "[", "\[IndentingNewLine]", 
        RowBox[{"Automatic", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "@", "#"}], "<>", "\"\< s\>\""}], "&"}], "/@",
           "timeStampsSeconds"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "&"}], "@", 
   "selectedFrontStates"}]}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.847884900773056*^9}, {3.8478849985512877`*^9, 
   3.8478849985522842`*^9}, {3.8478924319659033`*^9, 3.84789243559021*^9}, {
   3.847950401692638*^9, 3.847950420243037*^9}, {3.8480395603219404`*^9, 
   3.8480395670686674`*^9}, {3.848058496800141*^9, 3.84805851187978*^9}, {
   3.8480585491511116`*^9, 3.8480585502322493`*^9}, {3.8480585827034173`*^9, 
   3.8480585995034914`*^9}, {3.84805870033599*^9, 3.848058724800088*^9}, {
   3.860759389150073*^9, 3.860759418975318*^9}, {3.8607594505112057`*^9, 
   3.8607594507206087`*^9}, {3.8607595248067875`*^9, 
   3.8607595932460184`*^9}, {3.8613451338094387`*^9, 3.861345181703616*^9}, {
   3.861351522906794*^9, 3.861351527058301*^9}, {3.861351561117878*^9, 
   3.861351565690035*^9}, {3.8613524952498426`*^9, 3.861352520698643*^9}, 
   3.8622946494710865`*^9},
 CellLabel->
  "In[272]:=",ExpressionUUID->"eb016804-e9dd-40ad-80f1-0b981658d5de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<5_selected_front_states.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotSelectedFrontStates", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "550"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.86135160305816*^9, 3.8613516031140146`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"1d3d52d0-9970-4f59-84fb-c119a9cb6095"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Height Map Matrix", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}, {3.847885301976758*^9, 
  3.8478853119607177`*^9}},
 FontSize->24,ExpressionUUID->"754e3d7a-1826-4221-98f6-e7acdf195606"],

Cell["\<\
Defaults:

medianScaleFrontHeight=2;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, 3.8480429031813593`*^9},
 FontSize->16,ExpressionUUID->"855ff445-2fbc-4d17-be81-a9d920703a39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"medianScaleFrontHeight", "=", "2"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.847884900773056*^9}, {3.847885006810633*^9, 
   3.847885013549904*^9}, {3.847885086009289*^9, 3.8478851078326406`*^9}, {
   3.84788907533663*^9, 3.847889085376807*^9}, 3.8478924234301615`*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"c294f1d5-0356-48d3-b262-35e3284bf382"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frontHeightMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Last", "/@", "#"}], "&"}], "/@", "frontHeightMap"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"formattedFrontHeightMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageData", "@", 
       RowBox[{"MedianFilter", "[", 
        RowBox[{"#", ",", "medianScaleFrontHeight"}], "]"}]}], "&"}], "@", 
     RowBox[{"Image", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"Reverse", "@", 
        RowBox[{"Transpose", "@", "frontHeightMatrix"}]}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"physicalTicksHeightMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", 
             RowBox[{"Reverse", "@", 
              RowBox[{"Last", "@", "#"}]}]}], "}"}], "&"}], "@", 
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"width", "-", 
                  RowBox[{"Last", "@", 
                   RowBox[{"First", "@", "pixelRanges"}]}]}], ",", "0"}], 
                "}"}]}], ")"}], "&"}], "/@", 
            RowBox[{"First", "@", "#"}]}], "\[IndentingNewLine]", "]"}]}], "//",
          "Transpose"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "}"}], "&"}], 
     "@", "physicalTicks"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPhysicalTicks", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"timeStepSizeSeconds", "*", "#"}]}], "}"}], "&"}], "@", 
         "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{"stateFirst", ",", "stateLast", ",", "50"}], "]"}]}], "//", 
        "Transpose"}], ",", "None"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "@", "#"}], ",", 
            RowBox[{"Reverse", "@", 
             RowBox[{"Last", "@", "#"}]}]}], "}"}], "&"}], "@", 
         "\[IndentingNewLine]", 
         RowBox[{"Transpose", "@", 
          RowBox[{"First", "@", "physicalTicks"}]}]}], "//", "Transpose"}], 
       ",", "None"}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.847884900773056*^9}, {3.847885006810633*^9, 
   3.847885013549904*^9}, {3.847885086009289*^9, 3.8478851078326406`*^9}, {
   3.84788907533663*^9, 3.847889085376807*^9}, {3.8478924234301615`*^9, 
   3.847892427622552*^9}, {3.8622991271093764`*^9, 3.8622991274624853`*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"502e8cd7-6702-4de6-9d88-a5d1ec0fa53f"],

Cell["\<\
Defaults:

colorPalette=\[CloseCurlyDoubleQuote]RedBlueTones\[CloseCurlyDoubleQuote];
colorData={colorPalette,\[CloseCurlyDoubleQuote]Reverse\
\[CloseCurlyDoubleQuote]};
matrixPlotFontSize=16;
matrixPlotSize=750;
matrixPlotLegendSize=350;
dataInversion={True,True};
ticksRoundFactor=0.01;
ticksScaleFactor=1;
matrixBarLegendLabel=\[CloseCurlyDoubleQuote]mm\[CloseCurlyDoubleQuote];\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.848042909621373*^9}, {
   3.8614440688460307`*^9, 3.8614440855385103`*^9}, 3.861444974117799*^9},
 FontSize->16,ExpressionUUID->"7614e53c-a088-4945-9f29-892d0b6d6ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorPalette", "=", "\"\<RedBlueTones\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorData", "=", 
   RowBox[{"{", 
    RowBox[{"colorPalette", ",", "\"\<Reverse\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotFontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotSize", "=", "750"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotLegendSize", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataInversion", "=", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksRoundFactor", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksScaleFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixBarLegendLabel", "=", "\"\<mm\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.847884900773056*^9}, {3.847885006810633*^9, 
   3.8478850183906965`*^9}, {3.8478850860192614`*^9, 
   3.8478850860202584`*^9}, {3.8478889594402046`*^9, 
   3.8478889625109944`*^9}, {3.8478890333040223`*^9, 
   3.8478890427118373`*^9}, {3.8478891048397346`*^9, 3.84788912458294*^9}, {
   3.8478892160244217`*^9, 3.847889227608447*^9}, 3.8480588489594035`*^9, {
   3.8614440391337214`*^9, 3.8614440803832397`*^9}, {3.8614443142627373`*^9, 
   3.8614443215252323`*^9}, 3.8614444433180785`*^9, {3.8614449529968667`*^9, 
   3.8614449620449176`*^9}, {3.861684891095233*^9, 3.861684891174077*^9}, 
   3.86178277693245*^9, 3.8617923953516445`*^9, 3.861799121084766*^9, {
   3.861813831264137*^9, 3.861813848486642*^9}, {3.8618573144704356`*^9, 
   3.8618573154208937`*^9}, {3.862479141874964*^9, 3.862479142329955*^9}, {
   3.86250470512696*^9, 3.862504705519104*^9}, {3.8625048329835625`*^9, 
   3.8625048332783527`*^9}, {3.8625048638486614`*^9, 3.862504893534665*^9}, {
   3.862504959285922*^9, 3.8625049886320124`*^9}, 3.8626600110619173`*^9},
 CellLabel->
  "In[281]:=",ExpressionUUID->"2a0eb114-3c6f-460f-b314-fc3cd92bc552"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matrixPhysicalTicksHeight", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"timeStepSizeSeconds", "*", "#"}]}], "}"}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"Range", "[", 
           RowBox[{"stateFirst", ",", "stateLast", ",", "50"}], "]"}]}], "//",
          "Transpose"}], ",", "None"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", "#"}], ",", 
             RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"Transpose", "@", 
           RowBox[{"First", "@", "physicalTicksHeightMatrix"}]}]}], "//", 
         "Transpose"}], ",", "None"}], "\[IndentingNewLine]", "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotFrontHeightMatrix", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"getFrontMatrixPlot", "[", "\[IndentingNewLine]", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "@", "#"}], ",", 
          RowBox[{"Max", "@", "#"}]}], "}"}], "&"}], "@", "#"}], ",", 
      "matrixPhysicalTicksHeight", ",", "ticksRoundFactor", ",", 
      "ticksScaleFactor"}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
   "formattedFrontHeightMatrix"}]}]}], "Input",
 CellChangeTimes->{{3.8622982461666117`*^9, 3.862298248421632*^9}, {
  3.862298311231846*^9, 3.8622984189520707`*^9}, {3.862298451006319*^9, 
  3.862298550116621*^9}, {3.862298600309016*^9, 3.8622986272720375`*^9}, {
  3.8622986728369193`*^9, 3.8622987285559387`*^9}, {3.8622987702366447`*^9, 
  3.862298843549552*^9}, {3.8622989465671053`*^9, 3.8622990455576725`*^9}, {
  3.862299085126996*^9, 3.8622990865172796`*^9}, {3.862299124853409*^9, 
  3.862299130723714*^9}, {3.8625049759051003`*^9, 3.8625049785707493`*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"a836b6a6-97fa-4806-9786-fc568d8bf777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<6_front_height_matrix.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotFrontHeightMatrix", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.848058789695119*^9, 3.848058802831564*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"7e1e348e-d062-4828-99b8-cf685bf5cd41"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean Front Height Dynamics", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}, {3.847885301976758*^9, 
  3.8478853326564875`*^9}},
 FontSize->24,ExpressionUUID->"83cde701-c71f-4baa-be3c-829d7c3691cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"meanHeightPhysicalTicks", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"First", "@", "matrixPhysicalTicks"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frontHeightMeansDeviations", "=", 
    RowBox[{"getFrontHeightMeansDeviations", "@", "frontHeightMap"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotFrontHeightDynamics", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "#", "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
   RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pixelSizeMuMeters", "*", 
      RowBox[{"frontHeightMeansDeviations", "/", "1000"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
     RowBox[{"IntervalMarkersStyle", "\[Rule]", "Gray"}], ",", 
     RowBox[{"Filling", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", "meanHeightPhysicalTicks"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<t, s\>\"", ",", 
        "\"\<\[LeftAngleBracket]Y\[RightAngleBracket], mm\>\""}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.861434438424797*^9, 3.861434516421871*^9}, {
  3.8614345920685883`*^9, 3.8614346707585015`*^9}, {3.861434768262665*^9, 
  3.861434770828854*^9}, {3.8614348369257603`*^9, 3.8614348405251513`*^9}, {
  3.8614458760053673`*^9, 3.8614458818034334`*^9}, {3.861445929062271*^9, 
  3.8614459308055534`*^9}, {3.861897262266781*^9, 3.861897278550749*^9}, {
  3.8618975609443016`*^9, 3.8618975668049555`*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"f0837b87-d930-4997-b83e-37ae033170a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<7_mean_front_height_dynamics.jpg\>\""}], ",",
     "\[IndentingNewLine]", "plotFrontHeightDynamics", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.848058789695119*^9, 3.848058802831564*^9}, {
   3.8480588696625824`*^9, 3.8480588824389267`*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"05b1539e-3ad6-4bc0-87ab-153ae880c30c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Vertical Front Displacements", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
  3.845826386614379*^9, 3.845826389807841*^9}, {3.847885301976758*^9, 
  3.84788536072189*^9}},
 FontSize->24,ExpressionUUID->"e79640d4-7efa-4e10-b72a-6eb94ca51e6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"frontDisplacementMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "/@", "#"}], "&"}], "/@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"getFrontDisplacements", "@", "frontHeightMap"}], 
     "\[IndentingNewLine]", ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.84803998108428*^9, 3.848039990468438*^9}, {
  3.848040028652396*^9, 3.8480400529405065`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"9d025a70-28a4-4ca3-b2f5-f60a51acf985"],

Cell["\<\
Defaults:

outlierFilterThresholdsRadii={
{100,3},{40,2}
};\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.8480429190608473`*^9}},
 FontSize->16,ExpressionUUID->"a8ec029f-b833-4679-9f54-ca6253ad3445"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outlierFilterThresholdsRadii", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"40", ",", "2"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.847890812283408*^9, 3.8478908791695423`*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"735701ff-185f-4e30-9c40-35ca4d1d40dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cleanFrontDisplacementMatrix", "=", 
     RowBox[{"multiStageOutlierRemoval", "[", "\[IndentingNewLine]", 
      RowBox[{
      "frontDisplacementMatrix", ",", "outlierFilterThresholdsRadii"}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImageDifference", "[", 
   RowBox[{
    RowBox[{"Image", "@", "cleanFrontDisplacementMatrix"}], ",", 
    RowBox[{"Image", "@", "frontDisplacementMatrix"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Histogram", "[", 
        RowBox[{"#", ",", "\"\<Scott\>\"", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
      RowBox[{"Flatten", "@", "#"}]}], "&"}], "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"frontDisplacementMatrix", ",", "cleanFrontDisplacementMatrix"}],
      "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8478907687755175`*^9, 3.847890799047567*^9}, 
   3.847890844592035*^9, 3.8478908833992558`*^9, {3.8478909188235025`*^9, 
   3.84789092411934*^9}, {3.8478912028400555`*^9, 3.847891227008457*^9}, {
   3.8478925545512576`*^9, 3.8478925553032455`*^9}, {3.8478926325038366`*^9, 
   3.84789263562249*^9}, {3.862239248976338*^9, 3.8622392531244507`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"9b86b1a9-f9c4-46f6-a09c-7567d924db0f"],

Cell["\<\
Defaults:

bilateralValueSpread=2;
bilateralKernelScale=21;

colorPalette=\[CloseCurlyDoubleQuote]Rainbow\[CloseCurlyDoubleQuote];
colorData=colorPalette;
matrixPlotFontSize=16;
matrixPlotSize=750;
matrixPlotLegendSize=350;
dataInversion={True, False};
ticksRoundFactor=0.01;
ticksScaleFactor=timeStepSizeSeconds;
matrixBarLegendLabel=\[CloseCurlyDoubleQuote]mm\[CloseCurlyDoubleQuote];\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.8480429279328356`*^9}, 
   3.8614441286865234`*^9, 3.8614449878144693`*^9},
 FontSize->16,ExpressionUUID->"7df7fbbe-3d87-455d-b19b-6f4328488475"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bilateralValueSpread", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bilateralKernelScale", "=", "21"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPalette", "=", "\"\<Rainbow\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorData", "=", "colorPalette"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotFontSize", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotSize", "=", "750"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotLegendSize", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataInversion", "=", 
   RowBox[{"{", 
    RowBox[{"True", ",", " ", "False"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksRoundFactor", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksScaleFactor", "=", "timeStepSizeSeconds"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixBarLegendLabel", "=", "\"\<mm/s\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.8478849045445366`*^9}, {3.847885232352809*^9, 
   3.8478852323538065`*^9}, 3.847885267424729*^9, 3.8478892017087326`*^9, 
   3.8478892914726925`*^9, 3.8478893355528235`*^9, {3.8478894075924315`*^9, 
   3.847889418903187*^9}, {3.8478896026321845`*^9, 3.847889612562626*^9}, {
   3.847892155262246*^9, 3.847892166605913*^9}, {3.847892229238453*^9, 
   3.8478922373666897`*^9}, {3.8478922705180387`*^9, 3.847892297342335*^9}, {
   3.847892343695382*^9, 3.8478923880946245`*^9}, {3.8480590073037157`*^9, 
   3.8480590073585677`*^9}, {3.8542996615289702`*^9, 
   3.8542996701603107`*^9}, {3.8614441123655977`*^9, 3.861444141219859*^9}, {
   3.861444214478111*^9, 3.861444215734776*^9}, {3.8614442951341333`*^9, 
   3.8614443017566967`*^9}, 3.861444480102062*^9, {3.861444981374337*^9, 
   3.8614450027564945`*^9}, 3.861445519056671*^9, {3.8616849232154026`*^9, 
   3.8616849232772446`*^9}, 3.861782813264987*^9, 3.8617924016478586`*^9, 
   3.8617991323068037`*^9, {3.8622388463036613`*^9, 3.8622388926047497`*^9}, {
   3.8622400884776554`*^9, 3.862240092917782*^9}, {3.862242035590502*^9, 
   3.8622420369019437`*^9}, 3.8624791866189365`*^9, {3.862504715973099*^9, 
   3.8625047160319953`*^9}, {3.8625050381754985`*^9, 3.862505054877996*^9}, {
   3.8626599116750054`*^9, 3.862659915137971*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"9d0aa1a8-a7d9-437d-8bc0-063d37fa5c61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matrixPhysicalDisplacementTicks", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"First", "@", "matrixPhysicalTicks"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "@", "#"}], ",", 
               RowBox[{"Reverse", "@", 
                RowBox[{"Last", "@", "#"}]}]}], "}"}]}], "&"}], "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"First", "@", "#"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "}"}], "&"}], 
       "@", 
       RowBox[{"Last", "@", "matrixPhysicalTicks"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"formattedFrontDisplacementMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Rescale", "@", 
       RowBox[{"ImageData", "@", "\[IndentingNewLine]", 
        RowBox[{"BilateralFilter", "[", 
         RowBox[{
         "#", ",", "bilateralValueSpread", ",", "bilateralKernelScale"}], 
         "]"}]}]}], "&"}], "@", 
     RowBox[{"ImageAdjust", "@", "\[IndentingNewLine]", 
      RowBox[{"Image", "@", "cleanFrontDisplacementMatrix"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"plotFrontDisplacementMatrix", "=", 
  RowBox[{"getFrontMatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{"formattedFrontDisplacementMatrix", ",", "\[IndentingNewLine]", 
    RowBox[{"getTrueDisplacementRange", "[", 
     RowBox[{
     "cleanFrontDisplacementMatrix", ",", 
      "formattedFrontDisplacementMatrix"}], "]"}], ",", "\[IndentingNewLine]",
     "matrixPhysicalDisplacementTicks", ",", "ticksRoundFactor", ",", 
    "ticksScaleFactor"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8478927913535547`*^9, 3.8478927977275066`*^9}, {
   3.8478931477111015`*^9, 3.8478931536492214`*^9}, 3.8478931885987616`*^9, {
   3.8478932608465624`*^9, 3.8478933491504545`*^9}, {3.8478937209030223`*^9, 
   3.847893724038766*^9}, {3.847893758406717*^9, 3.8478937598214264`*^9}, {
   3.847942959974471*^9, 3.847942972549774*^9}, {3.847956339090973*^9, 
   3.847956346153097*^9}, {3.8480401558129253`*^9, 3.848040184284407*^9}, {
   3.861442846248281*^9, 3.8614428584316435`*^9}, {3.8614430677314*^9, 
   3.8614431053514705`*^9}, {3.8614438576177063`*^9, 
   3.8614439023357353`*^9}, {3.8614441332645025`*^9, 3.861444135880579*^9}, {
   3.8614441777114444`*^9, 3.8614441809008617`*^9}, {3.861444475159269*^9, 
   3.8614444842460127`*^9}, {3.861444688702759*^9, 3.861444693631626*^9}, {
   3.8614448701683626`*^9, 3.861444875736123*^9}, {3.86223902603853*^9, 
   3.86223904667683*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"d21db55c-e83a-4507-9f09-fcc97af21d8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<8_front_displacement_matrix.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotFrontDisplacementMatrix", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.848058789695119*^9, 3.848058802831564*^9}, {
   3.8480588696625824`*^9, 3.8480588824389267`*^9}, {3.8480589829115148`*^9, 
   3.8480589931432295`*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"5e626c11-f045-45ac-9a10-d81ff8b75c80"],

Cell["\<\
Defaults:

derivativeRegularizationScale=3;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.8480429796669874`*^9}},
 FontSize->16,ExpressionUUID->"51ff6493-bf55-4d3e-9025-42bbc49f8b26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"derivativeRegularizationScale", "=", "3"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.848042969827301*^9, 3.84804297171516*^9}, {
  3.8543014292844934`*^9, 3.8543014685311775`*^9}, {3.861684937103262*^9, 
  3.8616849416307034`*^9}, {3.861813891783802*^9, 3.8618139008720355`*^9}, {
  3.862239939372504*^9, 3.862239945659986*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"04417c55-dd98-4d86-975e-650e27b9f7df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frontDisplacemetsMeansDeviations", "=", 
    RowBox[{"DerivativeFilter", "[", "\[IndentingNewLine]", 
     RowBox[{"frontHeightMeansDeviations", ",", 
      RowBox[{"{", "1", "}"}], ",", "derivativeRegularizationScale"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanHeightPhysicalTicks", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Automatic", ",", "None"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"First", "@", "matrixPhysicalTicks"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.861445145447713*^9, 3.8614451830600653`*^9}, {
  3.861445347649143*^9, 3.861445349931985*^9}, {3.8614453893740964`*^9, 
  3.861445499260559*^9}, {3.86144553382218*^9, 3.861445560628338*^9}, {
  3.8614456022297153`*^9, 3.8614456046781197`*^9}, {3.861445762892954*^9, 
  3.861445771300133*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"67c7bfab-acc3-4b72-a3d1-78d55924ffa3"],

Cell[BoxData[
 RowBox[{"plotFrontDisplacementDynamics", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", "#", "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "@", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{"IntervalMarkers", "\[Rule]", "\"\<Bands\>\""}], ",", 
       RowBox[{"IntervalMarkersStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"Filling", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", "meanHeightPhysicalTicks"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<t, s\>\"", ",", 
          "\"\<\[LeftAngleBracket]dY/dt\[RightAngleBracket], mm /s\>\""}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"pixelSizeMuMeters", "*", 
     RowBox[{
      RowBox[{"frontDisplacemetsMeansDeviations", "/", "1000"}], "/", 
      "timeStepSizeSeconds"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.847945612039789*^9, 3.847945614327042*^9}, {
   3.847946077308827*^9, 3.847946117277999*^9}, {3.8479462023260655`*^9, 
   3.8479462116774893`*^9}, {3.847946278334365*^9, 3.847946382797172*^9}, {
   3.8479465055813074`*^9, 3.8479465482771626`*^9}, {3.847946591437417*^9, 
   3.847946809829389*^9}, {3.847956271561999*^9, 3.847956286617695*^9}, {
   3.848042967030176*^9, 3.8480430002676563`*^9}, {3.848059042807993*^9, 
   3.848059051298193*^9}, 3.861445187622939*^9, {3.8614453708720293`*^9, 
   3.861445375999057*^9}, {3.861445731735515*^9, 3.8614457474016223`*^9}, {
   3.861598214724348*^9, 3.8615982220352535`*^9}, {3.861647096813443*^9, 
   3.861647123644679*^9}, {3.8618973863204327`*^9, 3.8618974938788753`*^9}, {
   3.861897580586028*^9, 3.861897597494027*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"fdf531f1-7233-4c27-bedf-f65e21961873"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<9_mean_displacement_dynamics.jpg\>\""}], ",",
     "\[IndentingNewLine]", "plotFrontDisplacementDynamics", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.848058789695119*^9, 3.848058802831564*^9}, {
   3.8480588696625824`*^9, 3.8480588824389267`*^9}, {3.8480589829115148`*^9, 
   3.8480589931432295`*^9}, {3.8480590599349127`*^9, 3.8480590694146075`*^9}},
 CellLabel->
  "In[555]:=",ExpressionUUID->"4a9dd992-d5d8-4224-99b1-bbe3989db355"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Concentration Measurements Near the Front", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
   3.845826386614379*^9, 3.845826389807841*^9}, {3.847885301976758*^9, 
   3.84788536072189*^9}, 3.847948739636033*^9},
 FontSize->24,ExpressionUUID->"657e25ee-2227-4da0-a350-3de307b0415d"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ImageSubtract", "[", 
        RowBox[{"#", ",", "inpaintMask"}], "]"}], "&"}], "@", 
      RowBox[{"Colorize", "@", 
       RowBox[{"ImageAdjust", "@", 
        RowBox[{"cleanFrames", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
      RowBox[{"solidificationFront", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "solidificationFront"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844439302454`*^9}, {3.847884497305993*^9, 
   3.847884552157322*^9}, {3.8479494809323416`*^9, 3.8479495607561626`*^9}, {
   3.847949801980167*^9, 3.8479498033634715`*^9}, 3.8616850168234696`*^9, {
   3.8622948997173147`*^9, 3.8622949304227204`*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"2ce70849-3d8f-46fe-8110-2771d6a43212"],

Cell["\<\
Defaults:

frontBufferScaleLow=15;
frontBufferScaleHigh=30+frontBufferScaleLow;

liquidMedianRadius=1;
liquidBilateralValueSpread=3;
liquidBilateralKernelScale=21;
liquidNeighborhoodRadius=1;
liquidGaussianKernelScale=1;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.8480429796669874`*^9}, 
   3.848043021869646*^9},
 FontSize->16,ExpressionUUID->"95b5acb3-8535-4b83-b795-81b94823f128"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frontBufferScaleLow", "=", "15"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"frontBufferScaleHigh", "=", 
    RowBox[{"30", "+", "frontBufferScaleLow"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidMedianRadius", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidBilateralValueSpread", "=", "3"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidBilateralKernelScale", "=", "21"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidNeighborhoodRadius", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidGaussianKernelScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8479492118039894`*^9, 3.847949427707671*^9}, {
   3.84794964548356*^9, 3.8479496501161995`*^9}, {3.8479507059890428`*^9, 
   3.8479507062434034`*^9}, {3.847950743084916*^9, 3.847950762907918*^9}, {
   3.847952040211434*^9, 3.847952066403393*^9}, {3.847952146699682*^9, 
   3.8479522329649982`*^9}, {3.8479523682193346`*^9, 3.84795237286657*^9}, {
   3.847952454723158*^9, 3.847952460786971*^9}, {3.8479525217868495`*^9, 
   3.8479525381889615`*^9}, {3.8479525983355513`*^9, 
   3.8479526769948387`*^9}, {3.8479534952590327`*^9, 
   3.8479535263628893`*^9}, {3.8479536016108236`*^9, 
   3.8479536018661423`*^9}, {3.8479635209906583`*^9, 
   3.8479635949027996`*^9}, {3.8479688951662283`*^9, 
   3.8479689054053907`*^9}, {3.847969104909861*^9, 3.847969163949199*^9}, {
   3.8479691954050813`*^9, 3.847969422477863*^9}, {3.8479695075733094`*^9, 
   3.8479695143970613`*^9}, {3.847969566421696*^9, 3.84796962602927*^9}, {
   3.8479707845907917`*^9, 3.8479707992605314`*^9}, {3.8479709186936088`*^9, 
   3.8479709197966585`*^9}, {3.8479709730532446`*^9, 3.847970974575174*^9}, {
   3.847971057989115*^9, 3.8479710993166327`*^9}, {3.847971130588974*^9, 
   3.847971151020338*^9}, 3.8479716202371674`*^9, {3.8479716623405495`*^9, 
   3.8479717038605204`*^9}, {3.84797444531696*^9, 3.8479744495954885`*^9}, {
   3.848042388044508*^9, 3.8480423903471813`*^9}, {3.8617174808776717`*^9, 
   3.861717514938757*^9}, {3.8617176121555824`*^9, 3.8617176128915977`*^9}, {
   3.861717789141363*^9, 3.861717789211218*^9}, {3.8617197912765307`*^9, 
   3.861719791497938*^9}, {3.861786560901043*^9, 3.8617865609987793`*^9}, {
   3.8617867186146216`*^9, 3.8617867188603735`*^9}, {3.861857490944645*^9, 
   3.8618575017249393`*^9}, {3.8618575690695443`*^9, 3.861857569164291*^9}, {
   3.862223347165575*^9, 3.8622233482167645`*^9}, {3.8622422527507353`*^9, 
   3.8622422543683605`*^9}, {3.862505409960125*^9, 3.8625054100343266`*^9}, {
   3.862505699900143*^9, 3.862505700142579*^9}, {3.8625060785198746`*^9, 
   3.8625060797755055`*^9}, 3.8626586279414177`*^9},
 CellLabel->
  "In[318]:=",ExpressionUUID->"cb36a2b2-0843-4db0-b200-d65fa22e73f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"concentrationFieldFiltered", "=", 
     RowBox[{
      RowBox[{"getFilteredConcentrationField", "/@", 
       RowBox[{"cleanFrames", "[", 
        RowBox[{"[", "\[IndentingNewLine]", 
         RowBox[{"frontStateLowerLimit", ";;", "frontStateUpperLimit"}], 
         "\[IndentingNewLine]", "]"}], "]"}]}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"concentrationSamplingMask", "=", 
     RowBox[{
      RowBox[{"getConcentrationSamplingMask", "/@", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", "cleanFrames"}]}]}], "//", "Parallelize"}]}], 
    ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"concentrationSamplingZone", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageMultiply", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"concentrationFieldFiltered", ",", "\[IndentingNewLine]", 
        RowBox[{"concentrationSamplingMask", "[", 
         RowBox[{"[", 
          RowBox[{"frontStateLowerLimit", ";;", "frontStateUpperLimit"}], 
          "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.847971737132575*^9, 3.847971749428693*^9}, {
   3.8479717875575204`*^9, 3.8479718199742823`*^9}, {3.847974507075938*^9, 
   3.8479745074844503`*^9}, {3.8479746329318037`*^9, 3.847974633295454*^9}, 
   3.848040280381344*^9, 3.861598294746256*^9, {3.8616850924401517`*^9, 
   3.861685105549264*^9}, {3.86168527352663*^9, 3.8616852915869093`*^9}, {
   3.8622422639759073`*^9, 3.8622422714835796`*^9}, {3.862243129255188*^9, 
   3.8622431348671117`*^9}, 3.8622433170629396`*^9, {3.86250576730728*^9, 
   3.862505785000708*^9}, {3.8625058456713963`*^9, 3.8625058494283047`*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"95dd2822-83f3-41ee-baf0-888736cecf3a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stateID", "=", "120"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Colorize", "@", 
    RowBox[{"ImageAdjust", "@", 
     RowBox[{"concentrationFieldFiltered", "[", 
      RowBox[{"[", "stateID", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Blue"}], "]"}], "&"}], "@", 
      RowBox[{"EdgeDetect", "@", 
       RowBox[{"frontBuffer", "[", 
        RowBox[{
         RowBox[{"frontStateLowerLimit", "+", "stateID"}], ",", 
         "frontBufferScaleLow"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "Red"}], "]"}], "&"}], "@", 
      RowBox[{"concentrationSamplingMask", "[", 
       RowBox[{"[", 
        RowBox[{"frontStateLowerLimit", "+", "stateID"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8479492118039894`*^9, 3.847949427707671*^9}, {
   3.84794964548356*^9, 3.8479496501161995`*^9}, {3.8479507059890428`*^9, 
   3.8479507062434034`*^9}, {3.847950743084916*^9, 3.847950762907918*^9}, {
   3.847952040211434*^9, 3.847952066403393*^9}, {3.847952146699682*^9, 
   3.8479522329649982`*^9}, {3.8479523682193346`*^9, 3.84795237286657*^9}, {
   3.847952454723158*^9, 3.847952460786971*^9}, {3.8479525217868495`*^9, 
   3.8479525381889615`*^9}, {3.8479525983355513`*^9, 
   3.8479526769948387`*^9}, {3.8479534952590327`*^9, 
   3.8479535215627213`*^9}, {3.8479535516193194`*^9, 
   3.8479535593087564`*^9}, {3.847953616389305*^9, 3.847953675628982*^9}, {
   3.8479596748330407`*^9, 3.847959675016526*^9}, {3.8479635039046583`*^9, 
   3.8479635064410305`*^9}, {3.8479689289394293`*^9, 3.847969023221336*^9}, {
   3.847969612701909*^9, 3.8479696151603627`*^9}, 3.8479717305691004`*^9, 
   3.847974256877198*^9, {3.8479744025682516`*^9, 3.8479744590761375`*^9}, 
   3.848031687632784*^9, {3.848044976555447*^9, 3.848044976699063*^9}, {
   3.848123760108261*^9, 3.8481238424739747`*^9}, {3.854649389236985*^9, 
   3.8546493943325877`*^9}, {3.8616500236504574`*^9, 
   3.8616500792106247`*^9}, {3.8617172067574143`*^9, 3.861717207317884*^9}, {
   3.8617172423092966`*^9, 3.8617173025722218`*^9}, {3.861717365902008*^9, 
   3.8617173664844327`*^9}, {3.8617179535918655`*^9, 
   3.8617179755011625`*^9}, {3.8617180907325163`*^9, 
   3.8617180922828503`*^9}, {3.861720394906845*^9, 3.861720421637839*^9}, {
   3.8617828446794295`*^9, 3.8617828457356043`*^9}, 3.8617861952390957`*^9, {
   3.861786726629588*^9, 3.861786728123955*^9}, {3.8618574773440776`*^9, 
   3.8618574782606773`*^9}, {3.861857753481369*^9, 3.8618577609005933`*^9}, {
   3.8618973297381597`*^9, 3.8618973345749626`*^9}, {3.8622423148295803`*^9, 
   3.8622423235748796`*^9}, {3.862505942202959*^9, 3.8625059486638904`*^9}, {
   3.8625061034809866`*^9, 3.8625061305109425`*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"75b526bb-2cc4-4dca-af79-ad2c3fa72d81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"concentrationBinMeans", "=", 
    RowBox[{
     RowBox[{"getConcentrationBins", "/@", "concentrationSamplingZone"}], "//",
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.847975711882354*^9, 3.8479757817015715`*^9}, 
   3.8479758353159537`*^9, 3.8479760588756604`*^9, {3.8479761763556*^9, 
   3.847976178749199*^9}, {3.8479762909232473`*^9, 3.8479762946034064`*^9}, {
   3.8479763350761776`*^9, 3.8479763452918577`*^9}, {3.847978078875946*^9, 
   3.847978078955697*^9}, {3.8479781556599464`*^9, 3.8479781690606313`*^9}, {
   3.8479782231327534`*^9, 3.8479782255958395`*^9}, {3.847979036930936*^9, 
   3.847979088378908*^9}, {3.847979209347508*^9, 3.847979244026822*^9}, {
   3.8617178464130383`*^9, 3.8617178474147553`*^9}, {3.8617180972197976`*^9, 
   3.8617180983069253`*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"520e8e17-d80b-4121-a8d5-955e77eeffaa"],

Cell["\<\
Defaults:

bilateralValueSpread=2;
bilateralKernelScale=21;
concentrationMedianRadius=2;

colorPalette=\[CloseCurlyDoubleQuote]RedBlueTones\[CloseCurlyDoubleQuote];
colorData={colorPalette,\[CloseCurlyDoubleQuote]Reverse\
\[CloseCurlyDoubleQuote]};
matrixPlotFontSize=15;
matrixPlotSize=750;
matrixPlotLegendSize=350;
dataInversion={True, False};\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
  3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
  3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
  3.8480428593176937`*^9}, {3.8480429031813593`*^9, 3.8480429796669874`*^9}, {
  3.848043021869646*^9, 3.848043037173267*^9}},
 FontSize->16,ExpressionUUID->"e998fe8e-718b-4398-8d2a-e079d104f911"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bilateralValueSpread", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"bilateralKernelScale", "=", "21"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"concentrationMedianRadius", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPalette", "=", "\"\<RedBlueTones\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorData", "=", 
   RowBox[{"{", 
    RowBox[{"colorPalette", ",", "\"\<Reverse\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotFontSize", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotSize", "=", "750"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotLegendSize", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataInversion", "=", 
   RowBox[{"{", 
    RowBox[{"True", ",", " ", "False"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksRoundFactor", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksScaleFactor", "=", 
   RowBox[{"pixelSizeMuMeters", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixBarLegendLabel", "=", "\"\<C, arb\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, 3.847884789162485*^9, {
   3.8478848787328253`*^9, 3.8478849045445366`*^9}, {3.847885232352809*^9, 
   3.8478852323538065`*^9}, 3.847885267424729*^9, 3.8478892017087326`*^9, 
   3.8478892914726925`*^9, 3.8478893355528235`*^9, {3.8478894075924315`*^9, 
   3.847889418903187*^9}, {3.8478896026321845`*^9, 3.847889612562626*^9}, {
   3.847892155262246*^9, 3.847892166605913*^9}, {3.847892229238453*^9, 
   3.8478922373666897`*^9}, {3.8478922705180387`*^9, 3.847892297342335*^9}, {
   3.847892343695382*^9, 3.8478923880946245`*^9}, {3.8480323739831924`*^9, 
   3.8480324090553694`*^9}, 3.8480325528251905`*^9, {3.848032582992156*^9, 
   3.8480325934564323`*^9}, {3.8607609234466705`*^9, 
   3.8607609262538214`*^9}, {3.8614460805802484`*^9, 3.861446095763256*^9}, {
   3.8614461776837835`*^9, 3.861446220347305*^9}, {3.861446250810251*^9, 
   3.8614462578373938`*^9}, {3.8614644006406784`*^9, 3.861464440372994*^9}, {
   3.861466527469578*^9, 3.861466542197234*^9}, {3.861466592460906*^9, 
   3.86146661960429*^9}, {3.8616854487498517`*^9, 3.8616854488125615`*^9}, {
   3.8617173917398777`*^9, 3.861717427116475*^9}, 3.8617174862692003`*^9, {
   3.8617176293801565`*^9, 3.8617176301471596`*^9}, {3.8617176958686333`*^9, 
   3.8617177195660553`*^9}, 3.861717756268241*^9, 3.8617178939647655`*^9, 
   3.8617197089189515`*^9, {3.8617203374023886`*^9, 3.861720371467534*^9}, {
   3.8617204510871377`*^9, 3.861720463435112*^9}, {3.8617218116502714`*^9, 
   3.861721825361648*^9}, 3.861782853320319*^9, {3.861786797509119*^9, 
   3.861786801732811*^9}, {3.8617868466850324`*^9, 3.8617868701812544`*^9}, 
   3.8617869251568575`*^9, 3.861792437571477*^9, 3.861799145503456*^9, {
   3.8618140192586665`*^9, 3.861814039977761*^9}, {3.861857376541661*^9, 
   3.8618573781802783`*^9}, {3.862242406797331*^9, 3.8622424200824966`*^9}, {
   3.862242523221938*^9, 3.8622425686123257`*^9}, {3.862242759413601*^9, 
   3.8622427950139003`*^9}, {3.8622429387099094`*^9, 3.862242951253123*^9}, 
   3.8622433608696847`*^9, 3.862244331094846*^9, {3.862479284498687*^9, 
   3.862479284585454*^9}, {3.8624794298588986`*^9, 3.8624794553948746`*^9}, 
   3.8625047313168173`*^9, {3.8625053109913216`*^9, 3.8625053132384295`*^9}, {
   3.86254477111773*^9, 3.8625448295908556`*^9}, {3.8625467675096884`*^9, 
   3.8625467677090874`*^9}, 3.862660039404477*^9},
 CellLabel->
  "In[556]:=",ExpressionUUID->"fc3fb5e6-8a3c-403e-bed8-8f8b3f96faa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"concentrationMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "/.", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"{", "}"}], "]"}], "\[Rule]", 
        RowBox[{"Median", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"#", "/.", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{"{", "}"}], "]"}], "\[Rule]", "Nothing"}]}], "]"}]}]}]}],
       "&"}], "@", "concentrationBinMeans"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"formattedConcentrationMatrix", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ImageData", "@", 
         RowBox[{"BilateralFilter", "[", "\[IndentingNewLine]", 
          RowBox[{
          "#", ",", "bilateralValueSpread", ",", "bilateralKernelScale"}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
       RowBox[{"MedianFilter", "[", 
        RowBox[{"#", ",", "concentrationMedianRadius"}], "]"}]}], "&"}], "@", 
     RowBox[{"Image", "@", 
      RowBox[{"Clip", "[", 
       RowBox[{"concentrationMatrix", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"concentrationPlotRange", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "@", 
       RowBox[{"(", 
        RowBox[{"formattedConcentrationMatrix", "/.", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{"{", "}"}], "]"}], "\[Rule]", "Nothing"}]}], ")"}]}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"Min", ",", "Max"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotFrontConcentrationMatrix", "=", 
  RowBox[{"getFrontMatrixPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
   "formattedConcentrationMatrix", ",", "concentrationPlotRange", ",", 
    "matrixPhysicalDisplacementTicks", ",", "ticksRoundFactor", ",", 
    "ticksScaleFactor"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8480295464484787`*^9, 3.8480295745601006`*^9}, {
   3.848029638840435*^9, 3.848029656447658*^9}, {3.8480309338321886`*^9, 
   3.8480309371114907`*^9}, 3.84803114867225*^9, {3.8480314271997943`*^9, 
   3.848031471639411*^9}, 3.848031504024082*^9, 3.848032107896225*^9, {
   3.8480322006161427`*^9, 3.8480322145839357`*^9}, {3.8480322726320405`*^9, 
   3.848032306297182*^9}, {3.848032338159839*^9, 3.848032390216916*^9}, {
   3.848033330663164*^9, 3.8480333999428735`*^9}, 3.8480403583335123`*^9, {
   3.8480592813744526`*^9, 3.848059286606366*^9}, {3.861446041188384*^9, 
   3.8614460469590087`*^9}, {3.8614461249093*^9, 3.861446127662938*^9}, {
   3.8614462113897853`*^9, 3.861446212333349*^9}, {3.861717678550005*^9, 
   3.861717687465479*^9}, {3.862242708613344*^9, 3.8622427165571046`*^9}, {
   3.8622450928565683`*^9, 3.8622450953907924`*^9}, {3.8625447297464824`*^9, 
   3.8625447507190695`*^9}},
 CellLabel->
  "In[568]:=",ExpressionUUID->"b8f0355a-a516-4479-8eb2-8bf3ee51a071"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<10_front_concentration_matrix.jpg\>\""}], 
    ",", "\[IndentingNewLine]", "plotFrontConcentrationMatrix", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.838390601775787*^9, 3.838390602335291*^9}, {3.838440437486438*^9, 
   3.83844043753448*^9}, {3.8480573768150635`*^9, 3.848057383551051*^9}, 
   3.848057414294899*^9, {3.8480577388150315`*^9, 3.848057765896644*^9}, {
   3.8480582716075783`*^9, 3.84805827781495*^9}, {3.8480586764715776`*^9, 
   3.8480586863108892`*^9}, {3.848058789695119*^9, 3.848058802831564*^9}, {
   3.8480588696625824`*^9, 3.8480588824389267`*^9}, {3.8480589829115148`*^9, 
   3.8480589931432295`*^9}, {3.8480590599349127`*^9, 
   3.8480590694146075`*^9}, {3.84805930954348*^9, 3.8480593191025114`*^9}, {
   3.8617218152895346`*^9, 3.861721821863951*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"ea767c9b-a400-4f45-911b-c7016d00a521"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dendrite Region Analysis", "Section",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8387048339126616`*^9, 3.8387048415931826`*^9}, {
   3.847804817547017*^9, 
   3.847804822570589*^9}},ExpressionUUID->"b7890234-067c-4f2e-b525-\
97437688fafc"],

Cell[CellGroupData[{

Cell["Preview Clean & Filtered Frames", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
   3.845826386614379*^9, 3.845826389807841*^9}, 3.8478846445532837`*^9, 
   3.8478847622095747`*^9, 3.847884856955155*^9},
 FontSize->24,ExpressionUUID->"7b57015b-fd59-4686-83bf-cb64803dd271"],

Cell[BoxData[{
 RowBox[{"cleanFrames", "//", "Length"}], "\n", 
 RowBox[{
  RowBox[{"testID", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, {3.847884828599189*^9, 
   3.847884833960834*^9}, {3.8479566791224575`*^9, 3.8479566854335785`*^9}, 
   3.8481239434188814`*^9, {3.8481247796664567`*^9, 3.8481247797691817`*^9}, {
   3.848125432306443*^9, 3.8481254381059585`*^9}, {3.8481254775549774`*^9, 
   3.848125480123557*^9}, 3.8614670567649813`*^9, {3.861467099652252*^9, 
   3.8614671180745096`*^9}, {3.861467365268001*^9, 3.8614673714799476`*^9}, 
   3.861469484899852*^9, {3.8614730318150253`*^9, 3.8614730345097647`*^9}, 
   3.861543661162939*^9, {3.861547654963277*^9, 3.86154766653827*^9}, {
   3.8615505045113907`*^9, 3.861550508867687*^9}, 3.861551154087632*^9, {
   3.861599565828353*^9, 3.861599570017251*^9}, 3.86160811529891*^9, {
   3.861608300682153*^9, 3.861608303235376*^9}, 3.8616084903153543`*^9, {
   3.861610166810357*^9, 3.8616101687491674`*^9}, 3.8616115436734467`*^9, {
   3.8616123828082857`*^9, 3.8616123854750404`*^9}, 3.861613268030218*^9, {
   3.8616134578797216`*^9, 3.861613458109108*^9}, {3.8616154103161345`*^9, 
   3.8616154132253685`*^9}, {3.8616161264697995`*^9, 3.861616126652313*^9}, 
   3.8616167850917945`*^9, {3.8616854986304655`*^9, 3.8616855004087095`*^9}, 
   3.86169360763369*^9, {3.8616939391926966`*^9, 3.8616939431092224`*^9}, 
   3.861696642310052*^9, 3.861697154142378*^9, {3.861698249340793*^9, 
   3.861698258396249*^9}, {3.861698429214187*^9, 3.861698431745446*^9}, {
   3.86169895081207*^9, 3.8616989510552454`*^9}, {3.861699072468869*^9, 
   3.861699072714323*^9}, {3.861720581442151*^9, 3.8617205862453237`*^9}, {
   3.861779239610689*^9, 3.8617792398738794`*^9}, {3.8617796274395266`*^9, 
   3.8617796478098288`*^9}, 3.8617803222996597`*^9, {3.861780694163369*^9, 
   3.8617806942281275`*^9}, 3.8617810985876427`*^9, 3.8617816100662155`*^9, 
   3.8617828666327734`*^9, {3.861814581656542*^9, 3.861814582734724*^9}, {
   3.8624061719731884`*^9, 3.8624061813976946`*^9}, {3.862406527332984*^9, 
   3.8624065275472527`*^9}, {3.8624069068290386`*^9, 3.8624069103650846`*^9}, 
   3.8624096869098816`*^9, {3.8624098202131305`*^9, 3.8624098202600327`*^9}, {
   3.8624130824949517`*^9, 3.8624130871537027`*^9}, {3.862413444550321*^9, 
   3.8624134446838017`*^9}, {3.862461951955159*^9, 3.8624619520264845`*^9}, {
   3.86247362810032*^9, 3.862473628168848*^9}, 3.8624759708813334`*^9, {
   3.8624771718119907`*^9, 3.8624771721609707`*^9}, 3.8624775019142847`*^9, {
   3.862479372899071*^9, 3.862479375720891*^9}, {3.8624799032358932`*^9, 
   3.8624799035226555`*^9}, 3.8624812252183275`*^9, 3.8624905753012033`*^9, {
   3.862490982551382*^9, 3.862490983483963*^9}, {3.862492572693368*^9, 
   3.862492572722294*^9}, {3.862502596486659*^9, 3.8625025966466417`*^9}, {
   3.8625031517041717`*^9, 3.86250315195151*^9}, {3.8625037993683157`*^9, 
   3.8625037994855127`*^9}, {3.862546748469158*^9, 3.8625467507867603`*^9}, {
   3.8625952187996936`*^9, 3.8625952205263414`*^9}, {3.862595322910577*^9, 
   3.8625953292393*^9}, {3.862596449073224*^9, 3.8625964493966417`*^9}, {
   3.8625986641031675`*^9, 3.8625986643585405`*^9}, {3.8625988798316236`*^9, 
   3.8625988966863785`*^9}, {3.8625994014488335`*^9, 
   3.8625994016074095`*^9}, {3.86259981392665*^9, 3.8625998141342716`*^9}, {
   3.862628190871857*^9, 3.8626281910447755`*^9}, {3.8626290900061083`*^9, 
   3.8626290900528994`*^9}, {3.86265864345269*^9, 3.862658645357933*^9}, {
   3.8626717414527707`*^9, 3.8626717425878725`*^9}, {3.862671877125903*^9, 
   3.8626719048837614`*^9}, 3.862671944254656*^9, {3.862671996396885*^9, 
   3.8626720110549555`*^9}, {3.8627502654847755`*^9, 
   3.8627502656035414`*^9}, {3.8627542393738904`*^9, 3.862754243467681*^9}, {
   3.862774157194846*^9, 3.862774157585163*^9}, {3.8627751132258606`*^9, 
   3.8627751132725277`*^9}, {3.86277554200211*^9, 3.8627755423104715`*^9}},
 CellLabel->
  "In[4385]:=",ExpressionUUID->"1196e3a2-13e0-43f9-887c-4e81114e1ee8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testFrame", "=", 
    RowBox[{"cleanFrames", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Colorize", "/@", 
    RowBox[{"ImageAdjust", "/@", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], "&"}], ")"}], "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"cleanFrames", ",", "allFilteredFrames"}], "}"}]}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8478018451959243`*^9, 3.847801848860263*^9}, {
   3.8478048060826445`*^9, 3.8478048106185365`*^9}, 3.847884374860693*^9, {
   3.847884408194774*^9, 3.8478844411905427`*^9}, {3.847884828599189*^9, 
   3.847884833960834*^9}, {3.8479566791224575`*^9, 3.8479566854335785`*^9}, 
   3.8481239434188814`*^9, {3.8481247796664567`*^9, 3.8481247797691817`*^9}, {
   3.848125432306443*^9, 3.8481254381059585`*^9}, {3.8481254775549774`*^9, 
   3.848125480123557*^9}, 3.8614670567649813`*^9, {3.861467099652252*^9, 
   3.8614671180745096`*^9}},
 CellLabel->
  "In[4387]:=",ExpressionUUID->"9a9dcf2a-c7f2-488f-b0a3-afe376fdbfcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview The Solid Region", "Subsection",
 CellChangeTimes->{{3.845826103616875*^9, 3.8458261643344765`*^9}, {
   3.845826386614379*^9, 3.845826389807841*^9}, 3.8478846445532837`*^9, 
   3.8478847622095747`*^9, 3.847884856955155*^9, {3.8479567077768087`*^9, 
   3.847956709905117*^9}},
 FontSize->24,ExpressionUUID->"6cc62612-96bb-4e29-9934-13874a978456"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testMask", "=", 
   RowBox[{"useMask", "[", 
    RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testFrame", "=", 
    RowBox[{"cleanFrames", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Colorize", "@", 
    RowBox[{"ImageAdjust", "@", "testFrame"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"EdgeDetect", "@", "testMask"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8382098457913537`*^9, 3.838209853837426*^9}, 
   3.838210141479782*^9, 3.8382111731903343`*^9, 3.8382700827390237`*^9, {
   3.8382702275448837`*^9, 3.838270230466075*^9}, {3.838270385673864*^9, 
   3.8382703858723383`*^9}, {3.83827046947283*^9, 3.8382705009865775`*^9}, {
   3.838271956066*^9, 3.8382719577056165`*^9}, {3.8383533082367115`*^9, 
   3.838353310414888*^9}, {3.8383535563814597`*^9, 3.838353577550863*^9}, {
   3.8383557455336747`*^9, 3.838355765751622*^9}, {3.8383783476675105`*^9, 
   3.838378348515244*^9}, {3.83845733111415*^9, 3.838457331869952*^9}, {
   3.8387033492972994`*^9, 3.8387033503772416`*^9}, {3.8387148261249437`*^9, 
   3.8387148274047937`*^9}, {3.843042010199628*^9, 3.843042013075321*^9}, {
   3.843042881588657*^9, 3.843042882539934*^9}, {3.843191757080728*^9, 
   3.843191773412069*^9}, {3.843191964426389*^9, 3.8431919749761844`*^9}, {
   3.8431920285449677`*^9, 3.8431920351941915`*^9}, {3.8431923435767303`*^9, 
   3.8431923454018517`*^9}, {3.84319438489017*^9, 3.843194386112901*^9}, {
   3.8468289062456226`*^9, 3.8468289197883997`*^9}, 3.8479569274899006`*^9, {
   3.847957821857955*^9, 3.847957831067524*^9}, 3.8614668909970064`*^9, {
   3.8614669231880646`*^9, 3.8614669688913927`*^9}, {3.861467045483201*^9, 
   3.861467070422977*^9}, {3.862405462596301*^9, 3.8624054636909432`*^9}},
 CellLabel->
  "In[4389]:=",ExpressionUUID->"410f4bb3-1988-49b5-87a7-0d2bf33ec2db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Solid Region Image", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, 
   3.8383674622624593`*^9, 3.8383908156143403`*^9, {3.839153530654809*^9, 
   3.83915353327381*^9}, 
   3.8434803653761115`*^9},ExpressionUUID->"1392dbf0-a00f-4dbf-ad11-\
f67b56b5b4b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"realMask", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getImageMask", "[", 
      RowBox[{"inpaintMask", ",", "#"}], "]"}], "&"}], "@", "testMask"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solidImage", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getSolidImage", "[", 
      RowBox[{"testFrame", ",", "#"}], "]"}], "&"}], "@", "realMask"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Colorize", "@", "solidImage"}]}], "Input",
 CellChangeTimes->{{3.8375058675599203`*^9, 3.8375058940002327`*^9}, {
  3.8375059417336164`*^9, 3.837506011358474*^9}, {3.837506044263503*^9, 
  3.8375060460138235`*^9}, {3.8382098103105545`*^9, 3.8382098149287252`*^9}, {
  3.843480253655903*^9, 3.843480299384671*^9}, {3.8479578390354395`*^9, 
  3.8479579002576356`*^9}},
 CellLabel->
  "In[4392]:=",ExpressionUUID->"0d9dd891-04d7-474b-bece-fbf6f9e4ac17"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partition the Repaired Frame & Its Solid Mask", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065781495657`*^9, 
   3.8375065878865337`*^9}, {3.837507066205921*^9, 3.8375070675014563`*^9}, {
   3.8387857472513466`*^9, 
   3.8387857476027803`*^9}},ExpressionUUID->"ebd31fee-9894-4032-bc09-\
ac39f484f772"],

Cell["\<\
Defaults:

partitionScale=0.1;\
\>", "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
   3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
   3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
   3.8382101989016657`*^9, 3.838210203181193*^9}, {3.8383534539483156`*^9, 
   3.8383535248038826`*^9}, {3.846769657335847*^9, 3.846769717048169*^9}, {
   3.847521947265028*^9, 3.847522000015459*^9}, {3.848042850410941*^9, 
   3.8480428593176937`*^9}, {3.8480429031813593`*^9, 
   3.8480429796669874`*^9}, {3.848043021869646*^9, 3.848043037173267*^9}, 
   3.8480430842446833`*^9},
 FontSize->16,ExpressionUUID->"d6c81a0a-104d-4136-b05c-42c51cdbc8bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"partitionScale", "=", "0.1"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.838295353689997*^9, 3.838295402744422*^9}, {
   3.8383576923586116`*^9, 3.8383577001437964`*^9}, {3.8387099134591446`*^9, 
   3.8387099143706803`*^9}, {3.8387148648131633`*^9, 3.83871488012462*^9}, {
   3.8427020086195593`*^9, 3.8427020100193367`*^9}, 3.8428553182430377`*^9, {
   3.8430430723245544`*^9, 3.8430431055744333`*^9}, {3.8434803429694877`*^9, 
   3.8434803472483964`*^9}, {3.8479569821776314`*^9, 
   3.8479569991312947`*^9}, {3.8479579115057135`*^9, 
   3.8479579268183813`*^9}, {3.8548958892793274`*^9, 3.854895892388741*^9}, 
   3.854897115894951*^9, 3.854897237170783*^9, 3.854897381414708*^9, 
   3.8548974851484985`*^9},
 CellLabel->
  "In[4395]:=",ExpressionUUID->"d888d674-edfb-4e4d-ab94-38ccce52e2ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotSelectedMask", "=", 
   RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Colorize", "@", 
      RowBox[{"ImageAdjust", "@", "testFrame"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"EdgeDetect", "@", "realMask"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"partitionSize", "=", 
   RowBox[{"partitionScale", "*", 
    RowBox[{"Min", "@", 
     RowBox[{"ImageDimensions", "@", "testFrame"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagePartitions", "=", 
   RowBox[{"ImagePartition", "[", 
    RowBox[{"testFrame", ",", "partitionSize"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solidMaskPartitions", "=", 
    RowBox[{"ImagePartition", "[", 
     RowBox[{"realMask", ",", "partitionSize"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solidMaskPartitions", "//", "Dimensions"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionCount", "=", 
   RowBox[{"Times", "@@", 
    RowBox[{"Dimensions", "@", "solidMaskPartitions"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputFrameResults", "=", 
    RowBox[{"output", "<>", "\"\<Frame_\>\"", "<>", 
     RowBox[{"ToString", "@", "testID"}], "<>", "$PathnameSeparator"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DirectoryQ", "@", "outputFrameResults"}], ",", 
    "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
    RowBox[{"outputFrameResults", "//", "CreateDirectory"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.838295353689997*^9, 3.838295402744422*^9}, {
   3.8383576923586116`*^9, 3.8383577001437964`*^9}, {3.8387099134591446`*^9, 
   3.8387099143706803`*^9}, {3.8387148648131633`*^9, 3.83871488012462*^9}, {
   3.8427020086195593`*^9, 3.8427020100193367`*^9}, 3.8428553182430377`*^9, {
   3.8430430723245544`*^9, 3.8430431055744333`*^9}, {3.8434803429694877`*^9, 
   3.8434803472483964`*^9}, {3.8479569821776314`*^9, 
   3.8479569991312947`*^9}, {3.8479579115057135`*^9, 
   3.8479579268183813`*^9}, {3.8548958892793274`*^9, 
   3.8548958970861454`*^9}, {3.861467248187462*^9, 3.8614673540908356`*^9}, {
   3.86146741655048*^9, 3.8614674410960493`*^9}},
 CellLabel->
  "In[4396]:=",ExpressionUUID->"e59b3f19-f922-4842-ac55-7d426825ef53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "outputFrameResults", "<>", 
     "\"\<11_selected_frame_solid_boundary.jpg\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rasterize", "[", 
     RowBox[{"plotSelectedMask", ",", 
      RowBox[{"RasterSize", "\[Rule]", "2000"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageResolution", "\[Rule]", "1500"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.8382950125746803`*^9, 3.838295021703828*^9}, {3.8382950775846834`*^9, 
   3.8382951131273565`*^9}, {3.8382956421118793`*^9, 
   3.8382956831116853`*^9}, {3.8383908698722816`*^9, 3.838390870223343*^9}, {
   3.842855348436149*^9, 3.8428554155459566`*^9}, {3.848059516855147*^9, 
   3.8480595402062273`*^9}, 3.861467393997157*^9},
 CellLabel->
  "In[4404]:=",ExpressionUUID->"351f89f5-8e1c-484e-9268-db5fbd1f7edd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the Volume Fraction Map", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}},ExpressionUUID->"04e993a1-cdfc-4a84-9496-\
1cee884d221c"],

Cell[BoxData[{
 RowBox[{"voidFractionMap", "=", 
  RowBox[{"ColorNegate", "/@", 
   RowBox[{"Flatten", "@", "solidMaskPartitions"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionArea", "=", 
   RowBox[{"Times", "@@", 
    RowBox[{"ImageDimensions", "@", 
     RowBox[{"First", "@", "voidFractionMap"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"voidFraction", "=", 
   RowBox[{"getPartitionVoidFraction", "[", 
    RowBox[{"voidFractionMap", ",", "partitionArea"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solidFraction", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "#"}], ")"}], "&"}], "/@", "voidFraction"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.822372950785192*^9, 3.82237312694737*^9}, {
   3.822376863939001*^9, 3.8223768838326435`*^9}, {3.822416649120099*^9, 
   3.8224166507418528`*^9}, {3.822417079869441*^9, 3.822417097276037*^9}, {
   3.8375052858301787`*^9, 3.837505286294936*^9}, {3.837505522333885*^9, 
   3.837505556861576*^9}, {3.8376786140359154`*^9, 3.837678650211665*^9}, 
   3.842785241902147*^9, 3.843480855737689*^9, {3.846075506107475*^9, 
   3.846075577347969*^9}, {3.8468375919146585`*^9, 3.846837601657282*^9}, 
   3.846837633467848*^9},
 CellLabel->
  "In[4405]:=",ExpressionUUID->"3cf8948d-3ece-4d9d-8cc2-31df7d03546e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Filter Scan Regions", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 
   3.837506686485484*^9}},ExpressionUUID->"0a924c8b-64cd-43a7-882c-\
9ff30d618f78"],

Cell["\<\
Defaults:

criticalSolidFraction=0.3;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
  3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
  3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
  3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
  3.837509950255954*^9}},
 FontSize->16,ExpressionUUID->"ac05ae60-84e3-4afb-8efc-0eb2ce60b2e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"criticalSolidFraction", "=", "0.3"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.824311743444005*^9, 3.824311759640405*^9}, 
   3.837506483967363*^9, {3.8391492739195423`*^9, 3.8391492920071917`*^9}},
 CellLabel->
  "In[4409]:=",ExpressionUUID->"91e9802c-04dd-4764-b3f2-65f14035325b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scanRegionIndices", "=", 
    RowBox[{"Position", "[", "\[IndentingNewLine]", 
     RowBox[{"solidFraction", ",", "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", ">", "criticalSolidFraction"}], "&"}], ")"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"scanPartitions", "=", 
    RowBox[{"First", "/@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", "imagePartitions"}], ")"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "scanRegionIndices"}], 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Colorize", "/@", "scanPartitions"}], "//", 
  "Parallelize"}]}], "Input",
 CellChangeTimes->{{3.822385335901672*^9, 3.8223853624022894`*^9}, {
   3.822385397282818*^9, 3.8223854030826817`*^9}, {3.8223855230121303`*^9, 
   3.8223855230749607`*^9}, {3.8223856718698683`*^9, 3.8223856966023393`*^9}, 
   3.82238647536697*^9, {3.8224172047430534`*^9, 3.8224172069810057`*^9}, 
   3.824311771770623*^9, {3.837485517936162*^9, 3.8374855219856157`*^9}, {
   3.8376784445076895`*^9, 3.8376784705948114`*^9}, 3.8376786597948837`*^9, {
   3.861605253044856*^9, 3.8616052558843145`*^9}},
 CellLabel->
  "In[4410]:=",ExpressionUUID->"ccb06388-5b79-4a1d-ad4f-d1a153e9977f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Region Skeletons", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 
   3.837506702605446*^9}},ExpressionUUID->"d3a30a14-8f59-4ae5-8aef-\
f997d95325cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"preparedPartitions", "=", 
     RowBox[{
      RowBox[{"preprocessImage", "/@", "scanPartitions"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"postBM3Dpartitions", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"applyBM3D", "[", 
        RowBox[{"#", ",", "windowNoiseVarianceBM3D"}], "]"}], "&"}], "/@", 
      "preparedPartitions"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scannedSkeletons", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"getSkeleton", "@", 
        RowBox[{"ColorNegate", "@", 
         RowBox[{"MorphologicalBinarize", "@", 
          RowBox[{"cleanImage", "@", "#"}]}]}]}], "&"}], "/@", 
      "\[IndentingNewLine]", "postBM3Dpartitions"}], "//", "Parallelize"}]}], 
   ";"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.822413743180522*^9, 3.822413754022813*^9}, {
  3.822415307809186*^9, 3.822415309695699*^9}, {3.822415350296386*^9, 
  3.8224153986879077`*^9}, {3.822415526511174*^9, 3.822415535870405*^9}, {
  3.8224157040933037`*^9, 3.822415715309525*^9}, {3.8430480581599913`*^9, 
  3.8430480594315805`*^9}, {3.8430480971289244`*^9, 3.8430481083207912`*^9}, {
  3.8433080305637984`*^9, 3.8433080772534924`*^9}, {3.8460744420431867`*^9, 
  3.8460744506032963`*^9}, {3.861599616824791*^9, 3.8615996178640113`*^9}},
 CellLabel->
  "In[4413]:=",ExpressionUUID->"896b0f59-6122-49f7-90a2-c451d0a2eb70"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Remove Liquid & Window Border Artefacts", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.8375067182221594`*^9}, 
   3.8462501945946198`*^9, {3.846667647822192*^9, 
   3.846667652334798*^9}},ExpressionUUID->"51c68a2a-38e5-49d5-8d35-\
b4fae3e77dc8"],

Cell["\<\
Defaults:

postMaskingSizeThreshold=sizeThreshold/2//Round;
skeletonPruningScale=1;
skepetonPruningIterations=3;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.854649596187598*^9},
 FontSize->16,ExpressionUUID->"6bb607da-104c-4afd-a33a-d4685646961e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"postMaskingSizeThreshold", "=", 
   RowBox[{
    RowBox[{"sizeThreshold", "/", "2"}], "//", "Round"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"skeletonPruningScale", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"skepetonPruningIterations", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843480462155012*^9, 3.8434805132652903`*^9}, {
   3.8434805503604283`*^9, 3.8434805834485445`*^9}, {3.8462451737328267`*^9, 
   3.8462452304456005`*^9}, {3.8462454497736225`*^9, 3.846245452220088*^9}, {
   3.846245514678354*^9, 3.8462455461253586`*^9}, {3.8463029113504405`*^9, 
   3.846302945131962*^9}, {3.8463029903805375`*^9, 3.8463031184169497`*^9}, {
   3.846303691342352*^9, 3.846303701728818*^9}, {3.846303810211836*^9, 
   3.8463038653019876`*^9}, {3.846303973849126*^9, 3.846304107145749*^9}, {
   3.8463047160194798`*^9, 3.8463047188289676`*^9}, {3.84630475556563*^9, 
   3.846304785733778*^9}, {3.8463067539802046`*^9, 3.8463067571456203`*^9}, 
   3.8468277203213563`*^9, 3.846827996399705*^9, 3.846829471767104*^9, {
   3.8468374041939635`*^9, 3.846837404521406*^9}, {3.847957983945665*^9, 
   3.8479579866117067`*^9}},
 CellLabel->
  "In[4416]:=",ExpressionUUID->"b39d27ce-7afb-44fe-ba32-69aa6c2b8367"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"scanRegionMasks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ColorNegate", "/@", "voidFractionMap"}], ")"}], "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "scanRegionIndices"}], "//",
      "Parallelize"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solidSkeletons", "=", 
    RowBox[{
     RowBox[{"getCleanSolidSkeleton", "/@", 
      RowBox[{"getSolidSkeletons", "[", 
       RowBox[{"scannedSkeletons", ",", "scanRegionMasks"}], "]"}]}], "//", 
     "Parallelize"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", "solidSkeletons"}], "Input",
 CellChangeTimes->{{3.822416689504657*^9, 3.82241670058434*^9}, {
   3.822416739727393*^9, 3.822416787869097*^9}, {3.8224169447899065`*^9, 
   3.8224170314697375`*^9}, 3.8224172749672546`*^9, {3.8376786940524445`*^9, 
   3.8376786979075146`*^9}, {3.8381895836004333`*^9, 
   3.8381896632007785`*^9}, {3.8434805179050903`*^9, 
   3.8434805366724243`*^9}, {3.846245469605744*^9, 3.846245513475567*^9}, {
   3.846302634287902*^9, 3.8463026737164364`*^9}, {3.8463028524437485`*^9, 
   3.846302858416893*^9}, 3.8463029101715407`*^9, {3.8463029559325027`*^9, 
   3.846302975766498*^9}, {3.8463038024920607`*^9, 3.846303825186929*^9}, {
   3.8463041133561335`*^9, 3.846304143189499*^9}, {3.846305382328082*^9, 
   3.8463053888744345`*^9}, {3.846837751008943*^9, 3.8468377559131327`*^9}, 
   3.8615996233603673`*^9},
 CellLabel->
  "In[4419]:=",ExpressionUUID->"12c90e91-6f71-4c9b-b97d-0f255b59f692"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Colorize Skeletons by Orientation", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.8375067182221594`*^9}, {
   3.837518390425063*^9, 
   3.8375183994887037`*^9}},ExpressionUUID->"ff266445-38af-41c6-84e4-\
34571b2b0a93"],

Cell["\<\
Defaults:

colorPalette=\[CloseCurlyDoubleQuote]Rainbow\[CloseCurlyDoubleQuote];
criticalAspectRatio=5;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, 3.843044805598025*^9, 
   3.8471811637129307`*^9},
 FontSize->16,ExpressionUUID->"2601d965-8ca2-4e97-ae88-e80b8141bfc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorPalette", "=", "\"\<Rainbow\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalAspectRatio", "=", "5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8430421150525217`*^9, 3.8430421156123796`*^9}, {
  3.846302195760425*^9, 3.846302222891367*^9}, {3.8463058765479317`*^9, 
  3.8463058837876277`*^9}},
 CellLabel->
  "In[4422]:=",ExpressionUUID->"e285167e-0b66-42c7-8953-b7091f57195d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solidSkeletonsColorized", "=", 
     RowBox[{
      RowBox[{"getOrientationColors", "/@", "solidSkeletons"}], "//", 
      "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solidSkeletonsFiltered", "=", 
     RowBox[{
      RowBox[{"discolorUnorientedSegments", "/@", "solidSkeletonsColorized"}],
       "//", "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unorientedSegments", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", "0.9999"}], "]"}], "&"}], "@", 
           RowBox[{"ColorDetect", "[", 
            RowBox[{"#", ",", "White"}], "]"}]}], "&"}], "@", "#"}], "&"}], "/@",
        "solidSkeletonsFiltered"}], "//", "Parallelize"}]}], ";"}], "//", 
   "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "solidSkeletonsFiltered"}], \
"Input",
 CellChangeTimes->{{3.837517843894183*^9, 3.8375178606104913`*^9}, {
   3.8375183372090626`*^9, 3.837518337905264*^9}, {3.837518371818241*^9, 
   3.8375183807697663`*^9}, {3.837518424257571*^9, 3.837518425225644*^9}, {
   3.8376678957049108`*^9, 3.837667897560949*^9}, 3.8382181083837395`*^9, {
   3.838218150305238*^9, 3.8382181522481976`*^9}, {3.8463041686953073`*^9, 
   3.846304171996812*^9}, {3.846305905827859*^9, 3.846305906104123*^9}, {
   3.846306291031582*^9, 3.8463062943179045`*^9}, 3.846306357159971*^9, {
   3.84630657470518*^9, 3.8463066646419477`*^9}, {3.8463100523525467`*^9, 
   3.846310098872445*^9}, {3.846324210664571*^9, 3.846324228543688*^9}, {
   3.862302104964375*^9, 3.8623021078366947`*^9}},
 CellLabel->
  "In[4424]:=",ExpressionUUID->"c7d85d33-2d98-4f38-9b6d-b791a5ed9012"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resolve Overlapping Dendrites", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.8375067182221594`*^9}, {
   3.837518390425063*^9, 3.8375183994887037`*^9}, {3.8471670473813753`*^9, 
   3.8471670625244646`*^9}},ExpressionUUID->"92c7c829-27b7-477b-9f85-\
0d4fed4a286f"],

Cell["\<\
Defaults:

cornerPixelRange=0.5;
cornerThreshold=4.5*10^-6;
minimumCornerDistance=0;
killThreshold=3;
keepThreshold=2;
cornerConnectivity=True;
gaussianDerivatives={1,1};\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, 3.843044805598025*^9, 
   3.8471811637129307`*^9, 3.8546496234929867`*^9},
 FontSize->16,ExpressionUUID->"b55380f0-294f-4ecd-87ba-02cb3fee45b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cornerPixelRange", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cornerThreshold", "=", 
   RowBox[{"4.5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minimumCornerDistance", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"killThreshold", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keepThreshold", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cornerConnectivity", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaussianDerivatives", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[4428]:=",ExpressionUUID->"4a1092dc-fc82-42b2-9005-c06b2048c081"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolvedUnorientedSegments", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "@", "#"}], "\[NotEqual]", "0"}], ",", 
          RowBox[{"getResolvedUnorientedSkeleton", "@", "#"}], ",", "#"}], 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", "unorientedSegments"}], "//",
       "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolvedSkeletonsColorized", "=", 
     RowBox[{
      RowBox[{"getOrientationColors", "/@", "resolvedUnorientedSegments"}], "//",
       "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolvedSkeletonsFiltered", "=", 
     RowBox[{
      RowBox[{
      "discolorUnorientedSegments", "/@", "resolvedSkeletonsColorized"}], "//",
       "Parallelize"}]}], ";"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solidSkeletonsFinal", "=", 
    RowBox[{"getFinalizedSkeletons", "[", "\[IndentingNewLine]", 
     RowBox[{
     "unorientedSegments", ",", "solidSkeletonsFiltered", ",", 
      "resolvedSkeletonsFiltered"}], "\[IndentingNewLine]", "]"}]}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", "solidSkeletonsFinal"}], "Input",
 CellChangeTimes->{{3.8463243795620174`*^9, 3.8463243854663815`*^9}, {
   3.846324700200302*^9, 3.8463247099595356`*^9}, 3.8463335718264627`*^9, {
   3.846667728559266*^9, 3.846667737326331*^9}, {3.846838665130748*^9, 
   3.8468386796966033`*^9}, {3.846847488791851*^9, 3.8468475041497793`*^9}, {
   3.8468477890304585`*^9, 3.8468478475354757`*^9}, 3.862302115933049*^9},
 CellLabel->
  "In[4435]:=",ExpressionUUID->"65a2b581-7763-4591-8b6f-89c373aadb06"],

Cell[CellGroupData[{

Cell["Extra Visuals for Fine-tuning", "Subsubsection",
 CellChangeTimes->{{3.848043159238448*^9, 
  3.848043176650816*^9}},ExpressionUUID->"523888ac-3960-49d9-a805-\
16148a333c74"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Image", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
     RowBox[{"unorientedSegments", "[", 
      RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "unorientedSegments"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8462455932664433`*^9, 3.8462456253766766`*^9}, {
   3.8462456840070744`*^9, 3.8462456850951676`*^9}, 3.846302162033508*^9, {
   3.8463055291144433`*^9, 3.846305530177312*^9}, 3.8463241454414825`*^9},
 CellLabel->
  "In[4440]:=",ExpressionUUID->"4accd6dd-6730-472c-9d75-7d7a61194bcb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plotCornerPixels", ",", "plotBranchPointPixels"}], "}"}], "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getKeyPixelOverlay", "[", 
        RowBox[{"#1", ",", "#2", ",", "testSkeleton"}], "]"}], "&"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cornerPixels", ",", "branchPoints"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", "Red"}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"pixelsRemoved", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"testPatchSkeleton", "-", "#"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"White", "\[Rule]", "Orange"}]}], "]"}], "&"}], "@", 
         "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"ImageDifference", "[", 
      RowBox[{"testResolvedSkeleton", ",", "testPatchSkeleton"}], "]"}]}]}], 
   ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testPatchSkeleton", ",", "plotCornerPixels", ",", 
       "plotBranchPointPixels", ",", "pixelsRemoved", ",", 
       "testResolvedSkeleton"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "3"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8462491327267733`*^9, 3.8462491454221215`*^9}, {
   3.846249241152008*^9, 3.846249247631767*^9}, {3.8462493773534503`*^9, 
   3.846249417929287*^9}, 3.8462495463943014`*^9, {3.846249644850625*^9, 
   3.846249660370184*^9}, {3.8462496930748515`*^9, 3.8462497604665813`*^9}, {
   3.846250014732696*^9, 3.846250034275804*^9}, {3.8462501701200995`*^9, 
   3.846250170222827*^9}, {3.8462502510816307`*^9, 3.846250253888179*^9}, {
   3.8462502913608527`*^9, 3.8462503077860627`*^9}, {3.8462504345301633`*^9, 
   3.846250451881903*^9}, 3.8462507155643263`*^9, 3.8462509406216974`*^9, {
   3.8462514954703074`*^9, 3.8462516065281515`*^9}, {3.846251787292649*^9, 
   3.8462518181661997`*^9}, {3.8462520337577686`*^9, 
   3.8462520338694696`*^9}, {3.8462520984468727`*^9, 
   3.8462520989974017`*^9}, {3.8462521528315177`*^9, 3.846252183117572*^9}, {
   3.846252222502307*^9, 3.8462522228543663`*^9}, {3.846252266878701*^9, 
   3.8462522877020464`*^9}, {3.8462523863742795`*^9, 3.8462524047501526`*^9}, 
   3.8462524547345233`*^9, {3.846252632526211*^9, 3.846252632733656*^9}, {
   3.8462526709425077`*^9, 3.846252693438367*^9}, 3.8462528052310095`*^9, 
   3.846252986822018*^9, {3.8462530564313803`*^9, 3.8462530696223574`*^9}, {
   3.846253181514278*^9, 3.8462531914090047`*^9}, {3.846253227474249*^9, 
   3.8462532336658096`*^9}, 3.846253293273547*^9, {3.8462534340293236`*^9, 
   3.8462535546544027`*^9}, {3.846253838634121*^9, 3.846253923642633*^9}, {
   3.846253960075511*^9, 3.846253989331485*^9}, {3.846254337886094*^9, 
   3.8462543639495335`*^9}, {3.8462549351712255`*^9, 
   3.8462549353756795`*^9}, {3.846297187169941*^9, 3.8462971874564857`*^9}, {
   3.8462972206489506`*^9, 3.846297310232782*^9}, {3.8462976145340843`*^9, 
   3.846297720924122*^9}, {3.846297764405903*^9, 3.8462977651967907`*^9}, 
   3.846297797485659*^9, {3.8462978326699295`*^9, 3.84629788395792*^9}, {
   3.846297918286723*^9, 3.8462979988061433`*^9}, {3.846298443266034*^9, 
   3.8462985748575516`*^9}, {3.846298608833029*^9, 3.8462986334329844`*^9}, {
   3.846300977281146*^9, 3.846300977366917*^9}, 3.8463010666484632`*^9, {
   3.846301133655778*^9, 3.846301133839287*^9}, {3.846301165003106*^9, 
   3.8463011665519676`*^9}, 3.8463012579592276`*^9, {3.846302031553232*^9, 
   3.8463020316729126`*^9}, {3.8463062511035786`*^9, 3.846306273879093*^9}, 
   3.8463065291457186`*^9, {3.8463065595784082`*^9, 3.846306565633241*^9}, 
   3.846306834051059*^9, {3.8463068750429945`*^9, 3.8463068857790194`*^9}, 
   3.846306954091575*^9, {3.846307001372674*^9, 3.846307048523283*^9}, 
   3.846307110892912*^9, {3.8463072253420296`*^9, 3.8463072525105453`*^9}, {
   3.846307534623061*^9, 3.8463076134152484`*^9}, {3.8463076500234613`*^9, 
   3.8463076964711356`*^9}, 3.846308106331275*^9, {3.84630848521924*^9, 
   3.846308513955778*^9}, {3.8463085512918653`*^9, 3.8463085720433474`*^9}, {
   3.846309318878807*^9, 3.8463093543661146`*^9}, {3.846309588736572*^9, 
   3.846309596495854*^9}, {3.846310563883647*^9, 3.8463105655541983`*^9}, {
   3.846311002636406*^9, 3.8463110343153267`*^9}, {3.846312209551609*^9, 
   3.8463122135828705`*^9}, {3.846312271695591*^9, 3.8463123615026693`*^9}, {
   3.84631499559746*^9, 3.8463149956672726`*^9}, {3.8463150544926987`*^9, 
   3.8463150794599833`*^9}, {3.846315162469166*^9, 3.8463151625479555`*^9}, {
   3.8463152412131643`*^9, 3.84631524258051*^9}, {3.846315355869126*^9, 
   3.8463153561164646`*^9}, {3.846315433085491*^9, 3.8463154333009152`*^9}, {
   3.846315489277221*^9, 3.8463155281257553`*^9}, {3.8463221332229843`*^9, 
   3.846322133349646*^9}, {3.846322180790535*^9, 3.8463221889970913`*^9}, 
   3.846323760111779*^9, {3.846838731320917*^9, 3.8468387437372355`*^9}},
 CellLabel->
  "In[4441]:=",ExpressionUUID->"d6a07618-94f4-48d0-baf9-47036a9b3d51"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect Skeletons & Assemble the Global Skeleton", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 
   3.837506767157331*^9}},ExpressionUUID->"52a7c121-d66d-4832-af94-\
256904322318"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"emptyRegionIndices", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Delete", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], "/@", 
        RowBox[{"Range", "@", "partitionCount"}]}], ",", 
       "\[IndentingNewLine]", "scanRegionIndices"}], "\[IndentingNewLine]", 
      "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"skeletonMap", "=", 
    RowBox[{"getSkeletonMap", "[", 
     RowBox[{
     "voidFractionMap", ",", "emptyRegionIndices", ",", "solidSkeletonsFinal",
       ",", "scanRegionIndices"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assembledSkeleton", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageAssemble", "@", 
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Last", "@", 
          RowBox[{"Dimensions", "@", "imagePartitions"}]}]}], "]"}]}], "&"}], 
     "@", "skeletonMap"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanAssembledSkeleton", "=", 
    RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
     RowBox[{"assembledSkeleton", ",", "\[IndentingNewLine]", 
      RowBox[{"ColorDetect", "[", 
       RowBox[{"assembledSkeleton", ",", "White"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"assembledSkeleton", ",", "cleanAssembledSkeleton"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "10"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8374434360865107`*^9, 3.8374434415888057`*^9}, {
   3.8374475416716475`*^9, 3.8374475434217463`*^9}, {3.8375067739671326`*^9, 
   3.8375067801755977`*^9}, {3.837518435650288*^9, 3.8375184710656157`*^9}, {
   3.8375185965381784`*^9, 3.83751865630539*^9}, 3.8376679945137453`*^9, {
   3.837671065505262*^9, 3.837671151913252*^9}, {3.843480769228933*^9, 
   3.8434807801447554`*^9}, 3.8463343112763133`*^9, {3.8616041460946364`*^9, 
   3.861604170947037*^9}, 3.8616896801940575`*^9},
 CellLabel->
  "In[4442]:=",ExpressionUUID->"b6bb52dd-b081-40ef-811e-6acbebec2c6f"],

Cell[CellGroupData[{

Cell["Visuals for the Article", "Subsubsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.861606281523833*^9, 
   3.861606284826998*^9}},ExpressionUUID->"25a3458d-a691-4839-9b9e-\
f3ba2d1fc9dd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"testIWbounds", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ColorReplace", "[", 
       RowBox[{"#", ",", 
        RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Thinning", "/@", 
      RowBox[{"EdgeDetect", "/@", 
       RowBox[{"Flatten", "@", "scanRegionMasks"}]}]}]}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.861605333436841*^9, 3.861605385027594*^9}, {
  3.861605422574223*^9, 3.8616055021089463`*^9}, {3.8616062905417676`*^9, 
  3.861606307054681*^9}},
 CellLabel->
  "In[4447]:=",ExpressionUUID->"d9cb82fc-8a07-482d-b927-58865b5bc89f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"checkID", "=", "15"}], ";"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GraphicsRow", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImagePadding", "\[Rule]", "2"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Rows\>\""}], ",", 
         RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}], "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Colorize", "@", 
          RowBox[{"scanPartitions", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "-", 
         RowBox[{"ColorReplace", "[", 
          RowBox[{
           RowBox[{"testIWbounds", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", 
           RowBox[{"Red", "\[Rule]", "White"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"scannedSkeletons", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "+", 
         RowBox[{"testIWbounds", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"solidSkeletons", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Colorize", "@", 
          RowBox[{"scanPartitions", "[", 
           RowBox[{"[", "checkID", "]"}], "]"}]}], "-", 
         RowBox[{"solidSkeletons", "[", 
          RowBox[{"[", "checkID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "&"}], "@", "checkID"}], "*)"}]], "Input",
 CellChangeTimes->{{3.861605333436841*^9, 3.861605385027594*^9}, {
  3.861605422574223*^9, 3.8616055021089463`*^9}, {3.8616062905417676`*^9, 
  3.861606307054681*^9}, {3.8616068657086987`*^9, 3.861606990283021*^9}, {
  3.861607035433278*^9, 3.861607055876588*^9}, {3.8616081741553526`*^9, 
  3.8616082171263633`*^9}, {3.8616156793251705`*^9, 3.8616157924038734`*^9}, {
  3.8616161624129143`*^9, 3.8616162247009163`*^9}, {3.861694705511718*^9, 
  3.8616947055745497`*^9}, {3.86169527227321*^9, 3.8616952864133887`*^9}, {
  3.861695317543357*^9, 3.8616954711994267`*^9}, {3.8617219005387025`*^9, 
  3.8617219458351107`*^9}},
 CellLabel->
  "In[4448]:=",ExpressionUUID->"cc50011f-0d23-4d47-a858-5c8298fd83ff"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ImageCollage", "[", 
    RowBox[{"solidSkeletons", ",", 
     RowBox[{"ImagePadding", "\[Rule]", "2"}], ",", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "@", "Gray"}]}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Rows\>\""}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageCollage", "[", 
    RowBox[{"solidSkeletonsFiltered", ",", 
     RowBox[{"ImagePadding", "\[Rule]", "2"}], ",", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "@", "Gray"}]}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Rows\>\""}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImageCollage", "[", 
    RowBox[{"solidSkeletonsFinal", ",", 
     RowBox[{"ImagePadding", "\[Rule]", "2"}], ",", 
     RowBox[{"Background", "\[Rule]", 
      RowBox[{"Lighter", "@", "Gray"}]}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Rows\>\""}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8616050922426014`*^9, 3.8616052235204887`*^9}, {
  3.861606325779856*^9, 3.861606333760459*^9}, {3.86160638885318*^9, 
  3.861606389237152*^9}},
 CellLabel->
  "In[4449]:=",ExpressionUUID->"6626a6ea-39b7-4bf5-8c5e-b8616af4a038"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Skeleton - Orientation Spectrum, FFT & Visuals", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 
   3.8376881696134996`*^9}},ExpressionUUID->"4132375c-bc98-4914-8274-\
921bbc269d97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"customFrameTicks", ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"All", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"angleTickValues", ",", "None"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontSize", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.837486315824397*^9, 3.837486363272543*^9}, {
   3.837486402176996*^9, 3.837486480487789*^9}, {3.837486530896189*^9, 
   3.837486550248671*^9}, {3.837486613729086*^9, 3.8374866406326323`*^9}, {
   3.837486693896231*^9, 3.8374866939441037`*^9}, {3.8374868618166695`*^9, 
   3.8374868646886253`*^9}, {3.8375197500695443`*^9, 
   3.8375198643144693`*^9}, {3.837519898883273*^9, 3.837519899628687*^9}, {
   3.837520080866561*^9, 3.837520209106056*^9}, {3.8375216310422654`*^9, 
   3.837521657130557*^9}, {3.8375741058164845`*^9, 3.837574108344725*^9}, {
   3.8376843421099677`*^9, 3.8376843868540916`*^9}, {3.8376881716870813`*^9, 
   3.8376881727183247`*^9}, {3.8381897181633043`*^9, 3.838189741840721*^9}, {
   3.838189779728181*^9, 3.838189791183853*^9}, {3.8382139030481462`*^9, 
   3.8382139058067703`*^9}, {3.838272706829694*^9, 3.8382727076096077`*^9}, {
   3.847357086562025*^9, 3.8473570869115057`*^9}, 3.8473572221611776`*^9},
 CellLabel->
  "In[4450]:=",ExpressionUUID->"fc9be3f3-00c1-4cf9-991a-7fa513a33ebe"],

Cell["\<\
Defaults:

angleBinCount=100;
binInterpolation=2;

polarOverlayScale=1.2;
polarTicksFont=16;

fillFactorModifier=1;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, 3.838272704263554*^9, {
   3.8382733037062206`*^9, 3.8382733063132486`*^9}, {3.838354067691781*^9, 
   3.838354069380267*^9}, 3.838379479868639*^9},
 FontSize->16,ExpressionUUID->"9e1914f3-f6ca-4d10-936d-872f2b966c3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angleLabel", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<\[Phi], \[Degree]\>\"", ",", "\"\<\[Rho]\>\""}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleBinCount", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binInterpolation", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarOverlayScale", "=", "1.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarTicksFont", "=", "16"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.838272710689374*^9, {3.838273285833494*^9, 3.838273299155386*^9}, {
   3.838295511263817*^9, 3.8382955350712585`*^9}, {3.838298052639954*^9, 
   3.838298061088341*^9}, {3.8382980925602117`*^9, 3.8382980953716946`*^9}, {
   3.838353962532737*^9, 3.8383540109084044`*^9}, {3.8383540609408293`*^9, 
   3.8383540612210803`*^9}, 3.83835422629377*^9, {3.8383793750682716`*^9, 
   3.8383793752996526`*^9}, {3.838379408708146*^9, 3.83837940938733*^9}, {
   3.8383794425800066`*^9, 3.8383794428193665`*^9}, {3.8383909462716255`*^9, 
   3.8383909658065605`*^9}, {3.8383913675353537`*^9, 3.838391384744584*^9}, 
   3.838393638384965*^9, {3.83839368101717*^9, 3.838393727152563*^9}, {
   3.838395498433609*^9, 3.838395527575996*^9}, {3.838396038953995*^9, 
   3.8383960720173173`*^9}, {3.838440855336442*^9, 3.838440877073958*^9}, {
   3.8384409311122556`*^9, 3.838440931575018*^9}, {3.8384870302901134`*^9, 
   3.8384870317752595`*^9}, {3.838488902960991*^9, 3.8384889030397797`*^9}, {
   3.838634924601861*^9, 3.838634952777573*^9}, 3.838635298706417*^9, {
   3.8387056906267033`*^9, 3.8387056925057073`*^9}, 3.8387099670354586`*^9, {
   3.8387149108373346`*^9, 3.8387149111564817`*^9}, {3.8387149442853093`*^9, 
   3.83871497631603*^9}, {3.8387161082462993`*^9, 3.838716140828359*^9}, 
   3.8387820707396564`*^9, {3.838804587777757*^9, 3.8388046188175297`*^9}, {
   3.8388062254265776`*^9, 3.8388062254811487`*^9}, {3.8428555972205005`*^9, 
   3.8428555980093913`*^9}, {3.8429613707410016`*^9, 3.842961371228698*^9}, {
   3.8466799455319924`*^9, 3.8466799467387643`*^9}},
 CellLabel->
  "In[4452]:=",ExpressionUUID->"51a76618-992c-4801-8d34-10cda4b499e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"angleTickValues", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "15"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotSkeletonOrientationSpectrum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getSkeletonOrientationSpectrum", "[", 
      RowBox[{"#", ",", "Black"}], "]"}], "&"}], "@", 
    RowBox[{"getOrientationBinsWithWeights", "[", "\[IndentingNewLine]", 
     RowBox[{"cleanAssembledSkeleton", ",", "angleBinCount"}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotSkeletonDFT", "=", 
   RowBox[{"checkDFT", "@", "cleanAssembledSkeleton"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testLiquidMask", "=", 
   RowBox[{"liquidMask", "[", 
    RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testLiquidCavities", "=", 
    RowBox[{"liquidCavities", "[", 
     RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Image", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}], "@", 
  "plotReconstructedMap"}]}], "Input",
 CellChangeTimes->{{3.83748636536096*^9, 3.8374863707226267`*^9}, {
   3.8374864490173187`*^9, 3.83748645259276*^9}, {3.837486643448818*^9, 
   3.8374866886026073`*^9}, {3.8374868922720833`*^9, 3.837486894472067*^9}, {
   3.8375068444223456`*^9, 3.837506874742285*^9}, {3.8375081519347324`*^9, 
   3.8375082108465996`*^9}, {3.8375186711955824`*^9, 
   3.8375186797307625`*^9}, {3.837519459713752*^9, 3.8375194664896364`*^9}, {
   3.837519873770936*^9, 3.8375199022498293`*^9}, {3.837519944018324*^9, 
   3.837520001761738*^9}, {3.83752193014685*^9, 3.8375219337542057`*^9}, 
   3.8375220560525045`*^9, {3.8375759870582604`*^9, 3.8375759931788983`*^9}, {
   3.837579694011444*^9, 3.837579743187769*^9}, {3.837579802762864*^9, 
   3.8375798051408467`*^9}, {3.837668052856765*^9, 3.8376680597682867`*^9}, {
   3.8376680928777685`*^9, 3.837668178967606*^9}, {3.8376713027130823`*^9, 
   3.8376713117399487`*^9}, {3.8376787764205704`*^9, 3.837678785360629*^9}, {
   3.838189766601104*^9, 3.8381897932583485`*^9}, 3.8382732833331785`*^9, {
   3.8382955520806136`*^9, 3.8382955979113846`*^9}, {3.838296028404061*^9, 
   3.838296036080538*^9}, {3.8382961404805155`*^9, 3.8382961879635134`*^9}, 
   3.838297614211317*^9, {3.8382976762410645`*^9, 3.8382976902321067`*^9}, {
   3.8382978295763025`*^9, 3.8382978372557716`*^9}, {3.8382978770092487`*^9, 
   3.838297881378577*^9}, 3.8382980653539357`*^9, {3.8383539846296606`*^9, 
   3.83835398568484*^9}, {3.838381063318016*^9, 3.838381064415552*^9}, {
   3.8384870382723722`*^9, 3.83848704750453*^9}, {3.838783450324027*^9, 
   3.8387834510357103`*^9}, {3.842780853676028*^9, 3.8427808643554764`*^9}, 
   3.8427809328383875`*^9, {3.8427811598694205`*^9, 3.8427811859566765`*^9}, {
   3.8427818538780355`*^9, 3.842781855165594*^9}, {3.8427819438935933`*^9, 
   3.8427819745187645`*^9}, {3.842782227517682*^9, 3.842782240567793*^9}, {
   3.8428613030927076`*^9, 3.8428613226466894`*^9}, 3.8430443852378693`*^9, {
   3.8430444168055863`*^9, 3.8430444174448776`*^9}, {3.8466799194183064`*^9, 
   3.846679931396283*^9}, {3.8466801339398804`*^9, 3.846680142018277*^9}, {
   3.8467747174476104`*^9, 3.846774720727839*^9}, {3.847357095360993*^9, 
   3.8473570965454297`*^9}, {3.847958095067218*^9, 3.847958134793104*^9}, {
   3.8479581993308764`*^9, 3.847958238920464*^9}, {3.8479583213124485`*^9, 
   3.8479583249292765`*^9}, {3.8479585975931273`*^9, 3.847958599801049*^9}, {
   3.8479587648091927`*^9, 3.8479587672641554`*^9}},
 CellLabel->
  "In[4457]:=",ExpressionUUID->"b4eacca6-c0de-4992-93c9-5c134de16c18"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "outputFrameResults", "<>", 
      "\"\<12_skeleton_orientaton_spectrum.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "plotSkeletonOrientationSpectrum", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputFrameResults", "<>", "\"\<13_skeleton_DFT.jpg\>\""}], ",",
      "\[IndentingNewLine]", "plotSkeletonDFT", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputFrameResults", "<>", "\"\<14_reconstructed_map.jpg\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Rasterize", "[", 
     RowBox[{"plotReconstructedMap", ",", 
      RowBox[{"RasterSize", "\[Rule]", "2600"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageResolution", "\[Rule]", "1500"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8382943998810835`*^9, 3.8382944580973806`*^9}, {
   3.838294642855945*^9, 3.8382946592735653`*^9}, {3.8382947641837215`*^9, 
   3.8382947774230537`*^9}, {3.838294928695345*^9, 3.838294935608862*^9}, {
   3.8382950125746803`*^9, 3.838295021703828*^9}, {3.8382950775846834`*^9, 
   3.8382951131273565`*^9}, {3.8382957498472395`*^9, 
   3.8382958289208474`*^9}, {3.838295887343785*^9, 3.838295912350889*^9}, {
   3.838295960856927*^9, 3.8382959990950556`*^9}, {3.838296102048192*^9, 
   3.838296120638895*^9}, {3.838297963984865*^9, 3.8382979693435388`*^9}, {
   3.838379419164336*^9, 3.8383794201397285`*^9}, {3.8383794507401905`*^9, 
   3.8383794725571856`*^9}, {3.838390904238437*^9, 3.838390910374034*^9}, 
   3.8383909550641184`*^9, 3.838459912120163*^9, {3.8480596731425924`*^9, 
   3.84805967320642*^9}, {3.8480625571509047`*^9, 3.8480625593416905`*^9}, {
   3.8614676759789886`*^9, 3.8614676836341977`*^9}},
 CellLabel->
  "In[4463]:=",ExpressionUUID->"bb207d89-6550-4137-aaae-d649bfdc32d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix Plot of Partition Orientations", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.8460781572657833`*^9, 
   3.846078176826562*^9}},ExpressionUUID->"69d98335-8c6b-412e-b946-\
8c2b7673730e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matrixPlotFontSize", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotSize", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrixPlotLegendSize", "=", "550"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.846840820241092*^9, 3.846840853695734*^9}, {
   3.8468409758400793`*^9, 3.8468409766957912`*^9}, {3.846841220824067*^9, 
   3.8468412305523047`*^9}, {3.8468415458087883`*^9, 
   3.8468415488482285`*^9}, {3.846842020352212*^9, 3.846842032375646*^9}, {
   3.8468421207527933`*^9, 3.846842216072364*^9}, {3.8468422582241573`*^9, 
   3.8468423277369576`*^9}, 3.8468424984803286`*^9, 3.8468427174251423`*^9, {
   3.846842903529437*^9, 3.8468429603608685`*^9}, {3.8468431691286144`*^9, 
   3.846843176367257*^9}, {3.846843249487932*^9, 3.846843297847622*^9}, {
   3.8468435577524605`*^9, 3.8468436137836285`*^9}, {3.846843661807533*^9, 
   3.846843685143428*^9}, {3.8468437583443365`*^9, 3.8468437689586473`*^9}, {
   3.8468438075120554`*^9, 3.846843807631736*^9}, {3.846843874799955*^9, 
   3.84684387836698*^9}, {3.8468441173753877`*^9, 3.8468441318260756`*^9}, {
   3.846844187727313*^9, 3.846844385023009*^9}, {3.84684448310353*^9, 
   3.846844485216031*^9}, {3.8468445286319075`*^9, 3.846844657038422*^9}, {
   3.846844727512843*^9, 3.8468447402388144`*^9}, {3.846844817272462*^9, 
   3.846844826286354*^9}, {3.8468448880731287`*^9, 3.8468449282636557`*^9}, {
   3.846844965799458*^9, 3.8468450283120675`*^9}, {3.846845165127325*^9, 
   3.8468451703514853`*^9}, {3.846845213847227*^9, 3.8468452359202147`*^9}, {
   3.8468454686743402`*^9, 3.846845486239685*^9}, {3.847703456007388*^9, 
   3.8477034634466157`*^9}},
 CellLabel->
  "In[4466]:=",ExpressionUUID->"2896a955-d7d9-4025-892c-3c111d0c6177"],

Cell[BoxData[
 RowBox[{"plotPartitionOrientationMatrix", "=", 
  RowBox[{
  "partitionOrientationMatrixPlot", "@", 
   "cleanAssembledSkeleton"}]}]], "Input",
 CellChangeTimes->{{3.8468454224627085`*^9, 3.8468454304891415`*^9}, {
  3.8468455547831645`*^9, 3.8468456148231463`*^9}},
 CellLabel->
  "In[4469]:=",ExpressionUUID->"1f8c4392-b892-4605-91a6-aca973a07360"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "outputFrameResults", "<>", "\"\<15_orientation_matrix_plot.jpg\>\""}], 
    ",", "\[IndentingNewLine]", "plotPartitionOrientationMatrix", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8459620408008375`*^9, 3.8459621633833437`*^9}, {
   3.845962376648549*^9, 3.8459623779680214`*^9}, {3.846047080203837*^9, 
   3.846047093962757*^9}, {3.8460471278199124`*^9, 3.846047128923745*^9}, 
   3.846070542710996*^9, {3.846078272738577*^9, 3.8460783080497155`*^9}, {
   3.8460783426342325`*^9, 3.8460784400586777`*^9}, {3.846078473026679*^9, 
   3.846078473906327*^9}, {3.8467634178818316`*^9, 3.846763417954638*^9}, 
   3.8471762378754516`*^9, {3.8480597221829634`*^9, 3.848059722510127*^9}, 
   3.8614676888911624`*^9},
 CellLabel->
  "In[4470]:=",ExpressionUUID->"1c99ba3c-09e8-4cc0-80fe-d24528064892"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
<< Extra Filter for Analysis of Zoomed-In Primary Dendrites >>\
\>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8382060707719393`*^9, 
   3.8382060915723295`*^9}, {3.83880256201698*^9, 3.838802579607963*^9}, {
   3.8388026183201494`*^9, 
   3.838802663928574*^9}},ExpressionUUID->"6c730c9f-2440-4675-8a09-\
4c09718e5f5b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[4471]:=",ExpressionUUID->"e5d0f4bc-f076-4ddc-bfbf-5963029c186e"],

Cell["TEST ZONE", "Abstract",
 CellChangeTimes->{{3.822418106687871*^9, 3.8224181153957405`*^9}, {
   3.8376936673110924`*^9, 3.837693692007067*^9}, 3.838705248353115*^9},
 FontSize->36,ExpressionUUID->"acf83015-85ed-413d-8b20-76491b4c413a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[4472]:=",ExpressionUUID->"53e03ae8-b03a-4459-841a-ddf5352a8491"],

Cell["Implement dendrite curvature calculation", "Subitem",
 CellChangeTimes->{{3.8215428902446327`*^9, 3.8215429092917013`*^9}, {
   3.821543019999116*^9, 3.821543055134698*^9}, {3.821543108413828*^9, 
   3.82154310858138*^9}, 3.8215435373886523`*^9, {3.821543586804587*^9, 
   3.821543595004086*^9}, {3.821552325940542*^9, 3.8215523722177296`*^9}, {
   3.8215571746165543`*^9, 3.8215571838568335`*^9}, {3.8215962804132195`*^9, 
   3.821596310588499*^9}, {3.821628482941619*^9, 3.821628520128134*^9}, {
   3.8223951717372007`*^9, 3.822395209954018*^9}, {3.822420655055955*^9, 
   3.8224206766429777`*^9}, {3.828683791164585*^9, 3.8286838005880375`*^9}, {
   3.8376051147289844`*^9, 3.8376051299413137`*^9}, {3.8376055257819567`*^9, 
   3.837605601745866*^9}, {3.838273984166917*^9, 3.838273984166917*^9}, {
   3.8383541730600777`*^9, 3.838354207076136*^9}, {3.8384441121280336`*^9, 
   3.838444113231087*^9}, {3.838634880900425*^9, 3.838634880901421*^9}, {
   3.838804915200678*^9, 3.8388049300165234`*^9}},
 FontSize->18,ExpressionUUID->"99d72d06-1ab3-4e11-8e60-40da3a618343"],

Cell["\<\
Defaults:

thresholdSolidMask = 4.25*10^-2;
primaryClosingScale = 8;
secondaryClosingScale = 25;
maskComponentSizeThreshold = 3000;

localThresholdRadius = 15;
erosionScale = 1;
gaussianRadius = 5;
segmentationThreshold = 0.72;
componentSizeThreshold = 35;
maxPruningLength = 30;\
\>", "Abstract",
 CellChangeTimes->{{3.838800562898549*^9, 3.8388005867595716`*^9}},
 FontSize->16,ExpressionUUID->"f12e4be4-d1bf-466d-a5be-f1a6eb07dcb0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"thresholdSolidMask", "=", 
     RowBox[{"4.25", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"primaryClosingScale", "=", "8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"secondaryClosingScale", "=", "25"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maskComponentSizeThreshold", "=", "3000"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localThresholdRadius", "=", "15"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"erosionScale", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaussianRadius", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"segmentationThreshold", "=", "0.72"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"componentSizeThreshold", "=", "35"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxPruningLength", "=", "30"}], ";"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.838788483452833*^9, 3.838788515940116*^9}, {
   3.838788643572995*^9, 3.838788812684292*^9}, 3.838788848716731*^9, {
   3.8387889681566625`*^9, 3.8387889874531946`*^9}, {3.8387890743731904`*^9, 
   3.8387890745958233`*^9}, {3.838789715814104*^9, 3.8387897405569534`*^9}, {
   3.8387898347254295`*^9, 3.8387899452290077`*^9}, {3.83879135086976*^9, 
   3.838791402661295*^9}, {3.8387977979921665`*^9, 3.838797844430018*^9}, {
   3.8387979186316366`*^9, 3.8387979624310455`*^9}, {3.838798006232154*^9, 
   3.838798013183569*^9}, {3.838798195776266*^9, 3.838798237031251*^9}},
 CellLabel->
  "In[4473]:=",ExpressionUUID->"c0223776-8d87-47af-a513-5c23107b00a4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"solidMaskV3", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ColorNegate", "@", 
          RowBox[{"Binarize", "[", 
           RowBox[{"#", ",", 
            RowBox[{"1", "-", "thresholdSolidMask"}]}], "]"}]}], "&"}], "@", 
        "filteredFrame"}]}], ";"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "solidStructureBinarized"}], "=", 
    RowBox[{"LocalAdaptiveBinarize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ColorNegate", "@", "filteredFrame"}], ",", 
      "localThresholdRadius"}], "\[IndentingNewLine]", "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"structureMask", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Closing", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "secondaryClosingScale"}]}], 
            "\[IndentingNewLine]", "]"}]}], "&"}], "@", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"DeleteSmallComponents", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "maskComponentSizeThreshold"}], 
          "\[IndentingNewLine]", "]"}]}], "&"}], "@", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Closing", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", 
         RowBox[{"DiskMatrix", "@", "primaryClosingScale"}]}], 
        "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
     RowBox[{"ColorNegate", "@", "solidMaskV3"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Colorize", "@", "repairedFrame"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Colorize", "@", "filteredFrame"}], ",", 
        "\[IndentingNewLine]", "solidMaskV3", ",", "\[IndentingNewLine]", 
        "solidStructureBinarized"}], "\[IndentingNewLine]", "}"}]}], ",", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"Spacings", "\[Rule]", "20"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838798181319066*^9, 3.838798185583144*^9}, {
  3.8387983145134907`*^9, 3.8387983338332787`*^9}, {3.8387984157352543`*^9, 
  3.838798451167125*^9}, {3.8387985216875043`*^9, 3.838798611103454*^9}, {
  3.838798650439172*^9, 3.838798745303217*^9}, {3.838802466836788*^9, 
  3.838802468616373*^9}, {3.838802716841013*^9, 3.838802735712963*^9}},
 CellLabel->
  "In[4474]:=",ExpressionUUID->"d57da1ba-cb62-4c55-b918-affc4dc7dc22"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"structureMask", ",", "\[IndentingNewLine]", 
       RowBox[{"structureOfInterest", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageMultiply", "[", 
           RowBox[{"structureMask", ",", "#"}], "]"}], "&"}], "@", 
         "solidStructureBinarized"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"stuctureErosionStep1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Erosion", "[", 
           RowBox[{"#", ",", 
            RowBox[{"DiskMatrix", "@", "erosionScale"}]}], "]"}], "&"}], "@", 
         "structureOfInterest"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"stuctureErosionStep2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", "segmentationThreshold"}], "]"}], "&"}], "@", 
           RowBox[{"GaussianFilter", "[", 
            RowBox[{"#", ",", "gaussianRadius"}], "]"}]}], "&"}], "@", 
         "stuctureErosionStep1"}]}]}], "\[IndentingNewLine]", "}"}]}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "20"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.838798181319066*^9, 3.838798185583144*^9}, {
  3.8387983145134907`*^9, 3.8387983338332787`*^9}, {3.8387984157352543`*^9, 
  3.838798451167125*^9}, {3.8387985216875043`*^9, 3.838798611103454*^9}, {
  3.838798650439172*^9, 3.838798745303217*^9}, {3.838802466836788*^9, 
  3.838802468616373*^9}, {3.838802716841013*^9, 3.838802740928604*^9}},
 CellLabel->
  "In[4475]:=",ExpressionUUID->"e542bdbc-0e29-40c3-8774-b4f78d95e7e2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "2"}], "]"}], "&"}], "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"structureSkeleton", "=", 
        RowBox[{"Thinning", "@", "stuctureErosionStep2"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"structureSkeletonClean", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteSmallComponents", "[", 
           RowBox[{"#", ",", "componentSizeThreshold"}], "]"}], "&"}], "@", 
         "structureSkeleton"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"resolvedPrimaryDendrites", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Pruning", "[", 
           RowBox[{"#", ",", "maxPruningLength"}], "]"}], "&"}], "@", 
         "structureSkeletonClean"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Colorize", "@", "repairedFrame"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "[", "\[IndentingNewLine]", 
          RowBox[{"resolvedPrimaryDendrites", ",", "Black"}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"Spacings", "\[Rule]", "20"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.838798181319066*^9, 3.838798185583144*^9}, {
  3.8387983145134907`*^9, 3.8387983338332787`*^9}, {3.8387984157352543`*^9, 
  3.838798451167125*^9}, {3.8387985216875043`*^9, 3.838798611103454*^9}, {
  3.838798650439172*^9, 3.838798745303217*^9}, {3.838802466836788*^9, 
  3.838802468616373*^9}, {3.838802716841013*^9, 3.838802722232246*^9}},
 CellLabel->
  "In[4476]:=",ExpressionUUID->"58057baf-e4f0-4a07-b351-9f33564aa56e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"plotPrimaryDendriteOverlay", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Colorize", "@", "repairedFrame"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Style", "[", "\[IndentingNewLine]", 
         RowBox[{"resolvedPrimaryDendrites", ",", "Black"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"coloredPrimaryDendrites", "=", 
        RowBox[{"getOrientationColors", "@", "resolvedPrimaryDendrites"}]}], 
       ";"}], "\n", 
      RowBox[{
       RowBox[{"binInterpolation", "=", "1"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"primaryOrientationDegrees", "=", 
        RowBox[{"getOrientations", "@", "coloredPrimaryDendrites"}]}], ";"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "plotPrimaryOrientationSpectrum"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getNormalizedDistributions", "[", "\[IndentingNewLine]", 
          RowBox[{
          "#", ",", "angleBinCount", ",", "angleLabel", ",", "Black"}], 
          "\[IndentingNewLine]", "]"}], "&"}], "@", 
        "primaryOrientationDegrees"}], "\[IndentingNewLine]", "\n", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polarOverlayScale", "=", "1"}], ";"}], "\[IndentingNewLine]", 
       RowBox[{"plotPrimarySkeletonDFT", "=", 
        RowBox[{"checkDFT", "@", "resolvedPrimaryDendrites"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "plotDendritesBranchingPoints"}], "=", 
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ColorReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Black", "\[Rule]", "White"}]}], "]"}], "&"}], "@", 
         "coloredPrimaryDendrites"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "Black"}], "]"}], "&"}], "@", 
           RowBox[{"Dilation", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "5"}]}], "]"}]}], "&"}], "@", 
         RowBox[{
         "MorphologicalBranchPoints", "@", "resolvedPrimaryDendrites"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Image", "[", 
          RowBox[{"#", ",", 
           RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}], "@", 
        RowBox[{"ImagePad", "[", 
         RowBox[{"#", ",", "2", ",", "Black"}], "]"}]}], "&"}], "@", 
      "plotDendritesBranchingPoints"}], "\n", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "favoriteDendrite"}], "=", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Image", "/@", 
         RowBox[{"Last", "/@", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"#", ",", "\"\<Mask\>\""}], "]"}]}]}], "&"}], "@", 
       "resolvedPrimaryDendrites"}], "\[IndentingNewLine]", ")"}], "[", 
     RowBox[{"[", "11", "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8388034807690477`*^9, 3.838803575521327*^9}, {
   3.838803790953637*^9, 3.8388037922244806`*^9}, 3.838803920827877*^9, {
   3.8388039644104557`*^9, 3.838804045728614*^9}, {3.838804454800951*^9, 
   3.838804457569153*^9}},
 CellLabel->
  "In[4477]:=",ExpressionUUID->"4565c98c-b011-4a84-9e4c-69a84ceaf689"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "output", "<>", 
      "\"\<0_2_primary_dendrite_orientation_spectrum.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "plotPrimaryOrientationSpectrum", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "250"}]}], "\[IndentingNewLine]", 
    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<0_1_primary_dendrite_overlay.jpg\>\""}], 
     ",", "\[IndentingNewLine]", "plotPrimaryDendriteOverlay", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "250"}]}], "\[IndentingNewLine]", 
    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<0_3_primary_dendrite_DFT.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "plotPrimarySkeletonDFT", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "\[IndentingNewLine]", 
    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "output", "<>", "\"\<0_4_primary_dendrites_branching_points.jpg\>\""}], 
     ",", "\[IndentingNewLine]", "plotDendritesBranchingPoints", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.838804176160458*^9, 3.8388041973050785`*^9}, {
  3.838804362472314*^9, 3.8388043627042446`*^9}, {3.8388043930024405`*^9, 
  3.8388044068417377`*^9}},
 CellLabel->
  "In[4478]:=",ExpressionUUID->"0347f436-4000-4f55-9d4c-047b4e9c1d37"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[4479]:=",ExpressionUUID->"5c800286-3322-4ffc-93d1-4a0411a4c8ad"],

Cell["TEST ZONE END", "Abstract",
 CellChangeTimes->{{3.822418106687871*^9, 3.8224181153957405`*^9}, {
   3.8376936673110924`*^9, 3.837693692007067*^9}, 3.838705248353115*^9, {
   3.838788328284171*^9, 3.838788328739952*^9}},
 FontSize->36,ExpressionUUID->"fd09a6c4-169b-4a36-aa9c-98e0eb44926a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.838788339863214*^9, 3.838788347856843*^9}},
 CellLabel->
  "In[4480]:=",ExpressionUUID->"01844d75-67d9-4021-8bb8-efad99e646b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Measure Liquid Cavities", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.837688222422068*^9}},ExpressionUUID->"20ec0a83-a042-4d1c-8935-\
71a3631e981d"],

Cell["\<\
Defaults:

cavitySizeThreshold=10;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.8382727228997374`*^9}},
 FontSize->16,ExpressionUUID->"68b90f2b-2553-4c4a-a049-8af24d08e8c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cavitySizeThreshold", "=", "10"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.837576021945084*^9, 3.8375760261857476`*^9}, 
   3.8375778436179304`*^9, {3.842792873818446*^9, 3.8427928740158224`*^9}, 
   3.8428556538432455`*^9},
 CellLabel->
  "In[4481]:=",ExpressionUUID->"38c82971-05d6-472b-84fe-c2f90a093ef4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cavityData", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Last", "/@", 
        RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Area\>\"", ",", "\"\<Eccentricity\>\"", ",", 
            "\"\<Orientation\>\""}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#Area", ">", "cavitySizeThreshold"}], "&"}]}], 
         "\[IndentingNewLine]", "]"}]}], "&"}], "@", "testLiquidCavities"}], "/.", 
     RowBox[{"Rule", "\[Rule]", "List"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cavityAreas", ",", "cavityEccentricity", ",", "cavityOrientations"}], 
     "}"}], "=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cavityData", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "@", "cavityData"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "cavityAreas", ",", "cavityEccentricity", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", "/", "\[Pi]"}], ")"}], "*", 
      RowBox[{"ArcTan", "@", 
       RowBox[{"Tan", "@", "cavityOrientations"}]}]}]}], 
    "\[IndentingNewLine]", "}"}], "//", "Transpose"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.837576021945084*^9, 3.8375760261857476`*^9}, {
   3.8375778436179304`*^9, 3.837577847409794*^9}, {3.8375798422195797`*^9, 
   3.837579882330586*^9}, {3.837661228622967*^9, 3.837661229191778*^9}, {
   3.8376689026489935`*^9, 3.8376689043125453`*^9}, {3.8381899045368013`*^9, 
   3.8381899155765324`*^9}, {3.8381899757445145`*^9, 
   3.8381899774163203`*^9}, {3.8381901302979736`*^9, 3.838190182633993*^9}, {
   3.8381934305638385`*^9, 3.838193440153915*^9}, {3.8382102507500176`*^9, 
   3.8382102550714645`*^9}, {3.838273512642165*^9, 3.8382735336102376`*^9}, {
   3.8387839072124043`*^9, 3.838783942987286*^9}, {3.838783980756242*^9, 
   3.8387840367961283`*^9}, {3.8427823276770506`*^9, 3.842782330380822*^9}, {
   3.8427823931021366`*^9, 3.8427824131415606`*^9}, {3.8427928794410543`*^9, 
   3.842792903976237*^9}, 3.847958446234517*^9},
 CellLabel->
  "In[4482]:=",ExpressionUUID->"4f548078-2028-41ed-af12-81654e5a141f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dendrite Grain Decomposition (DGD)", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8429645653095303`*^9, 
   3.8429645704775333`*^9}, {3.862461972901928*^9, 
   3.862461980454281*^9}},ExpressionUUID->"2b64250c-c2c3-49bc-823a-\
6dea98b46960"],

Cell[CellGroupData[{

Cell["Primary Scan - Detect Dominant Orientations", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.842964531181522*^9, 
   3.842964556606129*^9}},ExpressionUUID->"ff872022-4438-4167-90c1-\
17522c53fe0b"],

Cell["\<\
Defaults:

binRegularization=0.15;
binAveragingRadius=2;
peakBinCount=200;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.838272735787283*^9}, {3.842938960908327*^9, 3.842938961659313*^9}},
 FontSize->16,ExpressionUUID->"7b62fbe8-6933-446e-a31e-6b844150aebf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binRegularization", "=", "0.15"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"binAveragingRadius", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"peakBinCount", "=", "200"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8427072624780755`*^9, 3.842707280284464*^9}, {
   3.8427073151003733`*^9, 3.8427073155022984`*^9}, {3.8427073946037965`*^9, 
   3.842707449733014*^9}, {3.8427074799641814`*^9, 3.8427074833491306`*^9}, 
   3.8427099093094854`*^9, {3.842853967610562*^9, 3.842853968986882*^9}, {
   3.8428557016349597`*^9, 3.84285576284221*^9}, 3.8429386075886793`*^9, {
   3.843013682743314*^9, 3.8430136881754313`*^9}, {3.8430414783386393`*^9, 
   3.843041488563308*^9}, 3.846680472787178*^9, {3.846680906946587*^9, 
   3.8466809089798203`*^9}, {3.8466819451953583`*^9, 3.8466819592904773`*^9}, 
   3.847352057447451*^9, {3.854650939673518*^9, 3.854650939889748*^9}, {
   3.85465102419279*^9, 3.8546510353999176`*^9}, {3.8615417489662213`*^9, 
   3.8615417496494083`*^9}, {3.8615421236544847`*^9, 
   3.8615421247894526`*^9}, {3.861542463517683*^9, 3.861542473604999*^9}, {
   3.8615440378986626`*^9, 3.8615440416526837`*^9}, 3.8615497019361053`*^9, {
   3.861549732368241*^9, 3.861549736455366*^9}, {3.8615501801831007`*^9, 
   3.8615501991197996`*^9}, {3.8615502993748875`*^9, 3.861550308527331*^9}, {
   3.8615505908717327`*^9, 3.8615506211976995`*^9}, 3.8615507077123346`*^9, 
   3.8615997499856105`*^9, {3.86160852677149*^9, 3.8616085271365223`*^9}, 
   3.8616111319767675`*^9, {3.8616115591593647`*^9, 3.861611559222316*^9}, {
   3.8616123957520185`*^9, 3.8616123960786543`*^9}, {3.861613589966399*^9, 
   3.8616135901249733`*^9}, {3.8616137414314766`*^9, 3.8616137414923067`*^9}, 
   3.8616137752779446`*^9, {3.861616329292535*^9, 3.8616163302749605`*^9}, {
   3.8616164595399323`*^9, 3.8616164727307034`*^9}, 3.8616168197898717`*^9, {
   3.86168800293312*^9, 3.8616880506319923`*^9}, 3.8616966641981883`*^9, 
   3.861698568947938*^9, 3.861699162180539*^9, {3.8617220608410835`*^9, 
   3.8617220609438047`*^9}, {3.8617221113227053`*^9, 3.86172212059486*^9}, {
   3.8617221697943163`*^9, 3.8617221847118006`*^9}, {3.8617222396617546`*^9, 
   3.8617222491832886`*^9}, {3.8617222945070667`*^9, 3.86172229469656*^9}, {
   3.861722516248266*^9, 3.8617225485442524`*^9}, {3.861722628872622*^9, 
   3.861722651712587*^9}, {3.8617239995749717`*^9, 3.8617240198486557`*^9}, {
   3.8617240931118145`*^9, 3.861724097175*^9}, {3.8617710865855937`*^9, 
   3.86177109827323*^9}, 3.861782909466234*^9, 3.861792479624051*^9, {
   3.861799223932695*^9, 3.8617992253698483`*^9}, {3.8618592287882204`*^9, 
   3.861859275325368*^9}, {3.861899120567692*^9, 3.8618991246623597`*^9}, {
   3.8618991812140036`*^9, 3.8618992478452387`*^9}, 3.861899296964456*^9, 
   3.862302263014741*^9, {3.862302308724383*^9, 3.8623023242209506`*^9}, 
   3.862414422253065*^9, 3.8624145623362236`*^9, 3.8624795348536215`*^9, 
   3.8625026818557763`*^9, {3.8625032029185324`*^9, 3.862503215349264*^9}, 
   3.862503416433015*^9, 3.862503886927635*^9, {3.8625039288801374`*^9, 
   3.8625039314453278`*^9}, {3.862573950642319*^9, 3.8625739506733284`*^9}, {
   3.862574168442255*^9, 3.8625741702249684`*^9}, 3.862574202963126*^9, {
   3.862583608531269*^9, 3.8625836098267345`*^9}, {3.862583848620887*^9, 
   3.862583854835825*^9}, {3.862584568197005*^9, 3.8625845781875954`*^9}, {
   3.8625847175981846`*^9, 3.8625847379000435`*^9}, {3.8625849138541164`*^9, 
   3.8625849150034866`*^9}, 3.862595633569951*^9, {3.8625980190380135`*^9, 
   3.8625980388224707`*^9}, {3.862627799894601*^9, 3.8626278077642965`*^9}, {
   3.862660207153866*^9, 3.8626602082017007`*^9}, {3.862750303692407*^9, 
   3.8627503042927732`*^9}},
 CellLabel->
  "In[4485]:=",ExpressionUUID->"87402a7b-bbf9-45c1-ab21-a5a120588cc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"orientationBins", "=", 
    RowBox[{"getOrientationBinsWithWeights", "[", "\[IndentingNewLine]", 
     RowBox[{"cleanAssembledSkeleton", ",", "peakBinCount"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"smoothedOrientationBins", "=", 
    RowBox[{"getSmoothOrientationBins", "@", "orientationBins"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"plotPrimaryPeaks", "=", 
  RowBox[{"plotOrientationPeaks", "@", 
   RowBox[{"{", 
    RowBox[{"orientationBins", ",", "smoothedOrientationBins"}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.8427072624780755`*^9, 3.842707280284464*^9}, {
   3.8427073151003733`*^9, 3.8427073155022984`*^9}, {3.8427073946037965`*^9, 
   3.842707449733014*^9}, {3.8427074799641814`*^9, 3.8427074833491306`*^9}, 
   3.8427099093094854`*^9, {3.842853967610562*^9, 3.842853968986882*^9}, {
   3.8428557016349597`*^9, 3.84285576284221*^9}, 3.8429386075886793`*^9, {
   3.843013682743314*^9, 3.8430136881754313`*^9}, {3.8430414783386393`*^9, 
   3.843041488563308*^9}, 3.846680472787178*^9, {3.846680906946587*^9, 
   3.8466809089798203`*^9}, {3.8466819451953583`*^9, 
   3.8466819592904773`*^9}, {3.847352057447451*^9, 3.8473520607033544`*^9}, {
   3.861468077323086*^9, 3.8614680782176886`*^9}, {3.8615415565432644`*^9, 
   3.8615415579445734`*^9}, {3.8615416001569166`*^9, 3.861541635173105*^9}, {
   3.8615417472657413`*^9, 3.861541751749833*^9}, {3.861781667833984*^9, 
   3.8617816684321594`*^9}, {3.8618592630940323`*^9, 3.8618592696295547`*^9}},
 CellLabel->
  "In[4488]:=",ExpressionUUID->"4ba33ef8-1aa8-4fa1-ae27-ab8e88561075"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputFrameResults", "<>", "\"\<16_orientation_peaks.jpg\>\""}], 
    ",", "\[IndentingNewLine]", "plotPrimaryPeaks", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8382979833999586`*^9, 3.8382980066802344`*^9}, {
   3.8383913393760614`*^9, 3.838391345014985*^9}, {3.8428557353159137`*^9, 
   3.8428557659060183`*^9}, {3.848062181999519*^9, 3.8480621824772453`*^9}, 
   3.861468081772269*^9},
 CellLabel->
  "In[4187]:=",ExpressionUUID->"988bc412-1fa4-4b64-81de-7e048d2d56a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Primary Scan - Detect Dominant Grains", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.842964531181522*^9, 3.842964556606129*^9}, {3.842964593757665*^9, 
   3.842964618325965*^9}},ExpressionUUID->"8a6f76c2-28d9-48f8-ad9c-\
a8f9cfec778e"],

Cell["\<\
Defaults:

grainAreaThreshold=2000;
grainClosingScale=5;
orientationPeakSharpness=Automatic;

orientationPeakThreshold=0.12;
colorSpaceWindow=0.05;
colorMatchThreshold=0.5;
criticalDistanceFactor=2;
criticalSpectrumEdgePeakDistance=5;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.8382727495804157`*^9}, 3.838705740978774*^9, 3.842968751521912*^9, {
   3.8430379982742977`*^9, 3.8430380243602533`*^9}, {3.8617788643781757`*^9, 
   3.8617788646834097`*^9}, {3.8623023407817287`*^9, 
   3.8623023414599156`*^9}, {3.862490258972452*^9, 3.8624902604750743`*^9}},
 FontSize->16,ExpressionUUID->"89c0d29b-06d8-4d2c-9380-5aae11be5ebc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grainAreaThreshold", "=", "2000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"grainClosingScale", "=", "9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"orientationPeakSharpness", "=", "Automatic"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orientationPeakThreshold", "=", "0.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"colorSpaceWindow", "=", "0.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"colorMatchThreshold", "=", "0.10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalDistanceFactor", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalSpectrumEdgePeakDistance", "=", "5"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8430379659045153`*^9, 3.8430379787287035`*^9}, {
   3.8430393775700502`*^9, 3.843039397210207*^9}, 3.8430394440017314`*^9, {
   3.843043186332448*^9, 3.8430432019968815`*^9}, 3.8430434893639565`*^9, 
   3.843043570444835*^9, {3.8430438371091337`*^9, 3.843043844925166*^9}, {
   3.843043878277847*^9, 3.84304390871693*^9}, 3.843044511005086*^9, 
   3.843045090134148*^9, {3.843046883719232*^9, 3.8430468915355635`*^9}, 
   3.843047048686841*^9, 3.8430490876562343`*^9, {3.8471813654573216`*^9, 
   3.8471813678170123`*^9}, {3.847359324065097*^9, 3.8473593241997375`*^9}, 
   3.84796007199207*^9, {3.8479613020882273`*^9, 3.84796130216822*^9}, 
   3.847961620472312*^9, {3.85464997008367*^9, 3.85464998141966*^9}, {
   3.8546500242512693`*^9, 3.8546500433390293`*^9}, {3.854650165358695*^9, 
   3.8546501782352104`*^9}, {3.8546505990737205`*^9, 3.854650600569477*^9}, {
   3.854650691737215*^9, 3.8546506964337816`*^9}, 3.854650952789182*^9, {
   3.861549754521561*^9, 3.861549754591374*^9}, 3.8615502052423763`*^9, 
   3.861550323425326*^9, {3.861550757416213*^9, 3.861550762590143*^9}, {
   3.861616278445351*^9, 3.8616162785231647`*^9}, 3.8616168315463753`*^9, {
   3.8616880629584017`*^9, 3.8616880745285125`*^9}, {3.861698579054849*^9, 
   3.8616985821553354`*^9}, {3.861699171059448*^9, 3.861699171115141*^9}, {
   3.8617220228816195`*^9, 3.8617220229993005`*^9}, {3.8617220715625067`*^9, 
   3.8617220916662254`*^9}, {3.861722350408763*^9, 3.861722523320348*^9}, 
   3.861722577137945*^9, {3.861723871985181*^9, 3.8617239498817873`*^9}, {
   3.8617240308553753`*^9, 3.8617240457426167`*^9}, {3.8617240904729233`*^9, 
   3.861724143111725*^9}, {3.8617241760147724`*^9, 3.8617242005910425`*^9}, {
   3.8617243374090614`*^9, 3.8617243486400204`*^9}, {3.86172438945687*^9, 
   3.861724390901988*^9}, 3.8617245199131794`*^9, {3.8617746819742217`*^9, 
   3.8617746822555227`*^9}, {3.8617829200813856`*^9, 
   3.8617829234553614`*^9}, {3.861791041049036*^9, 3.861791041194646*^9}, {
   3.861792491916174*^9, 3.8617924933842483`*^9}, {3.861799235028016*^9, 
   3.861799245335448*^9}, {3.8618592881801853`*^9, 3.8618593365903463`*^9}, {
   3.8623022782957845`*^9, 3.862302282662111*^9}, {3.8623023484378996`*^9, 
   3.862302348517688*^9}, {3.8624141221331954`*^9, 3.862414122596351*^9}, {
   3.862414575752426*^9, 3.8624145774934835`*^9}, {3.8624755087858257`*^9, 
   3.8624755269374895`*^9}, {3.86247556918633*^9, 3.862475577601742*^9}, 
   3.8624757125538087`*^9, 3.862475964730377*^9, {3.8624772932581434`*^9, 
   3.8624772941698446`*^9}, {3.862479634234809*^9, 3.862479637729479*^9}, {
   3.8624801982901325`*^9, 3.86248020282895*^9}, {3.862480787610419*^9, 
   3.8624808275955534`*^9}, {3.8624906680208817`*^9, 
   3.8624906682277765`*^9}, {3.862501737393359*^9, 3.862501769069831*^9}, {
   3.8625019688867426`*^9, 3.8625019966632338`*^9}, 3.8625026927675533`*^9, 
   3.862503251007241*^9, 3.8625034243587008`*^9, {3.8625739712501125`*^9, 
   3.8625739722652454`*^9}, 3.8625740485752983`*^9, {3.8625804665160336`*^9, 
   3.862580485354529*^9}, {3.862580798955878*^9, 3.8625808092436953`*^9}, {
   3.862580973396284*^9, 3.862580980818971*^9}, {3.8625817348449936`*^9, 
   3.862581735140416*^9}, {3.8625818210609474`*^9, 3.862581822403031*^9}, {
   3.862583351588833*^9, 3.8625834655472565`*^9}, {3.8625834989560432`*^9, 
   3.862583587567044*^9}, {3.862583626644008*^9, 3.8625836432599497`*^9}, {
   3.862583682653017*^9, 3.862583684202752*^9}, 3.862583757380447*^9, {
   3.8625838004126472`*^9, 3.862583811605009*^9}, 3.8625838634273767`*^9, 
   3.862583900731655*^9, {3.862584028939833*^9, 3.862584062812597*^9}, {
   3.8625841595172796`*^9, 3.8625841851802254`*^9}, {3.8625842227478466`*^9, 
   3.862584234669447*^9}, {3.862584455317687*^9, 3.8625844578111544`*^9}, {
   3.8625844891326513`*^9, 3.8625845595666513`*^9}, 3.8625846168367996`*^9, {
   3.8625846994042506`*^9, 3.8625846998827524`*^9}, {3.8625847542919817`*^9, 
   3.8625848388832006`*^9}, {3.862584925879219*^9, 3.862584928394947*^9}, {
   3.8625849644045362`*^9, 3.8625849648435497`*^9}, {3.862585152325838*^9, 
   3.8625851696759586`*^9}, {3.862585693325427*^9, 3.8625856934991145`*^9}, 
   3.8625862553085365`*^9, 3.8625864983090878`*^9, {3.862590624645338*^9, 
   3.8625906520686245`*^9}, {3.862590937094307*^9, 3.862590937908148*^9}, {
   3.8625918333677616`*^9, 3.8625918499895716`*^9}, {3.862592005534332*^9, 
   3.862592009124428*^9}, {3.862592866879925*^9, 3.8625929095759864`*^9}, 
   3.8625929982617426`*^9, {3.862593160279554*^9, 3.862593194559724*^9}, {
   3.862593276133404*^9, 3.862593276407595*^9}, {3.8625933109580927`*^9, 
   3.8625933336878*^9}, 3.8625934008718452`*^9, {3.862593471354043*^9, 
   3.862593471485691*^9}, 3.8625935500945587`*^9, {3.862593587646866*^9, 
   3.8625935997821684`*^9}, {3.862593971750098*^9, 3.8625939858026247`*^9}, {
   3.8625940662475533`*^9, 3.862594103548669*^9}, {3.862595507942562*^9, 
   3.8625955455281205`*^9}, {3.86259565913448*^9, 3.862595665694249*^9}, {
   3.86259581879105*^9, 3.8625958189346952`*^9}, {3.862595903367323*^9, 
   3.862595903429099*^9}, {3.862597984679371*^9, 3.86259800830181*^9}, {
   3.8625980679671803`*^9, 3.8625980943502026`*^9}, {3.862598124847211*^9, 
   3.8625982507672462`*^9}, {3.862598949040476*^9, 3.8625989667209635`*^9}, 
   3.862599500503309*^9, {3.862599678192071*^9, 3.8625997191102266`*^9}, {
   3.8626602262043285`*^9, 3.8626602293224916`*^9}, 3.862666447157488*^9, 
   3.8626667293090534`*^9, 3.862666770325431*^9, {3.8626668411161823`*^9, 
   3.862666841356539*^9}, 3.862669905508376*^9, {3.862670259764703*^9, 
   3.8626702977245865`*^9}, {3.8626703288531065`*^9, 3.862670355427702*^9}, 
   3.8626706537416153`*^9, 3.862670862613515*^9, {3.862671184756561*^9, 
   3.8626711875568137`*^9}, 3.8626722298367796`*^9, 3.8626722689247084`*^9, 
   3.8626723390366325`*^9, {3.8626726572046504`*^9, 3.8626726689514885`*^9}, {
   3.862674762637824*^9, 3.8626748573253803`*^9}, {3.8627503622372847`*^9, 
   3.8627504616273017`*^9}, {3.8627542963898306`*^9, 
   3.8627543611497602`*^9}, {3.8627751871224923`*^9, 3.862775202449685*^9}},
 CellLabel->
  "In[4491]:=",ExpressionUUID->"75036ac2-7dfe-4fdb-923c-18533693271a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"previewID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dendriteGrainMasks", "=", 
   RowBox[{"getDendriteGrainMasksAlternative", "[", "\[IndentingNewLine]", 
    RowBox[{"cleanAssembledSkeleton", ",", 
     RowBox[{"smoothedOrientationBins", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "All"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8427114500928984`*^9, {3.8427116941514835`*^9, 3.842711697646892*^9}, {
   3.842711739525206*^9, 3.8427117435565743`*^9}, {3.8427121193185196`*^9, 
   3.8427121358929524`*^9}, {3.842712174749054*^9, 3.8427121824526143`*^9}, {
   3.8427122846288457`*^9, 3.8427123002441683`*^9}, {3.8427123854457555`*^9, 
   3.842712414364266*^9}, {3.8427824778289514`*^9, 3.842782488092513*^9}, {
   3.8427932784677763`*^9, 3.84279328781523*^9}, {3.8428539823246417`*^9, 
   3.842853983915387*^9}, {3.8429382255807495`*^9, 3.842938309646119*^9}, {
   3.84293843686946*^9, 3.8429384401321807`*^9}, {3.8429386171732116`*^9, 
   3.8429386172440233`*^9}, {3.842938978061347*^9, 3.8429389818440585`*^9}, {
   3.8429555856836333`*^9, 3.8429555900672426`*^9}, {3.8429579457004304`*^9, 
   3.8429579544197245`*^9}, {3.8429672148404765`*^9, 3.842967220294633*^9}, {
   3.8429687604412956`*^9, 3.842968761727437*^9}, 3.842969241744796*^9, {
   3.8430127244401608`*^9, 3.843012724566822*^9}, {3.843012794510826*^9, 
   3.8430127947511835`*^9}, {3.843012860792135*^9, 3.843012861575042*^9}, 
   3.843012966567396*^9, {3.843013649528324*^9, 3.8430136568146753`*^9}, 
   3.843014829465399*^9, 3.843034260686932*^9, {3.843037492209197*^9, 
   3.8430375011774225`*^9}, {3.843037548417096*^9, 3.8430375505044656`*^9}, {
   3.8430375951286907`*^9, 3.843037608328765*^9}, 3.8430376715928297`*^9, {
   3.8430377208258696`*^9, 3.843037754121023*^9}, {3.8430379203854966`*^9, 
   3.8430379912320285`*^9}, {3.8430444939360027`*^9, 
   3.8430445180944633`*^9}, {3.8430460066938334`*^9, 3.843046038038988*^9}, {
   3.8430468221112947`*^9, 3.8430468287991753`*^9}, 3.843046870670882*^9, 
   3.843048143745442*^9, 3.843272531077879*^9, {3.8466692303272915`*^9, 
   3.8466692513260107`*^9}, {3.846669482559126*^9, 3.846669491861667*^9}, {
   3.846669553943783*^9, 3.846669567297112*^9}, {3.8466809318600636`*^9, 
   3.846680959827173*^9}, {3.846686470970048*^9, 3.846686479730262*^9}, {
   3.8468226121358805`*^9, 3.846822643534849*^9}, {3.8468480499501348`*^9, 
   3.8468480551330895`*^9}, {3.8473663652190857`*^9, 
   3.8473663704816494`*^9}, {3.8479598071293974`*^9, 
   3.8479598204566507`*^9}, {3.847960090481156*^9, 3.847960096352723*^9}, {
   3.854649825499436*^9, 3.8546498451243076`*^9}, {3.8546501401792974`*^9, 
   3.8546501559904566`*^9}, {3.8546501939387245`*^9, 3.854650204297749*^9}, {
   3.8546506096351104`*^9, 3.8546506178900375`*^9}, 3.8546506999624224`*^9, {
   3.861549716012151*^9, 3.86154972859251*^9}, {3.8615996916582255`*^9, 
   3.861599696578123*^9}, {3.861599769513962*^9, 3.8615997757791457`*^9}, {
   3.8616115764100494`*^9, 3.8616115780157256`*^9}, {3.8616135032786393`*^9, 
   3.861613520372458*^9}, {3.8616881036934524`*^9, 3.8616881132868032`*^9}, {
   3.8617220390893087`*^9, 3.861722044325252*^9}, 3.8617221345775075`*^9, {
   3.8617223304671774`*^9, 3.8617223354956493`*^9}, {3.8617223876731553`*^9, 
   3.8617224181636257`*^9}, 3.8617225622268257`*^9, {3.8617226022348213`*^9, 
   3.8617226182898817`*^9}, {3.8617226600811586`*^9, 
   3.8617226640336037`*^9}, {3.8617239296179852`*^9, 3.861723940001266*^9}, 
   3.861723979177487*^9, {3.86172405981592*^9, 3.861724077296115*^9}, 
   3.8617241117686043`*^9, {3.861724149552496*^9, 3.861724162073042*^9}, {
   3.861724218472165*^9, 3.8617243307269306`*^9}, {3.8617243612153873`*^9, 
   3.8617244356303587`*^9}, {3.8617710318584557`*^9, 3.861771035410901*^9}, {
   3.8617712756031322`*^9, 3.8617712816030335`*^9}, {3.861774694054911*^9, 
   3.861774721550577*^9}, {3.861787210213775*^9, 3.86178723266445*^9}, {
   3.8617901403349257`*^9, 3.8617901422777853`*^9}, 3.8617908313699436`*^9, {
   3.8617914305237646`*^9, 3.8617914577688956`*^9}, 3.8618593020401163`*^9, 
   3.861899136551649*^9, {3.8618992323752985`*^9, 3.8618992592558217`*^9}, {
   3.862302353847167*^9, 3.862302359847125*^9}, {3.8624065976926193`*^9, 
   3.8624066063809156`*^9}, {3.862407313773241*^9, 3.8624073175663834`*^9}, 
   3.8624075638050537`*^9, {3.8624075993003116`*^9, 3.862407641261371*^9}, 
   3.8624145844961166`*^9, {3.862466311404168*^9, 3.862466322457304*^9}, 
   3.8624755000661616`*^9, 3.8624755453145566`*^9, 3.8624759633909082`*^9, {
   3.86247723183488*^9, 3.8624772362905455`*^9}, {3.8624773012272863`*^9, 
   3.8624773076828213`*^9}, 3.8624781624528656`*^9, 3.8624795422581816`*^9, {
   3.8624795872669754`*^9, 3.862479603399376*^9}, {3.862480330798314*^9, 
   3.8624803486136675`*^9}, 3.8624807953403544`*^9, {3.8624808685558434`*^9, 
   3.8624808705162144`*^9}, {3.8624914240362487`*^9, 3.862491435526496*^9}, {
   3.862492598790865*^9, 3.862492603933647*^9}, {3.862501699895499*^9, 
   3.8625017138005857`*^9}, {3.8625017780176*^9, 3.8625017829869947`*^9}, {
   3.862502712176266*^9, 3.8625027203943644`*^9}, {3.8625038979918084`*^9, 
   3.8625039422980976`*^9}, 3.8625739620125227`*^9, {3.862574013549176*^9, 
   3.8625740354194736`*^9}, 3.862574070907201*^9, {3.8625741791234636`*^9, 
   3.862574186476079*^9}, 3.862574216890952*^9, {3.8625742487315874`*^9, 
   3.862574262186445*^9}, 3.8625804727345495`*^9, 3.8625807918763237`*^9, 
   3.8625833597495995`*^9, 3.862583411109694*^9, {3.86258348369388*^9, 
   3.8625835163098516`*^9}, {3.8625836506368785`*^9, 
   3.8625836760690975`*^9}, {3.8625837731972504`*^9, 3.86258378294064*^9}, {
   3.8625838796135635`*^9, 3.8625839196700897`*^9}, {3.86258404214112*^9, 
   3.8625840474860964`*^9}, {3.862584078988702*^9, 3.8625840839020576`*^9}, {
   3.862584192269163*^9, 3.862584212069101*^9}, {3.8625842506370263`*^9, 
   3.862584263109149*^9}, {3.8625844593409014`*^9, 3.8625845076444187`*^9}, {
   3.862584542079323*^9, 3.86258455010148*^9}, 3.862584585845838*^9, 
   3.8625846285741196`*^9, 3.8625847073331904`*^9, {3.862584769814223*^9, 
   3.8625847880532055`*^9}, 3.8625848484203944`*^9, {3.86258494192474*^9, 
   3.86258497654112*^9}, 3.8625857051099205`*^9, {3.862590631007045*^9, 
   3.8625906638784423`*^9}, 3.862590952862932*^9, {3.862591840174245*^9, 
   3.8625918599803925`*^9}, {3.8625940881185217`*^9, 3.862594122166481*^9}, {
   3.8625954807444263`*^9, 3.8625955282552304`*^9}, {3.8625956446802516`*^9, 
   3.862595681121976*^9}, 3.8625959176091204`*^9, {3.862597943407234*^9, 
   3.8625979723272295`*^9}, 3.8625980510487585`*^9, {3.862598700519326*^9, 
   3.8625987063192167`*^9}, {3.862599688201723*^9, 3.862599692879595*^9}, {
   3.862627825117384*^9, 3.8626278295914655`*^9}, {3.862629447110573*^9, 
   3.8626294562178526`*^9}, 3.8626654649250383`*^9, {3.862666454396465*^9, 
   3.862666474557831*^9}, {3.8626666861001043`*^9, 3.8626666945960846`*^9}, 
   3.862669912053915*^9, 3.862670230269178*^9, 3.862670840668599*^9, {
   3.8626708943262353`*^9, 3.86267090101364*^9}, {3.8626711934380217`*^9, 
   3.862671193508466*^9}, 3.862671281943398*^9, 3.8627503284292307`*^9, {
   3.862750397950448*^9, 3.8627504199189177`*^9}, {3.862754260068441*^9, 
   3.8627543245015993`*^9}, {3.862774642643258*^9, 3.8627746506667976`*^9}, 
   3.8627751546029525`*^9, 3.8627752075307236`*^9},
 CellLabel->
  "In[4499]:=",ExpressionUUID->"c240b065-2ebd-40fc-a933-e7246aef6606"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.862775567519143*^9},ExpressionUUID->"56f33684-343c-40ad-9531-\
b33c5a4cfd67"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Secondary Scan - Orientation-based Decomposition of Primary Grains\
\>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 
   3.8429647821656127`*^9}},ExpressionUUID->"ef664de0-b10c-4b96-8dbb-\
735db0292cda"],

Cell[BoxData[{
 RowBox[{"dendriteGrainMasksSeparated", "=", 
  RowBox[{"Flatten", "@", "dendriteGrainMasks"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isolatedGrains", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageMultiply", "[", 
      RowBox[{"cleanAssembledSkeleton", ",", "#"}], "]"}], "&"}], "/@", 
    "dendriteGrainMasksSeparated"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8427923853841133`*^9, 3.842792385680258*^9}, {
   3.842860769948488*^9, 3.8428607704361877`*^9}, {3.8428608448281803`*^9, 
   3.8428608584911537`*^9}, 3.842860937597397*^9, 3.846681711179249*^9, 
   3.8467719931367064`*^9, 3.8468485124462123`*^9, {3.846848721998787*^9, 
   3.8468487250139866`*^9}, {3.8626699324427996`*^9, 3.862669933773444*^9}, {
   3.8626747960753965`*^9, 3.8626747979993887`*^9}},
 CellLabel->
  "In[4501]:=",ExpressionUUID->"88b20394-0e67-4d39-bd11-004e11c1ebeb"],

Cell["\<\
Defaults:

binRegularization=0.15;
binAveragingRadius=2;
baseBinCount=200;
binCountFactor=1.5;
minimumBinCount=3;

orientationPeakThreshold=0.2;
colorSpaceWindow=0.05;
colorMatchThreshold=0.75;
criticalDistanceFactor=2;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.838272735787283*^9}, 3.8427780840516863`*^9, {3.8427831025081825`*^9, 
   3.8427831031335106`*^9}, {3.84296883802522*^9, 3.8429688392393017`*^9}, 
   3.843038038025073*^9, {3.8430415078746862`*^9, 3.8430415083065314`*^9}, 
   3.846683741586751*^9, 3.846769883826186*^9, {3.854649860954402*^9, 
   3.854649861714005*^9}, {3.862596048887193*^9, 3.8625960587813654`*^9}},
 FontSize->16,ExpressionUUID->"b6e36da3-81ca-441d-9b3c-79f534e70dc5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binRegularization", "=", "0.05"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"binAveragingRadius", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"baseBinCount", "=", "200"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"binCountFactor", "=", "1.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"minimumBinCount", "=", "10"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orientationPeakThreshold", "=", "0.2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"colorSpaceWindow", "=", "0.02"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"colorMatchThreshold", "=", "0.75"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"criticalDistanceFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalSpectrumEdgePeakDistance", "=", "10"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8427117596446023`*^9, 3.84271178037313*^9}, 
   3.842711945682965*^9, {3.842711976165303*^9, 3.8427119908532877`*^9}, {
   3.842712435062055*^9, 3.8427124384438434`*^9}, {3.8427125556364703`*^9, 
   3.842712555708288*^9}, 3.842712732268762*^9, {3.8427127985417013`*^9, 
   3.8427128043085585`*^9}, {3.8427128392365904`*^9, 3.842712858892226*^9}, {
   3.842712933989518*^9, 3.842712975964342*^9}, {3.842777926291606*^9, 
   3.8427779493238535`*^9}, {3.842782521876975*^9, 3.8427825219328256`*^9}, {
   3.8427827652937264`*^9, 3.8427828843264923`*^9}, {3.8427829478127613`*^9, 
   3.8427830173009844`*^9}, {3.842783053701667*^9, 3.8427830570078278`*^9}, {
   3.8427844892800307`*^9, 3.8427844980132365`*^9}, {3.842784553655472*^9, 
   3.8427845919817038`*^9}, {3.84278465576212*^9, 3.8427846711905518`*^9}, {
   3.84278509224755*^9, 3.842785111872491*^9}, {3.842785931470951*^9, 
   3.8427859407260246`*^9}, {3.8427933080574455`*^9, 3.84279336045564*^9}, {
   3.8428540008032365`*^9, 3.8428540029315467`*^9}, {3.842867496902975*^9, 
   3.8428674988134537`*^9}, {3.842867561439698*^9, 3.8428675930056534`*^9}, {
   3.842867682000082*^9, 3.842867715687256*^9}, {3.84286778445577*^9, 
   3.8428677904617395`*^9}, {3.8428678264154673`*^9, 3.842867854046875*^9}, {
   3.8428679494319963`*^9, 3.8428679558941507`*^9}, {3.8429648768804026`*^9, 
   3.8429648884544067`*^9}, {3.842968803441806*^9, 3.842968843175926*^9}, 
   3.8429692472579474`*^9, {3.843012735065754*^9, 3.843012735311097*^9}, {
   3.8430128087283583`*^9, 3.8430128090065794`*^9}, {3.8430128682572284`*^9, 
   3.843012868927437*^9}, 3.8430129745859594`*^9, {3.8430137131762514`*^9, 
   3.8430137141029253`*^9}, {3.8430339808483205`*^9, 3.843033980902177*^9}, 
   3.8430342337208214`*^9, {3.843034298776867*^9, 3.843034298821748*^9}, {
   3.8430375659067755`*^9, 3.8430375670878887`*^9}, 3.8430376154109063`*^9, 
   3.8430376793462353`*^9, 3.843037762265281*^9, {3.8430378571142645`*^9, 
   3.8430378681860137`*^9}, {3.8430379102739153`*^9, 
   3.8430379614327574`*^9}, {3.8430414646691794`*^9, 3.8430414651788163`*^9}, 
   3.84668172072388*^9, {3.8466836618269415`*^9, 3.846683718122294*^9}, {
   3.8466838396107454`*^9, 3.846683842113866*^9}, 3.8467698674569597`*^9, {
   3.8479601682809973`*^9, 3.8479601763680177`*^9}, {3.847960516959591*^9, 
   3.8479605249294577`*^9}, {3.861613803551459*^9, 3.861613805260884*^9}, {
   3.861615462563573*^9, 3.86161546323283*^9}, 3.8616164037087507`*^9, 
   3.8616164963740315`*^9, 3.8624772728821497`*^9, {3.8624802469783435`*^9, 
   3.8624802661618776`*^9}, {3.862501913206358*^9, 3.862501950926544*^9}, {
   3.862501987440422*^9, 3.8625020073515077`*^9}, {3.862502732383621*^9, 
   3.862502741607812*^9}, {3.8625034043192844`*^9, 3.862503406280691*^9}, {
   3.862503478942895*^9, 3.8625034792138033`*^9}, {3.862580424468688*^9, 
   3.8625804246578608`*^9}, {3.8625805911794133`*^9, 
   3.8625805998186884`*^9}, {3.8625806908850603`*^9, 3.862580695202835*^9}, {
   3.862580840299486*^9, 3.862580843634488*^9}, {3.862581027867977*^9, 
   3.862581028546212*^9}, 3.86258179837946*^9, {3.8625832970462365`*^9, 
   3.862583297282899*^9}, {3.862583330964302*^9, 3.8625833328998437`*^9}, {
   3.8625843701483088`*^9, 3.8625843718036723`*^9}, {3.862584644990547*^9, 
   3.862584647187395*^9}, 3.86258561314036*^9, 3.8625864279009514`*^9, 
   3.8625906732686663`*^9, {3.8625910101990767`*^9, 3.862591015261154*^9}, {
   3.8625911001258674`*^9, 3.8625911005796075`*^9}, {3.8625911335777845`*^9, 
   3.862591136246714*^9}, {3.8625913159503293`*^9, 3.862591317116559*^9}, {
   3.8625913886451063`*^9, 3.8625913887318387`*^9}, {3.8625914371172943`*^9, 
   3.8625914389000125`*^9}, {3.8625916003501725`*^9, 3.86259162077308*^9}, {
   3.8625916786305327`*^9, 3.86259168375924*^9}, {3.86259175395855*^9, 
   3.862591757053773*^9}, {3.8625918029750566`*^9, 3.862591803140645*^9}, {
   3.86259187638151*^9, 3.8625918870203543`*^9}, 3.8625921192941694`*^9, 
   3.8625922398782854`*^9, {3.8625926927036734`*^9, 3.862592692861297*^9}, 
   3.86259354572653*^9, {3.862593677821842*^9, 3.8625936810003824`*^9}, {
   3.8625937419427605`*^9, 3.8625937762872243`*^9}, 3.862593830112071*^9, {
   3.862593889406766*^9, 3.8625939143329363`*^9}, {3.8625939464144783`*^9, 
   3.862593946598362*^9}, {3.8625942308625345`*^9, 3.8625942586942883`*^9}, {
   3.8625943985255575`*^9, 3.862594410999548*^9}, {3.8625960037190514`*^9, 
   3.8625960327263217`*^9}, {3.8625977642972155`*^9, 
   3.8625977648217764`*^9}, {3.862599623454466*^9, 3.862599623698284*^9}, 
   3.8626279259006176`*^9, {3.862669946718972*^9, 3.862669948628422*^9}, {
   3.862670659969675*^9, 3.862670689692384*^9}, 3.8626707462705355`*^9, {
   3.862672197333604*^9, 3.8626722225923505`*^9}, {3.8626722885089025`*^9, 
   3.862672294866371*^9}, {3.862672638454784*^9, 3.862672641004451*^9}, {
   3.862672687564681*^9, 3.862672706284721*^9}},
 CellLabel->
  "In[4503]:=",ExpressionUUID->"3821deab-a10d-4060-94cb-e6b6a2872d69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grainAreaScaleFactors", "=", 
    RowBox[{
     RowBox[{"Total", "/@", 
      RowBox[{"FillingTransform", "/@", "dendriteGrainMasksSeparated"}]}], 
     "/", 
     RowBox[{"Total", "@", "realMask"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"adaptivePeakBinCountGrains", "=", 
   RowBox[{"getGrainBinCounts", "[", 
    RowBox[{
    "baseBinCount", ",", "minimumBinCount", ",", "binCountFactor", ",", 
     "grainAreaScaleFactors"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grainOrientationBins", "=", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getOrientationBinsWithWeights", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"isolatedGrains", ",", "adaptivePeakBinCountGrains"}], "}"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"grainSmoothedOrientationBins", "=", 
    RowBox[{"getSmoothOrientationBins", "/@", "grainOrientationBins"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", "decomposePrimaryGrains"}], "Input",
 CellChangeTimes->{{3.846684565187305*^9, 3.8466845843134236`*^9}, 
   3.8466855094352455`*^9, {3.8467698658263206`*^9, 3.8467699011358976`*^9}, {
   3.8468483830722537`*^9, 3.8468483847416153`*^9}, {3.8468485018080854`*^9, 
   3.846848592605859*^9}, {3.8468486456881695`*^9, 3.846848683558889*^9}, {
   3.8468487622992134`*^9, 3.846848836423732*^9}, {3.8468499115273113`*^9, 
   3.846849921806555*^9}, 3.847958492978182*^9, {3.847959980928864*^9, 
   3.8479599814489183`*^9}, {3.847960184273985*^9, 3.8479602143521748`*^9}, {
   3.847960453849227*^9, 3.847960588559844*^9}, 3.847961599265604*^9, {
   3.8480379515260997`*^9, 3.8480379530529795`*^9}, {3.862593039203873*^9, 
   3.8625930584635277`*^9}},
 CellLabel->
  "In[4513]:=",ExpressionUUID->"c7cdd761-0c25-4791-adb1-66a388c7f93d"],

Cell[TextData[{
 StyleBox["! ACHTUNG!", "Subtitle"],
 "\n\nIf no significant grains were detected, please run the cell below \nand \
afterwards proceed directly to\n\n* Liquid Region Analysis * (feel free to \
use Ctrl+F to jump)\n\nwithout evaluating any of  the other  cells below \
until then"
}], "Abstract",
 InitializationCell->True,
 CellChangeTimes->{{3.8374411840457907`*^9, 3.8374411921082387`*^9}, {
  3.8375060918433895`*^9, 3.8375061194775267`*^9}, {3.83750615485393*^9, 
  3.837506163173687*^9}, {3.8376970177353745`*^9, 3.837697056119751*^9}, {
  3.8382101989016657`*^9, 3.838210203181193*^9}, {3.838488803995907*^9, 
  3.8384888056954594`*^9}, {3.8386352516599693`*^9, 3.838635252401264*^9}, {
  3.8434803759359717`*^9, 3.8434803781120744`*^9}, {3.846764556057539*^9, 
  3.8467646154257812`*^9}, {3.8615961363339005`*^9, 3.8615961505468893`*^9}, {
  3.8615961859232635`*^9, 3.861596208930667*^9}, {3.86161228612644*^9, 
  3.8616123032136707`*^9}},
 FontSize->16,ExpressionUUID->"9b37f76a-fc3d-4033-b8da-ddb768a1ba6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect Separated Second Pass Grains", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8429648396778593`*^9, 3.842964843365999*^9}, {3.8468494930934105`*^9, 
   3.846849498613385*^9}},ExpressionUUID->"41423101-e252-4f12-8ae4-\
0341ac92a5c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"secondPassGrainMasks", "=", 
   RowBox[{"getSecondPassGrainMasks", "[", "\[IndentingNewLine]", 
    RowBox[{
    "dendriteGrainMasksSeparated", ",", "mainDendriteGrainMasksSeparated", 
     ",", "grainDifferences"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Range", "@", 
  RowBox[{"Length", "@", "secondPassGrainMasks"}]}]}], "Input",
 CellChangeTimes->{{3.8427846765689864`*^9, 3.8427847492286415`*^9}, {
   3.8427858404475255`*^9, 3.8427858726448603`*^9}, {3.8427866082230997`*^9, 
   3.8427866870379243`*^9}, {3.8427924299915457`*^9, 3.842792430383929*^9}, {
   3.8427937372011037`*^9, 3.842793769417204*^9}, {3.8428610012212*^9, 
   3.842861056603344*^9}, {3.8428612063647156`*^9, 3.8428612142675533`*^9}, {
   3.8429390058524165`*^9, 3.842939076741729*^9}, {3.8429641338710227`*^9, 
   3.842964178544679*^9}, {3.84296440415903*^9, 3.842964466439604*^9}, {
   3.8430386444915743`*^9, 3.843038666217579*^9}, {3.843038751307167*^9, 
   3.8430387569607143`*^9}, {3.843038910986377*^9, 3.8430389112247405`*^9}, {
   3.8466829667785053`*^9, 3.8466829829547524`*^9}, 3.8466857024486094`*^9, {
   3.846685738642299*^9, 3.8466857419532337`*^9}, 3.8466868379697866`*^9, {
   3.846750946086244*^9, 3.8467509472461414`*^9}, 3.8468488084476814`*^9, 
   3.8468488385348644`*^9, {3.8468490799355946`*^9, 3.8468491031013374`*^9}, 
   3.8468497163333716`*^9, 3.8616133153338284`*^9, 3.8616970849016542`*^9, 
   3.861697229375287*^9, {3.8625848749660854`*^9, 3.862584877875479*^9}, {
   3.8626725682454615`*^9, 3.862672585833591*^9}},
 CellLabel->
  "In[4518]:=",ExpressionUUID->"2be8557e-b6d5-48c9-bbd9-114cc443a4b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
!! ACHTUNG !! In Case of Hard-to-Correct Artifact Grains ==> Manual Selection\
\>", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8429648396778593`*^9, 3.842964843365999*^9}, {3.8468494930934105`*^9, 
   3.846849498613385*^9}, {3.862412817588278*^9, 3.862412842476026*^9}, {
   3.8624132902129393`*^9, 3.862413320491536*^9}},
 FontSize->24,ExpressionUUID->"da74216c-e5d9-4e72-812d-95a96808464c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"secondPassGrainMasks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"secondPassGrainMasks", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8624127586166143`*^9, 3.862412799620986*^9}, {
   3.8624128477034492`*^9, 3.8624128614362965`*^9}, 3.8624132683664837`*^9, {
   3.8625033351991234`*^9, 3.862503359397931*^9}, 3.8625034933425007`*^9, {
   3.8625040256714134`*^9, 3.862504033221746*^9}, {3.862671425053459*^9, 
   3.8626714487486954`*^9}, {3.8626715338146734`*^9, 3.862671534388013*^9}, {
   3.862672595898754*^9, 3.86267259999705*^9}, {3.862672739318932*^9, 
   3.862672741820346*^9}, 3.862750488911927*^9, {3.8627506408211718`*^9, 
   3.8627506457566333`*^9}, {3.8627738785048285`*^9, 
   3.8627738804163113`*^9}, {3.8627747035128627`*^9, 3.8627747377453423`*^9}, 
   3.862775244698225*^9},
 CellLabel->
  "In[4217]:=",ExpressionUUID->"9388906c-35ed-4612-855e-8b6472621a42"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resolve Ambiguities & Overlap Zones", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8467647148582478`*^9, 3.8467647267297754`*^9}, 
   3.846849501285425*^9},ExpressionUUID->"9b13fd71-fa42-45df-98d2-\
e18bd5561a99"],

Cell["\<\
Defaults:

criticalOverlapFactor=0.05;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.838272735787283*^9}, 3.8427780840516863`*^9, {3.8427831025081825`*^9, 
   3.8427831031335106`*^9}, {3.84296883802522*^9, 3.8429688392393017`*^9}, 
   3.843038038025073*^9, {3.8430415078746862`*^9, 3.8430415083065314`*^9}, 
   3.846683741586751*^9, 3.846769883826186*^9, 3.846849791366685*^9},
 FontSize->16,ExpressionUUID->"22e8a15c-66d6-44a1-ba0d-cb9ad8e420d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"criticalOverlapFactor", "=", "0.05"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8468493251498637`*^9, 3.846849327782095*^9}, {
   3.846849430116513*^9, 3.8468494603251257`*^9}, {3.846849505493351*^9, 
   3.846849600101283*^9}, {3.8468497239095087`*^9, 3.846849729487423*^9}, 
   3.8468497925649786`*^9, {3.861613323870945*^9, 3.861613324380582*^9}, {
   3.8616136663361945`*^9, 3.8616137248816977`*^9}, {3.862480111892222*^9, 
   3.8624801696696815`*^9}},
 CellLabel->
  "In[4218]:=",ExpressionUUID->"5a9d4c3c-7ddd-4c31-ae91-5f9e740a0f8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uniqueGrains", "=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "secondPassGrainMasks"}], "<", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "@", "\"\<Only 1 significant grain exists\>\""}], ";",
        "\[IndentingNewLine]", "secondPassGrainMasks"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"getUniqueGrains", "@", "secondPassGrainMasks"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overlapMask", "=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "secondPassGrainMasks"}], "<", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Binarize", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
       RowBox[{"First", "@", "uniqueGrains"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ImageMultiply", "@@", "#"}], "&"}], "/@", 
          RowBox[{"Subsets", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "@", "uniqueGrains"}], 
       "//", "ImageAdd"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Image", "[", 
    RowBox[{"#", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "@", 
  "overlapMask"}]}], "Input",
 CellChangeTimes->{{3.846741280724289*^9, 3.846741298964513*^9}, {
   3.84674225547369*^9, 3.8467423099366665`*^9}, {3.846743151738332*^9, 
   3.8467431553703885`*^9}, {3.8467699358251343`*^9, 
   3.8467699402881994`*^9}, {3.846849262982551*^9, 3.8468492958470387`*^9}, {
   3.846849648061572*^9, 3.8468496799660487`*^9}, {3.8468500383893414`*^9, 
   3.8468500662864895`*^9}, {3.86154386906896*^9, 3.861543933397663*^9}, {
   3.8615439738376427`*^9, 3.861543980084201*^9}, {3.862491042333104*^9, 
   3.8624911189640746`*^9}, {3.8624911563489523`*^9, 3.8624911698933954`*^9}, 
   3.862491248455209*^9, {3.862491292310104*^9, 3.862491389374181*^9}},
 CellLabel->
  "In[4219]:=",ExpressionUUID->"2c09721b-ca09-4e54-acfc-3e3b01848eac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Get Final Grain Masks", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8467647148582478`*^9, 3.8467647267297754`*^9}, 3.846849501285425*^9, {
   3.846850293684201*^9, 
   3.84685030503728*^9}},ExpressionUUID->"6dadc548-0b3b-45f3-bb83-\
3add3cc22aed"],

Cell["\<\
Defaults:

grainAreaThresholdSecondary=grainAreaThreshold/5//Round;
dendriteLengthThreshold=2;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.838272735787283*^9}, 3.8427780840516863`*^9, {3.8427831025081825`*^9, 
   3.8427831031335106`*^9}, {3.84296883802522*^9, 3.8429688392393017`*^9}, 
   3.843038038025073*^9, {3.8430415078746862`*^9, 3.8430415083065314`*^9}, 
   3.846683741586751*^9, 3.846769883826186*^9, 3.846849791366685*^9, 
   3.8468501528388968`*^9, {3.8468501963320365`*^9, 3.846850196614544*^9}},
 FontSize->16,ExpressionUUID->"33231405-2cf8-4080-8e78-26a382daef95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grainAreaThresholdSecondary", "=", 
   RowBox[{
    RowBox[{"grainAreaThreshold", "/", "5"}], "//", "Round"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dendriteLengthThreshold", "=", "2"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.846850124487376*^9, 3.846850134709779*^9}, {
  3.8468501948692093`*^9, 3.846850195238288*^9}, {3.8625921772375937`*^9, 
  3.862592217374629*^9}, {3.862774793577148*^9, 3.862774811801133*^9}},
 CellLabel->
  "In[4222]:=",ExpressionUUID->"964ab37c-d4a6-4ada-9441-198de9d251fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"finalGrainMasks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DeleteSmallComponents", "[", 
        RowBox[{"#", ",", "grainAreaThresholdSecondary"}], "]"}], "&"}], "/@",
       "\[IndentingNewLine]", 
      RowBox[{"Select", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "@", "#"}], ">", "grainAreaThreshold"}], "&"}]}], 
       "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageMultiply", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ColorNegate", "@", "overlapMask"}]}], "]"}], "&"}], "/@", 
      "uniqueGrains"}], "\[IndentingNewLine]", ")"}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"finalDendriteGrainMasks", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"DeleteSmallComponents", "[", 
     RowBox[{"#", ",", "dendriteLengthThreshold"}], "]"}], "&"}], "/@", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"#", ",", "cleanAssembledSkeleton"}], "]"}], "&"}], "/@", 
     "finalGrainMasks"}], "\[IndentingNewLine]", ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.8466868680761065`*^9, 3.846686959306797*^9}, {
   3.846751403127307*^9, 3.8467514059523816`*^9}, {3.8467521002309103`*^9, 
   3.846752117149835*^9}, {3.846752577974697*^9, 3.8467525986776247`*^9}, {
   3.8467526472301855`*^9, 3.8467526506935153`*^9}, {3.846755476685587*^9, 
   3.846755486825226*^9}, {3.846755518477063*^9, 3.8467556403968673`*^9}, {
   3.84685015839136*^9, 3.846850161333034*^9}, 3.8468502665899997`*^9, {
   3.8627748131554813`*^9, 3.8627748140408154`*^9}, {3.8627748551950045`*^9, 
   3.8627748763694315`*^9}},
 CellLabel->
  "In[4224]:=",ExpressionUUID->"4723fcf6-78eb-457f-8bc8-4996f1547cae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Secondary Scan - Remove Outlying Dendrites (N-sigma)", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8467647148582478`*^9, 3.8467647267297754`*^9}, {3.8467647569541073`*^9, 
   3.8467647811141543`*^9}},ExpressionUUID->"475ae74a-2551-4742-b473-\
6e2302de7250"],

Cell["\<\
Defaults:

deviationThreshold=20;
deviationToMeanRatioThreshold=2;
deviationScale=5;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.838272735787283*^9}, 3.8427780840516863`*^9, {3.8427831025081825`*^9, 
   3.8427831031335106`*^9}, {3.84296883802522*^9, 3.8429688392393017`*^9}, 
   3.843038038025073*^9, {3.8430415078746862`*^9, 3.8430415083065314`*^9}, 
   3.846683741586751*^9, 3.846769883826186*^9, 3.846849791366685*^9, 
   3.8468501528388968`*^9, {3.8468501963320365`*^9, 3.846850196614544*^9}, 
   3.8468503270141735`*^9, 3.861767546860345*^9},
 FontSize->16,ExpressionUUID->"59987e1e-dad6-4093-9d5b-fbb360ff1ad9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deviationThreshold", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deviationToMeanRatioThreshold", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deviationScale", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.846760262198159*^9, 3.8467602841330824`*^9}, {
   3.8467603227469873`*^9, 3.846760337203506*^9}, 3.846760465771899*^9, 
   3.846760918060046*^9, {3.8467618881154027`*^9, 3.846761895378641*^9}, {
   3.8467619607417393`*^9, 3.846761961058891*^9}, {3.846850373286151*^9, 
   3.846850375149208*^9}, 3.861733017122255*^9, {3.8617708363935647`*^9, 
   3.861770836498211*^9}, {3.8617709107896605`*^9, 3.8617709132890673`*^9}, {
   3.861776534550433*^9, 3.86177653579012*^9}, {3.8617798501945143`*^9, 
   3.861779850512939*^9}, 3.861781125623342*^9, {3.861781282195197*^9, 
   3.8617813169524555`*^9}, {3.8617813777863145`*^9, 
   3.8617813899783845`*^9}, {3.861781714298273*^9, 3.8617817264642735`*^9}, 
   3.861782942897415*^9, {3.861859543806405*^9, 3.861859590580058*^9}, {
   3.861899466277079*^9, 3.8618994854844575`*^9}, 3.8623024166623487`*^9, {
   3.8623733162549534`*^9, 3.8623733808540945`*^9}, 3.862373427630545*^9, 
   3.862374983710288*^9, 3.8624146182709355`*^9, 3.8624695720026054`*^9, 
   3.8624696045855618`*^9, {3.8625021401129804`*^9, 3.862502141933319*^9}, 
   3.8625022005027037`*^9, 3.862502233800383*^9, 3.862502266344417*^9, {
   3.862502297487295*^9, 3.8625023174455276`*^9}, 3.862502805552353*^9, 
   3.862503550423905*^9, {3.862581493515684*^9, 3.8625815160288544`*^9}, {
   3.86258546641296*^9, 3.8625854719239273`*^9}, {3.8625855045854874`*^9, 
   3.8625855311320715`*^9}, {3.8625931048776436`*^9, 3.862593110586034*^9}, {
   3.8625943138475337`*^9, 3.862594335486988*^9}, 3.862594970167504*^9, 
   3.8625950004226875`*^9, 3.862670986853747*^9, 3.862671041790351*^9, {
   3.8626750074939556`*^9, 3.8626750090123234`*^9}, {3.8626750470857615`*^9, 
   3.862675069164977*^9}, 3.8626751065256815`*^9, 3.8627569175656214`*^9, {
   3.8627735931065807`*^9, 3.8627735933592653`*^9}, 3.8627736250080853`*^9, 
   3.8627736689767237`*^9, {3.862773751281142*^9, 3.8627737533117056`*^9}},
 CellLabel->
  "In[4226]:=",ExpressionUUID->"06a80169-bd3e-47a5-950e-c04de0eabde8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"finalFilteredDendriteGrains", "=", 
    RowBox[{"resolveNearVerticalDendriteGrains", "@", 
     RowBox[{
     "getFilteredDendriteGrains", "@", "finalDendriteGrainMasks"}]}]}], ";"}],
   "\n"}], "\n", 
 RowBox[{"plotDecomposedGrainMasks", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}], "@", 
   "finalGrainMasks"}]}], "\[IndentingNewLine]", 
 RowBox[{"plotDecomposedGrains", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}], ",", 
      RowBox[{"ImagePadding", "\[Rule]", "5"}]}], "]"}], "&"}], "@", 
   "finalFilteredDendriteGrains"}]}]}], "Input",
 CellChangeTimes->{{3.846851681124561*^9, 3.846851723404827*^9}, {
   3.8480622691355*^9, 3.8480622842637396`*^9}, 3.848062318693599*^9, {
   3.8480623718460436`*^9, 3.848062374549513*^9}, {3.8614727054005527`*^9, 
   3.861472706851618*^9}, {3.861544018404736*^9, 3.8615440265172224`*^9}, 
   3.8617324723928385`*^9, {3.861733059713314*^9, 3.8617331115536613`*^9}, {
   3.8617379932607555`*^9, 3.861738000308957*^9}, 3.861776583172393*^9, 
   3.8617766205414443`*^9, 3.861778509815293*^9, {3.861778585197237*^9, 
   3.8617785865835295`*^9}, {3.862670941789708*^9, 3.8626709425616026`*^9}, {
   3.862674903477606*^9, 3.8626749057871437`*^9}},
 CellLabel->
  "In[4229]:=",ExpressionUUID->"a506d580-3f2b-4da2-822a-e26f71300686"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "outputFrameResults", "<>", "\"\<17_decomposed_grain_masks.jpg\>\""}], 
     ",", "\[IndentingNewLine]", "plotDecomposedGrainMasks", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputFrameResults", "<>", "\"\<18_decomposed_grains.jpg\>\""}], 
    ",", "\[IndentingNewLine]", "plotDecomposedGrains", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8382979833999586`*^9, 3.8382980066802344`*^9}, {
   3.8383913393760614`*^9, 3.838391345014985*^9}, {3.8428557353159137`*^9, 
   3.8428557659060183`*^9}, {3.848062181999519*^9, 3.8480621824772453`*^9}, {
   3.848062325887159*^9, 3.848062350072759*^9}, {3.8480624142865486`*^9, 
   3.848062416653595*^9}, {3.848062526214545*^9, 3.8480625286057634`*^9}, {
   3.861468143684306*^9, 3.861468193353491*^9}, {3.861472595178977*^9, 
   3.8614726272248044`*^9}, 3.8614726705035315`*^9, 3.8614727040405655`*^9, {
   3.861472912633784*^9, 3.861472914215494*^9}, {3.8615440026291184`*^9, 
   3.8615440103805947`*^9}, {3.8615478304663544`*^9, 3.861547915624367*^9}, {
   3.861548021653751*^9, 3.8615480647350345`*^9}, {3.86154816718464*^9, 
   3.861548179768602*^9}, 3.861548314121853*^9, 3.8617334365189886`*^9},
 CellLabel->
  "In[4232]:=",ExpressionUUID->"768417f7-bf15-47cc-b466-928c73e39369"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Dominant Grain Overlays", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.8427097049478493`*^9, 3.842709711835433*^9}, {
   3.8427778846192293`*^9, 3.8427778870984125`*^9}, {3.8429646447427826`*^9, 
   3.842964655582141*^9}, {3.842964718430003*^9, 3.8429647821656127`*^9}, {
   3.8429648396778593`*^9, 3.842964843365999*^9}, {3.842965034197981*^9, 
   3.842965044231017*^9}, 
   3.842965105405572*^9},ExpressionUUID->"fc18e74e-7e51-4b78-9501-\
f4735378dfee"],

Cell["\<\
Defaults:

areaOverlayClosingScale=10;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.8382727495804157`*^9}, 3.8382727957170744`*^9, 3.842862835749569*^9, {
   3.8428691242223015`*^9, 3.842869127125954*^9}, {3.8429691041517506`*^9, 
   3.842969104385127*^9}, {3.8467745083098745`*^9, 3.8467745164700637`*^9}, 
   3.8624061048912897`*^9},
 FontSize->16,ExpressionUUID->"00d43d31-eb5d-4838-a1d8-34c80babb597"],

Cell[BoxData[
 RowBox[{
  RowBox[{"areaOverlayClosingScale", "=", "12.5"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.862323407214795*^9, 3.8623234167385054`*^9}, {
   3.8625916523973274`*^9, 3.8625916586606517`*^9}, {3.862597868559561*^9, 
   3.8625978898628516`*^9}, {3.8625994624394417`*^9, 
   3.8625994747499437`*^9}, {3.8625995355276012`*^9, 
   3.8625995468711805`*^9}, {3.862670727115899*^9, 3.862670730427285*^9}, {
   3.8626710195126123`*^9, 3.862671020539774*^9}, {3.862671072270049*^9, 
   3.8626710830679235`*^9}, {3.8626713129768925`*^9, 3.862671354887554*^9}, 
   3.862671486054538*^9, {3.862750524485703*^9, 3.8627505381952295`*^9}},
 CellLabel->
  "In[4234]:=",ExpressionUUID->"fe0b865d-6560-48a4-9f8e-f59f7c84958c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dominantGrainOverlay", "=", 
   RowBox[{"getDominanGrainOverlay", "@", "finalFilteredDendriteGrains"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overlapZoneOverlay", "=", 
    RowBox[{"getOverlapZoneOverlay", "[", 
     RowBox[{"cleanAssembledSkeleton", ",", "overlapMask"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", "plotGrainDecomposition", "\
\[IndentingNewLine]", 
 RowBox[{"plotGrainDecompositionNoCavities", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grainAreaMasks", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteSmallComponents", "@", 
       RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"useMask", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FillingTransform", "@", 
          RowBox[{"Closing", "[", 
           RowBox[{"#", ",", 
            RowBox[{"DiskMatrix", "@", "areaOverlayClosingScale"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
     "finalGrainMasks"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"grainAreaOverlay", "=", 
    RowBox[{"getDominanGrainOverlay", "@", "grainAreaMasks"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotGrainDecompositionAreaOverlays", "=", 
   RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
    RowBox[{"plotGrainDecomposition", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", "0.2"}], "}"}], "&"}], "@", 
        RowBox[{"ColorReplace", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Black", "\[Rule]", "White"}]}], "]"}]}], "&"}], "@", 
      "grainAreaOverlay"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotGrainDecompositionOverlay", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ImagePad", "[", 
         RowBox[{"#", ",", "3", ",", "Gray"}], "]"}], "&"}], "@", 
       RowBox[{"ImageCompose", "[", 
        RowBox[{"#", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "0.65"}], "}"}], "&"}], "@", 
          "dominantGrainOverlay"}]}], "\[IndentingNewLine]", "]"}]}], "&"}], 
     "@", 
     RowBox[{"ImageMultiply", "[", 
      RowBox[{"#", ",", "realMask"}], "]"}]}], "&"}], "@", 
   RowBox[{"ImageAssemble", "@", 
    RowBox[{"getFramePartition", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Sharpen", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "&"}], "@", 
       RowBox[{"preprocessImage", "@", 
        RowBox[{"ColorNegate", "@", "testFrame"}]}]}], ",", 
      "\[IndentingNewLine]", "partitionScale"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8468521689724283`*^9, 3.8468522153245907`*^9}, {
   3.846855410132408*^9, 3.8468554106609945`*^9}, 3.847958497490572*^9, {
   3.8479612434256554`*^9, 3.847961244362135*^9}, {3.861542239991118*^9, 
   3.861542242052764*^9}, {3.861542367670141*^9, 3.8615424087331038`*^9}, {
   3.861548354866833*^9, 3.861548360771162*^9}, {3.8623231027963643`*^9, 
   3.8623231032691*^9}, {3.8623233529383917`*^9, 3.862323392501134*^9}, {
   3.8623234233886704`*^9, 3.8623234276901693`*^9}, {3.8623237255711*^9, 
   3.8623237667848487`*^9}},
 CellLabel->
  "In[4235]:=",ExpressionUUID->"ee2317e0-ecaf-4341-9476-d752caf7ee53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outputFrameResults", "<>", "#2", "<>", "\"\<.jpg\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Rasterize", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"RasterSize", "\[Rule]", "2600"}]}], "]"}], ",", 
       RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "\[IndentingNewLine]",
       "]"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "plotGrainDecomposition", ",", "plotGrainDecompositionNoCavities", ",",
         "\[IndentingNewLine]", "plotGrainDecompositionAreaOverlays", ",", 
        "plotGrainDecompositionOverlay"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<19_grain_decomposition\>\"", ",", 
        "\"\<20_grain_decomposition_no_cavities\>\"", ",", 
        "\[IndentingNewLine]", "\"\<20a_grain_decomposition_no_cavities\>\"", 
        ",", "\"\<21_test_grain_decomposition_overlay\>\""}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.862323785707547*^9, 3.8623239385796947`*^9}, {
  3.862323971598132*^9, 3.8623240056479483`*^9}, {3.8623240653479023`*^9, 
  3.8623240713686233`*^9}},
 CellLabel->
  "In[4243]:=",ExpressionUUID->"5a8c71d4-35ae-41f9-be56-66b76d7573a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Grain Stats & Orientation Spectra", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.837506681334256*^9, 3.837506767157331*^9}, {
   3.837688111486953*^9, 3.8376881696134996`*^9}, {3.837688213597789*^9, 
   3.8376882593816147`*^9}, {3.838197498961828*^9, 3.838197520356863*^9}, {
   3.8381981040506496`*^9, 
   3.838198114090807*^9}},ExpressionUUID->"a3a1db0d-75a1-4181-ae6c-\
9b9c94f872cf"],

Cell["Measure dendrite primary spacings (FFT / explicit)", "Subitem",
 CellChangeTimes->{{3.8215428902446327`*^9, 3.8215429092917013`*^9}, {
   3.821543019999116*^9, 3.821543055134698*^9}, {3.821543108413828*^9, 
   3.82154310858138*^9}, 3.8215435373886523`*^9, {3.821543586804587*^9, 
   3.821543595004086*^9}, {3.821552325940542*^9, 3.8215523722177296`*^9}, {
   3.8215571746165543`*^9, 3.8215571838568335`*^9}, {3.8215962804132195`*^9, 
   3.821596310588499*^9}, {3.821628482941619*^9, 3.821628520128134*^9}, {
   3.8223951717372007`*^9, 3.822395209954018*^9}, {3.822420655055955*^9, 
   3.8224206766429777`*^9}, {3.828683791164585*^9, 3.8286838005880375`*^9}, {
   3.8376051147289844`*^9, 3.8376051299413137`*^9}, {3.8376055257819567`*^9, 
   3.837605601745866*^9}, {3.838273984166917*^9, 3.838273984166917*^9}, {
   3.838354144260075*^9, 3.838354153707817*^9}, {3.8421814225497365`*^9, 
   3.8421816063522367`*^9}, {3.8431902013064957`*^9, 
   3.8431902638971725`*^9}, {3.8433028629501863`*^9, 
   3.8433028856062727`*^9}, {3.843303773685915*^9, 3.843303773686912*^9}},
 FontSize->18,ExpressionUUID->"871f8648-230b-4fee-b5fd-198516f0df61"],

Cell["\<\
Defaults:

binInterpolation=0;
angleBinCount=25;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.8375099397360787`*^9, 
   3.837509950255954*^9}, 3.8382723901146336`*^9, {3.838272704263554*^9, 
   3.8382727495804157`*^9}, 3.8382727957170744`*^9, 3.842862835749569*^9, {
   3.8428691242223015`*^9, 3.842869127125954*^9}, {3.8429691041517506`*^9, 
   3.842969104385127*^9}, {3.8467745083098745`*^9, 3.8467745164700637`*^9}},
 FontSize->16,ExpressionUUID->"a9b8b331-05c3-4bea-9ac4-cf59dbee032f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binInterpolation", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleBinCount", "=", "25"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.838213921854867*^9, 3.8382139562333956`*^9}, {
   3.842862807253234*^9, 3.842862847748487*^9}, 3.8428628945573044`*^9, {
   3.8428633730293818`*^9, 3.8428634439485197`*^9}, {3.8428635685257626`*^9, 
   3.842863568620509*^9}, {3.8428636100293193`*^9, 3.8428636102766585`*^9}, {
   3.8428682568139877`*^9, 3.842868262814066*^9}, {3.842869113606019*^9, 
   3.842869132982005*^9}, {3.842967862066251*^9, 3.8429678722071667`*^9}, {
   3.8430149193926897`*^9, 3.8430149428800654`*^9}, {3.843034023958337*^9, 
   3.843034042366315*^9}, {3.8430343320786653`*^9, 3.8430343331491785`*^9}, {
   3.843036347271718*^9, 3.8430363764965982`*^9}, {3.843036467519803*^9, 
   3.8430364675906143`*^9}, {3.843036585663992*^9, 3.8430366051828165`*^9}, 
   3.843037087688649*^9, {3.8430388486257143`*^9, 3.843038855160654*^9}, {
   3.843038934738821*^9, 3.8430389528081446`*^9}, {3.843039469386379*^9, 
   3.8430394811850185`*^9}, 3.843041446563577*^9, {3.843047444991276*^9, 
   3.843047490534295*^9}, {3.843048522480903*^9, 3.8430485415832024`*^9}, 
   3.843308207995796*^9, {3.8467745068477807`*^9, 3.8467745153271055`*^9}, {
   3.846828240164282*^9, 3.8468282405013804`*^9}, {3.8615426989494143`*^9, 
   3.861542699501936*^9}, {3.862503589183013*^9, 3.8625035913933973`*^9}, {
   3.8625978593185863`*^9, 3.862597862038036*^9}},
 CellLabel->
  "In[4244]:=",ExpressionUUID->"1d431070-19b8-49bc-bd5b-b87117431a8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grainStats", "=", 
   RowBox[{"getGrainStatsAdaptive", "@", "finalFilteredDendriteGrains"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grainStats", "//", "TableForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angleTickValues", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "5"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grainOrientationSpectra", "=", 
   RowBox[{
   "getGrainOrientationSpectraAdaptive", "@", 
    "finalFilteredDendriteGrains"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "&"}], "@", 
   "grainOrientationSpectra"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"exportGrainStatsTable", ":=", 
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputFrameResults", "<>", "\"\<22_grain_stats.jpg\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TraditionalForm", "@", 
       RowBox[{"TableForm", "[", 
        RowBox[{"#", ",", 
         RowBox[{"TableAlignments", "\[Rule]", "Center"}]}], "]"}]}], "&"}], 
     "@", 
     RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Grain\>\"", ",", "\"\<S, %\>\"", ",", 
           "\"\<\[Phi], \[Degree]\>\"", ",", 
           "\"\<\[Delta]\[Phi], \[Degree]\>\""}], "}"}], "}"}], ",", 
        "\[IndentingNewLine]", "grainStats"}], "\[IndentingNewLine]", "}"}], 
      "\[IndentingNewLine]", "]"}]}], ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.846857018786401*^9, 3.8468570463153057`*^9}, {
   3.8468571950432787`*^9, 3.8468571957481594`*^9}, {3.8471787693129025`*^9, 
   3.8471787699870996`*^9}, {3.847357133408291*^9, 3.847357153055667*^9}, {
   3.8479629251597157`*^9, 3.847962934337146*^9}, {3.84806261699887*^9, 
   3.8480626171574736`*^9}, 3.861468864331422*^9, 3.8617358874007993`*^9, 
   3.8617377202389746`*^9, {3.8617383732315593`*^9, 3.861738378387807*^9}, 
   3.8617390544615574`*^9, 3.861767436040174*^9, {3.861769227611145*^9, 
   3.861769228313899*^9}},
 CellLabel->
  "In[4246]:=",ExpressionUUID->"f47aab01-e49b-408a-8c97-35f5faa86b31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exportGrainStatsTable", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "outputFrameResults", "<>", "\"\<23_grain_orientation_spectrum_\>\"", "<>", 
       RowBox[{"ToString", "@", "#"}], "<>", "\"\<.jpg\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"grainOrientationSpectra", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
     "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "grainOrientationSpectra"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.843038383057142*^9, 3.8430383954406033`*^9}, {
   3.8430385880742445`*^9, 3.843038602873416*^9}, {3.843038874409793*^9, 
   3.843038874569454*^9}, {3.8467715908241863`*^9, 3.8467716032000933`*^9}, {
   3.8467730181363883`*^9, 3.846773020759373*^9}, {3.8467730551932926`*^9, 
   3.8467730741037235`*^9}, {3.8467731278629646`*^9, 3.8467731641529207`*^9}, 
   3.846773228672387*^9, 3.8467732724473295`*^9, {3.8467751021746516`*^9, 
   3.8467751044144325`*^9}, {3.8468572493085394`*^9, 
   3.8468572509872723`*^9}, {3.8471787638345523`*^9, 
   3.8471787657135277`*^9}, {3.848062600502522*^9, 3.848062614445822*^9}, 
   3.8614682548995934`*^9, {3.8615441723029537`*^9, 3.8615441837156324`*^9}, {
   3.861548391513055*^9, 3.8615483956884613`*^9}},
 CellLabel->
  "In[4252]:=",ExpressionUUID->"8d935ec8-0f9e-48e7-8fbb-b267dd6bb8e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Liquid Region Analysis", "Section",
 CellChangeTimes->{{3.8216381726723228`*^9, 3.821638180240076*^9}, 
   3.821638212294323*^9, {3.8387048339126616`*^9, 3.8387048415931826`*^9}, {
   3.8387048732178807`*^9, 
   3.8387048747851934`*^9}},ExpressionUUID->"8a698108-befd-4c75-8e6d-\
3bfc6e98e904"],

Cell[CellGroupData[{

Cell["Isolate the Liquid Region", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.838705224544797*^9, 3.838705338257781*^9}, 
   3.8387821733395023`*^9, {3.8387822136663895`*^9, 
   3.8387822399784584`*^9}},ExpressionUUID->"5b7207e9-4a88-4eac-9912-\
e6d21a226d96"],

Cell["\<\
Defaults:

maskInflation=15;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.837577863481824*^9, 
   3.83757786720986*^9}, 3.837579475676549*^9, 3.837588132191126*^9, 
   3.8375889349163*^9, {3.8381903110566654`*^9, 3.8381903132959633`*^9}, {
   3.83827282828999*^9, 3.8382728286201077`*^9}, {3.838459967495037*^9, 
   3.838459970967058*^9}, {3.838486692358446*^9, 3.8384866950302773`*^9}, {
   3.838782146842084*^9, 3.8387821471937017`*^9}, 3.838782320066891*^9},
 FontSize->16,ExpressionUUID->"0c0b2892-606d-4576-9f01-e7104b2b7dc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maskInflation", "=", "15"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8375781921537914`*^9, 3.837578222033907*^9}, {
   3.8375784105063057`*^9, 3.837578415945763*^9}, {3.8375784741312037`*^9, 
   3.837578502321836*^9}, {3.837578542138386*^9, 3.8375785693456473`*^9}, {
   3.8375786144739966`*^9, 3.837578720377862*^9}, {3.837578825826413*^9, 
   3.8375788510898714`*^9}, {3.837578963434595*^9, 3.8375789635143824`*^9}, {
   3.8375790421955347`*^9, 3.83757904627363*^9}, {3.837579090370738*^9, 
   3.837579126426342*^9}, {3.8375791842507486`*^9, 3.837579223778527*^9}, {
   3.837585149724168*^9, 3.837585149764061*^9}, 3.8375852146446095`*^9, {
   3.837585461077008*^9, 3.8375854760928626`*^9}, {3.8375857965725965`*^9, 
   3.8375858785564127`*^9}, {3.8375859518135004`*^9, 
   3.8375859536755195`*^9}, {3.8375877666046195`*^9, 3.83758778879629*^9}, 
   3.837588438668702*^9, {3.8375889306047935`*^9, 3.837588932788952*^9}, {
   3.8375890556705675`*^9, 3.8375890838302827`*^9}, {3.8375891405426617`*^9, 
   3.837589175598143*^9}, {3.8375892146766663`*^9, 3.8375892151494026`*^9}, {
   3.8376031378018584`*^9, 3.837603139930169*^9}, {3.8376034551536665`*^9, 
   3.837603455424942*^9}, {3.837603521818438*^9, 3.8376035240813885`*^9}, 
   3.8381903288565016`*^9, {3.8382728323391647`*^9, 3.8382728326034584`*^9}, {
   3.838442051488278*^9, 3.8384420711991653`*^9}, 3.8384494321774583`*^9, {
   3.838457995374819*^9, 3.838457998478876*^9}, {3.838458066223078*^9, 
   3.8384580721664352`*^9}, 3.8384582779505463`*^9, {3.8384583243834214`*^9, 
   3.8384583285103893`*^9}, 3.838458373304646*^9, {3.8384584529106913`*^9, 
   3.8384584760398626`*^9}, 3.8384591978637915`*^9, {3.8384599717049665`*^9, 
   3.8384599722951336`*^9}, {3.8384892254973974`*^9, 3.8384892399434843`*^9}, 
   3.838489313704712*^9, {3.83878231550023*^9, 3.838782317042672*^9}, {
   3.8481243090341797`*^9, 3.8481243091219454`*^9}, {3.8481244328660383`*^9, 
   3.848124433057526*^9}, {3.8614708822974005`*^9, 3.861470901119616*^9}, 
   3.861472201375866*^9, 3.8614731155517993`*^9, {3.861541735957954*^9, 
   3.861541737500902*^9}, {3.8615440482751455`*^9, 3.861544048660115*^9}, {
   3.8616138852305613`*^9, 3.861613886966916*^9}, {3.862753873475557*^9, 
   3.86275387547492*^9}},
 CellLabel->
  "In[4592]:=",ExpressionUUID->"1fbe5f60-74cf-4892-aee7-79a29a3adea1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testBulkLiquidMask", "=", 
   RowBox[{"liquidMaskFilledChannels", "[", 
    RowBox[{"[", "testID", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inflatedLiquidMask", "=", 
    RowBox[{"inflateMask", "@", "testBulkLiquidMask"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
  RowBox[{"inflatedLiquidMask", ",", "\[IndentingNewLine]", 
   RowBox[{"EdgeDetect", "@", "testBulkLiquidMask"}]}], "\[IndentingNewLine]",
   "]"}]}], "Input",
 CellChangeTimes->{{3.8384580316871614`*^9, 3.8384581123341117`*^9}, {
  3.8428730497040567`*^9, 3.842873060216953*^9}, {3.847963229846916*^9, 
  3.8479632466898766`*^9}, {3.847963289240116*^9, 3.8479633162957687`*^9}, {
  3.8479637210048456`*^9, 3.847963721798768*^9}, {3.8546512927927155`*^9, 
  3.8546512938087626`*^9}, {3.854651345473839*^9, 3.8546513470442543`*^9}, {
  3.8615417005029044`*^9, 3.861541739198321*^9}, {3.862406826940754*^9, 
  3.8624068275548677`*^9}},
 CellLabel->
  "In[4593]:=",ExpressionUUID->"3f852cdc-65da-44c6-8e29-e6271ef8b10f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filter the Liquid Region", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.838705224544797*^9, 3.838705338257781*^9}, 
   3.8387821733395023`*^9, {3.8387822136663895`*^9, 3.8387822399784584`*^9}, {
   3.847963694358906*^9, 
   3.847963696118373*^9}},ExpressionUUID->"d994c70f-7b3d-448c-b194-\
63a8b56c585c"],

Cell["\<\
Defaults:

liquidGaussianKernelScale=3;
liquidNeighborhoodRadius=2;
liquidMedianRadius=1;

extraNonlocalPatchSize=1;
extraNonlocalScanRadius=15;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.837577863481824*^9, 
   3.83757786720986*^9}, 3.837579475676549*^9, 3.837588132191126*^9, 
   3.8375889349163*^9, {3.8381903110566654`*^9, 3.8381903132959633`*^9}, {
   3.83827282828999*^9, 3.8382728286201077`*^9}, {3.838459967495037*^9, 
   3.838459970967058*^9}, {3.838486692358446*^9, 3.8384866950302773`*^9}, {
   3.838782146842084*^9, 3.8387821471937017`*^9}, 3.838782320066891*^9, 
   3.84804335540469*^9, 3.8614732207760615`*^9, {3.8615420161321507`*^9, 
   3.861542023693509*^9}, 3.8615426789488263`*^9, 3.861608673186631*^9, {
   3.8616092867445*^9, 3.861609286921028*^9}, 3.8616114306628976`*^9},
 FontSize->16,ExpressionUUID->"4e933f00-3b82-4997-b78a-87a41aa50ffd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"liquidGaussianKernelScale", "=", "3"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidNeighborhoodRadius", "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"liquidMedianRadius", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extraNonlocalPatchSize", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"extraNonlocalScanRadius", "=", "15"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8479636345989027`*^9, 3.8479636359364214`*^9}, {
   3.847963710382514*^9, 3.8479637130170045`*^9}, {3.8479637507032385`*^9, 
   3.84796375415085*^9}, {3.8481241409785814`*^9, 3.8481241847615004`*^9}, {
   3.8481242157546215`*^9, 3.848124220593681*^9}, {3.8481243888976145`*^9, 
   3.8481244108100185`*^9}, {3.861471424615811*^9, 3.8614714251852903`*^9}, {
   3.861471562057582*^9, 3.8614715623278584`*^9}, {3.86147160608818*^9, 
   3.861471606339391*^9}, {3.8614716760000887`*^9, 3.861471716248086*^9}, {
   3.861471752439612*^9, 3.8614717690730543`*^9}, {3.8614718114239745`*^9, 
   3.86147181367893*^9}, {3.861472066231906*^9, 3.861472080390696*^9}, 
   3.861472207338079*^9, {3.8614723631354012`*^9, 3.8614723631683493`*^9}, {
   3.861473123694912*^9, 3.86147315183815*^9}, {3.861541856981453*^9, 
   3.8615418714848585`*^9}, 3.861541918009631*^9, {3.8615419750465612`*^9, 
   3.861542042877422*^9}, {3.8616002112006674`*^9, 3.861600276903326*^9}, {
   3.861600423898613*^9, 3.8616004439594493`*^9}, {3.8616086456303186`*^9, 
   3.86160866053846*^9}, {3.861608738396678*^9, 3.861608758304534*^9}, {
   3.861608842961167*^9, 3.861608873369491*^9}, {3.8616089932268267`*^9, 
   3.861609013001691*^9}, {3.8616092059787736`*^9, 3.861609214951774*^9}, {
   3.861609263331126*^9, 3.861609285088928*^9}, {3.8616093549015446`*^9, 
   3.8616093684662647`*^9}, {3.861609548808679*^9, 3.8616095736409883`*^9}, 
   3.861609989848914*^9, {3.8616100980492907`*^9, 3.861610102233101*^9}, 
   3.861611380208946*^9, {3.8616116199995317`*^9, 3.86161162752579*^9}, {
   3.861611674559566*^9, 3.861611692584769*^9}, 3.8616124194388065`*^9, 
   3.8616133438764906`*^9, {3.8616159881965847`*^9, 3.861615989194864*^9}, {
   3.8616165785952077`*^9, 3.861616583348442*^9}, 3.8616972832297764`*^9, {
   3.8616993863624306`*^9, 3.861699408234346*^9}, 3.8616994566424184`*^9, 
   3.8617793571473985`*^9, 3.861779941102764*^9, 3.8617817880256014`*^9, 
   3.861782956719393*^9, 3.8624761184983025`*^9, 3.8624798048264008`*^9, 
   3.862490731051675*^9, {3.8625036588764634`*^9, 3.862503676689824*^9}, 
   3.8625962986002283`*^9, {3.8625987598623943`*^9, 3.8625987643341656`*^9}, {
   3.8625991603277206`*^9, 3.8625991759597354`*^9}, 3.8626715782361784`*^9, {
   3.8627538946940413`*^9, 3.862753895410493*^9}, {3.862775300991091*^9, 
   3.8627753082578497`*^9}},
 CellLabel->
  "In[4596]:=",ExpressionUUID->"b6885f77-ccfe-439c-aa2f-a36aa19f40b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"liquidImageFilteredFOV", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"NonlocalMeansFilter", "[", "\[IndentingNewLine]", 
       RowBox[{
       "#", ",", "extraNonlocalPatchSize", ",", "extraNonlocalScanRadius"}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"getFilteredConcentrationField", "@", "testFrame"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Image", "[", 
       RowBox[{"#", ",", 
        RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "&"}], "@", 
     RowBox[{"ColorReplace", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Black", "\[Rule]", "LightGray"}]}], "]"}]}], "&"}], "@", 
   RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Colorize", "@", 
      RowBox[{"ImageAdjust", "@", "liquidImageFilteredFOV"}]}], ",", 
     "inflatedLiquidMask"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"liquidImageFiltered", "=", 
   RowBox[{
    RowBox[{"ImageMultiply", "[", 
     RowBox[{"inflatedLiquidMask", ",", "liquidImageFilteredFOV"}], "]"}], "//",
     "ImageAdjust"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8479637407419863`*^9, 3.8479637995913634`*^9}, {
   3.8479640697521152`*^9, 3.8479640936739025`*^9}, {3.861469744211174*^9, 
   3.861469747211713*^9}, {3.861470549738278*^9, 3.8614705685841427`*^9}, {
   3.8614709870249014`*^9, 3.861471006290681*^9}, 3.8614714138575907`*^9, 
   3.8615418296227107`*^9, {3.861541885272047*^9, 3.8615418891487827`*^9}, {
   3.861541980062125*^9, 3.861541980621628*^9}, {3.8616002291696143`*^9, 
   3.861600230471175*^9}, {3.861600286387475*^9, 3.861600291592965*^9}, {
   3.861600328336382*^9, 3.8616003803384466`*^9}, {3.8616005134733706`*^9, 
   3.861600535744197*^9}, {3.8616085792282944`*^9, 3.8616086282807293`*^9}, {
   3.861608663611294*^9, 3.8616087137176924`*^9}, {3.8616087675708036`*^9, 
   3.8616087816411767`*^9}, {3.861608831835924*^9, 3.861608833194293*^9}, {
   3.861608983169734*^9, 3.861608987912997*^9}, {3.8616090614592834`*^9, 
   3.8616090896373897`*^9}, 3.861609271034531*^9, {3.8616093070821056`*^9, 
   3.861609316536871*^9}, {3.861609348508175*^9, 3.8616095327850075`*^9}, {
   3.8616099599374995`*^9, 3.861609985089589*^9}, {3.861610070870959*^9, 
   3.861610087576301*^9}, {3.8616118879607525`*^9, 3.8616118901925693`*^9}, {
   3.8616119288312836`*^9, 3.8616119297365074`*^9}, {3.8616126018885393`*^9, 
   3.8616126110309105`*^9}},
 CellLabel->
  "In[4601]:=",ExpressionUUID->"4683de75-aad5-43d6-a099-75041742152d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perform Plume Clustering", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.838705224544797*^9, 3.838705338257781*^9}, 
   3.8387821733395023`*^9, {3.8387822136663895`*^9, 3.8387822399784584`*^9}, {
   3.8387823444423466`*^9, 3.8387823964978437`*^9}, 3.847963703886881*^9, {
   3.862468281982733*^9, 
   3.8624682924313254`*^9}},ExpressionUUID->"1e9f0b0e-d844-406a-839d-\
a29e131fb7aa"],

Cell["\<\
Defaults:

clusterCount=9;
colorSetID=97;
clusteringMethod=\[CloseCurlyDoubleQuote]KMedoids\[CloseCurlyDoubleQuote];
clusterColorPalette=\[CloseCurlyDoubleQuote]RedBlueTones\
\[CloseCurlyDoubleQuote];\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.837577863481824*^9, 
   3.83757786720986*^9}, 3.837579475676549*^9, 3.837588132191126*^9, 
   3.8375889349163*^9, {3.8381903110566654`*^9, 3.8381903132959633`*^9}, {
   3.83827282828999*^9, 3.8382728286201077`*^9}, {3.838459967495037*^9, 
   3.838459970967058*^9}, {3.838486692358446*^9, 3.8384866950302773`*^9}, {
   3.838782146842084*^9, 3.8387821471937017`*^9}, 3.838782320066891*^9, 
   3.84804335540469*^9, 3.8614732207760615`*^9, {3.8615420161321507`*^9, 
   3.861542023693509*^9}, 3.8615426789488263`*^9, 3.861608673186631*^9, {
   3.8616092867445*^9, 3.861609286921028*^9}, 3.8616114306628976`*^9, 
   3.862406132393124*^9},
 FontSize->16,ExpressionUUID->"936be246-00af-4a1b-9d38-9afa8c5177ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"clusterCount", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorSetID", "=", "97"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clusteringMethod", "=", "\"\<KMedoids\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clusterColorPalette", "=", "\"\<RedBlueTones\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8479675600496407`*^9, 3.847967576861706*^9}, {
   3.8479676249819813`*^9, 3.8479676250538273`*^9}, {3.848038257948982*^9, 
   3.8480382587737474`*^9}, {3.848124264210045*^9, 3.848124316418433*^9}, {
   3.8481248838577843`*^9, 3.8481249501535015`*^9}, {3.848125090241887*^9, 
   3.8481250903047237`*^9}, {3.854651194825795*^9, 3.8546512083044434`*^9}, {
   3.8614712744725475`*^9, 3.8614712855209856`*^9}, {3.861471422126417*^9, 
   3.8614714299989257`*^9}, {3.8614714894484606`*^9, 3.8614715190476837`*^9}, 
   3.8614718491837225`*^9, {3.861471928753437*^9, 3.861471928823247*^9}, {
   3.861472125617268*^9, 3.8614721284317403`*^9}, 3.861472182601018*^9, 
   3.861472369601057*^9, {3.861473235431819*^9, 3.861473245198148*^9}, {
   3.8615417974489064`*^9, 3.861541812598352*^9}, {3.8616001516716623`*^9, 
   3.8616001930400734`*^9}, {3.861600299984082*^9, 3.8616003016106777`*^9}, {
   3.8616088574612784`*^9, 3.86160885888846*^9}, {3.861610109138632*^9, 
   3.8616101100641556`*^9}, {3.8616116406879745`*^9, 3.8616116547476788`*^9}, 
   3.8616119075436783`*^9, 3.861612038568082*^9, 3.861612425270607*^9, 
   3.861613347999469*^9, {3.86161393289319*^9, 3.861613948277376*^9}, 
   3.8616159958231363`*^9, {3.8616972763578806`*^9, 3.861697303060599*^9}, {
   3.86178186177162*^9, 3.8617818828088427`*^9}, 3.8617874119916534`*^9, {
   3.8617874444535546`*^9, 3.861787454821333*^9}, 3.8617877246427407`*^9, {
   3.862382160523123*^9, 3.862382210679473*^9}, {3.862382253017361*^9, 
   3.862382263456419*^9}, {3.8623822958648863`*^9, 3.862382334335997*^9}, {
   3.862502952865532*^9, 3.862502965734771*^9}, {3.862599038095318*^9, 
   3.8625990403139086`*^9}, {3.8625991180630836`*^9, 
   3.8625991465030336`*^9}, {3.8625992564623365`*^9, 3.862599268110817*^9}, {
   3.8627539238047833`*^9, 3.8627539418612556`*^9}},
 CellLabel->
  "In[4604]:=",ExpressionUUID->"d3efc333-3a66-4c73-80ab-ebc477c56f83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plumeClusters", "=", 
    RowBox[{"clusterColorize", "@", 
     RowBox[{"getClusters", "@", "liquidImageFiltered"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plumeLeveSets", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "0.999"}], "]"}], "&"}], "@", 
        RowBox[{"ImageAdjust", "@", 
         RowBox[{"ColorDetect", "[", 
          RowBox[{"plumeClusters", ",", "#"}], "]"}]}]}], "&"}], "/@", 
      "clusterColors"}], "//", "Parallelize"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanLevelsetValues", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Total", "@", "#"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Length", "@", "#"}]}], ")"}]}], ")"}], "&"}], "@", 
          "\[IndentingNewLine]", 
          RowBox[{"Select", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], "&"}], "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"ImageData", "@", "\[IndentingNewLine]", 
          RowBox[{"ImageMultiply", "[", 
           RowBox[{"liquidImageFiltered", ",", "#"}], "]"}]}]}]}], "&"}], "/@",
       "plumeLeveSets"}], "//", "Parallelize"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"orderedPlumeLevelSets", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", "#"}], ">", "0"}], "&"}]}], "]"}]}], "&"}], 
       "@", 
       RowBox[{"ReverseSortBy", "[", 
        RowBox[{"#", ",", "Last"}], "]"}]}], "&"}], "@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"plumeLeveSets", ",", "meanLevelsetValues"}], "}"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"clusterColorGrading", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Rescale", "@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Length", "@", "orderedPlumeLevelSets"}], "-", "1"}], ",", 
       "1"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clusterColorsOrdered", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Blend", "[", 
       RowBox[{"\"\<RedBlueTones\>\"", ",", "#"}], "]"}], "&"}], "/@", 
     "clusterColorGrading"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"orderedPlumeLevelSetsColorized", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ColorReplace", "[", 
         RowBox[{"#1", ",", 
          RowBox[{"White", "\[Rule]", "#2"}]}], "]"}], "&"}], "@@", "#"}], 
      "&"}], "/@", 
     RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"orderedPlumeLevelSets", ",", "clusterColorsOrdered"}], "}"}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotDecomposedPlumes", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImageCollage", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
      RowBox[{"Background", "\[Rule]", 
       RowBox[{"Darker", "@", "LightGray"}]}]}], "]"}], "&"}], "@", 
   "orderedPlumeLevelSets"}]}]}], "Input",
 CellChangeTimes->{{3.8623821207365456`*^9, 3.862382157679775*^9}, {
   3.862382270251259*^9, 3.8623822735385294`*^9}, {3.862382313850687*^9, 
   3.862382369767185*^9}, {3.86238245848841*^9, 3.8623824590388365`*^9}, {
   3.862384228608995*^9, 3.8623842337363367`*^9}, {3.8623843087916183`*^9, 
   3.862384311626092*^9}, {3.8623844306163197`*^9, 3.8623844334237633`*^9}, {
   3.862384985641223*^9, 3.8623849865358295`*^9}, {3.8623851347642*^9, 
   3.862385160689885*^9}, {3.8623852106635847`*^9, 3.8623852779762955`*^9}, {
   3.8623853139870977`*^9, 3.8623853431122203`*^9}, 3.862385406586911*^9, {
   3.862675172981656*^9, 3.8626751753179646`*^9}},
 CellLabel->
  "In[4608]:=",ExpressionUUID->"4aeefe0a-b444-4cc1-9bc2-419da5f09181"],

Cell[BoxData[
 RowBox[{"plotPlumes", "=", 
  RowBox[{"ImageCollage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageSubtract", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Colorize", "@", 
         RowBox[{"ImageAdjust", "@", "testFrame"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EdgeDetect", "@", "inflatedLiquidMask"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ImageAdd", "[", "orderedPlumeLevelSetsColorized", "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "White"}], "]"}], "&"}], "@", 
         RowBox[{"EdgeDetect", "@", "inflatedLiquidMask"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}], ",", 
    RowBox[{"ImagePadding", "\[Rule]", "10"}], ",", 
    RowBox[{"Background", "\[Rule]", 
     RowBox[{"Lighter", "@", "Gray"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8623853574566865`*^9, 3.862385424241516*^9}},
 CellLabel->
  "In[4616]:=",ExpressionUUID->"061d0f78-e8c8-4404-992f-54e65fd34554"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"outputFrameResults", "<>", "\"\<24_plume_level_sets.png\>\""}], 
     ",", "\[IndentingNewLine]", "plotPlumes", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "outputFrameResults", "<>", "\"\<25_plume_decomposition.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "plotDecomposedPlumes", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.862385496016236*^9, 3.862385496436164*^9}},
 CellLabel->
  "In[4617]:=",ExpressionUUID->"b6a67b93-f0bc-4d24-aa89-104739c12672"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Re-assemble Selected Level Sets", "Subsection",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
   3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
   3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
   3.8216399876620564`*^9, 3.8216400283502035`*^9}, {3.821640098757168*^9, 
   3.821640119517629*^9}, 3.821641684410327*^9, {3.821643198156432*^9, 
   3.821643205656372*^9}, {3.821643274153301*^9, 3.8216433257759104`*^9}, {
   3.8375018695251884`*^9, 3.8375018755724764`*^9}, {3.8375036220929403`*^9, 
   3.8375036743405614`*^9}, {3.8375043721407948`*^9, 3.837504375500778*^9}, {
   3.8375053022931643`*^9, 3.8375053087887993`*^9}, {3.837505575077873*^9, 
   3.8375055863088484`*^9}, {3.8375060541731005`*^9, 
   3.8375060628618712`*^9}, {3.8375065679249015`*^9, 
   3.8375065746140184`*^9}, {3.838705224544797*^9, 3.838705316001257*^9}, {
   3.838782442242496*^9, 3.838782452106126*^9}, {3.8623842596151056`*^9, 
   3.862384261063225*^9}, {3.8623855098552604`*^9, 
   3.862385521944913*^9}},ExpressionUUID->"e08d7376-4fba-468f-98e8-\
d7ddd1c4e105"],

Cell["\<\
Defaults:

plumeOpeningScale=5;
maxLevelSetOrder=2;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.837577863481824*^9, 
   3.83757786720986*^9}, 3.837579475676549*^9, 3.837588132191126*^9, 
   3.8375889349163*^9, {3.8381903110566654`*^9, 3.8381903132959633`*^9}, {
   3.83827282828999*^9, 3.8382728286201077`*^9}, {3.838459967495037*^9, 
   3.838459970967058*^9}, {3.838486692358446*^9, 3.8384866950302773`*^9}, {
   3.838782146842084*^9, 3.8387821471937017`*^9}, 3.838782320066891*^9, 
   3.84804335540469*^9, 3.8614732207760615`*^9, 3.861473289622404*^9},
 FontSize->16,ExpressionUUID->"8e323864-24fb-47b4-aa74-be8511b3dccf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plumeOpeningScale", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxLevelSetOrder", "=", "3"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.837585603919118*^9, 3.8375856807003794`*^9}, {
   3.837585717924859*^9, 3.837585755068557*^9}, {3.8375860413565283`*^9, 
   3.8375861438684616`*^9}, {3.837586181108899*^9, 3.8375862707003756`*^9}, 
   3.8375865224449234`*^9, {3.8375865605879474`*^9, 3.837586579907301*^9}, {
   3.8375866183245883`*^9, 3.8375866488370132`*^9}, {3.837586959964223*^9, 
   3.837586972668257*^9}, {3.837596121695969*^9, 3.8375961498946676`*^9}, {
   3.837602437065672*^9, 3.83760243990508*^9}, {3.8376027270822124`*^9, 
   3.8376027573523493`*^9}, {3.837602842649647*^9, 3.8376028472333927`*^9}, {
   3.8376032319462543`*^9, 3.837603236105136*^9}, {3.8376034375457416`*^9, 
   3.837603449673319*^9}, {3.8376035671451645`*^9, 3.8376036184190826`*^9}, {
   3.837603885947137*^9, 3.8376039673849363`*^9}, {3.8376044059705973`*^9, 
   3.837604422651513*^9}, {3.8382134002157726`*^9, 3.838213400375346*^9}, {
   3.8382134982716227`*^9, 3.8382135067669115`*^9}, {3.838213836264186*^9, 
   3.838213836406804*^9}, {3.838214590376047*^9, 3.838214591310549*^9}, {
   3.838293882279688*^9, 3.8382939079106693`*^9}, {3.838293950167695*^9, 
   3.8382940172888885`*^9}, {3.8382986300755625`*^9, 
   3.8382986502396545`*^9}, {3.838441619448615*^9, 3.8384416196231503`*^9}, {
   3.8384424966086345`*^9, 3.838442501799755*^9}, {3.838456987565939*^9, 
   3.838456987637747*^9}, {3.838457059926152*^9, 3.8384570769576454`*^9}, {
   3.8384571519103394`*^9, 3.838457152237465*^9}, {3.838457188782542*^9, 
   3.838457198390289*^9}, {3.8384577573672724`*^9, 3.838457773534251*^9}, 
   3.838458547086939*^9, {3.8384594894240527`*^9, 3.8384594895038385`*^9}, {
   3.8384595324084034`*^9, 3.838459532479214*^9}, {3.838459688247591*^9, 
   3.838459702191555*^9}, {3.838459735055764*^9, 3.838459748655336*^9}, {
   3.8384601251761103`*^9, 3.8384601521845913`*^9}, {3.83848587311103*^9, 
   3.8384858849025087`*^9}, {3.8384859274546556`*^9, 3.838485933446637*^9}, {
   3.8384867393757105`*^9, 3.838486747686059*^9}, {3.838487188607854*^9, 
   3.8384872490469093`*^9}, {3.838487823720228*^9, 3.8384878312885485`*^9}, {
   3.838488147960658*^9, 3.8384882183353796`*^9}, {3.838488435040777*^9, 
   3.838488483679637*^9}, {3.8384892773371153`*^9, 3.838489300017262*^9}, {
   3.838489562256948*^9, 3.83848957402387*^9}, {3.8384896953298*^9, 
   3.8384897216654997`*^9}, {3.838705360913904*^9, 3.838705413072939*^9}, {
   3.838713240165288*^9, 3.838713277083537*^9}, {3.8387171116054463`*^9, 
   3.838717124396512*^9}, {3.838717239213331*^9, 3.838717281725644*^9}, {
   3.83871779954173*^9, 3.8387178150855274`*^9}, {3.838717850805895*^9, 
   3.838717861989542*^9}, {3.8387178938066006`*^9, 3.8387178990294485`*^9}, {
   3.838717948430681*^9, 3.838717957773987*^9}, {3.838782465267956*^9, 
   3.8387825008338594`*^9}, {3.838782571706366*^9, 3.838782571794131*^9}, {
   3.8387828326582265`*^9, 3.8387828503060527`*^9}, {3.8387835433875732`*^9, 
   3.8387835938027644`*^9}, 3.8387841810124454`*^9, {3.838784753084985*^9, 
   3.8387848009787083`*^9}, {3.838785363195941*^9, 3.8387853846995783`*^9}, {
   3.83878541651651*^9, 3.838785416571066*^9}, {3.838805951530322*^9, 
   3.8388059884262395`*^9}, {3.838813020643861*^9, 3.8388130587874203`*^9}, {
   3.8388131897481756`*^9, 3.8388132019311686`*^9}, 3.838813255771466*^9, {
   3.8388136412524056`*^9, 3.83881366637945*^9}, 3.838813699451523*^9, {
   3.838815148619197*^9, 3.8388151638115067`*^9}, {3.8388166178376665`*^9, 
   3.8388166180371304`*^9}, {3.838816847549159*^9, 3.8388168476364536`*^9}, {
   3.838817019221846*^9, 3.838817019349112*^9}, {3.8388170844930363`*^9, 
   3.8388170975561476`*^9}, {3.8388178854139533`*^9, 
   3.8388178855725293`*^9}, {3.8388179389660234`*^9, 3.838817952660247*^9}, {
   3.838817985966519*^9, 3.8388179860924573`*^9}, {3.838819504734527*^9, 
   3.8388195073325806`*^9}, {3.8388203936306562`*^9, 
   3.8388204274540157`*^9}, {3.842938807340535*^9, 3.8429388142757497`*^9}, {
   3.842962516870043*^9, 3.8429625619487534`*^9}, {3.8429638576866317`*^9, 
   3.842963869470131*^9}, {3.8429673077766004`*^9, 3.842967312574772*^9}, {
   3.8429689646158285`*^9, 3.842968964704565*^9}, {3.843014420361517*^9, 
   3.843014420511263*^9}, {3.8430344594145994`*^9, 3.8430344631172934`*^9}, {
   3.843034621062679*^9, 3.843034625390167*^9}, {3.8430395567381663`*^9, 
   3.8430395568970995`*^9}, {3.8430423017315755`*^9, 3.8430423082588935`*^9}, 
   3.8430433297253675`*^9, {3.8430440186371045`*^9, 3.843044018780098*^9}, {
   3.843044652261784*^9, 3.8430446607331924`*^9}, {3.843045001094117*^9, 
   3.843045009661378*^9}, {3.843046221174111*^9, 3.843046221325828*^9}, {
   3.8430475880068636`*^9, 3.843047594231282*^9}, {3.8430482233598146`*^9, 
   3.843048249255829*^9}, {3.843048622840556*^9, 3.843048635247737*^9}, {
   3.847967293406515*^9, 3.847967299781477*^9}, {3.847967395302168*^9, 
   3.8479674029896107`*^9}, {3.8479674803108435`*^9, 3.847967509702248*^9}, {
   3.8481247263779564`*^9, 3.8481247343626046`*^9}, 3.8614717396257424`*^9, {
   3.8614717951116624`*^9, 3.861471801527503*^9}, {3.86147183460776*^9, 
   3.8614718823679156`*^9}, {3.861471940275364*^9, 3.86147194876067*^9}, {
   3.8614720231669564`*^9, 3.8614720427676554`*^9}, {3.861472105249117*^9, 
   3.8614721209188347`*^9}, 3.861472163625749*^9, {3.8614722329832954`*^9, 
   3.8614722648510118`*^9}, 3.861472385039565*^9, 3.8614731727426977`*^9, {
   3.861473214383192*^9, 3.8614732152932916`*^9}, 3.861541944838114*^9, {
   3.861545465434877*^9, 3.8615454900981064`*^9}, 3.861550812774344*^9, {
   3.861551306382105*^9, 3.8615513706069317`*^9}, 3.8615999281303997`*^9, 
   3.861600409738916*^9, {3.8616004635197124`*^9, 3.8616004747199593`*^9}, 
   3.861600559464757*^9, {3.861609119936934*^9, 3.861609145538461*^9}, {
   3.8616112200577326`*^9, 3.86161122124755*^9}, 3.861611407607561*^9, {
   3.8616118445598507`*^9, 3.8616118568874235`*^9}, {3.861611958544757*^9, 
   3.8616120283656197`*^9}, 3.8616120602630033`*^9, 3.861612488094775*^9, {
   3.861613363678261*^9, 3.861613389167039*^9}, 3.8616139708538475`*^9, 
   3.8616160044280405`*^9, {3.8616165973715754`*^9, 3.861616603844265*^9}, {
   3.861616888331196*^9, 3.861616897341014*^9}, {3.8616973389241433`*^9, 
   3.8616973468373055`*^9}, {3.8616983455155506`*^9, 
   3.8616983495393896`*^9}, {3.861699442148202*^9, 3.8616995032018137`*^9}, {
   3.8616995419558544`*^9, 3.861699551978117*^9}, {3.861779384554803*^9, 
   3.8617794064423323`*^9}, {3.861779468562846*^9, 3.86177951588188*^9}, {
   3.861779965635108*^9, 3.8617799894361525`*^9}, 3.861780894729497*^9, 
   3.8617814560331964`*^9, {3.8617818307800317`*^9, 3.8617818426514254`*^9}, {
   3.8617818986090775`*^9, 3.861781904041288*^9}, {3.8617829785440207`*^9, 
   3.861782979078599*^9}, {3.8624157114939003`*^9, 3.8624157127058735`*^9}, {
   3.8624683776496844`*^9, 3.8624683902806273`*^9}, {3.8624770111378083`*^9, 
   3.862477022354687*^9}, {3.8624770660900264`*^9, 3.8624770706737566`*^9}, {
   3.8624798191543303`*^9, 3.8624798234423423`*^9}, {3.862481166094321*^9, 
   3.862481170653762*^9}, {3.8624903672286725`*^9, 3.862490375435508*^9}, {
   3.8624907747505307`*^9, 3.8624908560543957`*^9}, {3.8624914982841387`*^9, 
   3.8624915544446115`*^9}, 3.8625024122476344`*^9, {3.862502908313693*^9, 
   3.8625029094242296`*^9}, {3.86250369595428*^9, 3.862503738386204*^9}, {
   3.862504126798716*^9, 3.8625041516880484`*^9}, {3.8625963217031918`*^9, 
   3.8625963358714905`*^9}, {3.8625987949261265`*^9, 
   3.8625987996730723`*^9}, {3.8625990259346943`*^9, 
   3.8625990292780075`*^9}, {3.8625991956310663`*^9, 3.862599244317747*^9}, {
   3.8625993169108667`*^9, 3.862599320385252*^9}, {3.8626280559093466`*^9, 
   3.8626280773173246`*^9}, {3.862628824332615*^9, 3.862628831588993*^9}, {
   3.862656665027861*^9, 3.862656697771681*^9}, {3.8626752001817102`*^9, 
   3.862675218382659*^9}, {3.8627539647328672`*^9, 3.862753981268731*^9}, {
   3.862773978321623*^9, 3.8627739904725504`*^9}, 3.862775320105667*^9, {
   3.862775418520928*^9, 3.862775448001234*^9}, {3.862775606420057*^9, 
   3.862775729273975*^9}},
 CellLabel->
  "In[4619]:=",ExpressionUUID->"56c88cb6-310c-4279-8b63-f1b0e0908944"],

Cell[BoxData[
 RowBox[{"plotAssembledPlumes", "=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ImagePad", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
           RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ImageDifference", "[", "\[IndentingNewLine]", 
              RowBox[{"testBulkLiquidMask", ",", 
               RowBox[{"liquidMaskFilledCavities", "[", 
                RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "]"}], ",", "#"}], "\[IndentingNewLine]", "]"}]}], "&"}], "@", 
         RowBox[{"Closing", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "[", 
            RowBox[{"plumeOpeningScale", "/", "2"}], "]"}]}], "]"}]}], "&"}], 
       "@", 
       RowBox[{"Opening", "[", 
        RowBox[{"#", ",", 
         RowBox[{"DiskMatrix", "@", "plumeOpeningScale"}]}], "]"}]}], "&"}], 
     "@", 
     RowBox[{
     "ImageSubtract", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageAdd", "@@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Binarize", "[", 
              RowBox[{"#", ",", "0.999"}], "]"}], "&"}], "/@", 
            RowBox[{"ImageAdjust", "/@", 
             RowBox[{"orderedPlumeLevelSets", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], "&"}], "/@", 
          RowBox[{"Range", "@", "maxLevelSetOrder"}]}], "\[IndentingNewLine]",
          ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ColorNegate", "@", "inflatedLiquidMask"}]}], 
      "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"EdgeDetect", "@", "#"}], ",", "Red"}], "]"}], "&"}], "@", 
       "inflatedLiquidMask"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"EdgeDetect", "@", "#"}], ",", "Orange"}], "]"}], "&"}], 
       "@", "testBulkLiquidMask"}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8384896152423763`*^9, 3.838489674705859*^9}, {
   3.838705373925741*^9, 3.8387053753539567`*^9}, {3.8387172082857275`*^9, 
   3.8387172106773663`*^9}, {3.8387178363903627`*^9, 3.83871784059739*^9}, {
   3.842873230761101*^9, 3.8428733158836184`*^9}, {3.842873351553239*^9, 
   3.842873388848564*^9}, {3.842873459088698*^9, 3.8428734904497585`*^9}, {
   3.8428736046486373`*^9, 3.8428736122915087`*^9}, {3.842873644616494*^9, 
   3.842873655120267*^9}, {3.842873838928465*^9, 3.842873840407511*^9}, {
   3.842873994056404*^9, 3.84287400555965*^9}, 3.842937140012575*^9, 
   3.8429372612919617`*^9, {3.8429374492839622`*^9, 3.8429374599960194`*^9}, {
   3.842937515060215*^9, 3.8429375152756386`*^9}, {3.8429624307023497`*^9, 
   3.8429624351095676`*^9}, {3.847967282590412*^9, 3.8479673030786223`*^9}, {
   3.847967344808195*^9, 3.8479673799252877`*^9}, {3.8479674223508368`*^9, 
   3.8479674378943014`*^9}, 3.847967500207637*^9, {3.847967962262718*^9, 
   3.847968009561141*^9}, {3.861471904243915*^9, 3.8614719209064217`*^9}, {
   3.8614719822810354`*^9, 3.8614720129282627`*^9}, {3.8614722478655148`*^9, 
   3.8614722721435604`*^9}, 3.861472389487668*^9, {3.861548474178276*^9, 
   3.8615484918830037`*^9}, {3.861548525681287*^9, 3.861548529913933*^9}, {
   3.861609140026203*^9, 3.861609174523955*^9}, {3.861611402912578*^9, 
   3.8616114039782677`*^9}, {3.86161199807257*^9, 3.8616120254870214`*^9}, {
   3.8626752016056457`*^9, 3.8626752027338233`*^9}},
 CellLabel->
  "In[4621]:=",ExpressionUUID->"0c5717a1-7c0d-4228-9c6f-f1e93e921f3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outputFrameResults", "<>", "\"\<26_plumes_assembled_1.jpg\>\""}],
     ",", "\[IndentingNewLine]", "plotAssembledPlumes", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.838298521271592*^9, 3.8382985819041224`*^9}, {
   3.838298764297079*^9, 3.8382987710161147`*^9}, {3.838306084306588*^9, 
   3.838306085349799*^9}, {3.838441988439225*^9, 3.838442019311427*^9}, {
   3.8384570716307487`*^9, 3.8384570725502152`*^9}, {3.8384571791344643`*^9, 
   3.8384572030460463`*^9}, {3.8384595237199335`*^9, 
   3.8384595246231527`*^9}, {3.8384596841685886`*^9, 
   3.8384597441911736`*^9}, {3.8384601401047993`*^9, 3.838460162655574*^9}, {
   3.838486735505742*^9, 3.8384867440793705`*^9}, {3.8384871947008843`*^9, 
   3.838487205238919*^9}, {3.8384872619763947`*^9, 3.8384872620472045`*^9}, {
   3.8384881688330364`*^9, 3.8384882115674877`*^9}, {3.8384884298402443`*^9, 
   3.838488430832757*^9}, {3.838488473640877*^9, 3.83848847957549*^9}, {
   3.8384892837446637`*^9, 3.8384892946483355`*^9}, {3.838489689161438*^9, 
   3.838489739609355*^9}, {3.8387053942417955`*^9, 3.838705405153627*^9}, {
   3.8387054565945263`*^9, 3.838705456649352*^9}, 3.838705511682433*^9, {
   3.8387132469002514`*^9, 3.838713286356772*^9}, {3.8387171203742647`*^9, 
   3.8387171204450755`*^9}, {3.838717246549806*^9, 3.8387172529166746`*^9}, 
   3.8387173834934845`*^9, {3.8387178449986405`*^9, 3.838717867797312*^9}, {
   3.838717912469886*^9, 3.8387179125250835`*^9}, {3.838717968167202*^9, 
   3.8387179890623074`*^9}, {3.8387824856926036`*^9, 3.838782512010504*^9}, {
   3.83878283799496*^9, 3.8387828579628096`*^9}, {3.8387835520753245`*^9, 
   3.8387836143159046`*^9}, {3.838784766043866*^9, 3.838784810707071*^9}, {
   3.838785369476024*^9, 3.8387854248597445`*^9}, {3.8388059586271453`*^9, 
   3.8388059943936567`*^9}, {3.8388130551565747`*^9, 
   3.8388130552194076`*^9}, {3.8388131970043306`*^9, 3.8388131970671625`*^9}, 
   3.838813250724283*^9, {3.838813637524866*^9, 3.838813658507455*^9}, {
   3.8388136948756742`*^9, 3.838813694947482*^9}, {3.8388151779964314`*^9, 
   3.8388151823646383`*^9}, {3.8388170895650005`*^9, 3.838817114348771*^9}, {
   3.8388179619572277`*^9, 3.838817965212847*^9}, {3.8388181009494543`*^9, 
   3.838818103869809*^9}, {3.8388204068542285`*^9, 3.8388204368534155`*^9}, {
   3.8480631937580605`*^9, 3.848063194549201*^9}, 3.861468373442581*^9, {
   3.8615513613302584`*^9, 3.861551368167571*^9}, {3.8616994867415533`*^9, 
   3.8616994894750032`*^9}, {3.861779495514266*^9, 3.861779500226611*^9}, {
   3.8617799972418985`*^9, 3.8617799998638096`*^9}, {3.862503730519248*^9, 
   3.862503741081813*^9}, {3.862599236822398*^9, 3.8625992407496457`*^9}, {
   3.862628071501663*^9, 3.8626280743331194`*^9}, 3.862628819966526*^9, {
   3.8627753788587294`*^9, 3.8627754154409733`*^9}, {3.8627756488170214`*^9, 
   3.8627757119084525`*^9}},
 CellLabel->
  "In[4622]:=",ExpressionUUID->"6c350752-353e-4b2e-97f2-215b73fdf3c7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate a Report", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 
  3.8429691537910447`*^9}},ExpressionUUID->"5fd1f7a3-8aba-4c1a-abbf-\
29600889f60a"],

Cell["Output text files with filter settings (non-default only?)", "Subitem",
 CellChangeTimes->{{3.8215428902446327`*^9, 3.8215429092917013`*^9}, {
   3.821543019999116*^9, 3.821543055134698*^9}, {3.821543108413828*^9, 
   3.82154310858138*^9}, 3.8215435373886523`*^9, {3.821543586804587*^9, 
   3.821543595004086*^9}, {3.821552325940542*^9, 3.8215523722177296`*^9}, {
   3.8215571746165543`*^9, 3.8215571838568335`*^9}, {3.8215962804132195`*^9, 
   3.821596310588499*^9}, {3.821628482941619*^9, 3.821628520128134*^9}, {
   3.8223951717372007`*^9, 3.822395209954018*^9}, {3.822420655055955*^9, 
   3.8224206766429777`*^9}, {3.828683791164585*^9, 3.8286838005880375`*^9}, {
   3.8376051147289844`*^9, 3.8376051299413137`*^9}, {3.8376055257819567`*^9, 
   3.837605601745866*^9}, {3.838273984166917*^9, 3.838273984166917*^9}, {
   3.838354144260075*^9, 3.838354153707817*^9}, {3.8421814225497365`*^9, 
   3.8421816063522367`*^9}, {3.8431902013064957`*^9, 3.8431902172269325`*^9}},
 FontSize->18,ExpressionUUID->"489bde9e-995a-4989-b945-9722eae613fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pasteReportContents", "[", "indices_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Paste", "[", 
       RowBox[{"report", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"reportContents", "[", 
      RowBox[{"[", "indices", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pagebreakReport", ":=", 
   RowBox[{"NotebookWrite", "[", "\[IndentingNewLine]", 
    RowBox[{"report", ",", 
     RowBox[{"Cell", "[", 
      RowBox[{"\"\<\>\"", ",", "\"\<PageBreak\>\"", ",", 
       RowBox[{"PageBreakBelow", "\[Rule]", "True"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rasterize", "[", "image_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Rasterize", "[", 
     RowBox[{"image", ",", 
      RowBox[{"RasterSize", "\[Rule]", "exportRasterSize"}]}], "]"}], "&"}], 
   "@", "image"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imageResize", "[", "image_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Image", "[", 
     RowBox[{"#", ",", 
      RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], "]"}], "&"}], "@", 
   "image"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imageResizeSecondary", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Image", "[", 
      RowBox[{"#", ",", 
       RowBox[{"ImageSize", "\[Rule]", "imageSizeSecondary"}]}], "]"}], "&"}],
     "@", "image"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkForMissingExportData", "[", "data_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListQ", "@", "secondPassGrainMasks"}], "\[Equal]", "False"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Rasterize", "@", "\"\<N/A\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"imageResize", "@", 
     RowBox[{"rasterize", "@", "data"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.842874791673894*^9, 3.8428748299276223`*^9}, {
   3.842875095975755*^9, 3.842875135935442*^9}, 3.8429611956528406`*^9, {
   3.842961445829194*^9, 3.8429616290300255`*^9}, {3.842961788404787*^9, 
   3.842961791388809*^9}, {3.8429618258712626`*^9, 3.8429618463649898`*^9}, {
   3.8429638156869144`*^9, 3.8429638233733654`*^9}, {3.842966605711975*^9, 
   3.842966661838925*^9}, {3.842966749048219*^9, 3.8429668152230053`*^9}, {
   3.8429668528397512`*^9, 3.842966853881965*^9}, {3.842966896911442*^9, 
   3.8429669270951843`*^9}, {3.842967335991691*^9, 3.8429673413354063`*^9}, {
   3.8429690112569885`*^9, 3.8429690490634317`*^9}, {3.8430131607040377`*^9, 
   3.843013161418126*^9}, {3.8430138682800784`*^9, 3.8430138875266495`*^9}, {
   3.8430144285364103`*^9, 3.8430144293060255`*^9}, {3.8430144774730053`*^9, 
   3.8430144776545177`*^9}, {3.8430346388469353`*^9, 3.843034639720599*^9}, {
   3.8430367027605495`*^9, 3.843036719175277*^9}, {3.8430371648244333`*^9, 
   3.8430371834877625`*^9}, {3.8430390361941905`*^9, 3.843039036233086*^9}, {
   3.8430423593250637`*^9, 3.8430423777632217`*^9}, {3.843043353476797*^9, 
   3.8430433547493443`*^9}, {3.8430433897331924`*^9, 
   3.8430434082524157`*^9}, {3.8430463099505343`*^9, 
   3.8430463101898947`*^9}, {3.8430471757594404`*^9, 3.843047194886298*^9}, {
   3.8430490663691645`*^9, 3.8430490757224455`*^9}, {3.846857627706783*^9, 
   3.846857634778185*^9}, {3.848064907597369*^9, 3.84806491388558*^9}, {
   3.8615448015796747`*^9, 3.8615448022538815`*^9}, 3.861548682346413*^9, 
   3.861549121688621*^9},
 CellLabel->
  "In[4623]:=",ExpressionUUID->"3825adbd-27b8-46fb-a4b8-2746abe76d8c"],

Cell["\<\
Defaults:

polarTicksFont=11;
polarOverlayScale=0.7;

exportRasterSize=2600;
imageSize=Automatic;
imageSizeSecondary=450;\
\>", "Abstract",
 CellChangeTimes->{{3.8242342452581434`*^9, 3.824234278455249*^9}, {
   3.8242343343233957`*^9, 3.824234354992875*^9}, {3.8242343890840216`*^9, 
   3.824234408999221*^9}, {3.8375097871659794`*^9, 3.8375098028620157`*^9}, {
   3.837509860682429*^9, 3.8375098967420273`*^9}, {3.837577863481824*^9, 
   3.83757786720986*^9}, 3.837588138351656*^9, {3.838190300737477*^9, 
   3.838190301079091*^9}, {3.838273407161825*^9, 3.838273407513884*^9}, 
   3.8428730079361486`*^9, 3.842969165978463*^9, {3.843014995526453*^9, 
   3.843014996582479*^9}, {3.8614733120080395`*^9, 3.8614733122095118`*^9}},
 FontSize->16,ExpressionUUID->"c85040e2-791d-42e2-a32d-e9e0e5162428"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ListQ", "@", "secondPassGrainMasks"}], "\[Equal]", "False"}], 
     ",", "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
     "exportGrainStatsTable"}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", "output"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarTicksFont", "=", "11"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"polarOverlayScale", "=", "0.45"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"exportRasterSize", "=", "2600"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"imageSize", "=", "Automatic"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imageSizeSecondary", "=", "450"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.842874791673894*^9, 3.8428748299276223`*^9}, {
   3.842875095975755*^9, 3.842875135935442*^9}, 3.8429611956528406`*^9, {
   3.842961445829194*^9, 3.8429616290300255`*^9}, {3.842961788404787*^9, 
   3.842961791388809*^9}, {3.8429618258712626`*^9, 3.8429618463649898`*^9}, {
   3.8429638156869144`*^9, 3.8429638233733654`*^9}, {3.842966605711975*^9, 
   3.842966661838925*^9}, {3.842966749048219*^9, 3.8429668152230053`*^9}, {
   3.8429668528397512`*^9, 3.842966853881965*^9}, {3.842966896911442*^9, 
   3.8429669270951843`*^9}, {3.842967335991691*^9, 3.8429673413354063`*^9}, {
   3.8429690112569885`*^9, 3.8429690490634317`*^9}, {3.8430131607040377`*^9, 
   3.843013161418126*^9}, {3.8430138682800784`*^9, 3.8430138875266495`*^9}, {
   3.8430144285364103`*^9, 3.8430144293060255`*^9}, {3.8430144774730053`*^9, 
   3.8430144776545177`*^9}, {3.8430346388469353`*^9, 3.843034639720599*^9}, {
   3.8430367027605495`*^9, 3.843036719175277*^9}, {3.8430371648244333`*^9, 
   3.8430371834877625`*^9}, {3.8430390361941905`*^9, 3.843039036233086*^9}, {
   3.8430423593250637`*^9, 3.8430423777632217`*^9}, {3.843043353476797*^9, 
   3.8430433547493443`*^9}, {3.8430433897331924`*^9, 
   3.8430434082524157`*^9}, {3.8430463099505343`*^9, 
   3.8430463101898947`*^9}, {3.8430471757594404`*^9, 3.843047194886298*^9}, {
   3.8430490663691645`*^9, 3.8430490757224455`*^9}, {3.846857627706783*^9, 
   3.846857641330093*^9}, {3.8480635923413463`*^9, 3.848063616637483*^9}, {
   3.8480648745726795`*^9, 3.84806488513246*^9}, {3.8480649493258233`*^9, 
   3.8480649788372774`*^9}, {3.861469279227439*^9, 3.861469281688792*^9}, {
   3.8614693466968937`*^9, 3.861469347001082*^9}, {3.8615444258134284`*^9, 
   3.861544431806323*^9}, {3.861548628475458*^9, 3.861548639900877*^9}, {
   3.8616131521818395`*^9, 3.861613165093253*^9}},
 CellLabel->
  "In[4629]:=",ExpressionUUID->"e35e43bb-06fb-4ba2-b4df-b652d57183b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getStatsImage", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"outputFrameResults", "<>", "\"\<22_grain_stats.jpg\>\""}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reportContents", "=", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"imageResize", "@", 
       RowBox[{"Colorize", "@", "testFrame"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"imageResize", "@", 
       RowBox[{"rasterize", "@", "plotSelectedMask"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"imageResize", "@", 
       RowBox[{"rasterize", "@", "plotReconstructedMap"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "plotSkeletonOrientationSpectrum", ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"checkDFT", "@", "cleanAssembledSkeleton"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "checkForMissingExportData", "@", 
       "plotGrainDecompositionAreaOverlays"}], ",", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{
      "checkForMissingExportData", "@", "plotGrainDecompositionNoCavities"}], 
      ",", "\n", "\[IndentingNewLine]", 
      RowBox[{"imageResize", "@", 
       RowBox[{"rasterize", "@", "plotReconstructedMap"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "checkForMissingExportData", "@", "plotGrainDecompositionOverlay"}], 
      ",", "\n", "\[IndentingNewLine]", 
      RowBox[{
      "checkForMissingExportData", "@", 
       "plotGrainDecompositionAreaOverlays"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"checkForMissingExportData", "@", "getStatsImage"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "@", "secondPassGrainMasks"}], "\[Equal]", "True"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageCollage", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"Background", "\[Rule]", "None"}], ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Grid\>\""}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], "@", 
         "grainOrientationSpectra"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Binarize", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "getStatsImage"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"imageResize", "@", "plotPlumes"}], ",", "\[IndentingNewLine]", 
      "plotDecomposedPlumes", ",", "\[IndentingNewLine]", 
      RowBox[{"imageResize", "@", "plotAssembledPlumes"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rasterize", "@", "plotSelectedFrontStates"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rasterize", "@", "plotFrontHeightMatrix"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"imageResizeSecondary", "@", 
       RowBox[{"rasterize", "@", "plotFrontHeightDynamics"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rasterize", "@", "plotFrontDisplacementMatrix"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"imageResizeSecondary", "@", 
       RowBox[{"rasterize", "@", "plotFrontDisplacementDynamics"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rasterize", "@", "plotFrontConcentrationMatrix"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"report", "=", 
    RowBox[{"CreateDocument", "[", "\[IndentingNewLine]", 
     RowBox[{"Null", ",", 
      RowBox[{"PageHeaders", "\[Rule]", "Automatic"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pasteReportContents", "[", 
   RowBox[{"1", ";;", "9"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pagebreakReport", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pasteReportContents", "[", 
   RowBox[{"10", ";;", "12"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pagebreakReport", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pasteReportContents", "[", 
   RowBox[{"13", ";;", "15"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pagebreakReport", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pasteReportContents", "[", 
   RowBox[{"16", ";;", "18"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pagebreakReport", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pasteReportContents", "[", 
    RowBox[{"19", ";;", "21"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"outputFrameResults", "<>", "\"\<Experiment_\>\"", "<>", 
         RowBox[{"Last", "@", 
          RowBox[{"StringSplit", "@", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"#", ",", 
             RowBox[{"$PathnameSeparator", "\[Rule]", "\"\< \>\""}]}], 
            "]"}]}]}]}], "&"}], "@", "\[IndentingNewLine]", "imageFolder"}], 
      "<>", "\"\<_Frame_\>\"", "<>", 
      RowBox[{"ToString", "@", "testID"}], "<>", "\"\<.pdf\>\""}], ",", 
     "report"}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookClose", "@", "report"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "@", "report"}], ";"}]}], "Input",
 CellChangeTimes->{{3.842874791673894*^9, 3.8428748299276223`*^9}, {
   3.842875095975755*^9, 3.842875135935442*^9}, 3.8429611956528406`*^9, {
   3.842961445829194*^9, 3.8429616290300255`*^9}, {3.842961788404787*^9, 
   3.842961791388809*^9}, {3.8429618258712626`*^9, 3.842961848885252*^9}, {
   3.842961889021951*^9, 3.842961889597412*^9}, {3.8429621729969673`*^9, 
   3.842962183030305*^9}, {3.842962326109062*^9, 3.842962331845726*^9}, 
   3.8429624666457925`*^9, {3.842963291509452*^9, 3.842963325190175*^9}, {
   3.8429654357608*^9, 3.8429654802259274`*^9}, {3.8429655331130824`*^9, 
   3.842965535214464*^9}, {3.8429657477603703`*^9, 3.842965761934477*^9}, 
   3.842966591728554*^9, {3.8429666243940325`*^9, 3.84296662795152*^9}, {
   3.8429666665952115`*^9, 3.8429667262240634`*^9}, {3.8429668028251343`*^9, 
   3.842966833542832*^9}, {3.8429668769453487`*^9, 3.842966884607864*^9}, {
   3.8429669448103037`*^9, 3.84296697423176*^9}, {3.842967013992691*^9, 
   3.842967019527894*^9}, {3.8429680578417063`*^9, 3.8429680756959743`*^9}, {
   3.848063448565595*^9, 3.8480634499893713`*^9}, 3.848063489599141*^9, {
   3.848063653918249*^9, 3.8480636540608377`*^9}, {3.848063767142649*^9, 
   3.8480637782709208`*^9}, {3.8480638522470922`*^9, 3.84806385544554*^9}, {
   3.8480638954474554`*^9, 3.8480638987416162`*^9}, 3.8480639341985292`*^9, {
   3.8480639677348185`*^9, 3.848064026823269*^9}, {3.8480640569668865`*^9, 
   3.8480640575084066`*^9}, {3.848064240261343*^9, 3.848064299757125*^9}, {
   3.84806433909673*^9, 3.848064345772876*^9}, {3.8480644059494295`*^9, 
   3.8480644126694307`*^9}, {3.848064462655018*^9, 3.8480645028850784`*^9}, {
   3.848064566557413*^9, 3.8480646655092382`*^9}, {3.848064706295213*^9, 
   3.848064706949463*^9}, {3.8480647378783026`*^9, 3.8480647540221624`*^9}, {
   3.848064786861947*^9, 3.8480647966528606`*^9}, {3.8480648379659443`*^9, 
   3.8480648407415233`*^9}, {3.8480649191894093`*^9, 3.848064923685357*^9}, 
   3.8614680244445276`*^9, 3.8614683816341767`*^9, 3.8614688208645144`*^9, {
   3.8614690667475386`*^9, 3.8614690676421385`*^9}, {3.8614691240181227`*^9, 
   3.8614691416010942`*^9}, {3.86146938254459*^9, 3.861469384017655*^9}, 
   3.861469425042423*^9, {3.8615442360072656`*^9, 3.8615442804290333`*^9}, {
   3.8615443190858088`*^9, 3.8615443235653076`*^9}, {3.861544381317789*^9, 
   3.861544397180558*^9}, {3.8615444785263343`*^9, 3.8615444977171516`*^9}, {
   3.8615445618768396`*^9, 3.8615445684283323`*^9}, {3.8615446049886513`*^9, 
   3.8615446338534493`*^9}, {3.8615447248945646`*^9, 3.861544782219957*^9}, {
   3.8615490959703817`*^9, 3.861549100465933*^9}, {3.861549137081031*^9, 
   3.8615491442326*^9}, {3.861549945992272*^9, 3.8615499492635236`*^9}, {
   3.8615500637767973`*^9, 3.861550065767445*^9}, {3.8615514289691706`*^9, 
   3.861551436573825*^9}, {3.8615515063917294`*^9, 3.861551506798583*^9}, {
   3.8616071590205903`*^9, 3.8616071608108635`*^9}, {3.8616131666252637`*^9, 
   3.8616131862238226`*^9}, 3.8624057751008377`*^9, 3.8624060059104223`*^9},
 CellLabel->
  "In[4636]:=",ExpressionUUID->"a31bab7e-df6d-4e23-a0ef-d5f14b523b12"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}},ExpressionUUID->"cf9b23cc-b6a6-431b-a6db-\
43e8efc0588d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"outputFrameResults", "<>", 
        RowBox[{"Last", "@", 
         RowBox[{"StringSplit", "[", 
          RowBox[{"#", ",", "$PathnameSeparator"}], "]"}]}]}], "&"}], "@", 
      "imageFolder"}], "<>", "\"\<_Frame_\>\"", "<>", 
     RowBox[{"ToString", "@", "testID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "\[IndentingNewLine]", "notebookSnapshot"}], "\[IndentingNewLine]", "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
  3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
  3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}},
 CellLabel->
  "In[4651]:=",ExpressionUUID->"d6f7da97-2e1f-43cb-be75-e4f3fc4a75c6"]
}, Open  ]]
},
WindowSize->{864., 1473.6},
WindowMargins->{{Automatic, -869.4000000000001}, {
  Automatic, -277.79999999999995`}},
TaggingRules->{"TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>0.9 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2dc84488-0e07-4c24-b4d5-05aabde3e87a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 131, 1, 25, "Input",ExpressionUUID->"45096047-8b69-47e7-9329-51d19bb0fc31"],
Cell[CellGroupData[{
Cell[714, 25, 539, 8, 59, "Section",ExpressionUUID->"2a45afa4-01f0-4d8b-870f-5ae3f8e134f4"],
Cell[1256, 35, 13291, 314, 2024, "Input",ExpressionUUID->"884cb88d-eb1f-4064-847e-add6faa523fc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14572, 353, 731, 9, 29, "Subitem",ExpressionUUID->"cf721f86-9762-4d2d-b0b1-0300ad0a92d5"],
Cell[15306, 364, 736, 9, 29, "Subitem",ExpressionUUID->"f6df6450-99d5-424f-8ed2-f29d0ecee839"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[16091, 379, 516, 8, 47, "Section",ExpressionUUID->"06a2365c-27b9-4856-8b6c-bf063a96d9ee"],
Cell[16610, 389, 1262, 28, 428, "Abstract",ExpressionUUID->"846099f5-e39f-491d-812f-5db230832caf"],
Cell[17875, 419, 6150, 108, 403, "Input",ExpressionUUID->"a8d5aaff-3a3a-4da0-8bf2-2806a0ee5587",
 InitializationCell->True],
Cell[24028, 529, 1012, 22, 147, "Input",ExpressionUUID->"71807184-3659-4b8e-923f-fe071caa0852"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25077, 556, 517, 8, 59, "Section",ExpressionUUID->"cd6a4491-20b7-468c-bded-69856ee6320d"],
Cell[CellGroupData[{
Cell[25619, 568, 182, 3, 48, "Subsection",ExpressionUUID->"10397ac2-609f-4642-ae9e-abbcc93d760e"],
Cell[25804, 573, 63051, 1470, 10442, "Input",ExpressionUUID->"26de3251-6e55-4209-95d2-c201d3f43658",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[88892, 2048, 490, 7, 34, "Subsection",ExpressionUUID->"ca0d425a-2a02-48db-a81a-d2184c3ee937"],
Cell[89385, 2057, 54436, 1245, 9718, "Input",ExpressionUUID->"f9e0f5d6-56ac-429c-ad75-9d4211a0e0a2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[143858, 3307, 507, 8, 34, "Subsection",ExpressionUUID->"6934529c-6d52-4e0f-acb2-2d1e5f174132"],
Cell[144368, 3317, 46629, 1062, 7337, "Input",ExpressionUUID->"ed36012d-dae3-44ee-9a0c-60eac11ed6bf",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[191046, 4385, 546, 8, 59, "Section",ExpressionUUID->"29ce30ae-a8ef-4ded-a58f-05ece2d801d9"],
Cell[191595, 4395, 737, 13, 314, "Abstract",ExpressionUUID->"d6a4f8fb-2eba-413b-b3ed-7c3915bff00b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[192357, 4412, 564, 8, 48, "Subsection",ExpressionUUID->"c2f71013-d1ab-4e3f-a187-ebee1a2e2579"],
Cell[192924, 4422, 1152, 27, 130, "Input",ExpressionUUID->"0b5153a8-c262-4945-adf9-28306fdba200"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194113, 4454, 606, 9, 48, "Subsection",ExpressionUUID->"b163eb5b-731a-4998-b829-3cbfc08644c9"],
Cell[194722, 4465, 1681, 50, 43, "Input",ExpressionUUID->"b4cb70dd-eca5-4062-bdaf-e9c0a8a8b70a"],
Cell[196406, 4517, 241, 3, 78, "Abstract",ExpressionUUID->"8ae5273f-f9eb-451f-a4f2-29b55e7c152e"],
Cell[196650, 4522, 1681, 50, 43, "Input",ExpressionUUID->"689660c6-74d1-4a0b-90e1-a64282a7951b"],
Cell[198334, 4574, 544, 13, 78, "Input",ExpressionUUID->"33a2e045-a731-468d-953b-4cc9a23abf49"],
Cell[CellGroupData[{
Cell[198903, 4591, 171, 3, 41, "Subsubsection",ExpressionUUID->"9881c276-4835-420b-a26b-1365c06911f8"],
Cell[199077, 4596, 733, 17, 216, "Abstract",ExpressionUUID->"734a88b1-7384-4a34-abfa-64126f0f971e",
 InitializationCell->True],
Cell[199813, 4615, 2097, 48, 316, "Input",ExpressionUUID->"edaf2fd6-053d-4a7f-ba0d-7822437056e5",
 InitializationCell->True],
Cell[201913, 4665, 726, 16, 194, "Abstract",ExpressionUUID->"78add57e-bd1e-4aa6-9b5f-08d9677204cb",
 InitializationCell->True],
Cell[202642, 4683, 2047, 46, 299, "Input",ExpressionUUID->"b714146f-d7de-4ef9-ae3b-c2113f072c61",
 InitializationCell->True],
Cell[204692, 4731, 909, 20, 262, "Abstract",ExpressionUUID->"7e72b7d3-00c8-422e-91ce-85fd85f17952",
 InitializationCell->True],
Cell[205604, 4753, 3008, 69, 334, "Input",ExpressionUUID->"83bc5391-5531-411c-ad24-c808e2ed04f2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[208649, 4827, 171, 3, 41, "Subsubsection",ExpressionUUID->"c88b5056-d5b2-46af-8cb6-3ab7ae51b65a"],
Cell[208823, 4832, 822, 18, 78, "Input",ExpressionUUID->"0a4cff3f-3c3b-4d4e-8bab-781d5a9181b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209682, 4855, 222, 4, 41, "Subsubsection",ExpressionUUID->"17687c91-6e1a-4ee7-83f3-ea2d38cd6383"],
Cell[209907, 4861, 1672, 40, 247, "Input",ExpressionUUID->"57cd93a8-8004-4a87-b174-4a8091ddf8cc",
 InitializationCell->True],
Cell[211582, 4903, 1054, 29, 161, "Input",ExpressionUUID->"334d749e-b32f-40e1-a029-90c9407b7c7b",
 InitializationCell->True],
Cell[212639, 4934, 2319, 46, 233, "Input",ExpressionUUID->"49d58532-bab9-450e-8c01-f29c5ede45ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214995, 4985, 179, 3, 41, "Subsubsection",ExpressionUUID->"235ff05b-f4c6-49fa-a8b8-7ad6a28412eb"],
Cell[215177, 4990, 290, 7, 39, "Input",ExpressionUUID->"8cf2e0a7-0048-4ac2-a364-2046a2ee6cf5",
 InitializationCell->True],
Cell[215470, 4999, 1932, 43, 233, "Input",ExpressionUUID->"cec27e6b-d65d-428d-8fb8-560d0493312e"],
Cell[217405, 5044, 808, 18, 130, "Input",ExpressionUUID->"d88e68e7-80cf-4b9d-8ed5-4e06ace93e29"],
Cell[218216, 5064, 1369, 31, 216, "Input",ExpressionUUID->"13b32005-e771-4a9d-b915-657a8f7a3a35"],
Cell[219588, 5097, 1681, 50, 43, "Input",ExpressionUUID->"8f3b3360-c332-4f80-b677-e709e3e6578e"],
Cell[221272, 5149, 351, 5, 78, "Abstract",ExpressionUUID->"543817a2-bbca-462a-a3f5-f9d1df52ca4b"],
Cell[221626, 5156, 1681, 50, 43, "Input",ExpressionUUID->"6d0e9ce8-77a3-4199-8aac-513c624b10ee"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[223356, 5212, 530, 8, 34, "Subsection",ExpressionUUID->"d7e4caf2-faa4-4a79-8252-82acdcceacb3"],
Cell[223889, 5222, 810, 15, 291, "Abstract",ExpressionUUID->"e8c91915-5474-4d03-a225-050d5f5681f0",
 InitializationCell->True],
Cell[224702, 5239, 723, 13, 58, "Input",ExpressionUUID->"3ed04c8f-016d-44e2-85eb-a94a1959e8f1",
 InitializationCell->True],
Cell[225428, 5254, 1204, 27, 61, "Input",ExpressionUUID->"3be85202-cec4-4eec-b672-d2da5e686504"],
Cell[226635, 5283, 937, 20, 78, "Input",ExpressionUUID->"1a8effe5-843c-457f-8124-3c593ba3ad00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227609, 5308, 530, 8, 48, "Subsection",ExpressionUUID->"f98aa120-7a94-48ba-bc49-7921d28e9267"],
Cell[228142, 5318, 2334, 43, 112, "Input",ExpressionUUID->"315b714d-5d03-46ea-be20-b2142f33aca6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230513, 5366, 693, 10, 48, "Subsection",ExpressionUUID->"01a09ac3-ccce-4bed-ac61-11da90f560d6"],
Cell[231209, 5378, 376, 9, 103, "Abstract",ExpressionUUID->"c1286c78-a933-4112-aafa-1d6480e41180",
 InitializationCell->True],
Cell[231588, 5389, 609, 11, 39, "Input",ExpressionUUID->"bdfc8a21-56c2-476e-9570-ff46645990f0",
 InitializationCell->True],
Cell[232200, 5402, 640, 11, 110, "Abstract",ExpressionUUID->"20e84f6a-1872-42a0-a1d6-e3bc2cbd3d79",
 InitializationCell->True],
Cell[232843, 5415, 1222, 27, 95, "Input",ExpressionUUID->"5831773f-7459-404f-b0e5-e5f19cf550d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234102, 5447, 731, 10, 48, "Subsection",ExpressionUUID->"09262507-4ae4-47d6-a816-f790577056fc"],
Cell[234836, 5459, 944, 28, 489, "Abstract",ExpressionUUID->"7c43d842-82fa-41c7-905d-3ae64924a050"],
Cell[235783, 5489, 3127, 51, 127, "Input",ExpressionUUID->"5116e97e-3591-4812-b8c7-6a94cbd44f0e",
 InitializationCell->True],
Cell[238913, 5542, 7083, 112, 147, "Input",ExpressionUUID->"2be48baf-9801-46d9-945e-0b0a469f2304"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246033, 5659, 846, 12, 48, "Subsection",ExpressionUUID->"eb21a759-9d82-4274-a7ff-4a5cbca9e503"],
Cell[246882, 5673, 691, 13, 78, "Input",ExpressionUUID->"eea0e5c5-8ad1-4693-901f-cfb45a3dc91f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247610, 5691, 780, 11, 48, "Subsection",ExpressionUUID->"dc5b14df-323a-4ab1-9283-e1024dbbb8b8"],
Cell[248393, 5704, 1326, 25, 92, "Input",ExpressionUUID->"cf67a536-0f0b-4283-82d8-b76664082487",
 InitializationCell->True],
Cell[249722, 5731, 258, 5, 43, "Input",ExpressionUUID->"616ecf20-6102-4110-a22b-b5beac904bb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250017, 5741, 835, 12, 48, "Subsection",ExpressionUUID->"fa9ffdb1-04da-4d84-8f12-ca73a67cb476"],
Cell[250855, 5755, 702, 14, 78, "Input",ExpressionUUID->"5d94345f-c956-4bda-9471-a1742ebac066"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251594, 5774, 744, 11, 48, "Subsection",ExpressionUUID->"9a8675f0-4ffa-4940-93e4-94c1eaee17c8"],
Cell[252341, 5787, 488, 14, 216, "Abstract",ExpressionUUID->"f5a24f1d-117a-4387-925c-966b370a2ad3"],
Cell[252832, 5803, 1987, 35, 127, "Input",ExpressionUUID->"e70df21a-49a3-49c0-b26f-0c71340d6fa6",
 InitializationCell->True],
Cell[254822, 5840, 3070, 52, 233, "Input",ExpressionUUID->"2f31778c-e2a9-417b-90d5-8b25e26aaadd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[257941, 5898, 296, 5, 59, "Section",ExpressionUUID->"caadb55f-dcff-404c-98a9-34fa549a0251"],
Cell[258240, 5905, 671, 11, 155, "Abstract",ExpressionUUID->"5f01a689-899f-4f2d-b6c4-754c3a2b8431",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[258936, 5920, 249, 3, 52, "Subsection",ExpressionUUID->"f9e4fef7-8387-439a-a4eb-b62465154806"],
Cell[259188, 5925, 501, 10, 103, "Abstract",ExpressionUUID->"a29337f9-08d7-46d8-9f62-a1037aea11e6"],
Cell[259692, 5937, 939, 15, 39, "Input",ExpressionUUID->"04adbd70-d8eb-4c79-b40b-1e0aeecf4bb5",
 InitializationCell->True],
Cell[260634, 5954, 1213, 21, 25, "Input",ExpressionUUID->"06959fb2-f402-49af-9b8c-9e4ea254d256"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261884, 5980, 242, 3, 52, "Subsection",ExpressionUUID->"cce0578b-3f2b-44b7-88b6-7ece180f5c3e"],
Cell[262129, 5985, 763, 17, 194, "Abstract",ExpressionUUID->"a96c7ca9-cfa8-43fa-a047-2da8d1e25b93"],
Cell[262895, 6004, 2516, 46, 196, "Input",ExpressionUUID->"2f1df84f-1196-4191-88be-f63569f2aa71",
 InitializationCell->True],
Cell[265414, 6052, 939, 14, 25, "Input",ExpressionUUID->"c54990dd-ff35-4932-9a59-0cd5b04dae7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266390, 6071, 231, 3, 52, "Subsection",ExpressionUUID->"978af63b-2690-4320-882c-cf88e14169c1"],
Cell[266624, 6076, 754, 15, 78, "Input",ExpressionUUID->"d8746e27-acf4-4ab6-a3db-c334caf6c94e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267415, 6096, 304, 4, 52, "Subsection",ExpressionUUID->"a654ea2e-e7cc-430a-851c-b6140cb16881"],
Cell[267722, 6102, 945, 21, 239, "Abstract",ExpressionUUID->"8d538b2c-f02e-48a9-852c-d7a84f188efd",
 InitializationCell->True],
Cell[268670, 6125, 3715, 72, 247, "Input",ExpressionUUID->"1562329f-a763-44a9-a80e-8368a7d7bbb7",
 InitializationCell->True],
Cell[272388, 6199, 645, 14, 78, "Input",ExpressionUUID->"5196880a-26aa-4f76-9a02-42c321364a65"],
Cell[273036, 6215, 812, 15, 25, "Input",ExpressionUUID->"7d6d67f2-27cb-4bb2-99a3-ccf908522a51"],
Cell[273851, 6232, 796, 16, 78, "Input",ExpressionUUID->"c266a4a0-9fde-4ecc-a13a-821835931160"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274684, 6253, 325, 4, 52, "Subsection",ExpressionUUID->"5449dda7-ee6a-4f01-9df5-65dd4d4b5bf4"],
Cell[275012, 6259, 1313, 32, 161, "Input",ExpressionUUID->"51c0e3e4-8f56-4595-8335-6c096171a99f",
 InitializationCell->True],
Cell[276328, 6293, 799, 18, 239, "Abstract",ExpressionUUID->"e9728bda-4375-4268-84d8-2c13b094040b",
 InitializationCell->True],
Cell[277130, 6313, 632, 14, 92, "Input",ExpressionUUID->"eba34a3f-1a32-4306-9f20-e769e3c11291",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[277787, 6331, 406, 5, 45, "Subsubsection",ExpressionUUID->"ad6d2d07-f4ef-473a-b829-10c8b0f5e593"],
Cell[278196, 6338, 1904, 46, 147, "Input",ExpressionUUID->"8b1e7705-a4d3-4839-824e-17e3220475a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280137, 6389, 390, 5, 45, "Subsubsection",ExpressionUUID->"f9f3c547-d814-4334-bf29-bf12017e20ea"],
Cell[280530, 6396, 2683, 52, 216, "Input",ExpressionUUID->"6f151834-556c-421c-b9c5-09eee7746a71"],
Cell[283216, 6450, 584, 13, 78, "Input",ExpressionUUID->"1a22ec43-6718-48ce-b82c-d8f6d127b201"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[283849, 6469, 393, 5, 52, "Subsection",ExpressionUUID->"4b501789-d90a-4123-b403-0402328a81cd"],
Cell[284245, 6476, 2546, 63, 492, "Input",ExpressionUUID->"4952f92c-44af-42f8-b753-df0abec33af7"]
}, Closed]],
Cell[CellGroupData[{
Cell[286828, 6544, 496, 6, 38, "Subsection",ExpressionUUID->"dbe506f2-abf7-4f2d-87b7-5814948e0dce"],
Cell[287327, 6552, 566, 12, 58, "Input",ExpressionUUID->"8de68d07-98be-4bae-a43b-553af0ba7429",
 InitializationCell->True],
Cell[287896, 6566, 1846, 43, 371, "Input",ExpressionUUID->"6794502d-6119-4e76-a333-bec7b9744506"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289779, 6614, 448, 6, 52, "Subsection",ExpressionUUID->"d910264e-c0ca-4c3b-8405-e86661d94767"],
Cell[290230, 6622, 752, 14, 125, "Abstract",ExpressionUUID->"58aedc44-b644-413a-9fcf-2ba375c3fc45"],
Cell[290985, 6638, 421, 9, 58, "Input",ExpressionUUID->"7653c26c-6347-4e21-8b6f-d827e047aaab",
 InitializationCell->True],
Cell[291409, 6649, 441, 11, 43, "Input",ExpressionUUID->"80af1f50-7de9-4d40-bf50-7cdd4ad5e9bc"],
Cell[291853, 6662, 779, 15, 78, "Input",ExpressionUUID->"2ad24b1e-3dd5-4d02-808e-122bce227845"],
Cell[292635, 6679, 896, 20, 239, "Abstract",ExpressionUUID->"ee5f9626-8676-4d63-ab9c-6f1bb62e1c4e"],
Cell[293534, 6701, 108096, 1788, 63, "Output",ExpressionUUID->"869df0db-8989-485a-b802-c3eec7f62d5b"],
Cell[401633, 8491, 13279, 197, 213, "Input",ExpressionUUID->"c3d06f19-3fbc-44bb-8a35-65d2b366c98b",
 InitializationCell->True],
Cell[414915, 8690, 1129, 22, 147, "Input",ExpressionUUID->"f74edd0c-bdc1-4b20-a942-5e328134e566"],
Cell[416047, 8714, 832, 15, 78, "Input",ExpressionUUID->"294f32d2-f8d3-463a-a2fc-d30aec3d6ad1"],
Cell[416882, 8731, 1308, 26, 199, "Input",ExpressionUUID->"c99f8b5e-46e3-4f91-ab26-24537ac59914"],
Cell[418193, 8759, 1171, 24, 112, "Input",ExpressionUUID->"ac8cbc06-5b97-42bc-981c-ded36ae8bb9d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[419413, 8789, 388, 6, 59, "Section",ExpressionUUID->"252b1651-74c6-4b87-9a34-5e1424428717"],
Cell[CellGroupData[{
Cell[419826, 8799, 327, 6, 52, "Subsection",ExpressionUUID->"d44bae79-2155-4f08-993f-ae6f12d19a4b"],
Cell[420156, 8807, 804, 20, 262, "Abstract",ExpressionUUID->"af2f951b-0167-4564-ad71-69c29669fe04",
 InitializationCell->True],
Cell[420963, 8829, 3642, 61, 161, "Input",ExpressionUUID->"ffe693f4-2c4a-4eeb-8fee-0aba6aa81b88",
 InitializationCell->True],
Cell[424608, 8892, 5829, 145, 492, "Input",ExpressionUUID->"d247dba2-ba72-462c-9168-6106caf6e8fd"],
Cell[430440, 9039, 727, 15, 78, "Input",ExpressionUUID->"3415ebed-5e84-4589-8931-881bd5fa17e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431204, 9059, 291, 4, 52, "Subsection",ExpressionUUID->"444e95a4-9f71-42f1-8c30-2a8e29c8079c"],
Cell[431498, 9065, 2444, 49, 181, "Input",ExpressionUUID->"601b3238-e7cf-441b-a62e-60a6bfd4ef9d"],
Cell[433945, 9116, 1444, 32, 130, "Input",ExpressionUUID->"885077d5-c44c-4824-8af0-54b1afb4be89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435426, 9153, 523, 7, 52, "Subsection",ExpressionUUID->"741d095f-9fcf-4cd6-bb33-f13ec53abb92"],
Cell[435952, 9162, 1265, 22, 43, "Input",ExpressionUUID->"63fca51f-f993-4561-bde0-803306599b04"],
Cell[437220, 9186, 1499, 37, 233, "Input",ExpressionUUID->"9401841b-2015-4c78-92ed-e531e8bf0c30"]
}, Closed]],
Cell[CellGroupData[{
Cell[438756, 9228, 294, 4, 38, "Subsection",ExpressionUUID->"15f22d84-5a4e-4e2e-9bc7-31b42762f73d"],
Cell[439053, 9234, 768, 15, 125, "Abstract",ExpressionUUID->"c541626f-92f6-4d0f-b681-ee7cb634fe0d",
 InitializationCell->True],
Cell[439824, 9251, 1171, 19, 58, "Input",ExpressionUUID->"849c864d-3981-4594-9263-b342bcaecab9",
 InitializationCell->True],
Cell[440998, 9272, 4959, 133, 475, "Input",ExpressionUUID->"cf5db055-6feb-47a0-8ce7-86efc0fd40ec"],
Cell[445960, 9407, 1661, 39, 164, "Input",ExpressionUUID->"24af1147-b0bd-4c29-b390-acbd50afb418"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447658, 9451, 277, 4, 52, "Subsection",ExpressionUUID->"dc918b8c-dd63-4df2-aa40-73565799173b"],
Cell[447938, 9457, 764, 16, 148, "Abstract",ExpressionUUID->"e48d3d99-21de-4ff7-a9b0-8efa38d6eb1c",
 InitializationCell->True],
Cell[448705, 9475, 1359, 23, 75, "Input",ExpressionUUID->"dfef6382-cb4f-4f0f-b84c-f361aeb1e14c",
 InitializationCell->True],
Cell[450067, 9500, 3757, 85, 285, "Input",ExpressionUUID->"eb016804-e9dd-40ad-80f1-0b981658d5de"],
Cell[453827, 9587, 1001, 17, 78, "Input",ExpressionUUID->"1d3d52d0-9970-4f59-84fb-c119a9cb6095"]
}, Open  ]],
Cell[CellGroupData[{
Cell[454865, 9609, 277, 4, 52, "Subsection",ExpressionUUID->"754e3d7a-1826-4221-98f6-e7acdf195606"],
Cell[455145, 9615, 660, 13, 103, "Abstract",ExpressionUUID->"855ff445-2fbc-4d17-be81-a9d920703a39",
 InitializationCell->True],
Cell[455808, 9630, 713, 12, 39, "Input",ExpressionUUID->"c294f1d5-0356-48d3-b262-35e3284bf382",
 InitializationCell->True],
Cell[456524, 9644, 3657, 92, 423, "Input",ExpressionUUID->"502e8cd7-6702-4de6-9d88-a5d1ec0fa53f"],
Cell[460184, 9738, 1105, 23, 284, "Abstract",ExpressionUUID->"7614e53c-a088-4945-9f29-892d0b6d6ba8",
 InitializationCell->True],
Cell[461292, 9763, 2384, 46, 178, "Input",ExpressionUUID->"2a0eb114-3c6f-460f-b314-fc3cd92bc552",
 InitializationCell->True],
Cell[463679, 9811, 2342, 56, 250, "Input",ExpressionUUID->"a836b6a6-97fa-4806-9786-fc568d8bf777"],
Cell[466024, 9869, 996, 17, 78, "Input",ExpressionUUID->"7e1e348e-d062-4828-99b8-cf685bf5cd41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467057, 9891, 286, 4, 52, "Subsection",ExpressionUUID->"83cde701-c71f-4baa-be3c-829d7c3691cc"],
Cell[467346, 9897, 2144, 47, 233, "Input",ExpressionUUID->"f0837b87-d930-4997-b83e-37ae033170a6"],
Cell[469493, 9946, 1059, 18, 78, "Input",ExpressionUUID->"05b1539e-3ad6-4bc0-87ab-153ae880c30c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470589, 9969, 293, 4, 52, "Subsection",ExpressionUUID->"e79640d4-7efa-4e10-b72a-6eb94ca51e6f"],
Cell[470885, 9975, 499, 12, 61, "Input",ExpressionUUID->"9d025a70-28a4-4ca3-b2f5-f60a51acf985"],
Cell[471387, 9989, 703, 15, 148, "Abstract",ExpressionUUID->"a8ec029f-b833-4679-9f54-ca6253ad3445",
 InitializationCell->True],
Cell[472093, 10006, 479, 13, 75, "Input",ExpressionUUID->"735701ff-185f-4e30-9c40-35ca4d1d40dd",
 InitializationCell->True],
Cell[472575, 10021, 1723, 38, 216, "Input",ExpressionUUID->"9b86b1a9-f9c4-46f6-a09c-7567d924db0f"],
Cell[474301, 10061, 1088, 25, 352, "Abstract",ExpressionUUID->"7df7fbbe-3d87-455d-b19b-6f4328488475",
 InitializationCell->True],
Cell[475392, 10088, 2812, 54, 230, "Input",ExpressionUUID->"9d0aa1a8-a7d9-437d-8bc0-063d37fa5c61",
 InitializationCell->True],
Cell[478207, 10144, 2987, 64, 302, "Input",ExpressionUUID->"d21db55c-e83a-4507-9f09-fcc97af21d8c"],
Cell[481197, 10210, 1116, 19, 78, "Input",ExpressionUUID->"5e626c11-f045-45ac-9a10-d81ff8b75c80"],
Cell[482316, 10231, 687, 13, 103, "Abstract",ExpressionUUID->"51ff6493-bf55-4d3e-9025-42bbc49f8b26",
 InitializationCell->True],
Cell[483006, 10246, 471, 9, 39, "Input",ExpressionUUID->"04417c55-dd98-4d86-975e-650e27b9f7df",
 InitializationCell->True],
Cell[483480, 10257, 1056, 22, 147, "Input",ExpressionUUID->"67c7bfab-acc3-4b72-a3d1-78d55924ffa3"],
Cell[484539, 10281, 2185, 43, 112, "Input",ExpressionUUID->"fdf531f1-7233-4c27-bedf-f65e21961873"],
Cell[486727, 10326, 1169, 19, 78, "Input",ExpressionUUID->"4a9dd992-d5d8-4224-99b1-bbe3989db355"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487933, 10350, 322, 4, 52, "Subsection",ExpressionUUID->"657e25ee-2227-4da0-a350-3de307b0415d"],
Cell[488258, 10356, 1517, 32, 164, "Input",ExpressionUUID->"2ce70849-3d8f-46fe-8110-2771d6a43212"],
Cell[489778, 10390, 896, 21, 262, "Abstract",ExpressionUUID->"95b5acb3-8535-4b83-b795-81b94823f128",
 InitializationCell->True],
Cell[490677, 10413, 2878, 52, 161, "Input",ExpressionUUID->"cb36a2b2-0843-4db0-b200-d65fa22e73f8",
 InitializationCell->True],
Cell[493558, 10467, 2159, 47, 250, "Input",ExpressionUUID->"95dd2822-83f3-41ee-baf0-888736cecf3a"],
Cell[495720, 10516, 3164, 59, 164, "Input",ExpressionUUID->"75b526bb-2cc4-4dca-af79-ad2c3fa72d81"],
Cell[498887, 10577, 950, 17, 25, "Input",ExpressionUUID->"520e8e17-d80b-4121-a8d5-955e77eeffaa"],
Cell[499840, 10596, 1039, 24, 307, "Abstract",ExpressionUUID->"e998fe8e-718b-4398-8d2a-e079d104f911",
 InitializationCell->True],
Cell[500882, 10622, 3991, 74, 247, "Input",ExpressionUUID->"fc3fb5e6-8a3c-403e-bed8-8f8b3f96faa2",
 InitializationCell->True],
Cell[504876, 10698, 3061, 73, 216, "Input",ExpressionUUID->"b8f0355a-a516-4479-8eb2-8bf3ee51a071"],
Cell[507940, 10773, 1272, 21, 78, "Input",ExpressionUUID->"ea767c9b-a400-4f45-911b-c7016d00a521"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[509261, 10800, 298, 5, 59, "Section",ExpressionUUID->"b7890234-067c-4f2e-b525-97437688fafc"],
Cell[CellGroupData[{
Cell[509584, 10809, 315, 4, 52, "Subsection",ExpressionUUID->"7b57015b-fd59-4686-83bf-cb64803dd271"],
Cell[509902, 10815, 4268, 60, 58, "Input",ExpressionUUID->"1196e3a2-13e0-43f9-887c-4e81114e1ee8",
 InitializationCell->True],
Cell[514173, 10877, 1479, 33, 130, "Input",ExpressionUUID->"9a9dcf2a-c7f2-488f-b0a3-afe376fdbfcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[515689, 10915, 360, 5, 52, "Subsection",ExpressionUUID->"6cc62612-96bb-4e29-9934-13874a978456"],
Cell[516052, 10922, 2038, 36, 130, "Input",ExpressionUUID->"410f4bb3-1988-49b5-87a7-0d2bf33ec2db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[518127, 10963, 825, 12, 48, "Subsection",ExpressionUUID->"1392dbf0-a00f-4dbf-ad11-f67b56b5b4b1"],
Cell[518955, 10977, 892, 22, 61, "Input",ExpressionUUID->"0d9dd891-04d7-474b-bece-fbf6f9e4ac17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[519884, 11004, 1039, 15, 48, "Subsection",ExpressionUUID->"ebd31fee-9894-4032-bc09-ac39f484f772"],
Cell[520926, 11021, 758, 15, 103, "Abstract",ExpressionUUID->"d6c81a0a-104d-4136-b05c-42c51cdbc8bd",
 InitializationCell->True],
Cell[521687, 11038, 854, 15, 39, "Input",ExpressionUUID->"d888d674-edfb-4e4d-ab94-38ccce52e2ff",
 InitializationCell->True],
Cell[522544, 11055, 2545, 58, 337, "Input",ExpressionUUID->"e59b3f19-f922-4842-ac55-7d426825ef53"],
Cell[525092, 11115, 1126, 23, 95, "Input",ExpressionUUID->"351f89f5-8e1c-484e-9268-db5fbd1f7edd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[526255, 11143, 919, 13, 48, "Subsection",ExpressionUUID->"04e993a1-cdfc-4a84-9496-1cee884d221c"],
Cell[527177, 11158, 1320, 30, 78, "Input",ExpressionUUID->"3cf8948d-3ece-4d9d-8cc2-31df7d03546e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[528534, 11193, 961, 14, 48, "Subsection",ExpressionUUID->"0a924c8b-64cd-43a7-882c-9ff30d618f78"],
Cell[529498, 11209, 457, 10, 103, "Abstract",ExpressionUUID->"ac05ae60-84e3-4afb-8efc-0eb2ce60b2e2"],
Cell[529958, 11221, 342, 7, 39, "Input",ExpressionUUID->"91e9802c-04dd-4764-b3f2-65f14035325b",
 InitializationCell->True],
Cell[530303, 11230, 1521, 35, 181, "Input",ExpressionUUID->"ccb06388-5b79-4a1d-ad4f-d1a153e9977f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[531861, 11270, 962, 14, 48, "Subsection",ExpressionUUID->"d3a30a14-8f59-4ae5-8aef-f997d95325cc"],
Cell[532826, 11286, 1621, 39, 112, "Input",ExpressionUUID->"896b0f59-6122-49f7-90a2-c451d0a2eb70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[534484, 11330, 1053, 15, 48, "Subsection",ExpressionUUID->"51c68a2a-38e5-49d5-8d35-b4fae3e77dc8"],
Cell[535540, 11347, 558, 12, 148, "Abstract",ExpressionUUID->"6bb607da-104c-4afd-a33a-d4685646961e"],
Cell[536101, 11361, 1306, 24, 75, "Input",ExpressionUUID->"b39d27ce-7afb-44fe-ba32-69aa6c2b8367",
 InitializationCell->True],
Cell[537410, 11387, 1626, 35, 95, "Input",ExpressionUUID->"12c90e91-6f71-4c9b-b97d-0f255b59f692"]
}, Open  ]],
Cell[CellGroupData[{
Cell[539073, 11427, 1025, 15, 48, "Subsection",ExpressionUUID->"ff266445-38af-41c6-84e4-34571b2b0a93"],
Cell[540101, 11444, 601, 12, 125, "Abstract",ExpressionUUID->"2601d965-8ca2-4e97-ae88-e80b8141bfc0"],
Cell[540705, 11458, 466, 11, 58, "Input",ExpressionUUID->"e285167e-0b66-42c7-8953-b7091f57195d",
 InitializationCell->True],
Cell[541174, 11471, 1963, 47, 147, "Input",ExpressionUUID->"c7d85d33-2d98-4f38-9b6d-b791a5ed9012"]
}, Open  ]],
Cell[CellGroupData[{
Cell[543174, 11523, 1071, 15, 48, "Subsection",ExpressionUUID->"92c7c829-27b7-477b-9f85-0d4fed4a286f"],
Cell[544248, 11540, 692, 17, 239, "Abstract",ExpressionUUID->"b55380f0-294f-4ecd-87ba-02cb3fee45b5"],
Cell[544943, 11559, 823, 22, 144, "Input",ExpressionUUID->"4a1092dc-fc82-42b2-9005-c06b2048c081",
 InitializationCell->True],
Cell[545769, 11583, 1957, 47, 233, "Input",ExpressionUUID->"65a2b581-7763-4591-8b6f-89c373aadb06"],
Cell[CellGroupData[{
Cell[547751, 11634, 180, 3, 41, "Subsubsection",ExpressionUUID->"523888ac-3960-49d9-a805-16148a333c74"],
Cell[547934, 11639, 844, 19, 78, "Input",ExpressionUUID->"4accd6dd-6730-472c-9d75-7d7a61194bcb"],
Cell[548781, 11660, 5689, 98, 319, "Input",ExpressionUUID->"d6a07618-94f4-48d0-baf9-47036a9b3d51"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[554519, 11764, 986, 14, 48, "Subsection",ExpressionUUID->"52a7c121-d66d-4832-af94-256904322318"],
Cell[555508, 11780, 2452, 59, 319, "Input",ExpressionUUID->"b6bb52dd-b081-40ef-811e-6acbebec2c6f"],
Cell[CellGroupData[{
Cell[557985, 11843, 1062, 15, 41, "Subsubsection",ExpressionUUID->"25a3458d-a691-4839-9b9e-f3ba2d1fc9dd"],
Cell[559050, 11860, 637, 17, 25, "Input",ExpressionUUID->"d9cb82fc-8a07-482d-b927-58865b5bc89f"],
Cell[559690, 11879, 2332, 52, 147, "Input",ExpressionUUID->"cc50011f-0d23-4d47-a858-5c8298fd83ff"],
Cell[562025, 11933, 1193, 28, 61, "Input",ExpressionUUID->"6626a6ea-39b7-4bf5-8c5e-b8616af4a038"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[563267, 11967, 1043, 15, 48, "Subsection",ExpressionUUID->"4132375c-bc98-4914-8274-921bbc269d97"],
Cell[564313, 11984, 1501, 29, 109, "Input",ExpressionUUID->"fc9be3f3-00c1-4cf9-991a-7fa513a33ebe",
 InitializationCell->True],
Cell[565817, 12015, 711, 18, 239, "Abstract",ExpressionUUID->"9e1914f3-f6ca-4d10-936d-872f2b966c3b"],
Cell[566531, 12035, 2278, 41, 144, "Input",ExpressionUUID->"51a76618-992c-4801-8d34-10cda4b499e0",
 InitializationCell->True],
Cell[568812, 12078, 3846, 72, 216, "Input",ExpressionUUID->"b4eacca6-c0de-4992-93c9-5c134de16c18"],
Cell[572661, 12152, 2223, 44, 268, "Input",ExpressionUUID->"bb207d89-6550-4137-aaae-d649bfdc32d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[574921, 12201, 1027, 15, 48, "Subsection",ExpressionUUID->"69d98335-8c6b-412e-b946-8c2b7673730e"],
Cell[575951, 12218, 1807, 29, 75, "Input",ExpressionUUID->"2896a955-d7d9-4025-892c-3c111d0c6177",
 InitializationCell->True],
Cell[577761, 12249, 365, 8, 25, "Input",ExpressionUUID->"1f8c4392-b892-4605-91a6-aca973a07360"],
Cell[578129, 12259, 984, 18, 78, "Input",ExpressionUUID->"1c99ba3c-09e8-4cc0-80fe-d24528064892"]
}, Open  ]],
Cell[CellGroupData[{
Cell[579150, 12282, 851, 14, 48, "Subsection",ExpressionUUID->"6c730c9f-2440-4675-8a09-4c09718e5f5b"],
Cell[580004, 12298, 1682, 50, 43, "Input",ExpressionUUID->"e5d0f4bc-f076-4ddc-bfbf-5963029c186e"],
Cell[581689, 12350, 241, 3, 78, "Abstract",ExpressionUUID->"acf83015-85ed-413d-8b20-76491b4c413a"],
Cell[581933, 12355, 1682, 50, 43, "Input",ExpressionUUID->"53e03ae8-b03a-4459-841a-ddf5352a8491"],
Cell[583618, 12407, 1078, 14, 29, "Subitem",ExpressionUUID->"99d72d06-1ab3-4e11-8e60-40da3a618343"],
Cell[584699, 12423, 445, 16, 330, "Abstract",ExpressionUUID->"f12e4be4-d1bf-466d-a5be-f1a6eb07dcb0"],
Cell[585147, 12441, 1770, 40, 213, "Input",ExpressionUUID->"c0223776-8d87-47af-a513-5c23107b00a4",
 InitializationCell->True],
Cell[586920, 12483, 2904, 66, 475, "Input",ExpressionUUID->"d57da1ba-cb62-4c55-b918-affc4dc7dc22"],
Cell[589827, 12551, 1989, 45, 199, "Input",ExpressionUUID->"e542bdbc-0e29-40c3-8774-b4f78d95e7e2"],
Cell[591819, 12598, 2071, 45, 285, "Input",ExpressionUUID->"58057baf-e4f0-4a07-b351-9f33564aa56e"],
Cell[593893, 12645, 3767, 91, 578, "Input",ExpressionUUID->"4565c98c-b011-4a84-9e4c-69a84ceaf689"],
Cell[597663, 12738, 1705, 34, 337, "Input",ExpressionUUID->"0347f436-4000-4f55-9d4c-047b4e9c1d37"],
Cell[599371, 12774, 1682, 50, 43, "Input",ExpressionUUID->"5c800286-3322-4ffc-93d1-4a0411a4c8ad"],
Cell[601056, 12826, 295, 4, 78, "Abstract",ExpressionUUID->"fd09a6c4-169b-4a36-aa9c-98e0eb44926a"],
Cell[601354, 12832, 1682, 50, 43, "Input",ExpressionUUID->"01844d75-67d9-4021-8bb8-efad99e646b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[603073, 12887, 1059, 15, 34, "Subsection",ExpressionUUID->"20ec0a83-a042-4d1c-8935-71a3631e981d"],
Cell[604135, 12904, 534, 11, 103, "Abstract",ExpressionUUID->"68b90f2b-2553-4c4a-a049-8af24d08e8c9"],
Cell[604672, 12917, 369, 8, 39, "Input",ExpressionUUID->"38c82971-05d6-472b-84fe-c2f90a093ef4",
 InitializationCell->True],
Cell[605044, 12927, 2706, 62, 285, "Input",ExpressionUUID->"4f548078-2028-41ed-af12-81654e5a141f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[607799, 12995, 1173, 17, 59, "Section",ExpressionUUID->"2b64250c-c2c3-49bc-823a-6dea98b46960"],
Cell[CellGroupData[{
Cell[608997, 13016, 1183, 17, 48, "Subsection",ExpressionUUID->"ff872022-4438-4167-90c1-17522c53fe0b"],
Cell[610183, 13035, 618, 13, 148, "Abstract",ExpressionUUID->"7b62fbe8-6933-446e-a31e-6b844150aebf"],
Cell[610804, 13050, 3815, 56, 75, "Input",ExpressionUUID->"87402a7b-bbf9-45c1-ab21-a5a120588cc8",
 InitializationCell->True],
Cell[614622, 13108, 1688, 31, 130, "Input",ExpressionUUID->"4ba33ef8-1aa8-4fa1-ae27-ab8e88561075"],
Cell[616313, 13141, 659, 13, 78, "Input",ExpressionUUID->"988bc412-1fa4-4b64-81de-7e048d2d56a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[617009, 13159, 1223, 17, 48, "Subsection",ExpressionUUID->"8a6f76c2-28d9-48f8-ad9c-a8f9cfec778e"],
Cell[618235, 13178, 988, 22, 284, "Abstract",ExpressionUUID->"89c0d29b-06d8-4d2c-9380-5aae11be5ebc"],
Cell[619226, 13202, 6871, 103, 178, "Input",ExpressionUUID->"75036ac2-7dfe-4fdb-923c-18533693271a",
 InitializationCell->True],
Cell[626100, 13307, 7514, 107, 78, "Input",ExpressionUUID->"c240b065-2ebd-40fc-a933-e7246aef6606"],
Cell[633617, 13416, 147, 3, 43, "Input",ExpressionUUID->"56f33684-343c-40ad-9531-b33c5a4cfd67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[633801, 13424, 1318, 20, 48, "Subsection",ExpressionUUID->"ef664de0-b10c-4b96-8dbb-735db0292cda"],
Cell[635122, 13446, 879, 17, 43, "Input",ExpressionUUID->"88b20394-0e67-4d39-bd11-004e11c1ebeb"],
Cell[636004, 13465, 1064, 24, 307, "Abstract",ExpressionUUID->"b6e36da3-81ca-441d-9b3c-79f534e70dc5"],
Cell[637071, 13491, 5784, 91, 213, "Input",ExpressionUUID->"3821deab-a10d-4060-94cb-e6b6a2872d69",
 InitializationCell->True],
Cell[642858, 13584, 2047, 44, 233, "Input",ExpressionUUID->"c7cdd761-0c25-4791-adb1-66a388c7f93d"],
Cell[644908, 13630, 1033, 17, 223, "Abstract",ExpressionUUID->"9b37f76a-fc3d-4033-b8da-ddb768a1ba6d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[645978, 13652, 1380, 19, 48, "Subsection",ExpressionUUID->"41423101-e252-4f12-8ae4-0341ac92a5c3"],
Cell[647361, 13673, 1695, 27, 95, "Input",ExpressionUUID->"2be8557e-b6d5-48c9-bbd9-114cc443a4b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[649093, 13705, 1540, 22, 52, "Subsection",ExpressionUUID->"da74216c-e5d9-4e72-812d-95a96808464c"],
Cell[650636, 13729, 1061, 21, 25, "Input",ExpressionUUID->"9388906c-35ed-4612-855e-8b6472621a42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[651734, 13755, 1355, 19, 48, "Subsection",ExpressionUUID->"9b13fd71-fa42-45df-98d2-e18bd5561a99"],
Cell[653092, 13776, 807, 14, 103, "Abstract",ExpressionUUID->"22e8a15c-66d6-44a1-ba0d-cb9ad8e420d6"],
Cell[653902, 13792, 599, 11, 39, "Input",ExpressionUUID->"5a9d4c3c-7ddd-4c31-ae91-5f9e740a0f8f",
 InitializationCell->True],
Cell[654504, 13805, 2343, 56, 250, "Input",ExpressionUUID->"2c09721b-ca09-4e54-acfc-3e3b01848eac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[656884, 13866, 1390, 20, 48, "Subsection",ExpressionUUID->"6dadc548-0b3b-45f3-bb83-3add3cc22aed"],
Cell[658277, 13888, 939, 16, 125, "Abstract",ExpressionUUID->"33231405-2cf8-4080-8e78-26a382daef95"],
Cell[659219, 13906, 584, 13, 58, "Input",ExpressionUUID->"964ab37c-d4a6-4ada-9441-198de9d251fd",
 InitializationCell->True],
Cell[659806, 13921, 1885, 44, 181, "Input",ExpressionUUID->"4723fcf6-78eb-457f-8bc8-4996f1547cae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[661728, 13970, 1400, 19, 48, "Subsection",ExpressionUUID->"475ae74a-2551-4742-b473-6e2302de7250"],
Cell[663131, 13991, 979, 18, 148, "Abstract",ExpressionUUID->"59987e1e-dad6-4093-9d5b-fbb360ff1ad9"],
Cell[664113, 14011, 2298, 36, 75, "Input",ExpressionUUID->"06a80169-bd3e-47a5-950e-c04de0eabde8",
 InitializationCell->True],
Cell[666414, 14049, 1576, 34, 95, "Input",ExpressionUUID->"a506d580-3f2b-4da2-822a-e26f71300686"],
Cell[667993, 14085, 1625, 29, 164, "Input",ExpressionUUID->"768417f7-bf15-47cc-b466-928c73e39369"]
}, Open  ]],
Cell[CellGroupData[{
Cell[669655, 14119, 1400, 20, 48, "Subsection",ExpressionUUID->"fc18e74e-7e51-4b78-9501-f4735378dfee"],
Cell[671058, 14141, 766, 14, 103, "Abstract",ExpressionUUID->"00d43d31-eb5d-4838-a1d8-34c80babb597"],
Cell[671827, 14157, 757, 13, 39, "Input",ExpressionUUID->"fe0b865d-6560-48a4-9f8e-f59f7c84958c",
 InitializationCell->True],
Cell[672587, 14172, 3617, 89, 423, "Input",ExpressionUUID->"ee2317e0-ecaf-4341-9476-d752caf7ee53"],
Cell[676207, 14263, 1599, 34, 285, "Input",ExpressionUUID->"5a8c71d4-35ae-41f9-be56-66b76d7573a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[677843, 14302, 1181, 17, 48, "Subsection",ExpressionUUID->"a3a1db0d-75a1-4181-ae6c-9b9c94f872cf"],
Cell[679027, 14321, 1144, 15, 29, "Subitem",ExpressionUUID->"871f8648-230b-4fee-b5fd-198516f0df61"],
Cell[680174, 14338, 748, 14, 125, "Abstract",ExpressionUUID->"a9b8b331-05c3-4bea-9ac4-cf59dbee032f"],
Cell[680925, 14354, 1608, 25, 58, "Input",ExpressionUUID->"1d431070-19b8-49bc-bd5b-b87117431a8a",
 InitializationCell->True],
Cell[682536, 14381, 2599, 63, 302, "Input",ExpressionUUID->"f47aab01-e49b-408a-8c97-35f5faa86b31"],
Cell[685138, 14446, 1562, 31, 112, "Input",ExpressionUUID->"8d935ec8-0f9e-48e7-8fbb-b267dd6bb8e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[686749, 14483, 300, 5, 59, "Section",ExpressionUUID->"8a698108-befd-4c75-8e6d-3bfc6e98e904"],
Cell[CellGroupData[{
Cell[687074, 14492, 1041, 15, 48, "Subsection",ExpressionUUID->"5b7207e9-4a88-4eac-9912-e6d21a226d96"],
Cell[688118, 14509, 790, 14, 103, "Abstract",ExpressionUUID->"0c0b2892-606d-4576-9f01-e7104b2b7dc8"],
Cell[688911, 14525, 2387, 35, 39, "Input",ExpressionUUID->"1fbe5f60-74cf-4892-aee7-79a29a3adea1",
 InitializationCell->True],
Cell[691301, 14562, 1133, 22, 130, "Input",ExpressionUUID->"3f852cdc-65da-44c6-8e29-e6271ef8b10f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[692471, 14589, 1090, 16, 48, "Subsection",ExpressionUUID->"d994c70f-7b3d-448c-b194-63a8b56c585c"],
Cell[693564, 14607, 1125, 22, 216, "Abstract",ExpressionUUID->"4e933f00-3b82-4997-b78a-87a41aa50ffd"],
Cell[694692, 14631, 2962, 49, 127, "Input",ExpressionUUID->"b6885f77-ccfe-439c-aa2f-a36aa19f40b9",
 InitializationCell->True],
Cell[697657, 14682, 2689, 54, 181, "Input",ExpressionUUID->"4683de75-aad5-43d6-a099-75041742152d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[700383, 14741, 1168, 17, 48, "Subsection",ExpressionUUID->"1e9f0b0e-d844-406a-839d-a29e131fb7aa"],
Cell[701554, 14760, 1207, 22, 171, "Abstract",ExpressionUUID->"936be246-00af-4a1b-9d38-9afa8c5177ab"],
Cell[702764, 14784, 2311, 38, 92, "Input",ExpressionUUID->"d3efc333-3a66-4c73-80ab-ebc477c56f83",
 InitializationCell->True],
Cell[705078, 14824, 4420, 121, 371, "Input",ExpressionUUID->"4aeefe0a-b444-4cc1-9bc2-419da5f09181"],
Cell[709501, 14947, 1365, 31, 233, "Input",ExpressionUUID->"061d0f78-e8c8-4404-992f-54e65fd34554"],
Cell[710869, 14980, 849, 19, 164, "Input",ExpressionUUID->"b6a67b93-f0bc-4d24-aa89-104739c12672"]
}, Open  ]],
Cell[CellGroupData[{
Cell[711755, 15004, 1119, 16, 48, "Subsection",ExpressionUUID->"e08d7376-4fba-468f-98e8-d7ddd1c4e105"],
Cell[712877, 15022, 884, 16, 125, "Abstract",ExpressionUUID->"8e323864-24fb-47b4-aa74-be8511b3dccf"],
Cell[713764, 15040, 8326, 116, 58, "Input",ExpressionUUID->"56c88cb6-310c-4279-8b63-f1b0e0908944",
 InitializationCell->True],
Cell[722093, 15158, 4065, 85, 371, "Input",ExpressionUUID->"0c5717a1-7c0d-4228-9c6f-f1e93e921f3a"],
Cell[726161, 15245, 3107, 46, 78, "Input",ExpressionUUID->"6c350752-353e-4b2e-97f2-215b73fdf3c7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[729317, 15297, 512, 8, 59, "Section",ExpressionUUID->"5fd1f7a3-8aba-4c1a-abbf-29600889f60a"],
Cell[729832, 15307, 1048, 13, 29, "Subitem",ExpressionUUID->"489bde9e-995a-4989-b945-9722eae613fd"],
Cell[730883, 15322, 3721, 81, 282, "Input",ExpressionUUID->"3825adbd-27b8-46fb-a4b8-2746abe76d8c",
 InitializationCell->True],
Cell[734607, 15405, 810, 18, 216, "Abstract",ExpressionUUID->"c85040e2-791d-42e2-a32d-e9e0e5162428"],
Cell[735420, 15425, 2848, 53, 265, "Input",ExpressionUUID->"e35e43bb-06fb-4ba2-b4df-b652d57183b3",
 InitializationCell->True],
Cell[738271, 15480, 9043, 175, 1337, "Input",ExpressionUUID->"a31bab7e-df6d-4e23-a0ef-d5f14b523b12"]
}, Closed]],
Cell[CellGroupData[{
Cell[747351, 15660, 574, 8, 47, "Section",ExpressionUUID->"cf9b23cc-b6a6-431b-a6db-43e8efc0588d"],
Cell[747928, 15670, 1240, 30, 164, "Input",ExpressionUUID->"d6f7da97-2e1f-43cb-be75-e4f3fc4a75c6"]
}, Open  ]]
}
]
*)

